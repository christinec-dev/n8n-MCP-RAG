{
  "source": "docs/courses/level-two/chapter-5/chapter-5.2.md",
  "index": 5,
  "content": "## Part 3: Generating files for total sales\n\nThe third part of the workflow consists of five nodes:\n\n<figure><img src=\"/_images/courses/level-two/chapter-five/workflow2_3.png\" alt=\"Workflow 3: Generating files for total sales\" style=\"width:100%\"><figcaption align = \"center\"><i>Workflow 3: Generating files for total sales</i></figcaption></figure>\n\n1. Use the [**Loop Over Items node**](/integrations/builtin/core-nodes/n8n-nodes-base.splitinbatches.md) to split data from the Item Lists node into batches of 5.\n2. Use the [**Set node**](/integrations/builtin/core-nodes/n8n-nodes-base.set.md) to set four values, referenced with expressions from the previous node: `customerEmail`, `customerRegion`, `customerSince`, and `orderPrice`.\n3. Use the [**Date & Time node**](/integrations/builtin/core-nodes/n8n-nodes-base.datetime.md) to change the date format of the field `customerSince` to the format MM/DD/YYYY.\n    - Set the **Include Input Fields** option to keep all the data together.\n4. Use the [**Convert to File node**](/integrations/builtin/core-nodes/n8n-nodes-base.converttofile.md) to create a CSV spreadsheet with the file name set as the expression: `{{$runIndex > 0 ? 'file_low_orders':'file_high_orders'}}`.\n5. Use the [**Discord node**](/integrations/builtin/app-nodes/n8n-nodes-base.discord/index.md) to send a message in the n8n Discord channel `#course-level-two`. In the node, configure the following parameters:\n    * **Webhook URL**: The Discord URL you received in the email when you signed up for this course.\n    * **Text**: \"I created the spreadsheet `{file name}`. My ID:\" followed by the unique ID emailed to you when you registered for this course. <br/> Note that you need to replace `{file name}` with an expression that references data from the previous **Convert to File node**.<br/>\n\n/// question | Quiz questions\n* What's the lowest order price in the first batch of items?\n* What's the formatted date of customer 7?\n* How many items does the **Convert to File node** return?\n///\n\n??? note \"Show me the solution\"\n\n\tTo check the configuration of the nodes, you can copy the JSON workflow code below and paste it into your Editor UI:\n\n\t```json\n    {\n    \"meta\": {\n        \"templateCredsSetupCompleted\": true,\n        \"instanceId\": \"cb484ba7b742928a2048bf8829668bed5b5ad9787579adea888f05980292a4a7\"\n    },\n    \"nodes\": [\n        {\n        \"parameters\": {\n            \"sendTo\": \"bart@n8n.io\",\n            \"subject\": \"Your TPS Reports\",\n            \"emailType\": \"text\",\n            \"message\": \"Please find your TPS report attached.\",\n            \"options\": {\n            \"attachmentsUi\": {\n                \"attachmentsBinary\": [\n                {}\n                ]\n            }\n            }\n        },\n        \"id\": \"d889eb42-8b34-4718-b961-38c8e7839ea6\",\n        \"name\": \"Gmail\",\n        \"type\": \"n8n-nodes-base.gmail\",\n        \"typeVersion\": 2.1,\n        \"position\": [\n            2100,\n            500\n        ],\n        \"credentials\": {\n            \"gmailOAuth2\": {\n            \"id\": \"HFesCcFcn1NW81yu\",\n            \"name\": \"Gmail account 7\"\n            }"
}