{
  "source": "docs/hosting/installation/server-setups/docker-compose.md",
  "index": 21,
  "content": "## 6. Create Docker Compose file\n\nCreate a `compose.yaml` file. Paste the following in the file:\n\n```yaml title=\"compose.yaml file\"\nservices:\n  traefik:\n    image: \"traefik\"\n    restart: always\n    command:\n      - \"--api.insecure=true\"\n      - \"--providers.docker=true\"\n      - \"--providers.docker.exposedbydefault=false\"\n      - \"--entrypoints.web.address=:80\"\n      - \"--entrypoints.web.http.redirections.entryPoint.to=websecure\"\n      - \"--entrypoints.web.http.redirections.entrypoint.scheme=https\"\n      - \"--entrypoints.websecure.address=:443\"\n      - \"--certificatesresolvers.mytlschallenge.acme.tlschallenge=true\"\n      - \"--certificatesresolvers.mytlschallenge.acme.email=${SSL_EMAIL}\"\n      - \"--certificatesresolvers.mytlschallenge.acme.storage=/letsencrypt/acme.json\"\n    ports:\n      - \"80:80\"\n      - \"443:443\"\n    volumes:\n      - traefik_data:/letsencrypt\n      - /var/run/docker.sock:/var/run/docker.sock:ro\n\n  n8n:\n    image: docker.n8n.io/n8nio/n8n\n    restart: always\n    ports:\n      - \"127.0.0.1:5678:5678\"\n    labels:\n      - traefik.enable=true\n      - traefik.http.routers.n8n.rule=Host(`${SUBDOMAIN}.${DOMAIN_NAME}`)\n      - traefik.http.routers.n8n.tls=true\n      - traefik.http.routers.n8n.entrypoints=web,websecure\n      - traefik.http.routers.n8n.tls.certresolver=mytlschallenge\n      - traefik.http.middlewares.n8n.headers.SSLRedirect=true\n      - traefik.http.middlewares.n8n.headers.STSSeconds=315360000\n      - traefik.http.middlewares.n8n.headers.browserXSSFilter=true\n      - traefik.http.middlewares.n8n.headers.contentTypeNosniff=true\n      - traefik.http.middlewares.n8n.headers.forceSTSHeader=true\n      - traefik.http.middlewares.n8n.headers.SSLHost=${DOMAIN_NAME}\n      - traefik.http.middlewares.n8n.headers.STSIncludeSubdomains=true\n      - traefik.http.middlewares.n8n.headers.STSPreload=true\n      - traefik.http.routers.n8n.middlewares=n8n@docker\n    environment:\n      - N8N_HOST=${SUBDOMAIN}.${DOMAIN_NAME}\n      - N8N_PORT=5678\n      - N8N_PROTOCOL=https\n      - NODE_ENV=production\n      - WEBHOOK_URL=https://${SUBDOMAIN}.${DOMAIN_NAME}/\n      - GENERIC_TIMEZONE=${GENERIC_TIMEZONE}\n    volumes:\n      - n8n_data:/home/node/.n8n\n      - ./local-files:/files\n\nvolumes:\n  n8n_data:\n  traefik_data:\n```\n\nThe above Docker Compose file configures two containers: one for n8n, and one to run [traefik](https://github.com/traefik/traefik), an application proxy to manage TLS/SSL certificates and handle routing.\n\nIt also creates and mounts two [Docker Volumes](https://docs.docker.com/engine/storage/volumes/) and mounts the `local-files` directory you created earlier:\n\n   | Name            | Type                                                        | Container mount   | Description                                                                                                                         |\n   |-----------------|-------------------------------------------------------------|-------------------|-------------------------------------------------------------------------------------------------------------------------------------|\n   | `n8n_data`      | [Volume](https://docs.docker.com/engine/storage/volumes/)   | `/home/node/.n8n` | Where n8n saves its SQLite database file and encryption key"
}