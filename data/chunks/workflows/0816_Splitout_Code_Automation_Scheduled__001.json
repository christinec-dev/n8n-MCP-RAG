{
  "source": "0816_Splitout_Code_Automation_Scheduled.json",
  "index": 1,
  "content": "{\n  \"meta\": {\n    \"instanceId\": \"408f9fb9940c3cb18ffdef0e0150fe342d6e655c3a9fac21f0f644e8bedabcd9\",\n    \"templateCredsSetupCompleted\": true\n  },\n  \"nodes\": [\n    {\n      \"id\": \"59b7eed3-8622-4722-b93f-f225cc0aa4e0\",\n      \"name\": \"Spam Detection\",\n      \"type\": \"@n8n/n8n-nodes-langchain.textClassifier\",\n      \"position\": [\n        260,\n        100\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"inputText\": \"={{ $json.content }}\",\n        \"categories\": {\n          \"categories\": [\n            {\n              \"category\": \"is_spam\",\n              \"description\": \"This text is a promotion, sales pitch or likely spam message to get members to visit another site.\"\n            },\n            {\n              \"category\": \"is_not_spam\",\n              \"description\": \"This text is not spam.\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"74420874-d831-4ff0-a8f4-e7c3b6551c57\",\n      \"name\": \"Get Recent Messages\",\n      \"type\": \"n8n-nodes-base.discord\",\n      \"position\": [\n        -1020,\n        40\n      ],\n      \"webhookId\": \"7aa72e1f-06f4-4fe8-82ec-ad0e87a5b6b9\",\n      \"parameters\": {\n        \"guildId\": {\n          \"__rl\": true,\n          \"mode\": \"id\",\n          \"value\": \"123456789\"\n        },\n        \"options\": {\n          \"simplify\": true\n        },\n        \"resource\": \"message\",\n        \"channelId\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"1248678443432808512\",\n          \"cachedResultUrl\": \"https://discord.com/channels/1248678443432808509/1248678443432808512\",\n          \"cachedResultName\": \"general\"\n        },\n        \"operation\": \"getAll\"\n      },\n      \"credentials\": {\n        \"discordBotApi\": {\n          \"id\": \"YUwD52E3oHsSUWdW\",\n          \"name\": \"Discord Bot account\"\n        }\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"6db26c7e-f1eb-45b8-a444-01270fab157f\",\n      \"name\": \"Only Once\",\n      \"type\": \"n8n-nodes-base.removeDuplicates\",\n      \"position\": [\n        -820,\n        40\n      ],\n      \"parameters\": {\n        \"options\": {\n          \"historySize\": 100\n        },\n        \"operation\": \"removeItemsSeenInPreviousExecutions\",\n        \"dedupeValue\": \"={{ $json.id }}\"\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"36923da1-5ebc-40fc-9780-74845ff2b268\",\n      \"name\": \"Model\",\n      \"type\": \"@n8n/n8n-nodes-langchain.lmChatOpenAi\",\n      \"position\": [\n        240,\n        260\n      ],\n      \"parameters\": {\n        \"model\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"o3-mini\",\n          \"cachedResultName\": \"o3-mini\"\n        },\n        \"options\": {}\n      },\n      \"credentials\": {\n        \"openAiApi\": {\n          \"id\": \"8gccIjcuf3gvaoEr\",\n          \"name\": \"OpenAi account\"\n        }\n      },\n      \"typeVersion\": 1.2\n    },\n    {\n      \"id\": \"af01bb60-fdef-4fa1-bf33-1862a18ebc99\",\n      \"name\": \"Warn User\",\n      \"type\": \"n8n-nodes-base.discord\",\n      \"position\": [\n        2880,\n        20\n      ],\n      \"webhookId\": \"88bdd468-8eb9-41b8-b017-1deec91c9498\",\n      \"parameters\": {\n        \"sendTo\": \"user\",\n        \"userId\": {\n          \"__rl\": true,\n          \"mode\": \"id\",\n          \"value\": \"={{ $('When Executed by Another Workflow').first().json.author.id }}\"\n        },\n        \"content\": \"=Warning: Please do not spam our channels\\nYour message was deleted to be in violation of our community terms & conditions and was subsequently deleted.\\n\\nFurther violations will result in a ban.\\n\\nIf you think this is a mistake, please message the moderation team.\",\n        \"guildId\": {\n          \"__rl\": true,\n          \"mode\": \"id\",\n          \"value\": \"123456789\"\n        },\n        \"options\": {},\n        \"resource\": \"message\"\n      },\n      \"credentials\": {\n        \"discordBotApi\": {\n          \"id\": \"YUwD52E3oHsSUWdW\",\n          \"name\": \"Discord Bot account\"\n        }\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"04e9f167-f816-4056-813a-3168dc22f209\",\n      \"name\": \"Warn User Only\",\n      \"type\": \"n8n-nodes-base.discord\",\n      \"position\": [\n        2540,\n        180\n      ],\n      \"webhookId\": \"88bdd468-8eb9-41b8-b017-1deec91c9498\",\n      \"parameters\": {\n        \"sendTo\": \"user\",\n        \"userId\": {\n          \"__rl\": true,\n          \"mode\": \"id\",\n          \"value\": \"={{ $('When Executed by Another Workflow').first().json.author.id }}\"\n        },\n        \"content\": \"=Warning: Please do not spam our channels\\nYour message was flagged to be in violation of our community terms & conditions. Please consider other members before posting.\\n\\nFurther violations will result in a ban.\\n\\nIf you think this is a mistake, please message the moderation team.\",\n        \"guildId\": {\n          \"__rl\": true,\n          \"mode\": \"id\",\n          \"value\": \"123456789\"\n        },\n        \"options\": {},\n        \"resource\": \"message\"\n      },\n      \"credentials\": {\n        \"discordBotApi\": {\n          \"id\": \"YUwD52E3oHsSUWdW\",\n          \"name\": \"Discord Bot account\"\n        }\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"41240c95-c5c1-4ac2-81e7-782ff8f3511b\",\n      \"name\": \"Group By User\",\n      \"type\": \"n8n-nodes-base.code\",\n      \"position\": [\n        -540,\n        100\n      ],\n      \"parameters\": {\n        \"jsCode\": \"const groupByUser = {};\\n\\nfor (const item of $input.all()) {\\n  if (!groupByUser[item.json.author.id]) {\\n    groupByUser[item.json.author.id] = [];\\n  }\\n  groupByUser[item.json.author.id].push(item.json);\\n}\\n\\nreturn { json : { groupByUser } };\"\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"03d56683-c307-455d-bd03-84107d30f328\",\n      \"name\": \"For Each User...\",\n      \"type\": \"n8n-nodes-base.splitInBatches\",\n      \"position\": [\n        -160,\n        100\n      ],\n      \"parameters\": {\n        \"options\": {}\n      },\n      \"typeVersion\": 3\n    },\n    {\n      \"id\": \"e7eb71a8-cfe5-4e3b-81c1-66ea18cc55ec\",\n      \"name\": \"Split Out\",\n      \"type\": \"n8n-nodes-base.splitOut\",\n      \"position\": [\n        -360,\n        100\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"fieldToSplitOut\": \"groupByUser\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"b74a7092-2b51-452b-bf29-6620969b3efb\",\n      \"name\": \"Message to List\",\n      \"type\": \"n8n-nodes-base.code\",\n      \"position\": [\n        100,\n        100\n      ],\n      \"parameters\": {\n        \"jsCode\": \"const messages = $input.first().json;\\nreturn Object.keys(messages).map(key => messages[key]);\"\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"762e3a5e-e013-4ca3-a2a9-cf7d5b0dd3f4\",\n      \"name\": \"Notify Moderators with Send & Wait\",\n      \"type\": \"n8n-nodes-base.discord\",\n      \"position\": [\n        1980,\n        180\n      ],\n      \"webhookId\": \"644a85f3-5add-4321-9d8a-bcc4acfa33f1\",\n      \"parameters\": {\n        \"guildId\": {\n          \"__rl\": true,\n          \"mode\": \"id\",\n          \"value\": \"123456789\"\n        },\n        \"message\": \"=**Spam Detected**\\nUser: @{{ $json.author.username }}\\nMessage:\\n{{\\n$input.all().map(item =>\\n  `* [${DateTime.fromISO(item.json.timestamp).format('yyyy-MM-dd @ hh:mm')}] ${item.json.content}`).join('\\\\n')\\n}}\",\n        \"options\": {},\n        \"resource\": \"message\",\n        \"channelId\": {\n          \"__rl\": true,\n          \"mode\": \"id\",\n          \"value\": \"=_moderation\"\n        },\n        \"operation\": \"sendAndWait\",\n        \"formFields\": {\n          \"values\": [\n            {\n              \"fieldType\": \"dropdown\",\n              \"fieldLabel\": \"Action\",\n              \"fieldOptions\": {\n                \"values\": [\n                  {\n                    \"option\": \"Delete Message and Warn User\"\n                  },\n                  {\n                    \"option\": \"Do nothing and Warn User\"\n                  },\n                  {\n                    \"option\": \"Do nothing\"\n                  }\n                ]\n              },\n              \"requiredField\": true\n            }\n          ]\n        },\n        \"responseType\": \"customForm\"\n      },\n      \"credentials\": {\n        \"discordBotApi\": {\n          \"id\": \"YUwD52E3oHsSUWdW\",\n          \"name\": \"Discord Bot account\"\n        }\n      },\n      \"executeOnce\": true,\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"f35bc6b0-855c-451b-aee7-e2af4e268893\",\n      \"name\": \"Flag as Spam\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        620,\n        0\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"e1eddfbe-c32d-4a3b-9660-07800f52f4c4\",\n              \"name\": \"is_spam\",\n              \"type\": \"boolean\",\n              \"value\": true\n            }\n          ]\n        },\n        \"includeOtherFields\": true\n      },\n      \"typeVersion\": 3.4\n    },\n    {\n      \"id\": \"f77a0101-d209-4d3c-ab4a-405579a1f539\",\n      \"name\": \"Flag as Not Spam\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        620,\n        200\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"e1eddfbe-c32d-4a3b-9660-07800f52f4c4\",\n              \"name\": \"is_spam\",\n              \"type\": \"boolean\",\n              \"value\": false\n            }\n          ]\n        },\n        \"includeOtherFields\": true\n      },\n      \"typeVersion\": 3.4,\n      \"alwaysOutputData\": true\n    },\n    {\n      \"id\": \"eefe79e2-603f-4f12-a385-fab4b8bdbc65\",\n      \"name\": \"Merge\",\n      \"type\": \"n8n-nodes-base.merge\",\n      \"position\": [\n        800,\n        100\n      ],\n      \"parameters\": {},\n      \"typeVersion\": 3\n    },\n    {\n      \"id\": \"f7d6cccc-0d4a-4353-bc30-9a760196361f\",\n      \"name\": \"Spam Messages Only\",\n      \"type\": \"n8n-nodes-base.filter\",\n      \"position\": [\n        1060,\n        100\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"conditions\": {\n          \"options\": {\n            \"version\": 2,\n            \"leftValue\": \"\",\n            \"caseSensitive\": true,\n            \"typeValidation\": \"strict\"\n          },\n          \"combinator\": \"and\",\n          \"conditions\": [\n            {\n              \"id\": \"f1dd7aa3-4215-47b5-830c-0d8d17e97c17\",\n              \"operator\": {\n                \"type\": \"boolean\",\n                \"operation\": \"true\",\n                \"singleValue\": true\n              },\n              \"leftValue\": \"={{ $json.is_spam }}\",\n              \"rightValue\": \"\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 2.2,\n      \"alwaysOutputData\": true\n    },\n    {\n      \"id\": \"7b4257b9-a5d3-4542-b4e2-563bf5634aa5\",\n      \"name\": \"Has Flagged Messages?\",\n      \"type\": \"n8n-nodes-base.if\",\n      \"position\": [\n        1240,\n        180\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"conditions\": {\n          \"options\": {\n            \"version\": 2,\n            \"leftValue\": \"\",\n            \"caseSensitive\": true,\n            \"typeValidation\": \"strict\"\n          },\n          \"combinator\": \"and\",\n          \"conditions\": [\n            {\n              \"id\": \"f085cf62-e82d-4a15-806b-4a740e3b119c\",\n              \"operator\": {\n                \"type\": \"object\",\n                \"operation\": \"notEmpty\",\n                \"singleValue\": true\n              },\n              \"leftValue\": \"={{ $json }}\",\n              \"rightValue\": \"\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 2.2\n    },\n    {\n      \"id\": \"0282a8bf-ab06-427f-b58b-83131205b26c\",\n      \"name\": \"Get Message IDs\",\n      \"type\": \"n8n-nodes-base.code\",\n      \"position\": [\n        2540,\n        20\n      ],\n      \"parameters\": {\n        \"jsCode\": \"return $('When Executed by Another Workflow').all().map(item => ({ json: {\\n  id: item.json.id,\\n  channel_id: item.json.channel_id\\n}}))\"\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"fc43a315-6b81-4d93-8e11-7955b7650b94\",\n      \"name\": \"Delete Messages\",\n      \"type\": \"n8n-nodes-base.discord\",\n      \"position\": [\n        2720,\n        20\n      ],\n      \"webhookId\": \"6fa8bb1c-c5b7-4498-af63-dbe43691e602\",\n      \"parameters\": {\n        \"guildId\": {\n          \"__rl\": true,\n          \"mode\": \"id\",\n          \"value\": \"123456789\"\n        },\n        \"resource\": \"message\",\n        \"channelId\": {\n          \"__rl\": true,\n          \"mode\": \"id\",\n          \"value\": \"={{ $json.channel_id }}\"\n        },\n        \"messageId\": \"={{ $json.id }}\",\n        \"operation\": \"deleteMessage\"\n      },\n      \"credentials\": {\n        \"discordBotApi\": {\n          \"id\": \"YUwD52E3oHsSUWdW\",\n          \"name\": \"Discord Bot account\"\n        }\n      },\n      \"executeOnce\": false,\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"3868754b-26df-4f06-b27b-dba3959cb365\",\n      \"name\": \"Receive Instructions\",\n      \"type\": \"n8n-nodes-base.switch\",\n      \"position\": [\n        2180,\n        180\n      ],\n      \"parameters\": {\n        \"rules\": {\n          \"values\": [\n            {\n              \"outputKey\": \"Delete & Warn\",\n              \"conditions\": {\n                \"options\": {\n                  \"version\": 2,\n                  \"leftValue\": \"\",\n                  \"caseSensitive\": true,\n                  \"typeValidation\": \"strict\"\n                },\n                \"combinator\": \"and\",\n                \"conditions\": [\n                  {\n                    \"id\": \"c9a82ef5-49f7-4196-9ee3-977d34bd1ec9\",\n                    \"operator\": {\n                      \"type\": \"string\",\n                      \"operation\": \"equals\"\n                    },\n                    \"leftValue\": \"={{ $json.data.Action }}\",\n                    \"rightValue\": \"Delete Message and Warn User\"\n                  }\n                ]\n              },\n              \"renameOutput\": true\n            },\n            {\n              \"outputKey\": \"Warn User Only\",\n              \"conditions\": {\n                \"options\": {\n                  \"version\": 2,\n                  \"leftValue\": \"\",\n                  \"caseSensitive\": true,\n                  \"typeValidation\": \"strict\"\n                },\n                \"combinator\": \"and\",\n                \"conditions\": [\n                  {\n                    \"id\": \"0e0d56da-bae0-4624-b712-fa44413eb17f\",\n                    \"operator\": {\n                      \"name\": \"filter.operator.equals\",\n                      \"type\": \"string\",\n                      \"operation\": \"equals\"\n                    },\n                    \"leftValue\": \"={{ $json.data.Action }}\",\n                    \"rightValue\": \"Do nothing and Warn User\"\n                  }\n                ]\n              },\n              \"renameOutput\": true\n            },\n            {\n              \"outputKey\": \"Do nothing\",\n              \"conditions\": {\n                \"options\": {\n                  \"version\": 2,\n                  \"leftValue\": \"\",\n                  \"caseSensitive\": true,\n                  \"typeValidation\": \"strict\"\n                },\n                \"combinator\": \"and\",\n                \"conditions\": [\n                  {\n                    \"id\": \"2f85cdf6-db7b-4e30-9577-20ddee437807\",\n                    \"operator\": {\n                      \"name\": \"filter.operator.equals\",\n                      \"type\": \"string\",\n                      \"operation\": \"equals\"\n                    },\n                    \"leftValue\": \"={{ $json.data.Action }}\",\n                    \"rightValue\": \"Do nothing\"\n                  }\n                ]\n              },\n              \"renameOutput\": true\n            }\n          ]\n        },\n        \"options\": {}\n      },\n      \"typeVersion\": 3.2\n    },\n    {\n      \"id\": \"27ea2dd8-07f0-438a-bee8-8c4a6ee7b5f7\",\n      \"name\": \"Sticky Note\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -1280,\n        -160\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 620,\n        \"height\": 520,\n        \"content\": \"## 1. Get Channel Messages\\n[Read more about the scheduled Trigger](https://docs.n8n.io/integrations/builtin/core-nodes/n8n-nodes-base.scheduletrigger/)\\n\\nThe scheduled trigger is used to execute this workflow throughout the day. Depending on how busy your community is, you may want to increase the messages fetched or set shorter intervals. The \\\"Remove Duplicates\\\" node is used to ensure we only process new messages.\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"66e770ab-4eaa-40b6-be73-c36bad254c2a\",\n      \"name\": \"Sticky Note1\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -640,\n        -160\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 640,\n        \"height\": 520,\n        \"content\": \"## 2. Group Messages By User\\n[Learn more about the loop node](https://docs.n8n.io/integrations/builtin/core-nodes/n8n-nodes-base.splitinbatches/)\\n\\nWhen dealing with nested data such as user and messages, using the loop node is a great way to ensure item references are not getting mixed up. Here, we're grouping users so that we can batch their messages and help minimise the number of notifications we need to send.\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"963074bf-91e5-4a47-886d-0dbcbbba8fc4\",\n      \"name\": \"Sticky Note2\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        20,\n        -160\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 960,\n        \"height\": 620,\n        \"content\": \"## 3. Spam Detection using AI-powered Text Classification\\n[Learn more about the text classification node](https://docs.n8n.io/integrations/builtin/cluster-nodes/root-nodes/n8n-nodes-langchain.text-classifier)\\n\\nIn this template, our goal is to moderate spam messages and one way to do this is by using an AI text classifier. This approach uses a Reasoning LLM to determine if a message falls into a generalised criteria of spam ie. promotion. You may prefer to customise this prompt for production use-case.\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"0cbcfe9d-7f66-423c-b930-a3c700636bd8\",\n      \"name\": \"Sticky Note3\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        1680,\n        -160\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 740,\n        \"height\": 620,\n        \"content\": \"## 5. Moderation using Human-in-the-Loop\\n[Read more about n8n's human-fallback functionality](https://docs.n8n.io/advanced-ai/examples/human-fallback/)\\n\\nIn this step, we can use the \\\"Send and Wait for Response\\\" operation in our Discord node to allow human moderators to decide which actions to perform on the flagged messages. There are currently 3 response types available and in this template, we'll use the custom form option which allows us to specify a dropdown list from which the moderator can select from a predefined list of actions. Using this approach, we can ensure consistency across all moderators.\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"c808c1a9-818e-4652-a92b-b6be1cb12706\",\n      \"name\": \"Sticky Note4\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        2440,\n        -160\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 660,\n        \"height\": 680,\n        \"content\": \"## 6. Execute Moderation Actions\\n[Learn more about the Discord node](https://docs.n8n.io/integrations/builtin/app-nodes/n8n-nodes-base.discord/)\\n\\nFinally, moderation actions can be executed on behalf of the moderator and thus saving them time. In the case of the delete action, the template will bulk remove the flagged messages accurately and even across multiple channels.\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"c08416cb-a477-4ccc-b682-85c35d9c2cd6\",\n      \"name\": \"Moderation Subworkflow\",\n      \"type\": \"n8n-nodes-base.executeWorkflow\",\n      \"position\": [\n        1460,\n        200\n      ],\n      \"parameters\": {\n        \"options\": {\n          \"waitForSubWorkflow\": false\n        },\n        \"workflowId\": {\n          \"__rl\": true,\n          \"mode\": \"id\",\n          \"value\": \"={{ $workflow.id }}\"\n        },\n        \"workflowInputs\": {\n          \"value\": {},\n          \"schema\": [],\n          \"mappingMode\": \"defineBelow\",\n          \"matchingColumns\": [],\n          \"attemptToConvertTypes\": false,\n          \"convertFieldsToString\": true\n        }\n      },\n      \"typeVersion\": 1.2\n    },\n    {\n      \"id\": \"f130b908-1653-4cb4-a72d-ae539c7a08dc\",\n      \"name\": \"Sticky Note5\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        1000,\n        -160\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 660,\n        \"height\": 620,\n        \"content\": \"## 4. Concurrent Processing using Subworkflows\\n[Learn more about Subworkflow Trigger](https://docs.n8n.io/integrations/builtin/core-nodes/n8n-nodes-base.executeworkflow)\\n\\nOne issue we might come across if we have a human-in-the-loop step inside another loop is that later users will not be processed until the current user is actioned. One way of solving this is to use subworkflows. Subworkflows allow us to run our remaining workflow steps in a separate execution and with specifically the \\\"wait for subworkflow completion\\\" set to \\\"off\\\", it won't block our current loop.\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"dc5e79f1-1ed9-4171-a787-a6b9dfee71f2\",\n      \"name\": \"When Executed by Another Workflow\",\n      \"type\": \"n8n-nodes-base.executeWorkflowTrigger\",\n      \"position\": [\n        1780,\n        180\n      ],\n      \"parameters\": {\n        \"inputSource\": \"passthrough\"\n      },\n      \"typeVersion\": 1.1\n    },\n    {\n      \"id\": \"df28cb07-a4fe-4edf-afd0-18f4fa12521d\",\n      \"name\": \"Sticky Note6\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -1700,\n        -580\n      ],\n      \"parameters\": {\n        \"width\": 380,\n        \"height\": 940,\n        \"content\": \"## Try it out\\n### This n8n template demonstrates how you can automate community moderation using human-in-the-loop functionality for Discord.\\n\\nThe use-case is for detecting and dealing with spam messages in a predefined and consistent way. Human-in-the-loop allows for a balance between overly aggressive bots and time and effort from the moderation team.\\n\\n### How it works\\n* A scheduled trigger is used to scan the most recent messages in a Discord Channel. Messages are tagged via the \\\"Remove Duplicates\\\" node so they don't get processed again in the future.\\n* Messages are grouped by user to allow for minimising of number of notifications sent.\\n* An AI text classifier node is then used to detect for spam in each user's message.\\n* When detected, a notification is sent to a moderation channel using the Send-and-wait mode for Discord. This notification comes with an n8n form and dropdown list of predefined actions to take in dealing with the spam messages. Once sent the workflow waits until a response is received.\\n* Once a moderator selects an action, the workflow continues and carries out a predefined moderation action.\\n\\n### How to use\\n* Depending on how busy your community is and subject to spammers, you may need to increase the scheduled interval.\\n* Add as many or few moderation actions as required.\\n* Remember to activate the workflow to  get it started.\\n\\n\\n### Need Help?\\nJoin the [Discord](https://discord.com/invite/XPKeKXeB7d) or ask in the [Forum](https://community.n8n.io/)!\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"a437d4f3-af31-4677-b853-99832ff6c051\",\n      \"name\": \"No Action Taken\",\n      \"type\": \"n8n-nodes-base.noOp\",\n      \"position\": [\n        2540,\n        340\n      ],\n      \"parameters\": {},\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"82a5b512-296b-4ad7-aa50-2f34ff2cf681\",\n      \"name\": \"Schedule Trigger\",\n      \"type\": \"n8n-nodes-base.scheduleTrigger\",\n      \"position\": [\n        -1220,\n        40\n      ],\n      \"parameters\": {\n        \"rule\": {\n          \"interval\": [\n            {\n              \"field\": \"hours\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 1.2\n    }\n  ],\n  \"pinData\": {},\n  \"connections\": {\n    \"Merge\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Spam Messages Only\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Model\": {\n      \"ai_languageModel\": [\n        [\n          {\n            \"node\": \"Spam Detection\",\n            \"type\": \"ai_languageModel\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Only Once\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Group By User\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Split Out\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"For Each User...\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Warn User\": {\n      \"main\": [\n        []\n      ]\n    },\n    \"Flag as Spam\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Merge\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Group By User\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Split Out\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Spam Detection\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Flag as Spam\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Flag as Not Spam\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Warn User Only\": {\n      \"main\": [\n        []\n      ]\n    },\n    \"Delete Messages\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Warn User\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Get Message IDs\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Delete Messages\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Message to List\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Spam Detection\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Flag as Not Spam\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Merge\",\n            \"type\": \"main\",\n            \"index\": 1\n          }\n        ]\n      ]\n    },\n    \"For Each User...\": {\n      \"main\": [\n        [],\n        [\n          {\n            \"node\": \"Message to List\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Schedule Trigger\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Get Recent Messages\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Spam Messages Only\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Has Flagged Messages?\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Get Recent Messages\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Only Once\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Receive Instructions\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Get Message IDs\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Warn User Only\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"No Action Taken\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Has Flagged Messages?\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Moderation Subworkflow\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"For Each User...\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Moderation Subworkflow\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"For Each User...\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"When Executed by Another Workflow\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Notify Moderators with Send & Wait\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Notify Moderators with Send & Wait\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Receive Instructions\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}",
  "metadata": {
    "node_types": [
      "@n8n/n8n-nodes-langchain.textClassifier",
      "n8n-nodes-base.discord",
      "n8n-nodes-base.removeDuplicates",
      "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "n8n-nodes-base.discord",
      "n8n-nodes-base.discord",
      "n8n-nodes-base.code",
      "n8n-nodes-base.splitInBatches",
      "n8n-nodes-base.splitOut",
      "n8n-nodes-base.code",
      "n8n-nodes-base.discord",
      "n8n-nodes-base.set",
      "n8n-nodes-base.set",
      "n8n-nodes-base.merge",
      "n8n-nodes-base.filter",
      "n8n-nodes-base.if",
      "n8n-nodes-base.code",
      "n8n-nodes-base.discord",
      "n8n-nodes-base.switch",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.executeWorkflow",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.executeWorkflowTrigger",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.noOp",
      "n8n-nodes-base.scheduleTrigger"
    ],
    "trigger": "schedule trigger"
  }
}