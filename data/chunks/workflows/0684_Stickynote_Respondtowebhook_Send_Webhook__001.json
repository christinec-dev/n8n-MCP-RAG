{
  "source": "0684_Stickynote_Respondtowebhook_Send_Webhook.json",
  "index": 1,
  "content": "{\n  \"meta\": {\n    \"instanceId\": \"03e9d14e9196363fe7191ce21dc0bb17387a6e755dcc9acc4f5904752919dca8\"\n  },\n  \"nodes\": [\n    {\n      \"id\": \"eece2f27-2a2f-4207-a756-c3b8062c0028\",\n      \"name\": \"Webhook\",\n      \"type\": \"n8n-nodes-base.webhook\",\n      \"position\": [\n        0,\n        0\n      ],\n      \"webhookId\": \"f6ec2074-6c23-410e-ad31-ac1eaf7381ad\",\n      \"parameters\": {\n        \"path\": \"f6ec2074-6c23-410e-ad31-ac1eaf7381ad\",\n        \"options\": {},\n        \"httpMethod\": \"POST\",\n        \"responseMode\": \"responseNode\"\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"3a710d14-a56b-4a9a-a30a-f298de68d92b\",\n      \"name\": \"Extract Incident ID from Response\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        200,\n        0\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"38125eed-d2ab-4a69-b48f-97cb8d1905b1\",\n              \"name\": \"incident_id\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.body.text }}\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 3.4\n    },\n    {\n      \"id\": \"cf285efd-f722-4c26-9b64-0b91206c739c\",\n      \"name\": \"Search For Incident in ServiceNow\",\n      \"type\": \"n8n-nodes-base.serviceNow\",\n      \"onError\": \"continueRegularOutput\",\n      \"position\": [\n        440,\n        0\n      ],\n      \"parameters\": {\n        \"options\": {\n          \"sysparm_query\": \"=GOTOnumber={{ $json.incident_id }}\",\n          \"sysparm_display_value\": \"true\"\n        },\n        \"resource\": \"incident\",\n        \"operation\": \"getAll\",\n        \"authentication\": \"basicAuth\"\n      },\n      \"credentials\": {\n        \"serviceNowBasicApi\": {\n          \"id\": \"wjkWiUNQxo5PzTIb\",\n          \"name\": \"ServiceNow Basic Auth account\"\n        }\n      },\n      \"typeVersion\": 1,\n      \"alwaysOutputData\": true\n    },\n    {\n      \"id\": \"84fbfbe2-e922-439e-aa33-7c70ebc2215d\",\n      \"name\": \"Send Incident Details to Slack\",\n      \"type\": \"n8n-nodes-base.respondToWebhook\",\n      \"position\": [\n        960,\n        180\n      ],\n      \"parameters\": {\n        \"options\": {\n          \"responseCode\": 200,\n          \"responseHeaders\": {\n            \"entries\": [\n              {\n                \"name\": \"Content-Type\",\n                \"value\": \"application/json\"\n              }\n            ]\n          }\n        },\n        \"respondWith\": \"json\",\n        \"responseBody\": \"={\\n    \\\"response_type\\\": \\\"in_channel\\\",\\n    \\\"blocks\\\": [\\n        {\\n            \\\"type\\\": \\\"header\\\",\\n            \\\"text\\\": {\\n                \\\"type\\\": \\\"plain_text\\\",\\n                \\\"text\\\": \\\"ServiceNow Incident Notification\\\",\\n                \\\"emoji\\\": true\\n            }\\n        },\\n        {\\n            \\\"type\\\": \\\"section\\\",\\n            \\\"fields\\\": [\\n                {\\n                    \\\"type\\\": \\\"mrkdwn\\\",\\n                    \\\"text\\\": \\\"*Incident ID:*\\\\n{{ $('Search For Incident in ServiceNow').item.json.number }}\\\"\\n                },\\n                {\\n                    \\\"type\\\": \\\"mrkdwn\\\",\\n                    \\\"text\\\": \\\"*Description:*\\\\n{{ $('Search For Incident in ServiceNow').item.json.short_description }}\\\"\\n                },\\n                {\\n                    \\\"type\\\": \\\"mrkdwn\\\",\\n                    \\\"text\\\": \\\"*Severity:*\\\\n{{ $('Search For Incident in ServiceNow').item.json.severity }}\\\"\\n                },\\n                {\\n                    \\\"type\\\": \\\"mrkdwn\\\",\\n                    \\\"text\\\": \\\"*Caller:*\\\\n{{ $('Search For Incident in ServiceNow').item.json.caller_id.display_value }}\\\"\\n                },\\n                {\\n                    \\\"type\\\": \\\"mrkdwn\\\",\\n                    \\\"text\\\": \\\"*Priority:*\\\\n{{ $('Search For Incident in ServiceNow').item.json.priority }}\\\"\\n                },\\n                {\\n                    \\\"type\\\": \\\"mrkdwn\\\",\\n                    \\\"text\\\": \\\"*State:*\\\\n{{ $('Search For Incident in ServiceNow').item.json.incident_state }}\\\"\\n                },\\n                {\\n                    \\\"type\\\": \\\"mrkdwn\\\",\\n                    \\\"text\\\": \\\"*Category:*\\\\n{{ $('Search For Incident in ServiceNow').item.json.category }}\\\"\\n                },\\n                {\\n                    \\\"type\\\": \\\"mrkdwn\\\",\\n                    \\\"text\\\": \\\"*Date Opened:*\\\\n{{ $('Search For Incident in ServiceNow').item.json.opened_at }}\\\"\\n                }\\n            ]\\n        },\\n        {\\n            \\\"type\\\": \\\"actions\\\",\\n            \\\"elements\\\": [\\n                {\\n                    \\\"type\\\": \\\"button\\\",\\n                    \\\"text\\\": {\\n                        \\\"type\\\": \\\"plain_text\\\",\\n                        \\\"text\\\": \\\"View Incident\\\",\\n                        \\\"emoji\\\": true\\n                    },\\n                    \\\"url\\\": \\\"https://dev206761.service-now.com/nav_to.do?uri=incident.do?sys_id={{ $('Search For Incident in ServiceNow').item.json.sys_id }}\\\",\\n                    \\\"action_id\\\": \\\"view_incident\\\"\\n                }\\n            ]\\n        }\\n    ]\\n}\"\n      },\n      \"typeVersion\": 1.1\n    },\n    {\n      \"id\": \"2bfefc69-8b4e-4bc2-8fea-1216aa95e58b\",\n      \"name\": \"Notify User no Incident was Found\",\n      \"type\": \"n8n-nodes-base.respondToWebhook\",\n      \"position\": [\n        960,\n        0\n      ],\n      \"parameters\": {\n        \"options\": {\n          \"responseCode\": 200,\n          \"responseHeaders\": {\n            \"entries\": [\n              {\n                \"name\": \"Content-Type\",\n                \"value\": \"application/json\"\n              }\n            ]\n          }\n        },\n        \"respondWith\": \"json\",\n        \"responseBody\": \"={\\n\\t\\\"blocks\\\": [\\n\\t\\t{\\n\\t\\t\\t\\\"type\\\": \\\"section\\\",\\n\\t\\t\\t\\\"text\\\": {\\n\\t\\t\\t\\t\\\"type\\\": \\\"mrkdwn\\\",\\n\\t\\t\\t\\t\\\"text\\\": \\\":warning: No incident was found with that ID. Please double check and try again. :warning:\\\"\\n\\t\\t\\t}\\n\\t\\t}\\n\\t]\\n}\"\n      },\n      \"typeVersion\": 1.1\n    },\n    {\n      \"id\": \"47e3fdb0-9824-4b95-b794-972adadcfe5c\",\n      \"name\": \"Notify User of Error with ServiceNow\",\n      \"type\": \"n8n-nodes-base.respondToWebhook\",\n      \"position\": [\n        960,\n        -180\n      ],\n      \"parameters\": {\n        \"options\": {\n          \"responseCode\": 200,\n          \"responseHeaders\": {\n            \"entries\": [\n              {\n                \"name\": \"Content-Type\",\n                \"value\": \"application/json\"\n              }\n            ]\n          }\n        },\n        \"respondWith\": \"json\",\n        \"responseBody\": \"={\\n\\t\\\"blocks\\\": [\\n\\t\\t{\\n\\t\\t\\t\\\"type\\\": \\\"section\\\",\\n\\t\\t\\t\\\"text\\\": {\\n\\t\\t\\t\\t\\\"type\\\": \\\"mrkdwn\\\",\\n\\t\\t\\t\\t\\\"text\\\": \\\":rotating_light: Issue connecting to ServiceNow. Please investigate in n8n. :rotating_light:\\\"\\n\\t\\t\\t}\\n\\t\\t}\\n\\t]\\n}\"\n      },\n      \"typeVersion\": 1.1\n    },\n    {\n      \"id\": \"a64be48f-c318-41f0-950f-d5c545b56001\",\n      \"name\": \"Sticky Note12\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -60,\n        -400\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 431.79628558910616,\n        \"height\": 756.5967348425984,\n        \"content\": \"![Slack](https://uploads.n8n.io/templates/slack.png)\\n## Receive Slack Webhook Slash Command\\n\\nThis section begins with the `Webhook` node, which listens for incoming Slack Slash Command requests. When triggered, it extracts the incident ID from the request payload using the `Extract Incident ID from Response` node. The incident ID is then passed forward for further processing. This setup allows users to initiate ServiceNow incident lookups directly from Slack.\\n\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"1434eb2a-5a9c-47f4-9e69-abaca2047c65\",\n      \"name\": \"Sticky Note2\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        378.80172279482787,\n        -402.30436380125093\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 390.19827720517213,\n        \"height\": 753.3043638012509,\n        \"content\": \"![ServiceNow](https://uploads.n8n.io/templates/servicenow.png)\\n## Search ServiceNow for Incident\\n\\nIn this section, the `Search For Incident in ServiceNow` node queries the ServiceNow platform using the extracted incident ID. If the query returns a valid incident, the details are prepared for the Slack response. If no incident is found, the workflow routes this outcome for a corresponding Slack notification. The `Parse ServiceNow Response` node evaluates the outcome of the ServiceNow query. This ensures accurate and responsive communication with ServiceNow.\\n\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"b5a063f6-3676-4ff0-b1ca-944e8285db0d\",\n      \"name\": \"Sticky Note11\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        777,\n        -646.1743824166542\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 448,\n        \"height\": 998.1743824166542,\n        \"content\": \"![Slack](https://uploads.n8n.io/templates/webhook.png)\\n## Respond to Slack Webhook\\n\\nBased on the ServiceNow result:\\n- The `Send Incident Details to Slack` node formats and sends detailed incident information to Slack.\\n- The `Notify User no Incident was Found` node sends a user-friendly notification indicating the incident ID was invalid.\\n- The `Notify User of Error with ServiceNow` node alerts the user if the ServiceNow connection fails.\\nThis ensures users receive the right response for every scenario, enabling seamless incident management directly from Slack.\\n\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"907e9461-2cf8-4c2a-8d25-38a319861937\",\n      \"name\": \"Parse ServiceNow Response\",\n      \"type\": \"n8n-nodes-base.switch\",\n      \"position\": [\n        640,\n        0\n      ],\n      \"parameters\": {\n        \"rules\": {\n          \"values\": [\n            {\n              \"outputKey\": \"ServiceNow Error\",\n              \"conditions\": {\n                \"options\": {\n                  \"version\": 2,\n                  \"leftValue\": \"\",\n                  \"caseSensitive\": true,\n                  \"typeValidation\": \"strict\"\n                },\n                \"combinator\": \"and\",\n                \"conditions\": [\n                  {\n                    \"operator\": {\n                      \"type\": \"string\",\n                      \"operation\": \"exists\",\n                      \"singleValue\": true\n                    },\n                    \"leftValue\": \"={{ $json.error }}\",\n                    \"rightValue\": \"\"\n                  }\n                ]\n              },\n              \"renameOutput\": true\n            },\n            {\n              \"outputKey\": \"Incident Not Found\",\n              \"conditions\": {\n                \"options\": {\n                  \"version\": 2,\n                  \"leftValue\": \"\",\n                  \"caseSensitive\": true,\n                  \"typeValidation\": \"strict\"\n                },\n                \"combinator\": \"and\",\n                \"conditions\": [\n                  {\n                    \"id\": \"6d9ff397-8bb6-41df-979c-4eb7ef16bfc1\",\n                    \"operator\": {\n                      \"type\": \"string\",\n                      \"operation\": \"notExists\",\n                      \"singleValue\": true\n                    },\n                    \"leftValue\": \"={{ $json.number }}\",\n                    \"rightValue\": \"\"\n                  }\n                ]\n              },\n              \"renameOutput\": true\n            },\n            {\n              \"outputKey\": \"Incident Found\",\n              \"conditions\": {\n                \"options\": {\n                  \"version\": 2,\n                  \"leftValue\": \"\",\n                  \"caseSensitive\": true,\n                  \"typeValidation\": \"strict\"\n                },\n                \"combinator\": \"and\",\n                \"conditions\": [\n                  {\n                    \"id\": \"aed034ac-8a45-44d5-9734-813a36aeadaa\",\n                    \"operator\": {\n                      \"type\": \"string\",\n                      \"operation\": \"exists\",\n                      \"singleValue\": true\n                    },\n                    \"leftValue\": \"={{ $json.number }}\",\n                    \"rightValue\": \"\"\n                  }\n                ]\n              },\n              \"renameOutput\": true\n            }\n          ]\n        },\n        \"options\": {}\n      },\n      \"typeVersion\": 3.2\n    }\n  ],\n  \"pinData\": {},\n  \"connections\": {\n    \"Webhook\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Extract Incident ID from Response\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Parse ServiceNow Response\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Notify User of Error with ServiceNow\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Notify User no Incident was Found\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Send Incident Details to Slack\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Extract Incident ID from Response\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Search For Incident in ServiceNow\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Search For Incident in ServiceNow\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Parse ServiceNow Response\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}",
  "metadata": {
    "node_types": [
      "n8n-nodes-base.webhook",
      "n8n-nodes-base.set",
      "n8n-nodes-base.serviceNow",
      "n8n-nodes-base.respondToWebhook",
      "n8n-nodes-base.respondToWebhook",
      "n8n-nodes-base.respondToWebhook",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.switch"
    ],
    "trigger": null
  }
}