{
  "source": "0805_Form_Html_Create_Triggered.json",
  "index": 1,
  "content": "{\n  \"meta\": {\n    \"instanceId\": \"b1f85eae352fde76d801a1a612661df6824cc2e68bfd6741e31305160a737e6e\",\n    \"templateCredsSetupCompleted\": true\n  },\n  \"nodes\": [\n    {\n      \"id\": \"a85eff80-4330-4bd8-acd9-9bf6e0b67c59\",\n      \"name\": \"Get MediaMarkt Offers Website\",\n      \"type\": \"n8n-nodes-brightdata.brightData\",\n      \"position\": [\n        40,\n        -160\n      ],\n      \"parameters\": {\n        \"url\": \"https://www.mediamarkt.es/es/campaign/campanas-y-ofertas\",\n        \"zone\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"web_unlocker1\",\n          \"cachedResultName\": \"web_unlocker1\"\n        },\n        \"format\": \"json\",\n        \"country\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"es\",\n          \"cachedResultName\": \"es\"\n        },\n        \"requestOptions\": {}\n      },\n      \"credentials\": {\n        \"brightdataApi\": {\n          \"id\": \"jk945kIuAFAo9bcg\",\n          \"name\": \"BrightData account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"d27b03e0-b0f1-4c76-b68e-d716391c71da\",\n      \"name\": \"Create HTML for Email\",\n      \"type\": \"n8n-nodes-document-generator.documentGenerator\",\n      \"position\": [\n        60,\n        100\n      ],\n      \"parameters\": {\n        \"template\": \"<br>\\nThese are our recommended deals today:<br>\\n<ul>\\n{{#each items}}\\n<li>{{category}}: <a href=\\\"https://www.bestbuy.com{{link}}\\\">{{name}}</a> for {{price}}â‚¬</li>\\n{{/each}}\\n</ul>\\n<br>\",\n        \"oneTemplate\": true\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"d47ee04f-c1c5-4aac-a615-aa68f5a2d6cd\",\n      \"name\": \"Extract items from results\",\n      \"type\": \"n8n-nodes-base.splitOut\",\n      \"position\": [\n        -140,\n        100\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"fieldToSplitOut\": \"message.content.results\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"34df63de-9b0d-4245-8f87-3654cab0c17e\",\n      \"name\": \"Notify End User by Email\",\n      \"type\": \"n8n-nodes-base.emailSend\",\n      \"position\": [\n        280,\n        100\n      ],\n      \"webhookId\": \"626001db-5451-4225-bf98-cd74c3952754\",\n      \"parameters\": {\n        \"html\": \"=Hi!\\n<br>\\n{{ $json.text }}\\n\\nBest,\\n<br>\\nThe n8nhackers team!\",\n        \"options\": {},\n        \"subject\": \"Your last deals!\",\n        \"toEmail\": \"={{ $('When User Completes Form').first().json.Email}}\",\n        \"fromEmail\": \"deals@n8nhackers.com\"\n      },\n      \"credentials\": {\n        \"smtp\": {\n          \"id\": \"z3kiLWNZTH4wQaGy\",\n          \"name\": \"SMTP account\"\n        }\n      },\n      \"typeVersion\": 2.1\n    },\n    {\n      \"id\": \"fbbd7e95-d972-401a-9aca-8015a1acf553\",\n      \"name\": \"Show Form Results Page\",\n      \"type\": \"n8n-nodes-base.form\",\n      \"position\": [\n        480,\n        100\n      ],\n      \"webhookId\": \"a67843b4-3ab9-427b-8e52-dfc42831065d\",\n      \"parameters\": {\n        \"options\": {},\n        \"operation\": \"completion\",\n        \"completionTitle\": \"Our recommended deals!\",\n        \"completionMessage\": \"=We have sent {{ $('Extract items from results').all().length }} recommended deals to your email!\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"e03ebc2b-db42-4a8d-8758-b3d988c4b943\",\n      \"name\": \"Extract Body and Title from Website\",\n      \"type\": \"n8n-nodes-base.html\",\n      \"position\": [\n        240,\n        -160\n      ],\n      \"parameters\": {\n        \"options\": {\n          \"trimValues\": true\n        },\n        \"operation\": \"extractHtmlContent\",\n        \"dataPropertyName\": \"body\",\n        \"extractionValues\": {\n          \"values\": [\n            {\n              \"key\": \"title\",\n              \"cssSelector\": \"title\"\n            },\n            {\n              \"key\": \"body\",\n              \"cssSelector\": \"body\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 1.2\n    },\n    {\n      \"id\": \"74b0dcd7-d833-452c-82fe-98a21bd39d12\",\n      \"name\": \"Generate List of Deals by Category\",\n      \"type\": \"@n8n/n8n-nodes-langchain.openAi\",\n      \"position\": [\n        -520,\n        100\n      ],\n      \"parameters\": {\n        \"modelId\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"gpt-4o-mini\",\n          \"cachedResultName\": \"GPT-4O-MINI\"\n        },\n        \"options\": {},\n        \"messages\": {\n          \"values\": [\n            {\n              \"role\": \"system\",\n              \"content\": \"Generate a list of recommended deals in json list. Classify items by category. Generate the next properties: name, description, price, link and category. All properties will be in a property called: results. Translate texts to english if required.\"\n            },\n            {\n              \"content\": \"=The input text is:\\n{{ $json.body }}\"\n            },\n            {\n              \"content\": \"=Categories to filter: {{ $('When User Completes Form').item.json.Category.join(',') }}\"\n            }\n          ]\n        },\n        \"jsonOutput\": true\n      },\n      \"credentials\": {\n        \"openAiApi\": {\n          \"id\": \"oKzfvOwieOm4upQ2\",\n          \"name\": \"OpenAi account\"\n        }\n      },\n      \"typeVersion\": 1.8\n    },\n    {\n      \"id\": \"a1095cea-6adc-4cf9-93fe-3a67dc061276\",\n      \"name\": \"When User Completes Form\",\n      \"type\": \"n8n-nodes-base.formTrigger\",\n      \"position\": [\n        -180,\n        -160\n      ],\n      \"webhookId\": \"33e8f7c3-82fb-4339-9c91-4b19aa6c14ba\",\n      \"parameters\": {\n        \"options\": {\n          \"path\": \"get-top-deals\",\n          \"ignoreBots\": true,\n          \"buttonLabel\": \"Get Deals\"\n        },\n        \"formTitle\": \"Top deals\",\n        \"formFields\": {\n          \"values\": [\n            {\n              \"fieldType\": \"dropdown\",\n              \"fieldLabel\": \"Category\",\n              \"multiselect\": true,\n              \"fieldOptions\": {\n                \"values\": [\n                  {\n                    \"option\": \"Appliances\"\n                  },\n                  {\n                    \"option\": \"Cameras, CamCorders & Drones\"\n                  },\n                  {\n                    \"option\": \"Car Electronics \"\n                  },\n                  {\n                    \"option\": \"Cell Phones\"\n                  },\n                  {\n                    \"option\": \"Computers & Tablets\"\n                  },\n                  {\n                    \"option\": \"TV & Home Theater\"\n                  },\n                  {\n                    \"option\": \"Video Games\"\n                  }\n                ]\n              },\n              \"requiredField\": true\n            },\n            {\n              \"fieldType\": \"email\",\n              \"fieldLabel\": \"Email\",\n              \"placeholder\": \"Complete your email\",\n              \"requiredField\": true\n            }\n          ]\n        },\n        \"responseMode\": \"lastNode\",\n        \"formDescription\": \"This form returns top deals by your preferences in the same page.\\n\\nYou can schedule your future deals once per day at the end of this test.\"\n      },\n      \"typeVersion\": 2.2\n    }\n  ],\n  \"pinData\": {},\n  \"connections\": {\n    \"Create HTML for Email\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Notify End User by Email\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Notify End User by Email\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Show Form Results Page\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"When User Completes Form\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Get MediaMarkt Offers Website\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Extract items from results\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Create HTML for Email\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Get MediaMarkt Offers Website\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Extract Body and Title from Website\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Generate List of Deals by Category\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Extract items from results\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Extract Body and Title from Website\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Generate List of Deals by Category\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}",
  "metadata": {
    "node_types": [
      "n8n-nodes-brightdata.brightData",
      "n8n-nodes-document-generator.documentGenerator",
      "n8n-nodes-base.splitOut",
      "n8n-nodes-base.emailSend",
      "n8n-nodes-base.form",
      "n8n-nodes-base.html",
      "@n8n/n8n-nodes-langchain.openAi",
      "n8n-nodes-base.formTrigger"
    ],
    "trigger": null
  }
}