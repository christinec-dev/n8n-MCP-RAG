{
  "source": "0074_Manual_HTTP_Monitor_Webhook.json",
  "index": 1,
  "content": "{\n  \"nodes\": [\n    {\n      \"name\": \"On clicking 'execute'\",\n      \"type\": \"n8n-nodes-base.manualTrigger\",\n      \"position\": [\n        200,\n        470\n      ],\n      \"parameters\": {},\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"HTTP Request\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        600,\n        470\n      ],\n      \"parameters\": {\n        \"url\": \"={{$node[\\\"Config URL\\\"].json[\\\"next\\\"]}}\",\n        \"options\": {},\n        \"queryParametersUi\": {\n          \"parameter\": [\n            {\n              \"name\": \"hapikey\",\n              \"value\": \"<YOUR_API_KEY>\"\n            },\n            {\n              \"name\": \"limit\",\n              \"value\": \"100\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"NoOp\",\n      \"type\": \"n8n-nodes-base.noOp\",\n      \"position\": [\n        800,\n        470\n      ],\n      \"parameters\": {},\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Wait\",\n      \"type\": \"n8n-nodes-base.function\",\n      \"position\": [\n        1000,\n        470\n      ],\n      \"parameters\": {\n        \"functionCode\": \"return new Promise((resolve, reject) => {\\n      setTimeout(() => { resolve([{ json: {} }]) }, 5000);\\n    })\\n\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Config URL\",\n      \"type\": \"n8n-nodes-base.function\",\n      \"position\": [\n        400,\n        470\n      ],\n      \"parameters\": {\n        \"functionCode\": \"\\nlet next = 'https://api.hubapi.com/crm/v3/objects/contacts'\\n\\nif (items[0].json.next) {\\n  next = items[0].json.next\\n}\\n\\nreturn [\\n  {\\n    json: {\\n      next : next\\n    }\\n  }\\n]\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Check if pagination?\",\n      \"type\": \"n8n-nodes-base.if\",\n      \"position\": [\n        1250,\n        470\n      ],\n      \"parameters\": {\n        \"conditions\": {\n          \"string\": [],\n          \"boolean\": [\n            {\n              \"value1\": \"={{$node[\\\"HTTP Request\\\"].json[\\\"paging\\\"] ? true : false}}\",\n              \"value2\": true\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Set next URL\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        890,\n        210\n      ],\n      \"parameters\": {\n        \"values\": {\n          \"string\": [\n            {\n              \"name\": \"next\",\n              \"value\": \"={{$node[\\\"HTTP Request\\\"].json[\\\"paging\\\"][\\\"next\\\"][\\\"link\\\"]}}\"\n            }\n          ]\n        },\n        \"options\": {},\n        \"keepOnlySet\": true\n      },\n      \"executeOnce\": true,\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Combine all data\",\n      \"type\": \"n8n-nodes-base.function\",\n      \"position\": [\n        1500,\n        560\n      ],\n      \"parameters\": {\n        \"functionCode\": \"const allData = []\\n\\nlet counter = 0;\\ndo {\\n  try {\\n    const items = $items(\\\"HTTP Request\\\", 0, counter).map(item => item.json.results);\\n                    \\n    const aja = items[0].map(item => {\\n      return { json: item }\\n    })    \\n    \\n    allData.push.apply(allData, aja);\\n    //allData.push($items(\\\"Increment\\\", 0, counter));\\n  } catch (error) {\\n    return allData;  \\n  }\\n\\n  counter++;\\n} while(true);\\n\\n\"\n      },\n      \"typeVersion\": 1\n    }\n  ],\n  \"connections\": {\n    \"NoOp\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Wait\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Wait\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Check if pagination?\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Config URL\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"HTTP Request\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"HTTP Request\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"NoOp\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Set next URL\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Config URL\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Check if pagination?\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Set next URL\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Combine all data\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"On clicking 'execute'\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Config URL\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}",
  "metadata": {
    "node_types": [
      "n8n-nodes-base.manualTrigger",
      "n8n-nodes-base.httpRequest",
      "n8n-nodes-base.noOp",
      "n8n-nodes-base.function",
      "n8n-nodes-base.function",
      "n8n-nodes-base.if",
      "n8n-nodes-base.set",
      "n8n-nodes-base.function"
    ],
    "trigger": null
  }
}