{
  "source": "0212_Noop_Cratedb_Automation_Triggered.json",
  "index": 1,
  "content": "{\n  \"id\": \"168\",\n  \"name\": \"Smart Factory Use Case\",\n  \"nodes\": [\n    {\n      \"name\": \"Values higher than 50°C\",\n      \"type\": \"n8n-nodes-base.if\",\n      \"position\": [\n        250,\n        550\n      ],\n      \"parameters\": {\n        \"conditions\": {\n          \"number\": [\n            {\n              \"value1\": \"={{$node[\\\"Data from factory sensors\\\"].json[\\\"body\\\"][\\\"temperature_celsius\\\"]}}\",\n              \"value2\": 50,\n              \"operation\": \"largerEqual\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Data from factory sensors\",\n      \"type\": \"n8n-nodes-base.amqpTrigger\",\n      \"position\": [\n        50,\n        700\n      ],\n      \"parameters\": {\n        \"sink\": \"berlin_factory_01\",\n        \"options\": {}\n      },\n      \"credentials\": {\n        \"amqp\": \"\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Set sensor data\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        450,\n        850\n      ],\n      \"parameters\": {\n        \"values\": {\n          \"number\": [\n            {\n              \"name\": \"temeprature_fahrenheit\",\n              \"value\": \"={{$node[\\\"Data enrichment (°C to °F)\\\"].json[\\\"temperature_fahrenheit\\\"]}}\"\n            },\n            {\n              \"name\": \"temperature_celsius\",\n              \"value\": \"={{$node[\\\"Data enrichment (°C to °F)\\\"].json[\\\"body\\\"][\\\"temperature_celsius\\\"]}}\"\n            },\n            {\n              \"name\": \"machine_uptime\",\n              \"value\": \"={{$node[\\\"Data from factory sensors\\\"].json[\\\"body\\\"][\\\"machine_id\\\"][\\\"uptime\\\"]}}\"\n            },\n            {\n              \"name\": \"time_stamp\",\n              \"value\": \"={{$node[\\\"Data from factory sensors\\\"].json[\\\"body\\\"][\\\"time_stamp\\\"]}}\"\n            }\n          ],\n          \"string\": [\n            {\n              \"name\": \"machine_name\",\n              \"value\": \"={{$node[\\\"Data from factory sensors\\\"].json[\\\"body\\\"][\\\"machine_id\\\"][\\\"name\\\"]}}\"\n            }\n          ]\n        },\n        \"options\": {}\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Ingest machine data\",\n      \"type\": \"n8n-nodes-base.crateDb\",\n      \"position\": [\n        650,\n        850\n      ],\n      \"parameters\": {\n        \"table\": \"machine_data\",\n        \"columns\": \"temperature_fahrenheit, temperature_celsius, machine_name, machine_uptime, time_stamp\"\n      },\n      \"credentials\": {\n        \"crateDb\": \"\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Ingest incident data\",\n      \"type\": \"n8n-nodes-base.crateDb\",\n      \"position\": [\n        850,\n        450\n      ],\n      \"parameters\": {\n        \"table\": \"incident_data\",\n        \"columns\": \"incident_id, html_url, incident_timestamp\"\n      },\n      \"credentials\": {\n        \"crateDb\": \"\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Set incident info\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        650,\n        450\n      ],\n      \"parameters\": {\n        \"values\": {\n          \"string\": [\n            {\n              \"name\": \"incident_id\",\n              \"value\": \"={{$node[\\\"Create an incident\\\"].json[\\\"id\\\"]}}\"\n            },\n            {\n              \"name\": \"html_url\",\n              \"value\": \"={{$node[\\\"Create an incident\\\"].json[\\\"html_url\\\"]}}\"\n            },\n            {\n              \"name\": \"incident_timestamp\",\n              \"value\": \"={{$node[\\\"Create an incident\\\"].json[\\\"created_at\\\"]}}\"\n            }\n          ]\n        },\n        \"options\": {},\n        \"keepOnlySet\": true\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Create an incident\",\n      \"type\": \"n8n-nodes-base.pagerDuty\",\n      \"position\": [\n        450,\n        450\n      ],\n      \"parameters\": {\n        \"title\": \"=Incident with {{$node[\\\"Data from factory sensors\\\"].json[\\\"body\\\"][\\\"machine_id\\\"][\\\"name\\\"]}}\",\n        \"additionalFields\": {}\n      },\n      \"credentials\": {\n        \"pagerDutyApi\": \"\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Data enrichment (°C to °F)\",\n      \"type\": \"n8n-nodes-base.function\",\n      \"position\": [\n        250,\n        850\n      ],\n      \"parameters\": {\n        \"functionCode\": \"temp_fahrenheit = (items[0].json.body.temperature_celsius * 1.8) + 32;\\nitems[0].json.temperature_fahrenheit = temp_fahrenheit;\\nreturn items;\"\n      },\n      \"typeVersion\": 1,\n      \"alwaysOutputData\": true\n    },\n    {\n      \"name\": \"Do  nothing\",\n      \"type\": \"n8n-nodes-base.noOp\",\n      \"position\": [\n        450,\n        640\n      ],\n      \"parameters\": {},\n      \"typeVersion\": 1\n    }\n  ],\n  \"active\": false,\n  \"settings\": {},\n  \"connections\": {\n    \"Set sensor data\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Ingest machine data\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Set incident info\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Ingest incident data\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Create an incident\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Set incident info\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Values higher than 50°C\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Create an incident\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Do  nothing\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Data from factory sensors\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Data enrichment (°C to °F)\",\n            \"type\": \"main\",\n            \"index\": 0\n          },\n          {\n            \"node\": \"Values higher than 50°C\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Data enrichment (°C to °F)\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Set sensor data\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}",
  "metadata": {
    "node_types": [
      "n8n-nodes-base.if",
      "n8n-nodes-base.amqpTrigger",
      "n8n-nodes-base.set",
      "n8n-nodes-base.crateDb",
      "n8n-nodes-base.crateDb",
      "n8n-nodes-base.set",
      "n8n-nodes-base.pagerDuty",
      "n8n-nodes-base.function",
      "n8n-nodes-base.noOp"
    ],
    "trigger": null
  }
}