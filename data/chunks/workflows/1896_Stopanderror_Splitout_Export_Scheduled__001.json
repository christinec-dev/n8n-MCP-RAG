{
  "source": "1896_Stopanderror_Splitout_Export_Scheduled.json",
  "index": 1,
  "content": "{\n  \"id\": \"k22TSNIZXHaQ9rGr\",\n  \"meta\": {\n    \"instanceId\": \"fb8bc2e315f7f03c97140b30aa454a27bc7883a19000fa1da6e6b571bf56ad6d\",\n    \"templateCredsSetupCompleted\": true\n  },\n  \"name\": \"Clockify Backup Template\",\n  \"tags\": [\n    {\n      \"id\": \"RKga6I6NviNI12bx\",\n      \"name\": \"template\",\n      \"createdAt\": \"2024-09-19T19:09:21.997Z\",\n      \"updatedAt\": \"2024-09-19T19:09:21.997Z\"\n    }\n  ],\n  \"nodes\": [\n    {\n      \"id\": \"24115363-9a03-4f8a-aa6e-2a9d4247f035\",\n      \"name\": \"Extract from File\",\n      \"type\": \"n8n-nodes-base.extractFromFile\",\n      \"position\": [\n        660,\n        400\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"operation\": \"fromJson\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"11aa4b51-98f9-4df8-b2d2-6757fe686894\",\n      \"name\": \"Compare Datasets\",\n      \"type\": \"n8n-nodes-base.compareDatasets\",\n      \"position\": [\n        880,\n        280\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"mergeByFields\": {\n          \"values\": [\n            {\n              \"field1\": \"data\",\n              \"field2\": \"data\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 2.3\n    },\n    {\n      \"id\": \"831ad368-6a46-4dd4-bb6c-8ea46200cdf0\",\n      \"name\": \"Stop and Error\",\n      \"type\": \"n8n-nodes-base.stopAndError\",\n      \"position\": [\n        880,\n        700\n      ],\n      \"parameters\": {\n        \"errorMessage\": \"={{ $json.error }}\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"2f838fc8-96bf-4111-aaba-743e0c88b688\",\n      \"name\": \"Globals\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        -660,\n        480\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"6bd5904d-0218-4075-a767-d4b659def9b0\",\n              \"name\": \"workspace_id\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.id }}\"\n            },\n            {\n              \"id\": \"63fa6231-6c5b-414f-b813-18f7dd5c33e9\",\n              \"name\": \"github_repo.owner\",\n              \"type\": \"string\",\n              \"value\": \"\"\n            },\n            {\n              \"id\": \"be2530d7-b2b5-41c5-af19-ab8d27f18e2e\",\n              \"name\": \"github_repo.name\",\n              \"type\": \"string\",\n              \"value\": \"\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 3.4\n    },\n    {\n      \"id\": \"bea9590e-355e-410a-bc4b-ae777efb9f15\",\n      \"name\": \"Set month indexes\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        -440,\n        480\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"ad278249-5320-4ffa-8d75-e47194c83e58\",\n              \"name\": \"monthIndex\",\n              \"type\": \"array\",\n              \"value\": \"=[0, 1, 2]\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 3.4\n    },\n    {\n      \"id\": \"f541d535-80d9-439d-8543-9c3cb156a5ff\",\n      \"name\": \"Split Out indexes\",\n      \"type\": \"n8n-nodes-base.splitOut\",\n      \"position\": [\n        -220,\n        480\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"fieldToSplitOut\": \"monthIndex\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"76c74727-d338-4a61-9bf2-e97893721995\",\n      \"name\": \"Set intervals\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        0,\n        480\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"7f5ff2ee-b93c-4121-b3dc-ce592513db88\",\n              \"name\": \"reportName\",\n              \"type\": \"string\",\n              \"value\": \"=detailed_report_{{ $now.minus($json.monthIndex, 'month').format('yyyy-MM') }}\"\n            },\n            {\n              \"id\": \"ea571bdb-8f51-4852-9fda-55ff1a929d1f\",\n              \"name\": \"startDate\",\n              \"type\": \"string\",\n              \"value\": \"={{ $now.minus($json.monthIndex, 'month').startOf('month').format('yyyy-MM-dd') }}\"\n            },\n            {\n              \"id\": \"e88726c4-1eb8-4f29-9805-7b0a5ee484a4\",\n              \"name\": \"endDate\",\n              \"type\": \"string\",\n              \"value\": \"={{ $now.minus($json.monthIndex, 'month').endOf('month').format('yyyy-MM-dd') }}\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 3.4\n    },\n    {\n      \"id\": \"6d5e917e-68ac-4dbd-98be-4c8ad97fa54a\",\n      \"name\": \"Skip empty reports\",\n      \"type\": \"n8n-nodes-base.filter\",\n      \"position\": [\n        880,\n        500\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"conditions\": {\n          \"options\": {\n            \"version\": 2,\n            \"leftValue\": \"\",\n            \"caseSensitive\": true,\n            \"typeValidation\": \"strict\"\n          },\n          \"combinator\": \"and\",\n          \"conditions\": [\n            {\n              \"id\": \"f6c69f9b-9e78-4a1e-af33-a1197f35e970\",\n              \"operator\": {\n                \"type\": \"array\",\n                \"operation\": \"notEmpty\",\n                \"singleValue\": true\n              },\n              \"leftValue\": \"={{ $json.timeentries }}\",\n              \"rightValue\": \"\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 2.2\n    },\n    {\n      \"id\": \"60c7a408-74d3-4c6c-ac78-1ed1071e873e\",\n      \"name\": \"Get first workspace\",\n      \"type\": \"n8n-nodes-base.clockify\",\n      \"position\": [\n        -880,\n        480\n      ],\n      \"parameters\": {\n        \"limit\": 1,\n        \"resource\": \"workspace\"\n      },\n      \"credentials\": {\n        \"clockifyApi\": {\n          \"id\": \"CMJ0LAYOs143GAXw\",\n          \"name\": \"Clockify (octionictest)\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"824bf2c6-9159-40ec-83f3-3f0b8d87c208\",\n      \"name\": \"Get detailed monthly report\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        220,\n        480\n      ],\n      \"parameters\": {\n        \"url\": \"=https://reports.api.clockify.me/v1/workspaces/{{ $('Globals').item.json.workspace_id }}/reports/detailed\",\n        \"method\": \"POST\",\n        \"options\": {},\n        \"jsonBody\": \"={\\n  \\\"dateRangeStart\\\": \\\"{{ $json.startDate }}T00:00:00Z\\\",\\n  \\\"dateRangeEnd\\\": \\\"{{ $json.endDate }}T23:59:59.999Z\\\",\\n  \\\"detailedFilter\\\": {\\n    \\\"page\\\": 1,\\n    \\\"pageSize\\\": 50\\n  },\\n  \\\"exportType\\\": \\\"json\\\"\\n}\",\n        \"sendBody\": true,\n        \"specifyBody\": \"json\",\n        \"authentication\": \"predefinedCredentialType\",\n        \"nodeCredentialType\": \"clockifyApi\"\n      },\n      \"credentials\": {\n        \"clockifyApi\": {\n          \"id\": \"CMJ0LAYOs143GAXw\",\n          \"name\": \"Clockify (octionictest)\"\n        }\n      },\n      \"typeVersion\": 4.2\n    },\n    {\n      \"id\": \"f9323c68-c70f-4f22-ae18-916d5fc1b264\",\n      \"name\": \"Check if file exists in GitHub\",\n      \"type\": \"n8n-nodes-base.github\",\n      \"onError\": \"continueErrorOutput\",\n      \"position\": [\n        440,\n        480\n      ],\n      \"parameters\": {\n        \"owner\": {\n          \"__rl\": true,\n          \"mode\": \"name\",\n          \"value\": \"={{ $('Globals').first().json.github_repo.owner }}\"\n        },\n        \"filePath\": \"=reports/{{ $('Set intervals').item.json.reportName }}\",\n        \"resource\": \"file\",\n        \"operation\": \"get\",\n        \"repository\": {\n          \"__rl\": true,\n          \"mode\": \"name\",\n          \"value\": \"={{ $('Globals').first().json.github_repo.name }}\"\n        },\n        \"additionalParameters\": {}\n      },\n      \"credentials\": {\n        \"githubApi\": {\n          \"id\": \"Eb9yCfVJGJvXD05z\",\n          \"name\": \"GitHub (n8n-test-01)\"\n        }\n      },\n      \"retryOnFail\": false,\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"41877a6a-ba5b-43bd-8ca3-f8402793685f\",\n      \"name\": \"Point to new data\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        660,\n        200\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"00d2885f-451e-436e-8852-b9ad086d231b\",\n              \"name\": \"data\",\n              \"type\": \"array\",\n              \"value\": \"={{ $('Get detailed monthly report').item.json.timeentries }}\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 3.4\n    },\n    {\n      \"id\": \"9f448921-5b9d-4937-a7d9-00a62b1fba99\",\n      \"name\": \"Check for 404 error message\",\n      \"type\": \"n8n-nodes-base.if\",\n      \"position\": [\n        660,\n        600\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"conditions\": {\n          \"options\": {\n            \"version\": 2,\n            \"leftValue\": \"\",\n            \"caseSensitive\": true,\n            \"typeValidation\": \"strict\"\n          },\n          \"combinator\": \"and\",\n          \"conditions\": [\n            {\n              \"id\": \"6b34c09d-0136-433c-856d-b29a0c3aac34\",\n              \"operator\": {\n                \"type\": \"string\",\n                \"operation\": \"contains\"\n              },\n              \"leftValue\": \"={{ $json.error }}\",\n              \"rightValue\": \"could not be found\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 2.2\n    },\n    {\n      \"id\": \"900905ed-cff6-4ebb-b0da-67db9f02b301\",\n      \"name\": \"Update file in GitHub\",\n      \"type\": \"n8n-nodes-base.github\",\n      \"position\": [\n        1100,\n        180\n      ],\n      \"parameters\": {\n        \"owner\": {\n          \"__rl\": true,\n          \"mode\": \"name\",\n          \"value\": \"={{ $('Globals').first().json.github_repo.owner }}\"\n        },\n        \"filePath\": \"=reports/{{ $('Set intervals').item.json.reportName }}\",\n        \"resource\": \"file\",\n        \"operation\": \"edit\",\n        \"repository\": {\n          \"__rl\": true,\n          \"mode\": \"name\",\n          \"value\": \"={{ $('Globals').first().json.github_repo.name }}\"\n        },\n        \"fileContent\": \"={{ JSON.stringify($json.data, null, 2) }}\",\n        \"commitMessage\": \"Update report\"\n      },\n      \"credentials\": {\n        \"githubApi\": {\n          \"id\": \"Eb9yCfVJGJvXD05z\",\n          \"name\": \"GitHub (n8n-test-01)\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"b928cdb2-b21a-45ff-9bc6-9be483891c4c\",\n      \"name\": \"Create file in GitHub\",\n      \"type\": \"n8n-nodes-base.github\",\n      \"position\": [\n        1100,\n        500\n      ],\n      \"parameters\": {\n        \"owner\": {\n          \"__rl\": true,\n          \"mode\": \"name\",\n          \"value\": \"={{ $('Globals').first().json.github_repo.owner }}\"\n        },\n        \"filePath\": \"=reports/{{ $('Set intervals').item.json.reportName }}\",\n        \"resource\": \"file\",\n        \"repository\": {\n          \"__rl\": true,\n          \"mode\": \"name\",\n          \"value\": \"={{ $('Globals').first().json.github_repo.name }}\"\n        },\n        \"fileContent\": \"={{ JSON.stringify($json.timeentries, null, 2) }}\",\n        \"commitMessage\": \"Create report\"\n      },\n      \"credentials\": {\n        \"githubApi\": {\n          \"id\": \"Eb9yCfVJGJvXD05z\",\n          \"name\": \"GitHub (n8n-test-01)\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"04a5b42d-ea1f-4b32-98b5-953e22b26819\",\n      \"name\": \"Schedule Trigger\",\n      \"type\": \"n8n-nodes-base.scheduleTrigger\",\n      \"position\": [\n        -1100,\n        480\n      ],\n      \"parameters\": {\n        \"rule\": {\n          \"interval\": [\n            {\n              \"triggerAtHour\": 5\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 1.2\n    },\n    {\n      \"id\": \"4728f389-df04-4f8d-a436-ac06508d28ba\",\n      \"name\": \"Sticky Note3\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -720,\n        260\n      ],\n      \"parameters\": {\n        \"width\": 220,\n        \"height\": 380,\n        \"content\": \"## Set Globals\\n- Define the repository owner (username / organization) and repository name\\n- By default the fist available Clockify workspace ID is set. This can be overridden here.\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"2e31df0a-1e67-4a9a-8dc1-42360b4da978\",\n      \"name\": \"Sticky Note4\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -1160,\n        360\n      ],\n      \"parameters\": {\n        \"width\": 220,\n        \"height\": 280,\n        \"content\": \"## Set trigger\\nBy default this workflow runs once a day.\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"696721c6-25fc-48f9-b0f5-53d1b6462183\",\n      \"name\": \"Sticky Note\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -500,\n        300\n      ],\n      \"parameters\": {\n        \"width\": 220,\n        \"height\": 340,\n        \"content\": \"## Set Scope (optional)\\nBy default the last three moths are being backed up.\\n_0 = current month, 1 = last month, etc._\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"a0ebb845-7472-40ec-b2b5-abc2f118b0e1\",\n      \"name\": \"Sticky Note1\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        160,\n        360\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 220,\n        \"height\": 280,\n        \"content\": \"A detailed report is being retrieved for every month across all entries in the workspace.\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"feb9f194-4c9d-41c8-9b46-3759dcdae9d5\",\n      \"name\": \"Sticky Note2\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        380,\n        100\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 920,\n        \"height\": 780,\n        \"content\": \"The reports are created or updated in GitHub.\\n**It is essential to back up previous months as well, as values like tags may still change over time.**\"\n      },\n      \"typeVersion\": 1\n    }\n  ],\n  \"active\": false,\n  \"pinData\": {},\n  \"settings\": {\n    \"executionOrder\": \"v1\"\n  },\n  \"versionId\": \"34ab93f2-a965-42ac-bd44-478c19a0f7d6\",\n  \"connections\": {\n    \"Globals\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Set month indexes\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Set intervals\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Get detailed monthly report\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Compare Datasets\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Update file in GitHub\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [],\n        []\n      ]\n    },\n    \"Schedule Trigger\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Get first workspace\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Extract from File\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Compare Datasets\",\n            \"type\": \"main\",\n            \"index\": 1\n          }\n        ]\n      ]\n    },\n    \"Point to new data\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Compare Datasets\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Set month indexes\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Split Out indexes\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Split Out indexes\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Set intervals\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Skip empty reports\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Create file in GitHub\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Get first workspace\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Globals\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Check for 404 error message\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Skip empty reports\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Stop and Error\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Get detailed monthly report\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Check if file exists in GitHub\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Check if file exists in GitHub\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Point to new data\",\n            \"type\": \"main\",\n            \"index\": 0\n          },\n          {\n            \"node\": \"Extract from File\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Check for 404 error message\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}",
  "metadata": {
    "node_types": [
      "n8n-nodes-base.extractFromFile",
      "n8n-nodes-base.compareDatasets",
      "n8n-nodes-base.stopAndError",
      "n8n-nodes-base.set",
      "n8n-nodes-base.set",
      "n8n-nodes-base.splitOut",
      "n8n-nodes-base.set",
      "n8n-nodes-base.filter",
      "n8n-nodes-base.clockify",
      "n8n-nodes-base.httpRequest",
      "n8n-nodes-base.github",
      "n8n-nodes-base.set",
      "n8n-nodes-base.if",
      "n8n-nodes-base.github",
      "n8n-nodes-base.github",
      "n8n-nodes-base.scheduleTrigger",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote"
    ],
    "trigger": "schedule trigger"
  }
}