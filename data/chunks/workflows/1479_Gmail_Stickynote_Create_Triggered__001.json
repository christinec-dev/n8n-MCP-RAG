{
  "source": "1479_Gmail_Stickynote_Create_Triggered.json",
  "index": 1,
  "content": "{\n  \"id\": \"aOQANirVMuWrH0ZD\",\n  \"meta\": {\n    \"instanceId\": \"b78ce2d06ac74b90a581919cf44503cf07404c11eda5c3847597226683145618\"\n  },\n  \"name\": \"Gmail AI auto-responder: create draft replies to incoming emails\",\n  \"tags\": [],\n  \"nodes\": [\n    {\n      \"id\": \"2a9ff08f-919a-41a8-980b-8c2bca3059e4\",\n      \"name\": \"Gmail Trigger\",\n      \"type\": \"n8n-nodes-base.gmailTrigger\",\n      \"position\": [\n        -332.809175564116,\n        566.0845437534399\n      ],\n      \"parameters\": {\n        \"simple\": false,\n        \"filters\": {\n          \"q\": \"-from:me\"\n        },\n        \"options\": {},\n        \"pollTimes\": {\n          \"item\": [\n            {\n              \"mode\": \"everyMinute\"\n            }\n          ]\n        }\n      },\n      \"credentials\": {\n        \"gmailOAuth2\": {\n          \"id\": \"ofvBTX8A0aWfQb2O\",\n          \"name\": \"Gmail account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"3ef14615-0045-404f-a21b-2c65a52f4be8\",\n      \"name\": \"If Needs Reply\",\n      \"type\": \"n8n-nodes-base.if\",\n      \"position\": [\n        240,\n        560\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"conditions\": {\n          \"options\": {\n            \"leftValue\": \"\",\n            \"caseSensitive\": true,\n            \"typeValidation\": \"strict\"\n          },\n          \"combinator\": \"and\",\n          \"conditions\": [\n            {\n              \"id\": \"53849246-ad32-4845-9976-9f9688f5a6f2\",\n              \"operator\": {\n                \"type\": \"boolean\",\n                \"operation\": \"true\",\n                \"singleValue\": true\n              },\n              \"leftValue\": \"={{ $json.needsReply }}\",\n              \"rightValue\": \"true\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"36968dd5-8d51-4184-a05a-587b6c95aa82\",\n      \"name\": \"JSON Parser\",\n      \"type\": \"@n8n/n8n-nodes-langchain.outputParserStructured\",\n      \"position\": [\n        100,\n        720\n      ],\n      \"parameters\": {\n        \"jsonSchema\": \"{\\n \\\"type\\\": \\\"object\\\",\\n \\\"properties\\\": {\\n \\\"needsReply\\\": {\\n \\\"type\\\": \\\"boolean\\\"\\n }\\n },\\n \\\"required\\\": [\\\"needsReply\\\"]\\n}\\n\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"2a64dce8-e2f0-475e-a366-a02084293aad\",\n      \"name\": \"OpenAI Chat\",\n      \"type\": \"@n8n/n8n-nodes-langchain.lmChatOpenAi\",\n      \"position\": [\n        -92.809175564116,\n        726.0845437534399\n      ],\n      \"parameters\": {\n        \"model\": \"gpt-4o\",\n        \"options\": {\n          \"temperature\": 0,\n          \"responseFormat\": \"json_object\"\n        }\n      },\n      \"credentials\": {\n        \"openAiApi\": {\n          \"id\": \"13ffkrNMlQMfvbZy\",\n          \"name\": \"OpenAi account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"be892ff8-0981-4b34-9c93-7674ddd90360\",\n      \"name\": \"Sticky Note\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -429.809175564116,\n        461.08454375343996\n      ],\n      \"parameters\": {\n        \"width\": 304.10628068244364,\n        \"height\": 394.42512272977456,\n        \"content\": \"## When I receive an Email\\n\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"9d92839a-9ff2-436c-8abb-2f43e07c1ace\",\n      \"name\": \"Sticky Note1\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -112.809175564116,\n        460.08454375343996\n      ],\n      \"parameters\": {\n        \"width\": 556,\n        \"height\": 397,\n        \"content\": \"## ... that Needs a Reply\\n\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"3cd77609-684c-44e2-9cdc-9479cfd836bd\",\n      \"name\": \"Sticky Note2\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        460,\n        460\n      ],\n      \"parameters\": {\n        \"width\": 333.19082443588354,\n        \"height\": 400.08454375343996,\n        \"content\": \"## Generate a Reply\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"b123cf31-767d-48bb-a0ba-79a69f6da585\",\n      \"name\": \"Sticky Note3\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        807.190824435884,\n        461.08454375343996\n      ],\n      \"parameters\": {\n        \"width\": 326,\n        \"height\": 395,\n        \"content\": \"## ...as a Draft in the conversation\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"1a87c416-6b1c-4526-a2b6-20468c95ea0e\",\n      \"name\": \"OpenAI Chat Model\",\n      \"type\": \"@n8n/n8n-nodes-langchain.lmChatOpenAi\",\n      \"position\": [\n        480,\n        680\n      ],\n      \"parameters\": {\n        \"model\": \"gpt-4-turbo\",\n        \"options\": {}\n      },\n      \"credentials\": {\n        \"openAiApi\": {\n          \"id\": \"13ffkrNMlQMfvbZy\",\n          \"name\": \"OpenAi account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"84b4d516-252e-444e-b998-2d4aa0f89653\",\n      \"name\": \"Gmail - Create Draft\",\n      \"type\": \"n8n-nodes-base.gmail\",\n      \"position\": [\n        900,\n        560\n      ],\n      \"parameters\": {\n        \"message\": \"={{ $json.text.replace(/\\\\n/g, \\\"<br />\\\\n\\\") }}\",\n        \"options\": {\n          \"sendTo\": \"={{ $('Gmail Trigger').item.json.headers.from }}\",\n          \"threadId\": \"={{ $('Gmail Trigger').item.json.threadId }}\"\n        },\n        \"subject\": \"=Re: {{ $('Gmail Trigger').item.json.headers.subject }}\",\n        \"resource\": \"draft\",\n        \"emailType\": \"html\"\n      },\n      \"credentials\": {\n        \"gmailOAuth2\": {\n          \"id\": \"ofvBTX8A0aWfQb2O\",\n          \"name\": \"Gmail account\"\n        }\n      },\n      \"typeVersion\": 2.1\n    },\n    {\n      \"id\": \"86017ff4-9c57-4b2a-9cd9-f62571a05ffd\",\n      \"name\": \"Assess if message needs a reply\",\n      \"type\": \"@n8n/n8n-nodes-langchain.chainLlm\",\n      \"position\": [\n        -92.809175564116,\n        566.0845437534399\n      ],\n      \"parameters\": {\n        \"prompt\": \"=Subject: {{ $json.subject }}\\nMessage:\\n{{ $json.textAsHtml }} \",\n        \"messages\": {\n          \"messageValues\": [\n            {\n              \"message\": \"Your task is to assess if the message requires a response. Return in JSON format true if it does, false otherwise.\\nMarketing emails don't require a response.\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 1.3\n    },\n    {\n      \"id\": \"cab1e7e5-93dc-4850-a471-e285cdbe2058\",\n      \"name\": \"Generate email reply\",\n      \"type\": \"@n8n/n8n-nodes-langchain.chainLlm\",\n      \"position\": [\n        500,\n        520\n      ],\n      \"parameters\": {\n        \"text\": \"=Subject: {{ $('Gmail Trigger').item.json.subject }}\\nMessage: {{ $('Gmail Trigger').item.json.textAsHtml }}\",\n        \"messages\": {\n          \"messageValues\": [\n            {\n              \"message\": \"You're a helpful personal assistant and your task is to draft replies on my behalf to my incoming emails. Whenever I provide some text from an email, return an appropriate draft reply for it and nothing else.\\nEnsure that the reply is suitable for a professional email setting and addresses the topic in a clear, structured, and detailed manner.\\nDo not make things up.\\n\\nDetailed instructions:\\n- Be concise and maintain a business casual tone.\\n- Start with \\\"Hello,\\\", and end with \\\"Best,\\\"\\n- When replying to yes-no questions, draft 2 responses: one affirmative and one negative separated by \\\" - - - - - - - OR - - - - - - - \\\"\\n- If you don't know an answer, you can leave placeholders like \\\"[YOUR_ANSWER_HERE]\\\".\\n- Don't use any special formatting, only plain text.\\n- Reply in the same language as the inbound email.\"\n            }\n          ]\n        },\n        \"promptType\": \"define\"\n      },\n      \"typeVersion\": 1.4\n    }\n  ],\n  \"active\": true,\n  \"pinData\": {},\n  \"settings\": {\n    \"executionOrder\": \"v1\"\n  },\n  \"versionId\": \"c4448c34-1f75-4479-805e-20d8a69a7e00\",\n  \"connections\": {\n    \"JSON Parser\": {\n      \"ai_outputParser\": [\n        [\n          {\n            \"node\": \"Assess if message needs a reply\",\n            \"type\": \"ai_outputParser\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"OpenAI Chat\": {\n      \"ai_languageModel\": [\n        [\n          {\n            \"node\": \"Assess if message needs a reply\",\n            \"type\": \"ai_languageModel\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Gmail Trigger\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Assess if message needs a reply\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"If Needs Reply\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Generate email reply\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"OpenAI Chat Model\": {\n      \"ai_languageModel\": [\n        [\n          {\n            \"node\": \"Generate email reply\",\n            \"type\": \"ai_languageModel\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Generate email reply\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Gmail - Create Draft\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Assess if message needs a reply\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"If Needs Reply\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}",
  "metadata": {
    "node_types": [
      "n8n-nodes-base.gmailTrigger",
      "n8n-nodes-base.if",
      "@n8n/n8n-nodes-langchain.outputParserStructured",
      "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "n8n-nodes-base.gmail",
      "@n8n/n8n-nodes-langchain.chainLlm",
      "@n8n/n8n-nodes-langchain.chainLlm"
    ],
    "trigger": "gmail trigger"
  }
}