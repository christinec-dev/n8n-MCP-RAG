{
  "source": "0449_Splitout_Webhook_Create_Webhook.json",
  "index": 1,
  "content": "{\n  \"meta\": {\n    \"instanceId\": \"dbd43d88d26a9e30d8aadc002c9e77f1400c683dd34efe3778d43d27250dde50\"\n  },\n  \"nodes\": [\n    {\n      \"id\": \"80b17b5c-6a05-45b9-bfa6-97fe84706687\",\n      \"name\": \"HTTP Request\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        940,\n        320\n      ],\n      \"parameters\": {\n        \"url\": \"=https://yt.lemnoslife.com/videos?part=mostReplayed&id={{ $json.youtubeVideoID }}\",\n        \"options\": {}\n      },\n      \"typeVersion\": 4.1\n    },\n    {\n      \"id\": \"12b006e7-83f0-450e-98a8-3b5c3864fac4\",\n      \"name\": \"Split Out\",\n      \"type\": \"n8n-nodes-base.splitOut\",\n      \"position\": [\n        1420,\n        260\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"fieldToSplitOut\": \"items[0].mostReplayed.markers\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"cb4cdfe1-7601-43e9-b314-818556c4724b\",\n      \"name\": \"has intensity data?\",\n      \"type\": \"n8n-nodes-base.if\",\n      \"position\": [\n        1160,\n        320\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"conditions\": {\n          \"options\": {\n            \"leftValue\": \"\",\n            \"caseSensitive\": true,\n            \"typeValidation\": \"strict\"\n          },\n          \"combinator\": \"and\",\n          \"conditions\": [\n            {\n              \"id\": \"91f8b87d-228f-4877-ad25-5b9cef3a0f86\",\n              \"operator\": {\n                \"type\": \"object\",\n                \"operation\": \"exists\",\n                \"singleValue\": true\n              },\n              \"leftValue\": \"={{ $json.items[0].mostReplayed }}\",\n              \"rightValue\": \"\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"76614979-d1eb-4b9e-8b16-0f22705d0a0a\",\n      \"name\": \"No intensity data available for video\",\n      \"type\": \"n8n-nodes-base.noOp\",\n      \"position\": [\n        1420,\n        500\n      ],\n      \"parameters\": {},\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"7532185d-30c8-4fab-bb95-6aaa1e96c9f5\",\n      \"name\": \"intensity > 0.6\",\n      \"type\": \"n8n-nodes-base.filter\",\n      \"position\": [\n        1620,\n        260\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"conditions\": {\n          \"options\": {\n            \"leftValue\": \"\",\n            \"caseSensitive\": true,\n            \"typeValidation\": \"strict\"\n          },\n          \"combinator\": \"and\",\n          \"conditions\": [\n            {\n              \"id\": \"86716013-333d-4418-b516-f86f5098abca\",\n              \"operator\": {\n                \"type\": \"number\",\n                \"operation\": \"gt\"\n              },\n              \"leftValue\": \"={{ $json.intensityScoreNormalized }}\",\n              \"rightValue\": 0.6\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"6021cfc5-614c-41a5-b08d-557f6b2ceb94\",\n      \"name\": \"Filter out moments close to each other\",\n      \"type\": \"n8n-nodes-base.filter\",\n      \"position\": [\n        2000,\n        260\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"conditions\": {\n          \"options\": {\n            \"leftValue\": \"\",\n            \"caseSensitive\": true,\n            \"typeValidation\": \"strict\"\n          },\n          \"combinator\": \"and\",\n          \"conditions\": [\n            {\n              \"id\": \"7f682942-953b-4489-b892-811b0bec22ce\",\n              \"operator\": {\n                \"type\": \"number\",\n                \"operation\": \"gt\"\n              },\n              \"leftValue\": \"={{ $input.all()[ $itemIndex + 1].json.startSec }}\",\n              \"rightValue\": \"={{ $input.all()[ $itemIndex ].json.startSec + 20 }}\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"99e3d626-b394-48e6-925e-b5eca155720f\",\n      \"name\": \"Input variables\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        720,\n        320\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"fcd7c7ef-8b06-45fa-8257-d44ed772cf08\",\n              \"name\": \"youtubeVideoID\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.query.ytID }}\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 3.3\n    },\n    {\n      \"id\": \"50e81b17-4b82-4a8f-a559-aff6ee671c7f\",\n      \"name\": \"Aggregate\",\n      \"type\": \"n8n-nodes-base.aggregate\",\n      \"position\": [\n        2400,\n        260\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"aggregate\": \"aggregateAllItemData\",\n        \"destinationFieldName\": \"engagingMoments\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"5cfd4462-ff82-499a-9090-e233a6147af6\",\n      \"name\": \"Create each moment (human readable)\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        2200,\n        260\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"2ad5088d-f42a-42f6-931e-bc11e5ce43da\",\n              \"name\": \"humanReadableMessage\",\n              \"type\": \"string\",\n              \"value\": \"=Engaging moment #{{ $itemIndex +1 }}: https://youtu.be/{{ $('Input variables').first().json.youtubeVideoID }}?t={{ $json.startSec.round() - 3 }}\\n\"\n            },\n            {\n              \"id\": \"dcbe5150-2aaa-46d4-960e-4cad0204dbf4\",\n              \"name\": \"startSec\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.startSec.round() }}\"\n            },\n            {\n              \"id\": \"6a554773-9caf-4682-9e36-5d7dfee6d5f5\",\n              \"name\": \"directYTURL\",\n              \"type\": \"string\",\n              \"value\": \"=https://youtu.be/{{ $('Input variables').first().json.youtubeVideoID }}?t={{ $json.startSec.round() - 3 }}\"\n            }\n          ]\n        },\n        \"includeOtherFields\": true\n      },\n      \"typeVersion\": 3.3\n    },\n    {\n      \"id\": \"aa70beee-e6ed-4af4-892c-743f8150a57f\",\n      \"name\": \"Webhook\",\n      \"type\": \"n8n-nodes-base.webhook\",\n      \"position\": [\n        500,\n        320\n      ],\n      \"webhookId\": \"21504b31-88e6-4cd9-aaf3-7587427ca5c5\",\n      \"parameters\": {\n        \"path\": \"youtube-engaging-moments-extractor\",\n        \"options\": {},\n        \"responseMode\": \"responseNode\"\n      },\n      \"typeVersion\": 1.1\n    },\n    {\n      \"id\": \"7b55436e-45d7-4fd7-8a08-0127e8dfb299\",\n      \"name\": \"millisecs to seconds\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        1800,\n        260\n      ],\n      \"parameters\": {\n        \"include\": \"except\",\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"8b350b84-b78f-46d4-adfb-7115b64494ba\",\n              \"name\": \"startSec\",\n              \"type\": \"number\",\n              \"value\": \"={{ $json.startMillis / 1000 }}\"\n            }\n          ]\n        },\n        \"excludeFields\": \"startMillis\",\n        \"includeOtherFields\": true\n      },\n      \"typeVersion\": 3.3\n    },\n    {\n      \"id\": \"182da3ef-19c0-4356-866d-159d5aa8be16\",\n      \"name\": \"prepare response\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        2620,\n        260\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"35261be7-c208-4025-bca1-0b41cf011c38\",\n              \"name\": \"youtubeID\",\n              \"type\": \"string\",\n              \"value\": \"={{ $('Webhook').item.json.query.ytID }}\"\n            }\n          ]\n        },\n        \"includeOtherFields\": true\n      },\n      \"typeVersion\": 3.3\n    },\n    {\n      \"id\": \"03830a21-13b3-426d-b972-43ded224b66f\",\n      \"name\": \"Respond with \\\"no results\\\"\",\n      \"type\": \"n8n-nodes-base.respondToWebhook\",\n      \"position\": [\n        1660,\n        500\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"respondWith\": \"json\",\n        \"responseBody\": \"={\\n  \\\"engagingMoments\\\": null,\\n  \\\"youtubeID\\\": \\\"{{ $('Webhook').item.json.query.ytID }}\\\"\\n}\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"d7e8441c-a429-490b-8993-c714fcbb61a2\",\n      \"name\": \"Respond with moments\",\n      \"type\": \"n8n-nodes-base.respondToWebhook\",\n      \"position\": [\n        2860,\n        260\n      ],\n      \"parameters\": {\n        \"options\": {}\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"cfa06a1f-8e50-4e91-9a18-5b77e315a816\",\n      \"name\": \"Sticky Note\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        1620,\n        480\n      ],\n      \"parameters\": {\n        \"color\": 3,\n        \"width\": 307.626814098134,\n        \"height\": 357.96212854181044,\n        \"content\": \"\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\nExample response ðŸ‘‡\\n![](https://i.ibb.co/7VZVFBh/error-response.png#full-width)\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"3c4b9ced-1713-4f02-8a95-519e2e4f2ce8\",\n      \"name\": \"Sticky Note1\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        2800,\n        240\n      ],\n      \"parameters\": {\n        \"color\": 4,\n        \"width\": 402.30435383552106,\n        \"height\": 480.9199723565991,\n        \"content\": \"\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\nExample response ðŸ‘‡\\n![](https://i.ibb.co/ssymRNt/success-response.png#full-width)\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"15e8201c-6b72-40f6-bdd2-441a74424aa3\",\n      \"name\": \"Sticky Note2\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        500,\n        -180\n      ],\n      \"parameters\": {\n        \"color\": 5,\n        \"width\": 362.9578438147888,\n        \"height\": 424.35936420179615,\n        \"content\": \"## Extract engaging moments from YouTube video\\nThis template takes a YouTube video ID and returns potentially engaging moments, based on the \\\"intensity\\\" of a certain timestamp ðŸ‘‡\\n\\n![](https://i.ibb.co/Xz2CDnW/Screenshot-2024-02-28-at-15-51-02.png#full-width)\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"3edebeb4-c842-4366-a05a-d463fffe449f\",\n      \"name\": \"Sticky Note3\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        880,\n        60\n      ],\n      \"parameters\": {\n        \"color\": 5,\n        \"width\": 445.3395991706974,\n        \"height\": 184.59156876295762,\n        \"content\": \"### How to use\\n1. Open `Webhook` node and copy the `Production URL`\\n2. Activate the workflow\\n3. In a web browser, PostMan or n8n HTTP Request invoke the Production URL: `{prod url}?ytID={youtube ID}`. \\ne.g. `{your instance URL}/webhook/youtube-engaging-moments-extractor?ytID=IZsQqarWXtYy`\"\n      },\n      \"typeVersion\": 1\n    }\n  ],\n  \"pinData\": {},\n  \"connections\": {\n    \"Webhook\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Input variables\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Aggregate\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"prepare response\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Split Out\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"intensity > 0.6\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"HTTP Request\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"has intensity data?\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Input variables\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"HTTP Request\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"intensity > 0.6\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"millisecs to seconds\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"prepare response\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Respond with moments\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"has intensity data?\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Split Out\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"No intensity data available for video\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"millisecs to seconds\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Filter out moments close to each other\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Create each moment (human readable)\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Aggregate\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"No intensity data available for video\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Respond with \\\"no results\\\"\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Filter out moments close to each other\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Create each moment (human readable)\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}",
  "metadata": {
    "node_types": [
      "n8n-nodes-base.httpRequest",
      "n8n-nodes-base.splitOut",
      "n8n-nodes-base.if",
      "n8n-nodes-base.noOp",
      "n8n-nodes-base.filter",
      "n8n-nodes-base.filter",
      "n8n-nodes-base.set",
      "n8n-nodes-base.aggregate",
      "n8n-nodes-base.set",
      "n8n-nodes-base.webhook",
      "n8n-nodes-base.set",
      "n8n-nodes-base.set",
      "n8n-nodes-base.respondToWebhook",
      "n8n-nodes-base.respondToWebhook",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote"
    ],
    "trigger": null
  }
}