{
  "source": "0626_HTTP_Schedule_Create_Scheduled.json",
  "index": 1,
  "content": "{\n  \"nodes\": [\n    {\n      \"id\": \"2654751b-aa66-40ce-b8a0-79063aa710ad\",\n      \"name\": \"Generate OAuth Token\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        820,\n        460\n      ],\n      \"parameters\": {\n        \"url\": \"=https://accounts.accesscontrol.windows.net/{{ $json.tenant_id }}/tokens/oAuth/2\",\n        \"options\": {},\n        \"requestMethod\": \"POST\",\n        \"bodyParametersUi\": {\n          \"parameter\": [\n            {\n              \"name\": \"grant_type\",\n              \"value\": \"client_credentials\"\n            },\n            {\n              \"name\": \"client_id\",\n              \"value\": \"{{client_id}}\"\n            },\n            {\n              \"name\": \"client_secret\",\n              \"value\": \"{{client_secret}}\"\n            },\n            {\n              \"name\": \"resource\",\n              \"value\": \"https://{your-sharepoint-domain}.sharepoint.com\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"6f713c65-8fbd-4d05-bbef-9b4a1f6248e9\",\n      \"name\": \"Fetch SharePoint List\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        1160,\n        460\n      ],\n      \"parameters\": {\n        \"url\": \"https://{your-sharepoint-domain}.sharepoint.com/_api/web/lists/getbytitle('YourListTitle')/items\",\n        \"options\": {},\n        \"headerParametersUi\": {\n          \"parameter\": [\n            {\n              \"name\": \"Accept\",\n              \"value\": \"application/json;odata=nometadata\"\n            },\n            {\n              \"name\": \"Content-Type\",\n              \"value\": \"application/json;odata=verbose\"\n            },\n            {\n              \"name\": \"Authorization\",\n              \"value\": \"Bearer {{Token}}\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"d11e9e92-2468-485c-87f5-6de7da7f9589\",\n      \"name\": \"Schedule Trigger\",\n      \"type\": \"n8n-nodes-base.scheduleTrigger\",\n      \"position\": [\n        380,\n        460\n      ],\n      \"parameters\": {\n        \"rule\": {\n          \"interval\": [\n            {}\n          ]\n        }\n      },\n      \"typeVersion\": 1.2\n    },\n    {\n      \"id\": \"8539f52c-2218-4a47-9678-3e3e8e9fd4c8\",\n      \"name\": \"setTenant\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        600,\n        460\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"399d42f3-41e0-4043-9a57-85771bf5cd07\",\n              \"name\": \"tenant_id\",\n              \"type\": \"string\",\n              \"value\": \"\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 3.4\n    },\n    {\n      \"id\": \"5a4fa41c-0726-4528-99a3-b5e0c47c1960\",\n      \"name\": \"Sticky Note\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        580,\n        220\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 458,\n        \"height\": 404,\n        \"content\": \"## Never expose or hard code below values \\n**tenant_id,client_id,client_secret** \\n\\nAlways save these either in secure vault like hashicorp or GCP Secret Manager.\"\n      },\n      \"typeVersion\": 1\n    }\n  ],\n  \"pinData\": {},\n  \"connections\": {\n    \"setTenant\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Generate OAuth Token\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Schedule Trigger\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"setTenant\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Generate OAuth Token\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Fetch SharePoint List\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}",
  "metadata": {
    "node_types": [
      "n8n-nodes-base.httpRequest",
      "n8n-nodes-base.httpRequest",
      "n8n-nodes-base.scheduleTrigger",
      "n8n-nodes-base.set",
      "n8n-nodes-base.stickyNote"
    ],
    "trigger": "schedule trigger"
  }
}