{
  "source": "0942_Webhook_Signl4_Automation_Webhook.json",
  "index": 1,
  "content": "{\n  \"id\": 3,\n  \"name\": \"TheHive\",\n  \"nodes\": [\n    {\n      \"name\": \"TheHive Create Alert\",\n      \"type\": \"n8n-nodes-base.theHive\",\n      \"position\": [\n        500,\n        360\n      ],\n      \"parameters\": {\n        \"date\": \"2022-04-25T08:53:18.000Z\",\n        \"tags\": \"tlp:pwhite\",\n        \"type\": \"misp\",\n        \"title\": \"TheHive Alert\",\n        \"source\": \"1311\",\n        \"sourceRef\": \"1330\",\n        \"description\": \"Security issue detected on server A2. Please check and take care.\",\n        \"additionalFields\": {}\n      },\n      \"credentials\": {\n        \"theHiveApi\": {\n          \"id\": \"1\",\n          \"name\": \"The Hive account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"TheHive Read Alerts\",\n      \"type\": \"n8n-nodes-base.theHive\",\n      \"position\": [\n        500,\n        200\n      ],\n      \"parameters\": {\n        \"filters\": {},\n        \"options\": {},\n        \"operation\": \"getAll\"\n      },\n      \"credentials\": {\n        \"theHiveApi\": {\n          \"id\": \"1\",\n          \"name\": \"The Hive account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"IF\",\n      \"type\": \"n8n-nodes-base.if\",\n      \"position\": [\n        280,\n        540\n      ],\n      \"parameters\": {\n        \"conditions\": {\n          \"boolean\": [\n            {\n              \"value1\": \"={{$node[\\\"TheHive Webhook Request\\\"].json[\\\"body\\\"][\\\"object\\\"][\\\"stage\\\"]}}\",\n              \"value2\": \"=Closed\",\n              \"operation\": \"notEqual\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"SIGNL4 Send Alert\",\n      \"type\": \"n8n-nodes-base.signl4\",\n      \"position\": [\n        500,\n        520\n      ],\n      \"parameters\": {\n        \"message\": \"={{$node[\\\"TheHive Webhook Request\\\"].json[\\\"body\\\"][\\\"details\\\"][\\\"description\\\"]}}\",\n        \"additionalFields\": {\n          \"title\": \"={{$node[\\\"TheHive Webhook Request\\\"].json[\\\"body\\\"][\\\"details\\\"][\\\"title\\\"]}}\",\n          \"externalId\": \"={{$node[\\\"TheHive Webhook Request\\\"].json[\\\"body\\\"][\\\"objectId\\\"]}}\"\n        }\n      },\n      \"credentials\": {\n        \"signl4Api\": {\n          \"id\": \"2\",\n          \"name\": \"SIGNL4 Webhook account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"TheHive Webhook Request\",\n      \"type\": \"n8n-nodes-base.webhook\",\n      \"position\": [\n        80,\n        540\n      ],\n      \"webhookId\": \"22c76955-3f52-469e-a8ae-3f62e8e87ebe\",\n      \"parameters\": {\n        \"path\": \"22c76955-3f52-469e-a8ae-3f62e8e87ebe\",\n        \"options\": {},\n        \"httpMethod\": \"POST\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Start (Testing)\",\n      \"type\": \"n8n-nodes-base.manualTrigger\",\n      \"position\": [\n        80,\n        200\n      ],\n      \"parameters\": {},\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"SIGNL4 Resolve Alert\",\n      \"type\": \"n8n-nodes-base.signl4\",\n      \"position\": [\n        500,\n        720\n      ],\n      \"parameters\": {\n        \"operation\": \"resolve\",\n        \"externalId\": \"={{$node[\\\"TheHive Webhook Request\\\"].json[\\\"body\\\"][\\\"objectId\\\"]}}\"\n      },\n      \"credentials\": {\n        \"signl4Api\": {\n          \"id\": \"2\",\n          \"name\": \"SIGNL4 Webhook account\"\n        }\n      },\n      \"typeVersion\": 1\n    }\n  ],\n  \"active\": false,\n  \"settings\": {},\n  \"connections\": {\n    \"IF\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"SIGNL4 Send Alert\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"SIGNL4 Resolve Alert\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Start (Testing)\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"TheHive Create Alert\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"TheHive Webhook Request\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"IF\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}",
  "metadata": {
    "node_types": [
      "n8n-nodes-base.theHive",
      "n8n-nodes-base.theHive",
      "n8n-nodes-base.if",
      "n8n-nodes-base.signl4",
      "n8n-nodes-base.webhook",
      "n8n-nodes-base.manualTrigger",
      "n8n-nodes-base.signl4"
    ],
    "trigger": null
  }
}