{
  "source": "0505_HTTP_Stickynote_Create_Webhook.json",
  "index": 1,
  "content": "{\n  \"meta\": {\n    \"instanceId\": \"2490ba08907e49e216e6667acbe7f8867d372c76c9bd95e87bb8d210bd552e80\"\n  },\n  \"nodes\": [\n    {\n      \"id\": \"3ebbf865-26f6-456f-83bd-33fa72bc09ea\",\n      \"name\": \"Token SuiteCRM\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        480,\n        800\n      ],\n      \"parameters\": {\n        \"url\": \"=https://SUITECRMURLSERVER/Api/access_token\",\n        \"options\": {},\n        \"requestMethod\": \"POST\",\n        \"bodyParametersUi\": {\n          \"parameter\": [\n            {\n              \"name\": \"grant_type\",\n              \"value\": \"client_credentials\"\n            },\n            {\n              \"name\": \"client_id\",\n              \"value\": \"IDVALUE\"\n            },\n            {\n              \"name\": \"client_secret\",\n              \"value\": \"PWDVALUE\"\n            }\n          ]\n        },\n        \"allowUnauthorizedCerts\": true\n      },\n      \"notesInFlow\": true,\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"763bd0bc-7c08-496d-82b7-1fb021c1e6e1\",\n      \"name\": \"CaptainMail\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        -360,\n        560\n      ],\n      \"parameters\": {\n        \"url\": \"=https://api.captainverify.com/v2/verify?apikey=YOURAPIKEY&email={{ $json.body.data.fields[0].value }}\",\n        \"options\": {\n          \"response\": {\n            \"response\": {\n              \"responseFormat\": \"json\"\n            }\n          }\n        }\n      },\n      \"typeVersion\": 4.2\n    },\n    {\n      \"id\": \"9d1f03eb-4be2-4e72-bc86-723d92869888\",\n      \"name\": \"If mail ok\",\n      \"type\": \"n8n-nodes-base.if\",\n      \"position\": [\n        220,\n        580\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"conditions\": {\n          \"options\": {\n            \"leftValue\": \"\",\n            \"caseSensitive\": true,\n            \"typeValidation\": \"strict\"\n          },\n          \"combinator\": \"and\",\n          \"conditions\": [\n            {\n              \"id\": \"ea7e2b2b-35cc-469c-b01b-eeb4f0030aa5\",\n              \"operator\": {\n                \"name\": \"filter.operator.equals\",\n                \"type\": \"string\",\n                \"operation\": \"equals\"\n              },\n              \"leftValue\": \"={{ $json.result }}\",\n              \"rightValue\": \"invalid\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"03ffff8c-401a-4723-80c6-df702cda2ba5\",\n      \"name\": \"If Credits OK\",\n      \"type\": \"n8n-nodes-base.if\",\n      \"position\": [\n        -180,\n        560\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"conditions\": {\n          \"options\": {\n            \"leftValue\": \"\",\n            \"caseSensitive\": true,\n            \"typeValidation\": \"strict\"\n          },\n          \"combinator\": \"and\",\n          \"conditions\": [\n            {\n              \"id\": \"007b0ec4-870d-48d6-a961-adff23ceabd4\",\n              \"operator\": {\n                \"type\": \"number\",\n                \"operation\": \"lt\"\n              },\n              \"leftValue\": \"={{ $json.credits }}\",\n              \"rightValue\": 100\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"487b4746-48d3-40c2-a21c-0a3aa38ba780\",\n      \"name\": \"Tally Forms Trigger\",\n      \"type\": \"n8n-nodes-base.executeWorkflowTrigger\",\n      \"position\": [\n        -600,\n        560\n      ],\n      \"parameters\": {},\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"2ff81440-ffb4-4d92-8fb0-0a46f6488a2e\",\n      \"name\": \"Sticky Note\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -420,\n        382.5935162094766\n      ],\n      \"parameters\": {\n        \"width\": 221.29675810473822,\n        \"height\": 324.588528678304,\n        \"content\": \"## CaptainVerify \\n**Verify your email !** To reduce bounce email for your future campains. [Link](https://captainverify.com)\\n\\nChange **YOURAPIKEY** with yours\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"73d00252-c081-451c-84df-67e44bf0bb11\",\n      \"name\": \"Sticky Note1\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -60,\n        180\n      ],\n      \"parameters\": {\n        \"color\": 5,\n        \"width\": 266.18453865336653,\n        \"height\": 395.6608478802989,\n        \"content\": \"## Warning about your credits \\nNotify with a message and level of credits in your NextCloud Discussion\\n\\nChange **URLSERVERNEXTCLOUD** with yours\\nand **DISCUSSIONCODE** with the code of target discussion\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"da8758f6-82f6-481c-97cc-40292579d723\",\n      \"name\": \"Notif Talk credits\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        20,\n        420\n      ],\n      \"parameters\": {\n        \"url\": \"=https://URLSERVERNEXTCLOUD/ocs/v2.php/apps/spreed/api/v1/chat/DISCUSSIONCODE\",\n        \"options\": {\n          \"bodyContentType\": \"json\",\n          \"bodyContentCustomMimeType\": \"application/json\"\n        },\n        \"requestMethod\": \"POST\",\n        \"authentication\": \"basicAuth\",\n        \"jsonParameters\": true,\n        \"bodyParametersJson\": \"={\\n\\\"message\\\":\\\"Low credits for CaptainVerify Mail. Balance = {{ $json[\\\"credits\\\"] }}\\\"\\n}\",\n        \"headerParametersJson\": \"={\\\"OCS-APIRequest\\\":\\\"true\\\"}\"\n      },\n      \"notesInFlow\": true,\n      \"typeVersion\": 1,\n      \"continueOnFail\": true\n    },\n    {\n      \"id\": \"569b9fd4-85d0-4300-8dc1-ab71fc5c2d09\",\n      \"name\": \"Notif Talk bad email\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        420,\n        420\n      ],\n      \"parameters\": {\n        \"url\": \"=https://URLSERVERNEXTCLOUD/ocs/v2.php/apps/spreed/api/v1/chat/DISCUSSIONCODE\",\n        \"options\": {\n          \"bodyContentType\": \"json\",\n          \"bodyContentCustomMimeType\": \"application/json\"\n        },\n        \"requestMethod\": \"POST\",\n        \"authentication\": \"basicAuth\",\n        \"jsonParameters\": true,\n        \"bodyParametersJson\": \"={\\n\\\"message\\\":\\\"Invalid mail on submission form for contact : {{ $('Execute Workflow Trigger').item.json[\\\"body\\\"][\\\"data\\\"][\\\"fields\\\"][1][\\\"value\\\"] }} et mail : {{ $('CaptainMail').item.json[\\\"email\\\"] }} \\\"\\n}\",\n        \"headerParametersJson\": \"={\\\"OCS-APIRequest\\\":\\\"true\\\"}\"\n      },\n      \"notesInFlow\": true,\n      \"typeVersion\": 1,\n      \"continueOnFail\": true\n    },\n    {\n      \"id\": \"6b555580-b66d-485d-b1b7-dd9fbd580294\",\n      \"name\": \"Sticky Note2\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        340,\n        180\n      ],\n      \"parameters\": {\n        \"color\": 5,\n        \"width\": 266.18453865336653,\n        \"height\": 395.6608478802989,\n        \"content\": \"## Warning bad email \\nNotify with a message for contact with invalid mail in your NextCloud Discussion\\n\\nChange **URLSERVERNEXTCLOUD** with yours\\nand **DISCUSSIONCODE** with the code of target discussion\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"fcc84bdb-9ae2-44c9-a038-c9282cfe1373\",\n      \"name\": \"Sticky Note3\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        420,\n        600\n      ],\n      \"parameters\": {\n        \"color\": 3,\n        \"width\": 226.00997506234387,\n        \"height\": 358.40399002493757,\n        \"content\": \"## Auth SuiteCRM \\n**Get Token** with V8 API. [Guide](https://docs.suitecrm.com/developer/api/developer-setup-guide/)\\n\\nChange **SUITECRMURLSERVER** with yours\\nChange **IDVALUE** and **PWDVALUE** with a specific user in SuiteCRM\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"d9a96370-f545-4daf-a2e2-af7efd5fda42\",\n      \"name\": \"Sticky Note4\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -680,\n        461.97007481296754\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"height\": 252.8428927680797,\n        \"content\": \"## WEBHOOK \\n**TRIGGER** with the FormsTool of your choice.\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"8e50db5a-5945-468c-ae92-239b8eb74f31\",\n      \"name\": \"Sticky Note5\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        1060,\n        120\n      ],\n      \"parameters\": {\n        \"width\": 221.29675810473822,\n        \"height\": 80,\n        \"content\": \"## CaptainVerify \\n\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"81deb53f-4161-42ef-9eec-d075e694aa04\",\n      \"name\": \"Sticky Note6\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        1060,\n        220\n      ],\n      \"parameters\": {\n        \"color\": 5,\n        \"width\": 220.39900249376552,\n        \"height\": 80,\n        \"content\": \"## NextCloud\\n\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"2aea4eaf-d7fa-4e87-ae75-e52bc3f385c2\",\n      \"name\": \"Sticky Note7\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        660,\n        600\n      ],\n      \"parameters\": {\n        \"color\": 3,\n        \"width\": 226.00997506234387,\n        \"height\": 358.40399002493757,\n        \"content\": \"## Create Leads \\nAdjust **Json** with your data\\n\\nChange **SUITECRMURLSERVER** with yours\\nChange **IDVALUE** and **PWDVALUE** with a specific user in SuiteCRM\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"2550bf07-3d3b-497a-b14e-8626ab478659\",\n      \"name\": \"Sticky Note8\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        1060,\n        320\n      ],\n      \"parameters\": {\n        \"color\": 3,\n        \"width\": 223.46633416458826,\n        \"height\": 80,\n        \"content\": \"## SuiteCRM \\n\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"18324e1a-6873-466c-9eab-2292eb2fe1f4\",\n      \"name\": \"Sticky Note9\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        920,\n        600\n      ],\n      \"parameters\": {\n        \"color\": 4,\n        \"height\": 357.1321695760598,\n        \"content\": \"## Brevo\\nCreate Contact with data and **Link with the id of SuiteCRM** Lead in a dedicated custom field in Brevo\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"df474fee-be22-4fda-9cfc-61e46492e30c\",\n      \"name\": \"Create Lead SuiteCRM\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        720,\n        800\n      ],\n      \"parameters\": {\n        \"url\": \"https://SUITECRMURLSERVER/Api/V8/module\",\n        \"method\": \"POST\",\n        \"options\": {\n          \"response\": {\n            \"response\": {\n              \"responseFormat\": \"json\"\n            }\n          }\n        },\n        \"jsonBody\": \"={\\\"data\\\": {\\n\\\"type\\\": \\\"Leads\\\",\\n\\\"attributes\\\": { \\n\\\"last_name\\\": \\\"{{ $('Tally Forms Trigger').item.json[\\\"body\\\"][\\\"data\\\"][\\\"fields\\\"][1][\\\"value\\\"] }}\\\",\\n\\\"status\\\": \\\"Hot\\\",\\n\\\"email1\\\": \\\"{{ $('CaptainMail').item.json[\\\"email\\\"] }}\\\",\\n\\\"lead_source\\\": \\\"FormsChoice\\\",\\n\\\"assigned_user_id\\\": \\\"491cf554-4d5e-b06a-7a61-605210d85367\\\",\\n\\\"lead_source_description\\\": \\\"FORMNAME Submission\\\"}\\n}\\n}\",\n        \"sendBody\": true,\n        \"sendHeaders\": true,\n        \"specifyBody\": \"json\",\n        \"headerParameters\": {\n          \"parameters\": [\n            {\n              \"name\": \"Authorization\",\n              \"value\": \"=Bearer {{$node[\\\"Token SuiteCRM\\\"].json[\\\"access_token\\\"]}}\"\n            },\n            {\n              \"name\": \"Content-Type\",\n              \"value\": \"application/vnd.api+json\"\n            }\n          ]\n        }\n      },\n      \"notesInFlow\": true,\n      \"typeVersion\": 3\n    },\n    {\n      \"id\": \"635665d3-f35b-42b7-b9d5-427f46d1867f\",\n      \"name\": \"Notif Talk Lead created\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        1260,\n        800\n      ],\n      \"parameters\": {\n        \"url\": \"=https://URLSERVERNEXTCLOUD/ocs/v2.php/apps/spreed/api/v1/chat/DISCUSSIONCODE\",\n        \"options\": {\n          \"bodyContentType\": \"json\",\n          \"bodyContentCustomMimeType\": \"application/json\"\n        },\n        \"requestMethod\": \"POST\",\n        \"authentication\": \"basicAuth\",\n        \"jsonParameters\": true,\n        \"bodyParametersJson\": \"={\\n\\\"message\\\":\\\"Lead créé ! Saisie du Formulaire choix séance. Contact : {{ $('Tally Forms Trigger').item.json[\\\"body\\\"][\\\"data\\\"][\\\"fields\\\"][1][\\\"value\\\"] }} et mail : {{ $('CaptainMail').item.json[\\\"email\\\"] }} \\\"\\n}\",\n        \"headerParametersJson\": \"={\\\"OCS-APIRequest\\\":\\\"true\\\"}\"\n      },\n      \"notesInFlow\": true,\n      \"typeVersion\": 1,\n      \"continueOnFail\": true\n    },\n    {\n      \"id\": \"84fda59b-5d9c-42aa-9ce6-2c3fc837e04e\",\n      \"name\": \"Sticky Note10\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        1180,\n        600\n      ],\n      \"parameters\": {\n        \"color\": 5,\n        \"width\": 266.18453865336653,\n        \"height\": 357.50623441396476,\n        \"content\": \"## Notify lead created \\nMessage for a lead created in your selected NextCloud discussion\\n\\nChange **URLSERVERNEXTCLOUD** with yours\\nand **DISCUSSIONCODE** with the code of target discussion\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"2f55803e-bb3a-482a-9d12-5fdeefbbac6c\",\n      \"name\": \"Sticky Note11\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        1060,\n        420\n      ],\n      \"parameters\": {\n        \"color\": 4,\n        \"width\": 224.73815461346635,\n        \"height\": 80,\n        \"content\": \"## Brevo\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"fbf39f60-e895-4477-9f62-9ec6965a84cc\",\n      \"name\": \"Brevo Create Contact\",\n      \"type\": \"n8n-nodes-base.sendInBlue\",\n      \"position\": [\n        980,\n        800\n      ],\n      \"parameters\": {\n        \"email\": \"{{ $('CaptainMail').item.json[\\\"email\\\"] }}\",\n        \"resource\": \"contact\",\n        \"createContactAttributes\": {\n          \"attributesValues\": [\n            {\n              \"fieldName\": \"NOM\",\n              \"fieldValue\": \"={{ $('Tally Forms Trigger').item.json.body.data.fields[1].value }}\"\n            },\n            {\n              \"fieldName\": \"PRENOM\",\n              \"fieldValue\": \"={{ $('Tally Forms Trigger').item.json.body.data.fields[2].value }}\"\n            },\n            {\n              \"fieldName\": \"LEADS_ID\",\n              \"fieldValue\": \"={{ $('Create Lead SuiteCRM').item.json.data.id }}\"\n            }\n          ]\n        }\n      },\n      \"notesInFlow\": true,\n      \"typeVersion\": 1\n    }\n  ],\n  \"pinData\": {},\n  \"connections\": {\n    \"If mail ok\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Notif Talk bad email\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Token SuiteCRM\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"CaptainMail\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"If Credits OK\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"If Credits OK\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Notif Talk credits\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"If mail ok\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Token SuiteCRM\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Create Lead SuiteCRM\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Notif Talk credits\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"If mail ok\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Tally Forms Trigger\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"CaptainMail\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Brevo Create Contact\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Notif Talk Lead created\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Create Lead SuiteCRM\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Brevo Create Contact\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}",
  "metadata": {
    "node_types": [
      "n8n-nodes-base.httpRequest",
      "n8n-nodes-base.httpRequest",
      "n8n-nodes-base.if",
      "n8n-nodes-base.if",
      "n8n-nodes-base.executeWorkflowTrigger",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.httpRequest",
      "n8n-nodes-base.httpRequest",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.httpRequest",
      "n8n-nodes-base.httpRequest",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.sendInBlue"
    ],
    "trigger": "tally forms trigger"
  }
}