{
  "source": "0944_Telegram_Rssfeedread_Automation_Scheduled.json",
  "index": 1,
  "content": "{\n  \"id\": \"3\",\n  \"name\": \"rss-telegram\",\n  \"nodes\": [\n    {\n      \"name\": \"SplitInBatches\",\n      \"type\": \"n8n-nodes-base.splitInBatches\",\n      \"position\": [\n        480,\n        220\n      ],\n      \"parameters\": {\n        \"batchSize\": 1\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Function\",\n      \"type\": \"n8n-nodes-base.function\",\n      \"position\": [\n        610,\n        220\n      ],\n      \"parameters\": {\n        \"functionCode\": \"const staticData = getWorkflowStaticData('global');\\n\\n// Access its data\\nconst oldlink = staticData.oldlink;\\n\\nitems[0].json.oldlink = oldlink || \\\"\\\";\\n\\n// Update its data\\nstaticData.oldlink = items[0].json.link;\\n\\nreturn items;\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Cron1\",\n      \"type\": \"n8n-nodes-base.cron\",\n      \"position\": [\n        180,\n        290\n      ],\n      \"parameters\": {\n        \"triggerTimes\": {\n          \"item\": [\n            {\n              \"mode\": \"everyMinute\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"是否重复\",\n      \"type\": \"n8n-nodes-base.if\",\n      \"notes\": \"判断链接是否相同\",\n      \"position\": [\n        750,\n        220\n      ],\n      \"parameters\": {\n        \"conditions\": {\n          \"string\": [\n            {\n              \"value1\": \"={{$node[\\\"Function\\\"].data[\\\"oldlink\\\"]}}\",\n              \"value2\": \"={{$node[\\\"Function\\\"].data[\\\"link\\\"]}}\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"写入图片的属性\",\n      \"type\": \"n8n-nodes-base.function\",\n      \"position\": [\n        910,\n        220\n      ],\n      \"parameters\": {\n        \"functionCode\": \"function imgList(items) {\\n  let imgReg = /<img.*?(?:>|\\\\/>)/gi //匹配图片中的img标签\\n  let srcReg = /src=[\\\\'\\\\\\\"]?([^\\\\'\\\\\\\"]*)[\\\\'\\\\\\\"]?/i // 匹配图片中的src\\n  let str = items[0].json.content\\n  let arr = str.match(imgReg)  //筛选出所有的img\\n  let srcArr = []\\n  if(arr !== null){\\n     for (let i = 0; i < arr.length; i++) {\\n          let src = arr[i].match(srcReg)\\n          // 获取图片地址\\n          srcArr.push(src[1])\\n      }\\n        items[0].json.arrlength = arr.length;\\n        items[0].json.imgList = srcArr;\\n   } else {\\n        items[0].json.arrlength = 0;\\n   }\\n   \\n }\\nimgList(items)\\nreturn items;\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"图片数量判断\",\n      \"type\": \"n8n-nodes-base.if\",\n      \"position\": [\n        1060,\n        220\n      ],\n      \"parameters\": {\n        \"conditions\": {\n          \"number\": [\n            {\n              \"value1\": \"={{$node[\\\"写入图片的属性\\\"].data[\\\"arrlength\\\"]}}\",\n              \"value2\": 1,\n              \"operation\": \"equal\"\n            }\n          ],\n          \"string\": [],\n          \"boolean\": []\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"一张图片\",\n      \"type\": \"n8n-nodes-base.telegram\",\n      \"position\": [\n        1270,\n        80\n      ],\n      \"parameters\": {\n        \"file\": \"={{$node[\\\"图片数量判断\\\"].data[\\\"imgList\\\"][0]}}\",\n        \"chatId\": \"-1001314058276\",\n        \"operation\": \"sendPhoto\",\n        \"additionalFields\": {\n          \"caption\": \"={{$node[\\\"图片数量判断\\\"].data[\\\"contentSnippet\\\"]}}\"\n        }\n      },\n      \"credentials\": {\n        \"telegramApi\": \"lataimei\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"其他状况\",\n      \"type\": \"n8n-nodes-base.telegram\",\n      \"notes\": \"无图片\",\n      \"position\": [\n        1270,\n        230\n      ],\n      \"parameters\": {\n        \"text\": \"={{$node[\\\"图片数量判断\\\"].data[\\\"contentSnippet\\\"]}} {{$node[\\\"图片数量判断\\\"].data[\\\"link\\\"]}}\",\n        \"chatId\": \"-1001314058276\",\n        \"additionalFields\": {\n          \"parse_mode\": \"HTML\",\n          \"disable_web_page_preview\": true\n        }\n      },\n      \"credentials\": {\n        \"telegramApi\": \"lataimei\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"NaN\",\n      \"type\": \"n8n-nodes-base.function\",\n      \"position\": [\n        910,\n        370\n      ],\n      \"parameters\": {\n        \"functionCode\": \"function imgList(items) {\\n  let imgReg = /<img.*?(?:>|\\\\/>)/gi //匹配图片中的img标签\\n  let srcReg = /src=[\\\\'\\\\\\\"]?([^\\\\'\\\\\\\"]*)[\\\\'\\\\\\\"]?/i // 匹配图片中的src\\n  let str = items[0].json.content\\n  let arr = str.match(imgReg)  //筛选出所有的img\\n  let srcArr = []\\n  if(arr !== null){\\n     for (let i = 0; i < arr.length; i++) {\\n          let src = arr[i].match(srcReg)\\n          // 获取图片地址\\n          srcArr.push(src[1])\\n      }\\n        items[0].json.arrlength = arr.length;\\n        items[0].json.imgList = srcArr;\\n   } else {\\n        items[0].json.arrlength = 0;\\n   }\\n   \\n }\\nimgList(items)\\nreturn items;\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"SplitInBatches1\",\n      \"type\": \"n8n-nodes-base.splitInBatches\",\n      \"position\": [\n        480,\n        370\n      ],\n      \"parameters\": {\n        \"batchSize\": 1\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Function1\",\n      \"type\": \"n8n-nodes-base.function\",\n      \"position\": [\n        610,\n        370\n      ],\n      \"parameters\": {\n        \"functionCode\": \"const staticData = getWorkflowStaticData('global');\\n\\n// Access its data\\nconst tsaioldlink = staticData.tsaioldlink;\\n\\nitems[0].json.tsaioldlink = tsaioldlink || \\\"\\\";\\n\\n// Update its data\\nstaticData.tsaioldlink = items[0].json.link;\\n\\nreturn items;\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"IF\",\n      \"type\": \"n8n-nodes-base.if\",\n      \"position\": [\n        750,\n        370\n      ],\n      \"parameters\": {\n        \"conditions\": {\n          \"string\": [\n            {\n              \"value1\": \"={{$node[\\\"Function1\\\"].data[\\\"tsaioldlink\\\"]}}\",\n              \"value2\": \"={{$node[\\\"Function1\\\"].data[\\\"link\\\"]}}\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"IF1\",\n      \"type\": \"n8n-nodes-base.if\",\n      \"position\": [\n        1060,\n        370\n      ],\n      \"parameters\": {\n        \"conditions\": {\n          \"number\": [\n            {\n              \"value1\": 1,\n              \"value2\": \"=0\",\n              \"operation\": \"equal\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"send\",\n      \"type\": \"n8n-nodes-base.telegram\",\n      \"notes\": \"无图片\",\n      \"position\": [\n        1270,\n        380\n      ],\n      \"parameters\": {\n        \"file\": \"={{$node[\\\"IF1\\\"].data[\\\"imgList\\\"][0]}}\",\n        \"chatId\": \"-1001499587010\",\n        \"operation\": \"sendPhoto\",\n        \"additionalFields\": {\n          \"caption\": \"={{$node[\\\"IF1\\\"].data[\\\"contentSnippet\\\"]}}\"\n        }\n      },\n      \"credentials\": {\n        \"telegramApi\": \"lataimei\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"instagram rss\",\n      \"type\": \"n8n-nodes-base.rssFeedRead\",\n      \"position\": [\n        360,\n        370\n      ],\n      \"parameters\": {\n        \"url\": \"=https://rsshub985.herokuapp.com/instagram/user/tsai_ingwen/\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"weibo rss\",\n      \"type\": \"n8n-nodes-base.rssFeedRead\",\n      \"position\": [\n        360,\n        220\n      ],\n      \"parameters\": {\n        \"url\": \"=https://rsshub985.herokuapp.com/weibo/user/5721376081\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Telegram\",\n      \"type\": \"n8n-nodes-base.telegram\",\n      \"position\": [\n        1270,\n        530\n      ],\n      \"parameters\": {\n        \"file\": \"={{$node[\\\"IF1\\\"].data[\\\"imgList\\\"][0]}}\",\n        \"chatId\": \"-1001499587010\",\n        \"operation\": \"sendPhoto\",\n        \"additionalFields\": {\n          \"caption\": \"={{$node[\\\"IF1\\\"].data[\\\"contentSnippet\\\"]}} {{$node[\\\"IF1\\\"].data[\\\"link\\\"]}}\"\n        }\n      },\n      \"credentials\": {\n        \"telegramApi\": \"lataimei\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"test\",\n      \"type\": \"n8n-nodes-base.manualTrigger\",\n      \"position\": [\n        180,\n        130\n      ],\n      \"parameters\": {},\n      \"typeVersion\": 1\n    }\n  ],\n  \"active\": true,\n  \"settings\": {},\n  \"connections\": {\n    \"IF\": {\n      \"main\": [\n        [],\n        [\n          {\n            \"node\": \"NaN\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"IF1\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"send\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Telegram\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"NaN\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"IF1\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"test\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"instagram rss\",\n            \"type\": \"main\",\n            \"index\": 0\n          },\n          {\n            \"node\": \"weibo rss\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Cron1\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"weibo rss\",\n            \"type\": \"main\",\n            \"index\": 0\n          },\n          {\n            \"node\": \"instagram rss\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Function\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"是否重复\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Function1\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"IF\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"weibo rss\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"SplitInBatches\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"是否重复\": {\n      \"main\": [\n        [],\n        [\n          {\n            \"node\": \"写入图片的属性\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"instagram rss\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"SplitInBatches1\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"SplitInBatches\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Function\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"SplitInBatches1\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Function1\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"图片数量判断\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"一张图片\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"其他状况\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"写入图片的属性\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"图片数量判断\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}",
  "metadata": {
    "node_types": [
      "n8n-nodes-base.splitInBatches",
      "n8n-nodes-base.function",
      "n8n-nodes-base.cron",
      "n8n-nodes-base.if",
      "n8n-nodes-base.function",
      "n8n-nodes-base.if",
      "n8n-nodes-base.telegram",
      "n8n-nodes-base.telegram",
      "n8n-nodes-base.function",
      "n8n-nodes-base.splitInBatches",
      "n8n-nodes-base.function",
      "n8n-nodes-base.if",
      "n8n-nodes-base.if",
      "n8n-nodes-base.telegram",
      "n8n-nodes-base.rssFeedRead",
      "n8n-nodes-base.rssFeedRead",
      "n8n-nodes-base.telegram",
      "n8n-nodes-base.manualTrigger"
    ],
    "trigger": null
  }
}