{
  "source": "1661_GoogleSheets_Stickynote_Monitor_Triggered.json",
  "index": 1,
  "content": "{\n  \"id\": \"aLTkMiEDYXbMK4fT\",\n  \"meta\": {\n    \"instanceId\": \"5b860a91d7844b5237bb51cc58691ca8c3dc5b576f42d4d6bbedfb8d43d58ece\",\n    \"templateCredsSetupCompleted\": true\n  },\n  \"name\": \"AI agent: expense tracker in Google Sheets and n8n chat\",\n  \"tags\": [],\n  \"nodes\": [\n    {\n      \"id\": \"9260b53e-6848-4f34-9643-311c58c807f6\",\n      \"name\": \"AI Agent\",\n      \"type\": \"@n8n/n8n-nodes-langchain.agent\",\n      \"position\": [\n        360,\n        40\n      ],\n      \"parameters\": {\n        \"options\": {\n          \"maxIterations\": 3,\n          \"systemMessage\": \"You are a helpful accountant. Use save to db tool to save expense message to DB. respond with \\\"Your expense saved, here is the output of save sub-workflow:[data]\\\"\"\n        }\n      },\n      \"typeVersion\": 1.7\n    },\n    {\n      \"id\": \"0d7a686c-42c2-4223-9f78-b454788fb6da\",\n      \"name\": \"When chat message received\",\n      \"type\": \"@n8n/n8n-nodes-langchain.chatTrigger\",\n      \"position\": [\n        0,\n        40\n      ],\n      \"webhookId\": \"6a34ec84-459d-4cc4-83b6-06ae4c99dc8f\",\n      \"parameters\": {\n        \"options\": {}\n      },\n      \"typeVersion\": 1.1\n    },\n    {\n      \"id\": \"f1f27aaf-cf13-40d9-b8f9-800a862f8bf0\",\n      \"name\": \"Workflow Input Trigger\",\n      \"type\": \"n8n-nodes-base.executeWorkflowTrigger\",\n      \"position\": [\n        180,\n        600\n      ],\n      \"parameters\": {\n        \"workflowInputs\": {\n          \"values\": [\n            {\n              \"name\": \"input1\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 1.1\n    },\n    {\n      \"id\": \"a1530601-1a91-45be-adef-2e0608bfe773\",\n      \"name\": \"OpenAI Chat Model\",\n      \"type\": \"@n8n/n8n-nodes-langchain.lmChatOpenAi\",\n      \"position\": [\n        340,\n        300\n      ],\n      \"parameters\": {\n        \"options\": {}\n      },\n      \"credentials\": {\n        \"openAiApi\": {\n          \"id\": \"vHFEeel4RHFsjcMI\",\n          \"name\": \"OpenAi account\"\n        }\n      },\n      \"typeVersion\": 1.1\n    },\n    {\n      \"id\": \"c6f9782e-6b9b-421e-8b10-9ef04cbbee8c\",\n      \"name\": \"Window Buffer Memory\",\n      \"type\": \"@n8n/n8n-nodes-langchain.memoryBufferWindow\",\n      \"position\": [\n        500,\n        300\n      ],\n      \"parameters\": {},\n      \"typeVersion\": 1.3\n    },\n    {\n      \"id\": \"bbe1116a-1c66-496e-a9bf-747457e47bb0\",\n      \"name\": \"Sticky Note\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -760,\n        200\n      ],\n      \"parameters\": {\n        \"width\": 720,\n        \"height\": 500,\n        \"content\": \"## Save your expenses via chat message. \\n\\nLLM will parse your message to structured JSON and save as a new row into Google Sheet.\\n\\n## Installation\\n### 1. Set up Google Sheets:\\nClone this Sheet:\\nhttps://docs.google.com/spreadsheets/d/1D0r3tun7LF7Ypb21CmbTKEtn76WE-kaHvBCM5NdgiPU/edit?gid=0#gid=0\\n\\n(File -> Make a copy)\\n\\nChoose this sheet into \\\"Save expense into Google Sheets\\\" node.\\n\\n\\n### 2. Fix sub-workflow dropdown: \\nopen \\\"Parse msg and save to Sheets\\\" node (which is an n8n sub-workflow executor tool) and choose the SAME workflow in the dropdown. it will allow n8n to call \\\"Workflow Input Trigger\\\" properly when needed.\\n\\n\\n### 3. Activate the workflow to make chat work properly.\\nSent message to chat, something like \\\"car wash; 59.3 usd; 25 jan 2024\\\"\\n\\nyou should get a response:\\nYour expense saved, here is the output of save sub-workflow:{\\\"cost\\\":59.3,\\\"descr\\\":\\\"car wash\\\",\\\"date\\\":\\\"2024-01-25\\\",\\\"msg\\\":\\\"car wash; 59.3 usd; 25 jan 2024\\\"}\\n\\nand new row in Google sheets should be inserted!\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"61a489f7-5b95-438a-81f0-1e3e8c445622\",\n      \"name\": \"OpenAI Chat Model1\",\n      \"type\": \"@n8n/n8n-nodes-langchain.lmChatOpenAi\",\n      \"position\": [\n        400,\n        900\n      ],\n      \"parameters\": {\n        \"options\": {}\n      },\n      \"credentials\": {\n        \"openAiApi\": {\n          \"id\": \"vHFEeel4RHFsjcMI\",\n          \"name\": \"OpenAi account\"\n        }\n      },\n      \"typeVersion\": 1.1\n    },\n    {\n      \"id\": \"57908f61-ed9b-41a9-aba6-031bfc65bd31\",\n      \"name\": \"Expense text to JSON parser\",\n      \"type\": \"@n8n/n8n-nodes-langchain.informationExtractor\",\n      \"position\": [\n        400,\n        600\n      ],\n      \"parameters\": {\n        \"text\": \"=convert expense to JSON: \\n\\n{{ $json.input1 }}\",\n        \"options\": {},\n        \"attributes\": {\n          \"attributes\": [\n            {\n              \"name\": \"cost\",\n              \"type\": \"number\",\n              \"required\": true,\n              \"description\": \"expense cost\"\n            },\n            {\n              \"name\": \"descr\",\n              \"required\": true,\n              \"description\": \"description of expense\"\n            },\n            {\n              \"name\": \"date\",\n              \"type\": \"date\",\n              \"description\": \"date in UTC format. \"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"23f123eb-c4d9-4e6c-a521-311498d40d61\",\n      \"name\": \"Save expense into Google Sheets\",\n      \"type\": \"n8n-nodes-base.googleSheets\",\n      \"position\": [\n        760,\n        600\n      ],\n      \"parameters\": {\n        \"columns\": {\n          \"value\": {\n            \"msg\": \"={{ $('Workflow Input Trigger').item.json.input1 }}\",\n            \"cost\": \"={{ $json.output.cost }}\",\n            \"date\": \"={{ $json.output.date ? $json.output.date : $now }}\",\n            \"descr\": \"={{ $json.output.descr }}\"\n          },\n          \"schema\": [\n            {\n              \"id\": \"date\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"date\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"cost\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"cost\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"descr\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"descr\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"msg\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"msg\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            }\n          ],\n          \"mappingMode\": \"defineBelow\",\n          \"matchingColumns\": [],\n          \"attemptToConvertTypes\": false,\n          \"convertFieldsToString\": false\n        },\n        \"options\": {\n          \"useAppend\": true\n        },\n        \"operation\": \"append\",\n        \"sheetName\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"gid=0\",\n          \"cachedResultUrl\": \"https://docs.google.com/spreadsheets/d/1_BMLmh5MtmQarWuZIJANQZSkjaQ2Rc3YYLhwyz1Sec0/edit#gid=0\",\n          \"cachedResultName\": \"Sheet1\"\n        },\n        \"documentId\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"1_BMLmh5MtmQarWuZIJANQZSkjaQ2Rc3YYLhwyz1Sec0\",\n          \"cachedResultUrl\": \"https://docs.google.com/spreadsheets/d/1_BMLmh5MtmQarWuZIJANQZSkjaQ2Rc3YYLhwyz1Sec0/edit?usp=drivesdk\",\n          \"cachedResultName\": \"ai-expense\"\n        }\n      },\n      \"credentials\": {\n        \"googleSheetsOAuth2Api\": {\n          \"id\": \"vowsrhMIxy2PRDbH\",\n          \"name\": \"Google Sheets account\"\n        }\n      },\n      \"typeVersion\": 4.5\n    },\n    {\n      \"id\": \"83770030-eab1-499a-b743-fe639e34fbb2\",\n      \"name\": \"Parse msg and save to Sheets\",\n      \"type\": \"@n8n/n8n-nodes-langchain.toolWorkflow\",\n      \"notes\": \"Make sure that this SAME workflow is chosen in the Workflow dropdown!\",\n      \"position\": [\n        660,\n        300\n      ],\n      \"parameters\": {\n        \"name\": \"save_expense_in_db\",\n        \"workflowId\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"aLTkMiEDYXbMK4fT\",\n          \"cachedResultName\": \"sub-workflow1\"\n        },\n        \"description\": \"Call this tool to save expense in db.\",\n        \"workflowInputs\": {\n          \"value\": {\n            \"input1\": \"={{ $json.chatInput }}\"\n          },\n          \"schema\": [\n            {\n              \"id\": \"input1\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"input1\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            }\n          ],\n          \"mappingMode\": \"defineBelow\",\n          \"matchingColumns\": [],\n          \"attemptToConvertTypes\": false,\n          \"convertFieldsToString\": false\n        }\n      },\n      \"notesInFlow\": true,\n      \"typeVersion\": 2\n    }\n  ],\n  \"active\": true,\n  \"pinData\": {},\n  \"settings\": {\n    \"executionOrder\": \"v1\"\n  },\n  \"versionId\": \"9ab1bbef-ffe8-462c-a201-920c6d250ade\",\n  \"connections\": {\n    \"OpenAI Chat Model\": {\n      \"ai_languageModel\": [\n        [\n          {\n            \"node\": \"AI Agent\",\n            \"type\": \"ai_languageModel\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"OpenAI Chat Model1\": {\n      \"ai_languageModel\": [\n        [\n          {\n            \"node\": \"Expense text to JSON parser\",\n            \"type\": \"ai_languageModel\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Window Buffer Memory\": {\n      \"ai_memory\": [\n        [\n          {\n            \"node\": \"AI Agent\",\n            \"type\": \"ai_memory\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Workflow Input Trigger\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Expense text to JSON parser\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"When chat message received\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"AI Agent\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Expense text to JSON parser\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Save expense into Google Sheets\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Parse msg and save to Sheets\": {\n      \"ai_tool\": [\n        [\n          {\n            \"node\": \"AI Agent\",\n            \"type\": \"ai_tool\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}",
  "metadata": {
    "node_types": [
      "@n8n/n8n-nodes-langchain.agent",
      "@n8n/n8n-nodes-langchain.chatTrigger",
      "n8n-nodes-base.executeWorkflowTrigger",
      "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "@n8n/n8n-nodes-langchain.memoryBufferWindow",
      "n8n-nodes-base.stickyNote",
      "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "@n8n/n8n-nodes-langchain.informationExtractor",
      "n8n-nodes-base.googleSheets",
      "@n8n/n8n-nodes-langchain.toolWorkflow"
    ],
    "trigger": "workflow input trigger"
  }
}