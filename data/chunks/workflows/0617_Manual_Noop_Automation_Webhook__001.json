{
  "source": "0617_Manual_Noop_Automation_Webhook.json",
  "index": 1,
  "content": "{\n  \"meta\": {\n    \"instanceId\": \"6b6a2db47bdf8371d21090c511052883cc9a3f6af5d0d9d567c702d74a18820e\"\n  },\n  \"nodes\": [\n    {\n      \"id\": \"f4570aad-db25-4dcd-8589-b1c8335935de\",\n      \"name\": \"When clicking ‘Test workflow’\",\n      \"type\": \"n8n-nodes-base.manualTrigger\",\n      \"position\": [\n        20,\n        5220\n      ],\n      \"parameters\": {},\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"675243b0-080f-4d5e-a0ca-a0fe0e7c04a9\",\n      \"name\": \"Sticky Note9\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        185,\n        5140\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 426.32566328767217,\n        \"height\": 260.3707944299243,\n        \"content\": \"**Find and replace image in docx. Connect to a datasource with an image URL you want to insert into the Docx file**\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"16bbf5da-5ebc-4e9c-8b3c-80d0077c51b8\",\n      \"name\": \"Find Image ID in Docx\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        900,\n        5220\n      ],\n      \"parameters\": {\n        \"url\": \"=https://docs.googleapis.com/v1/documents/{{$json.documentId}}\",\n        \"options\": {},\n        \"authentication\": \"predefinedCredentialType\",\n        \"nodeCredentialType\": \"googleDocsOAuth2Api\"\n      },\n      \"notesInFlow\": true,\n      \"typeVersion\": 4.2\n    },\n    {\n      \"id\": \"60325192-4730-4410-ae33-9127ff8cc5f7\",\n      \"name\": \"Make file shareable publically (optional)\",\n      \"type\": \"n8n-nodes-base.googleDrive\",\n      \"position\": [\n        1360,\n        5220\n      ],\n      \"parameters\": {\n        \"fileId\": {\n          \"__rl\": true,\n          \"mode\": \"id\",\n          \"value\": \"={{ $json.documentId }}\"\n        },\n        \"options\": {},\n        \"operation\": \"share\",\n        \"permissionsUi\": {\n          \"permissionsValues\": {\n            \"role\": \"writer\",\n            \"type\": \"anyone\"\n          }\n        }\n      },\n      \"typeVersion\": 3\n    },\n    {\n      \"id\": \"6f254810-3ab8-4ec1-b964-8b399472acf3\",\n      \"name\": \"Image URL\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"notes\": \"Define Image URL\",\n      \"position\": [\n        440,\n        5220\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"cc2c6af0-68d3-49eb-85fe-3288d2ed0f6b\",\n              \"name\": \"url\",\n              \"type\": \"string\",\n              \"value\": \"https://picsum.photos/id/400/300/300\"\n            }\n          ]\n        },\n        \"includeOtherFields\": true\n      },\n      \"notesInFlow\": true,\n      \"typeVersion\": 3.4\n    },\n    {\n      \"id\": \"d33a913a-2d98-4922-ba8d-5d325b114572\",\n      \"name\": \"Find & Copy Docx Template\",\n      \"type\": \"n8n-nodes-base.googleDrive\",\n      \"position\": [\n        660,\n        5220\n      ],\n      \"parameters\": {\n        \"name\": \"Chosen filename\",\n        \"fileId\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"1RQAX2CszNqw79gZxeocEZU0-KquTq3RQc2-5Uv1mgd0\",\n          \"cachedResultUrl\": \"https://docs.google.com/document/d/1RQAX2CszNqw79gZxeocEZU0-KquTq3RQc2-5Uv1mgd0/edit?usp=drivesdk\",\n          \"cachedResultName\": \"Marketing Plan (template)\"\n        },\n        \"options\": {},\n        \"operation\": \"copy\"\n      },\n      \"notesInFlow\": true,\n      \"typeVersion\": 3\n    },\n    {\n      \"id\": \"1f43d321-eddf-4008-99e2-9338cc85bad2\",\n      \"name\": \"Sticky Note42\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        180,\n        5420\n      ],\n      \"parameters\": {\n        \"color\": 3,\n        \"width\": 415.45208033736463,\n        \"height\": 105.04337297263078,\n        \"content\": \"**REQUIRED**\\nConnect to your database of image urls to input. Name the column `url` like in the `Image URL` node. This flow works with an image URL only, not a physical image file\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"0e1bb319-8429-4bde-88a3-9fd69df7c986\",\n      \"name\": \"Own datasource\",\n      \"type\": \"n8n-nodes-base.noOp\",\n      \"position\": [\n        240,\n        5220\n      ],\n      \"parameters\": {},\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"d534cc1f-e651-4c06-860b-ce3d3c648964\",\n      \"name\": \"Sticky Note43\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        620,\n        5420\n      ],\n      \"parameters\": {\n        \"color\": 2,\n        \"width\": 415.45208033736463,\n        \"height\": 222.7191963089109,\n        \"content\": \"**OPTIONAL**\\nIf you want to create multiple documents with multiple images then create a template in your GDrive folder with a placeholder image that you want to replace. This template will be copied each time you run the flow, and the ID of that new document will be passed to `find image ID in Docx` to find the relevant image to replace with your image url. If you are just doing this for a single document then remove the `find and copy docx template` node. If you do this step, follow the [n8n guide](https://docs.n8n.io/integrations/builtin/app-nodes/n8n-nodes-base.googledrive/) on how to connect to your GDrive account.\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"b6a22eb4-0b13-4eb5-be40-ed2dfedf99b5\",\n      \"name\": \"Sticky Note44\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        620,\n        5120\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 169.22824698060023,\n        \"height\": 278.7193163441844,\n        \"content\": \"**Optional - create and copy a template document in your GDrive folder**\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"25d2a7c0-cef7-4aaf-9bb8-fe9c83d73731\",\n      \"name\": \"Sticky Note45\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        853,\n        5120\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 435.22861330045936,\n        \"height\": 278.7193163441844,\n        \"content\": \"**Sends request to Google API to retrieve document details (including image ID) in the template document**\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"f8dcb709-5505-4c63-afe9-83a0dfb608e9\",\n      \"name\": \"Replace Image in Docx\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        1100,\n        5220\n      ],\n      \"parameters\": {\n        \"url\": \"=https://docs.googleapis.com/v1/documents/{{$json.documentId}}:batchUpdate\",\n        \"method\": \"POST\",\n        \"options\": {},\n        \"jsonBody\": \"={\\n  \\\"requests\\\": [\\n    {\\n      \\\"replaceImage\\\": {\\n        \\\"imageObjectId\\\": {{ $json.body.content[1].paragraph.elements[0].inlineObjectElement.inlineObjectId }},\\n        \\\"uri\\\": \\\"{{ $('Image URL').item.json.url }}\\\",\\n        \\\"imageReplaceMethod\\\": \\\"CENTER_CROP\\\"\\n      }\\n    }\\n  ]\\n} \",\n        \"sendBody\": true,\n        \"specifyBody\": \"json\",\n        \"authentication\": \"predefinedCredentialType\",\n        \"nodeCredentialType\": \"googleDocsOAuth2Api\"\n      },\n      \"notesInFlow\": true,\n      \"typeVersion\": 4.2\n    },\n    {\n      \"id\": \"f800131b-e8d3-4741-8e8d-ad208e53ebe7\",\n      \"name\": \"Sticky Note46\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        1060,\n        5420\n      ],\n      \"parameters\": {\n        \"color\": 3,\n        \"width\": 297.15093794343295,\n        \"height\": 373.0766632058715,\n        \"content\": \"**REQUIRED**\\n- Update the Google Docs OAuth 2 API credentials [with your own](https://docs.n8n.io/integrations/builtin/app-nodes/n8n-nodes-base.googledocs/)\\n- Ensure Document ID is passing correctly to `Find Image ID in Docx` if you removed the previous step\\n- Ensure the `imageObjectId` in the `Replace Image in Docx` node is correct, if you only have a single image in the document it should use the `\\\"{{ $json.body.content[1].paragraph.elements[0].inlineObjectElement.inlineObjectId }}\\\"` returned from the previous node. If you have more than one image then id will be nested in the `\\\"body.content[1].paragraph.positionedObjectIds[0]\\\"` object from the previous node \"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"0cdad7ae-e407-4c21-b454-8b2824e2b6d4\",\n      \"name\": \"Sticky Note47\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        1380,\n        5420\n      ],\n      \"parameters\": {\n        \"color\": 2,\n        \"width\": 747.7707439712262,\n        \"height\": 222.7191963089109,\n        \"content\": \"**OPTIONAL**\\n- Make the file publically shareable (anyone can view/edit)\\n- Download the file as a Docx\\n- Download the file as a PDF\\n\\n\\nAll of the above requires authenticating with your GDrive account, ensuring the `documentID` is pulling correctly from previous nodes and choosing a `filename` if relevant\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"fa6a214e-b6c5-403a-884a-d915f5a1362f\",\n      \"name\": \"Download File - Docx\",\n      \"type\": \"n8n-nodes-base.googleDrive\",\n      \"position\": [\n        1580,\n        5220\n      ],\n      \"parameters\": {\n        \"fileId\": {\n          \"__rl\": true,\n          \"mode\": \"id\",\n          \"value\": \"={{ $json.documentId }}\"\n        },\n        \"options\": {},\n        \"operation\": \"download\"\n      },\n      \"notesInFlow\": true,\n      \"typeVersion\": 3\n    },\n    {\n      \"id\": \"399e08ae-864d-4ffa-bc18-d82e03e30f7c\",\n      \"name\": \"Download File - PDF\",\n      \"type\": \"n8n-nodes-base.googleDrive\",\n      \"position\": [\n        1800,\n        5220\n      ],\n      \"parameters\": {\n        \"fileId\": {\n          \"__rl\": true,\n          \"mode\": \"id\",\n          \"value\": \"={{ $json.documentId }}\"\n        },\n        \"options\": {\n          \"fileName\": \"=filename - PDF\",\n          \"googleFileConversion\": {\n            \"conversion\": {\n              \"docsToFormat\": \"application/pdf\"\n            }\n          }\n        },\n        \"operation\": \"download\"\n      },\n      \"notesInFlow\": true,\n      \"typeVersion\": 3\n    },\n    {\n      \"id\": \"0855b49a-dca3-4da8-8e22-4294523798d7\",\n      \"name\": \"Sticky Note48\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        1320,\n        5120\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 683.4764182113373,\n        \"height\": 278.7193163441844,\n        \"content\": \"**Optional - make the file shareable, and download in docx and PDF format**\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"d4a2e23d-9c14-4b0c-8fd3-99a981d2f39b\",\n      \"name\": \"Sticky Note49\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -800,\n        4960\n      ],\n      \"parameters\": {\n        \"color\": 4,\n        \"width\": 773.6179704580734,\n        \"height\": 875.8289847608302,\n        \"content\": \"## Replace Images in Google Docs Documents and Download as PDF/Docx\\n\\n## Use Case\\nAutomate image replacement in Google Docs:\\n- You need to update document images dynamically\\n- You want to create multiple versions of a template with different images\\n- You need to batch process document images from a URL database\\n- You want to generate shareable documents with custom images\\n\\n## What this Workflow Does\\nThe workflow automates image replacement in Google Docs:\\n- Accepts image URLs from your database\\n- Finds and replaces images in template documents\\n- Creates new document copies with updated images\\n- Optionally converts to PDF and makes documents shareable\\n\\n## Setup\\n1. Connect your image URL database (column name must be \\\"url\\\")\\n2. Set up [Google Docs OAuth 2 API credentials](https://docs.n8n.io/integrations/builtin/app-nodes/n8n-nodes-base.googledocs/)\\n3. Optional: Create a template document in Google Drive with placeholder images\\n4. Optional: Configure [Google Drive authentication](https://docs.n8n.io/integrations/builtin/app-nodes/n8n-nodes-base.googledrive/) for additional features\\n\\n## How to Adjust it to Your Needs\\n- Remove template copying for single document processing\\n- Adjust image ID selection for documents with multiple images\\n- Configure sharing settings and download formats\\n- Customize file naming and storage location\\n\\n\\nMade by Simon @ [automake.io](https://automake.io)\"\n      },\n      \"typeVersion\": 1\n    }\n  ],\n  \"pinData\": {},\n  \"connections\": {\n    \"Image URL\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Find & Copy Docx Template\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Own datasource\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Image URL\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Download File - Docx\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Download File - PDF\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Find Image ID in Docx\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Replace Image in Docx\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Replace Image in Docx\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Make file shareable publically (optional)\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Find & Copy Docx Template\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Find Image ID in Docx\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"When clicking ‘Test workflow’\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Own datasource\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Make file shareable publically (optional)\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Download File - Docx\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}",
  "metadata": {
    "node_types": [
      "n8n-nodes-base.manualTrigger",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.httpRequest",
      "n8n-nodes-base.googleDrive",
      "n8n-nodes-base.set",
      "n8n-nodes-base.googleDrive",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.noOp",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.httpRequest",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.googleDrive",
      "n8n-nodes-base.googleDrive",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote"
    ],
    "trigger": null
  }
}