{
  "source": "0835_Microsoftoutlook_Schedule_Automation_Scheduled.json",
  "index": 1,
  "content": "{\n  \"meta\": {\n    \"instanceId\": \"4359279a248a64f23ddf72d3bc2de4dead8a687e643e9296f8a007dd65120396\"\n  },\n  \"nodes\": [\n    {\n      \"id\": \"59b786fe-8e45-4616-aa45-9748df144c3a\",\n      \"name\": \"MySQL\",\n      \"type\": \"n8n-nodes-base.mySql\",\n      \"position\": [\n        -80,\n        220\n      ],\n      \"parameters\": {\n        \"query\": \"SELECT \\n    company,\\n    cost_center AS default_cost_center,\\n    COUNT(*) AS project_count\\nFROM \\n    tabProject\\nWHERE \\n    status = 'Open' \\n    AND project_type = 'External'\\n    AND is_active = 'Yes'\\n    AND budgeted_project_cost = 0\\n    \\nGROUP BY \\n    company, cost_center\\nORDER BY \\n    company, project_count DESC;\\n\",\n        \"options\": {},\n        \"operation\": \"executeQuery\"\n      },\n      \"typeVersion\": 2.4\n    },\n    {\n      \"id\": \"48c20822-9f2e-4108-8bfb-b300689a9724\",\n      \"name\": \"Schedule Trigger\",\n      \"type\": \"n8n-nodes-base.scheduleTrigger\",\n      \"position\": [\n        -360,\n        220\n      ],\n      \"parameters\": {\n        \"rule\": {\n          \"interval\": [\n            {\n              \"field\": \"weeks\",\n              \"triggerAtHour\": 8\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 1.2\n    },\n    {\n      \"id\": \"3757860b-b7a0-4617-a398-37ac42f1acea\",\n      \"name\": \"Switch\",\n      \"type\": \"n8n-nodes-base.switch\",\n      \"position\": [\n        180,\n        200\n      ],\n      \"parameters\": {\n        \"rules\": {\n          \"values\": [\n            {\n              \"outputKey\": \"A\",\n              \"conditions\": {\n                \"options\": {\n                  \"version\": 2,\n                  \"leftValue\": \"\",\n                  \"caseSensitive\": true,\n                  \"typeValidation\": \"strict\"\n                },\n                \"combinator\": \"and\",\n                \"conditions\": [\n                  {\n                    \"id\": \"423062ba-e116-4e22-aa00-29107e8c24ce\",\n                    \"operator\": {\n                      \"type\": \"string\",\n                      \"operation\": \"equals\"\n                    },\n                    \"leftValue\": \"={{ $json.default_cost_center }}\",\n                    \"rightValue\": \"Cost Center A\"\n                  }\n                ]\n              },\n              \"renameOutput\": true\n            },\n            {\n              \"outputKey\": \"B\",\n              \"conditions\": {\n                \"options\": {\n                  \"version\": 2,\n                  \"leftValue\": \"\",\n                  \"caseSensitive\": true,\n                  \"typeValidation\": \"strict\"\n                },\n                \"combinator\": \"and\",\n                \"conditions\": [\n                  {\n                    \"id\": \"e065ab84-61fd-4e6c-8835-92d08be3e359\",\n                    \"operator\": {\n                      \"name\": \"filter.operator.equals\",\n                      \"type\": \"string\",\n                      \"operation\": \"equals\"\n                    },\n                    \"leftValue\": \"={{ $json.default_cost_center }}\",\n                    \"rightValue\": \"Cost Center B\"\n                  }\n                ]\n              },\n              \"renameOutput\": true\n            },\n            {\n              \"outputKey\": \"C\",\n              \"conditions\": {\n                \"options\": {\n                  \"version\": 2,\n                  \"leftValue\": \"\",\n                  \"caseSensitive\": true,\n                  \"typeValidation\": \"strict\"\n                },\n                \"combinator\": \"and\",\n                \"conditions\": [\n                  {\n                    \"id\": \"0ef8ce35-2507-4ff4-8dea-11380262098e\",\n                    \"operator\": {\n                      \"name\": \"filter.operator.equals\",\n                      \"type\": \"string\",\n                      \"operation\": \"equals\"\n                    },\n                    \"leftValue\": \"={{ $json.default_cost_center }}\",\n                    \"rightValue\": \"=COST CENTER C\"\n                  }\n                ]\n              },\n              \"renameOutput\": true\n            },\n            {\n              \"outputKey\": \"D\",\n              \"conditions\": {\n                \"options\": {\n                  \"version\": 2,\n                  \"leftValue\": \"\",\n                  \"caseSensitive\": true,\n                  \"typeValidation\": \"strict\"\n                },\n                \"combinator\": \"and\",\n                \"conditions\": [\n                  {\n                    \"id\": \"9152e548-cca9-441c-b4b6-8903f449dc2b\",\n                    \"operator\": {\n                      \"name\": \"filter.operator.equals\",\n                      \"type\": \"string\",\n                      \"operation\": \"equals\"\n                    },\n                    \"leftValue\": \"={{ $json.default_cost_center }}\",\n                    \"rightValue\": \"Cost Center D\"\n                  }\n                ]\n              },\n              \"renameOutput\": true\n            }\n          ]\n        },\n        \"options\": {}\n      },\n      \"typeVersion\": 3.2\n    },\n    {\n      \"id\": \"bf8fd5f4-e107-44e8-af1a-be32596d664e\",\n      \"name\": \"Microsoft Outlook6\",\n      \"type\": \"n8n-nodes-base.microsoftOutlook\",\n      \"position\": [\n        560,\n        -20\n      ],\n      \"webhookId\": \"dce42873-919a-4dac-9f9d-792b0a39b7f7\",\n      \"parameters\": {\n        \"subject\": \"Project Cost Missing\",\n        \"bodyContent\": \"==<!DOCTYPE html>\\n<html lang=\\\"en\\\">\\n<head>\\n  <meta charset=\\\"UTF-8\\\">\\n  <title>Missing Budgeted Cost Notification</title>\\n  <style>\\n    body { font-family: Arial, sans-serif; background-color: #f4f4f4; margin: 0; padding: 0; }\\n    .email-container { max-width: 600px; margin: 20px auto; background-color: #ffffff; border-radius: 8px; overflow: hidden; }\\n    .email-header { background-color: #007BFF; color: #ffffff; padding: 20px; text-align: center; font-size: 18px; font-weight: bold; }\\n    .email-body { padding: 20px; font-size: 16px; color: #333333; }\\n    .email-body strong { color: #007BFF; }\\n    .email-footer { padding: 10px 20px; font-size: 14px; color: #555555; text-align: left; }\\n  </style>\\n</head>\\n<body>\\n  <div class=\\\"email-container\\\">\\n    <div class=\\\"email-header\\\">\\n      {{ $json.default_cost_center }} - Project Data Missing\\n    </div>\\n    <div class=\\\"email-body\\\">\\n      Dear {{ $json.default_cost_center }} Team,<br><br>\\n      There are <strong>{{ $json.project_count }}</strong> active projects with missing <strong>Budgeted Cost</strong>.<br>\\n      Kindly coordinate with the <strong>Accounts Team</strong> to update the missing values for accurate tracking.<br><br>\\n      Your timely attention is appreciated.<br><br>\\n      Regards,\\n    </div>\\n    <div class=\\\"email-footer\\\">\\n      <strong>Amjid Ali</strong><br>\\n      Automation Demo – n8n\\n    </div>\\n  </div>\\n</body>\\n</html>\\n\",\n        \"toRecipients\": \"amjid@amjidali.com\",\n        \"additionalFields\": {\n          \"bodyContentType\": \"html\"\n        }\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"e4ffe557-0862-401e-9f65-7195a72db1d9\",\n      \"name\": \"Microsoft Outlook1\",\n      \"type\": \"n8n-nodes-base.microsoftOutlook\",\n      \"position\": [\n        560,\n        160\n      ],\n      \"webhookId\": \"ea8b2720-cbb6-4712-b9ff-4b443958d0d0\",\n      \"parameters\": {\n        \"subject\": \"Projects Cost Missing\",\n        \"bodyContent\": \"==<!DOCTYPE html>\\n<html lang=\\\"en\\\">\\n<head>\\n  <meta charset=\\\"UTF-8\\\">\\n  <title>Missing Budgeted Cost Notification</title>\\n  <style>\\n    body { font-family: Arial, sans-serif; background-color: #f4f4f4; margin: 0; padding: 0; }\\n    .email-container { max-width: 600px; margin: 20px auto; background-color: #ffffff; border-radius: 8px; overflow: hidden; }\\n    .email-header { background-color: #007BFF; color: #ffffff; padding: 20px; text-align: center; font-size: 18px; font-weight: bold; }\\n    .email-body { padding: 20px; font-size: 16px; color: #333333; }\\n    .email-body strong { color: #007BFF; }\\n    .email-footer { padding: 10px 20px; font-size: 14px; color: #555555; text-align: left; }\\n  </style>\\n</head>\\n<body>\\n  <div class=\\\"email-container\\\">\\n    <div class=\\\"email-header\\\">\\n      {{ $json.default_cost_center }} - Project Data Missing\\n    </div>\\n    <div class=\\\"email-body\\\">\\n      Dear {{ $json.default_cost_center }} Team,<br><br>\\n      There are <strong>{{ $json.project_count }}</strong> active projects with missing <strong>Budgeted Cost</strong>.<br>\\n      Kindly coordinate with the <strong>Accounts Team</strong> to update the missing values for accurate tracking.<br><br>\\n      Your timely attention is appreciated.<br><br>\\n      Regards,\\n    </div>\\n    <div class=\\\"email-footer\\\">\\n      <strong>Amjid Ali</strong><br>\\n      Automation Demo – n8n\\n    </div>\\n  </div>\\n</body>\\n</html>\\n\",\n        \"toRecipients\": \"amjid@amjidali.com\",\n        \"additionalFields\": {\n          \"bodyContentType\": \"html\"\n        }\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"e0722ebd-1e05-4efe-a27a-e4db193dec80\",\n      \"name\": \"Microsoft Outlook7\",\n      \"type\": \"n8n-nodes-base.microsoftOutlook\",\n      \"position\": [\n        560,\n        380\n      ],\n      \"webhookId\": \"46e6a678-d922-4dfc-b51d-864477e6b01e\",\n      \"parameters\": {\n        \"subject\": \"Projects Cost Missing\",\n        \"bodyContent\": \"==<!DOCTYPE html>\\n<html lang=\\\"en\\\">\\n<head>\\n  <meta charset=\\\"UTF-8\\\">\\n  <title>Missing Budgeted Cost Notification</title>\\n  <style>\\n    body { font-family: Arial, sans-serif; background-color: #f4f4f4; margin: 0; padding: 0; }\\n    .email-container { max-width: 600px; margin: 20px auto; background-color: #ffffff; border-radius: 8px; overflow: hidden; }\\n    .email-header { background-color: #007BFF; color: #ffffff; padding: 20px; text-align: center; font-size: 18px; font-weight: bold; }\\n    .email-body { padding: 20px; font-size: 16px; color: #333333; }\\n    .email-body strong { color: #007BFF; }\\n    .email-footer { padding: 10px 20px; font-size: 14px; color: #555555; text-align: left; }\\n  </style>\\n</head>\\n<body>\\n  <div class=\\\"email-container\\\">\\n    <div class=\\\"email-header\\\">\\n      {{ $json.default_cost_center }} - Project Data Missing\\n    </div>\\n    <div class=\\\"email-body\\\">\\n      Dear {{ $json.default_cost_center }} Team,<br><br>\\n      There are <strong>{{ $json.project_count }}</strong> active projects with missing <strong>Budgeted Cost</strong>.<br>\\n      Kindly coordinate with the <strong>Accounts Team</strong> to update the missing values for accurate tracking.<br><br>\\n      Your timely attention is appreciated.<br><br>\\n      Regards,\\n    </div>\\n    <div class=\\\"email-footer\\\">\\n      <strong>Amjid Ali</strong><br>\\n      Automation Demo – n8n\\n    </div>\\n  </div>\\n</body>\\n</html>\\n\",\n        \"toRecipients\": \"amjid@amjidali.com\",\n        \"additionalFields\": {\n          \"bodyContentType\": \"html\"\n        }\n      },\n      \"typeVersion\": 2\n    }\n  ],\n  \"pinData\": {},\n  \"connections\": {\n    \"MySQL\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Switch\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Switch\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Microsoft Outlook6\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Microsoft Outlook1\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Microsoft Outlook7\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        []\n      ]\n    },\n    \"Schedule Trigger\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"MySQL\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}",
  "metadata": {
    "node_types": [
      "n8n-nodes-base.mySql",
      "n8n-nodes-base.scheduleTrigger",
      "n8n-nodes-base.switch",
      "n8n-nodes-base.microsoftOutlook",
      "n8n-nodes-base.microsoftOutlook",
      "n8n-nodes-base.microsoftOutlook"
    ],
    "trigger": "schedule trigger"
  }
}