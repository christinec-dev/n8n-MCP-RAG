{
  "source": "1787_Splitout_Code_Automate_Webhook.json",
  "index": 1,
  "content": "{\n  \"id\": \"ZpgJpdtmq6MM1jr2\",\n  \"meta\": {\n    \"instanceId\": \"df9ffe0ce66252bcc29753df3925c45bd5340ded4ecdfc4be9cdb17ed78e229b\",\n    \"templateCredsSetupCompleted\": true\n  },\n  \"name\": \"AI T-Shirt Redesign Workflow from any Mockup Image\",\n  \"tags\": [],\n  \"nodes\": [\n    {\n      \"id\": \"97ce19f8-d83b-481d-a5c4-8ed46a06f18d\",\n      \"name\": \"HTTP Request\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        360,\n        -600\n      ],\n      \"parameters\": {\n        \"url\": \"https://api.openai.com/v1/images/generations\",\n        \"method\": \"POST\",\n        \"options\": {},\n        \"jsonBody\": \"={\\n  \\\"model\\\": \\\"gpt-image-1\\\",\\n  \\\"prompt\\\": \\\"{{ $json.escapedString }}\\\",\\n  \\\"n\\\": 1,\\n  \\\"size\\\": \\\"1024x1536\\\",\\n  \\\"quality\\\": \\\"high\\\"\\n}\",\n        \"sendBody\": true,\n        \"specifyBody\": \"json\",\n        \"authentication\": \"predefinedCredentialType\",\n        \"nodeCredentialType\": \"openAiApi\"\n      },\n      \"credentials\": {\n        \"openAiApi\": {\n          \"id\": \"15P9TuEdDQwlWhIR\",\n          \"name\": \"OpenAi account 2\"\n        }\n      },\n      \"typeVersion\": 4.2\n    },\n    {\n      \"id\": \"3ba73c97-c6d7-4275-8c8c-064a49762edb\",\n      \"name\": \"Convert to File\",\n      \"type\": \"n8n-nodes-base.convertToFile\",\n      \"position\": [\n        780,\n        -600\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"operation\": \"toBinary\",\n        \"sourceProperty\": \"data[0].b64_json\"\n      },\n      \"typeVersion\": 1.1\n    },\n    {\n      \"id\": \"4b0c830c-caea-420c-b547-048ef795e542\",\n      \"name\": \"Split Out\",\n      \"type\": \"n8n-nodes-base.splitOut\",\n      \"position\": [\n        560,\n        -600\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"fieldToSplitOut\": \"data[0].b64_json\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"d06e9bde-0fee-42dc-9c3d-004c97c1ee49\",\n      \"name\": \"AI Agent\",\n      \"type\": \"@n8n/n8n-nodes-langchain.agent\",\n      \"position\": [\n        -220,\n        -600\n      ],\n      \"parameters\": {\n        \"text\": \"={{ $json.content }}\",\n        \"options\": {\n          \"systemMessage\": \"You are a creative prompt generation assistant specialized in T-shirt artwork refinement.\\nYour job is to analyze an existing T-shirt design user message above and create a new, upgraded version that preserves the original layout, overall structure, and message placement, but enhances its visual style, mood, and artistic quality.\\n\\n✦ Keep all key design elements and text in their original positions — do not remove or move important words or graphics.\\n✦ Improve the typography by suggesting more expressive font styling (e.g., handwritten, retro, bold serif, clean sans-serif, brush script), and enhance the lettering arrangement to feel more dynamic, elegant, or visually balanced.\\n✦ Enhance illustrative elements, texture, and background details to feel more artistic, emotional, or premium — without overwhelming the message.\\n✦ Use descriptive, natural language to generate a final prompt that can be used with Midjourney, DALL·E, or other image-generation AIs.\\n✦ The new version should feel like a refined and artistic redesign, not a complete concept change.\\n✦ Solid black background\\n\\nRule:\\n- Output the final design prompt as a single plain-text sentence, without markdown, formatting, or line breaks. Make sure the prompt is concise but expressive, suitable for use inside a JSON payload or passed into an image generation API. All key elements must remain: characters, objects, text styling, and background mood — but the format should be clean, compact, and system-friendly.\\n- Format the output as a single line of plain text, using escaped double quotes (\\\\\\\") where needed, suitable for inclusion in a JSON string without formatting issues.\"\n        },\n        \"promptType\": \"define\"\n      },\n      \"typeVersion\": 1.9\n    },\n    {\n      \"id\": \"f54f401d-5fd3-482f-903d-322acabfcce4\",\n      \"name\": \"OpenAI\",\n      \"type\": \"@n8n/n8n-nodes-langchain.openAi\",\n      \"position\": [\n        -420,\n        -600\n      ],\n      \"parameters\": {\n        \"modelId\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"gpt-4o\",\n          \"cachedResultName\": \"GPT-4O\"\n        },\n        \"options\": {},\n        \"resource\": \"image\",\n        \"imageUrls\": \"https://m.media-amazon.com/images/I/B1pppR4gVKL._CLa%7C2140%2C2000%7C91-OyNW80tL.png%7C0%2C0%2C2140%2C2000%2B0.0%2C0.0%2C2140.0%2C2000.0_AC_SX342_SY445_.png\",\n        \"operation\": \"analyze\"\n      },\n      \"credentials\": {\n        \"openAiApi\": {\n          \"id\": \"l51tyBcX4FuEb6tX\",\n          \"name\": \"OpenAi account\"\n        }\n      },\n      \"typeVersion\": 1.8\n    },\n    {\n      \"id\": \"b867eeda-8eea-4574-8537-a7130e8710c3\",\n      \"name\": \"OpenAI Chat Model\",\n      \"type\": \"@n8n/n8n-nodes-langchain.lmChatOpenAi\",\n      \"position\": [\n        -260,\n        -380\n      ],\n      \"parameters\": {\n        \"model\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"gpt-4o-mini\"\n        },\n        \"options\": {}\n      },\n      \"credentials\": {\n        \"openAiApi\": {\n          \"id\": \"15P9TuEdDQwlWhIR\",\n          \"name\": \"OpenAi account 2\"\n        }\n      },\n      \"typeVersion\": 1.2\n    },\n    {\n      \"id\": \"8877fbdc-091b-4a1c-82cf-bf980a8c3045\",\n      \"name\": \"When chat message received\",\n      \"type\": \"@n8n/n8n-nodes-langchain.chatTrigger\",\n      \"position\": [\n        -1000,\n        -560\n      ],\n      \"webhookId\": \"22b3dae3-95e5-4bfa-8187-9dca2dc72f85\",\n      \"parameters\": {\n        \"options\": {}\n      },\n      \"typeVersion\": 1.1\n    },\n    {\n      \"id\": \"90fe70c2-3b64-4d28-82a8-c575b26c8b5b\",\n      \"name\": \"If\",\n      \"type\": \"n8n-nodes-base.if\",\n      \"position\": [\n        -700,\n        -560\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"conditions\": {\n          \"options\": {\n            \"version\": 2,\n            \"leftValue\": \"\",\n            \"caseSensitive\": true,\n            \"typeValidation\": \"strict\"\n          },\n          \"combinator\": \"and\",\n          \"conditions\": [\n            {\n              \"id\": \"cb4e9a22-d429-4d11-b536-5d8760dd5042\",\n              \"operator\": {\n                \"type\": \"string\",\n                \"operation\": \"startsWith\"\n              },\n              \"leftValue\": \"={{ $json.chatInput }}\",\n              \"rightValue\": \"https://\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 2.2\n    },\n    {\n      \"id\": \"00509d12-784c-4f9f-a5e4-fdccf5382d2e\",\n      \"name\": \"Code\",\n      \"type\": \"n8n-nodes-base.code\",\n      \"position\": [\n        140,\n        -600\n      ],\n      \"parameters\": {\n        \"jsCode\": \"const rawContent = $json.output;\\n\\n// 1. Replace all line breaks with spaces\\nlet cleaned = rawContent.replace(/\\\\n/g, ' ');\\n\\n// 2. Trim any extra spaces at the beginning and end\\ncleaned = cleaned.trim();\\n\\n// 3. Escape backslashes and double quotes for JSON safety\\nlet escaped = cleaned.replace(/\\\\\\\\/g, '\\\\\\\\\\\\\\\\').replace(/\\\"/g, '\\\\\\\\\\\"');\\n\\n// 4. Remove leading or trailing escaped quotes if accidentally included\\nescaped = escaped.replace(/^\\\\\\\\\\\\\\\"/, '').replace(/\\\\\\\\\\\\\\\"$/, '');\\n\\n// 5. Return the cleaned and fully escaped string\\nreturn [\\n  {\\n    json: {\\n      escapedString: escaped\\n    }\\n  }\\n];\\n\"\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"caec0c49-a46c-42a5-bb64-f6ba86490eef\",\n      \"name\": \"Sticky Note\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -1060,\n        -640\n      ],\n      \"parameters\": {\n        \"width\": 280,\n        \"height\": 260,\n        \"content\": \"## Send a mockup image url to chat\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"d0862a3b-7409-49a9-b68e-ff7046031885\",\n      \"name\": \"Sticky Note1\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -460,\n        -680\n      ],\n      \"parameters\": {\n        \"color\": 5,\n        \"width\": 540,\n        \"height\": 300,\n        \"content\": \"## Analyze image and generate new prompt\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"cea5c30b-154a-4c51-9b9a-e187c27224d7\",\n      \"name\": \"Sticky Note2\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        280,\n        -680\n      ],\n      \"parameters\": {\n        \"color\": 3,\n        \"width\": 680,\n        \"height\": 300,\n        \"content\": \"## Generate the new Tshirt design\"\n      },\n      \"typeVersion\": 1\n    }\n  ],\n  \"active\": false,\n  \"pinData\": {},\n  \"settings\": {\n    \"executionOrder\": \"v1\"\n  },\n  \"versionId\": \"1a42d08d-cca5-4eab-a041-770d1a7da235\",\n  \"connections\": {\n    \"If\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"OpenAI\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        []\n      ]\n    },\n    \"Code\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"HTTP Request\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"OpenAI\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"AI Agent\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"AI Agent\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Code\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Split Out\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Convert to File\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"HTTP Request\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Split Out\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Convert to File\": {\n      \"main\": [\n        []\n      ]\n    },\n    \"OpenAI Chat Model\": {\n      \"ai_languageModel\": [\n        [\n          {\n            \"node\": \"AI Agent\",\n            \"type\": \"ai_languageModel\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"When chat message received\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"If\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}",
  "metadata": {
    "node_types": [
      "n8n-nodes-base.httpRequest",
      "n8n-nodes-base.convertToFile",
      "n8n-nodes-base.splitOut",
      "@n8n/n8n-nodes-langchain.agent",
      "@n8n/n8n-nodes-langchain.openAi",
      "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "@n8n/n8n-nodes-langchain.chatTrigger",
      "n8n-nodes-base.if",
      "n8n-nodes-base.code",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote"
    ],
    "trigger": null
  }
}