{
  "source": "1984_Code_Executecommand_Automation_Webhook.json",
  "index": 1,
  "content": "{\n  \"id\": \"tlnJNm9t5H3VLU5K\",\n  \"meta\": {\n    \"instanceId\": \"505c2bdb4483cbbca32871c0acd4b60c83809f177e47e2864f71c1c1760a9b2a\",\n    \"templateCredsSetupCompleted\": true\n  },\n  \"name\": \"Credentials Transfer\",\n  \"tags\": [],\n  \"nodes\": [\n    {\n      \"id\": \"9bb3fd8d-cead-4325-9c77-2c1d203ac805\",\n      \"name\": \"Success\",\n      \"type\": \"n8n-nodes-base.form\",\n      \"position\": [\n        680,\n        300\n      ],\n      \"webhookId\": \"6a630d50-a4b6-4fd7-a7a7-fa0283996903\",\n      \"parameters\": {\n        \"options\": {},\n        \"operation\": \"completion\",\n        \"completionTitle\": \"✅ Transfer completed\",\n        \"completionMessage\": \"=The credential has been transfered.\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"0c90e8d6-3230-4139-a625-e8656fe1c4d9\",\n      \"name\": \"Error\",\n      \"type\": \"n8n-nodes-base.form\",\n      \"position\": [\n        680,\n        460\n      ],\n      \"webhookId\": \"bfaa86b9-fddf-47b3-9456-caba547a1f5e\",\n      \"parameters\": {\n        \"options\": {},\n        \"operation\": \"completion\",\n        \"completionTitle\": \"⚠️ Transfer failed\",\n        \"completionMessage\": \"=Please check the workflow settings\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"050bb8b6-faf5-4190-a727-986d7fe6b28a\",\n      \"name\": \"Create Credential\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"onError\": \"continueErrorOutput\",\n      \"position\": [\n        460,\n        340\n      ],\n      \"parameters\": {\n        \"url\": \"={{ $json.instance.baseUrl }}/credentials\",\n        \"method\": \"POST\",\n        \"options\": {},\n        \"sendBody\": true,\n        \"sendHeaders\": true,\n        \"bodyParameters\": {\n          \"parameters\": [\n            {\n              \"name\": \"name\",\n              \"value\": \"={{ $json.credential.name }}\"\n            },\n            {\n              \"name\": \"type\",\n              \"value\": \"={{ $json.credential.type }}\"\n            },\n            {\n              \"name\": \"data\",\n              \"value\": \"={{ $json.credential.data }}\"\n            }\n          ]\n        },\n        \"headerParameters\": {\n          \"parameters\": [\n            {\n              \"name\": \"X-N8N-API-KEY\",\n              \"value\": \"={{ $json.instance.apiKey }}\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 4.2\n    },\n    {\n      \"id\": \"17072ec2-526c-49b4-8384-e9ca347b8748\",\n      \"name\": \"Get Instance Names\",\n      \"type\": \"n8n-nodes-base.code\",\n      \"position\": [\n        680,\n        -240\n      ],\n      \"parameters\": {\n        \"jsCode\": \"dropDownValues = [];\\n\\nfor (const instance of $input.first().json.remoteInstances) {\\n  dropDownValues.push({\\\"option\\\": instance.name});\\n}\\n\\nreturn { \\\"options\\\": JSON.stringify(dropDownValues) };\"\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"27fdd4c4-5c39-497b-91b3-e468b20e8f8c\",\n      \"name\": \"Settings\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        460,\n        -240\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"8a5d50fc-95dc-40b3-a3f2-293521bab29a\",\n              \"name\": \"remoteInstances\",\n              \"type\": \"array\",\n              \"value\": \"=[\\n  {\\n    \\\"name\\\": \\\"n8n-test-01\\\",\\n    \\\"apiKey\\\": \\\"n8n_api_26b5bb6d39d337bd904f3d89fe88562d456c1cd13af401f490145206f2dc516ffa1fed04a26ae689\\\",\\n    \\\"baseUrl\\\": \\\"https://n8n-test-01.services.octionic.com/api/v1\\\"\\n  }\\n]\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 3.4\n    },\n    {\n      \"id\": \"76b7d9d2-c919-42a6-8724-8771d9415e3e\",\n      \"name\": \"Export Credentials\",\n      \"type\": \"n8n-nodes-base.executeCommand\",\n      \"position\": [\n        240,\n        40\n      ],\n      \"parameters\": {\n        \"command\": \"n8n export:credentials --all --pretty --decrypted --output=/tmp/cred\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"b5f53aa1-ccf6-43b0-9f4c-cfc52f99aabf\",\n      \"name\": \"Get Credentials Data\",\n      \"type\": \"n8n-nodes-base.readWriteFile\",\n      \"position\": [\n        460,\n        40\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"fileSelector\": \"/tmp/cred\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"16fdae2d-f3e6-4030-859a-ecba74dfe4c2\",\n      \"name\": \"Binary to JSON\",\n      \"type\": \"n8n-nodes-base.extractFromFile\",\n      \"position\": [\n        680,\n        40\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"operation\": \"fromJson\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"3d590285-e82c-4754-8618-2a52fcda6253\",\n      \"name\": \"Get Credential Names\",\n      \"type\": \"n8n-nodes-base.code\",\n      \"position\": [\n        900,\n        40\n      ],\n      \"parameters\": {\n        \"jsCode\": \"dropDownValues = [];\\n\\nfor (const credential of $input.first().json.data) {\\n  dropDownValues.push({\\\"option\\\": credential.name});\\n}\\n\\nreturn { \\\"options\\\": JSON.stringify(dropDownValues) };\"\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"21615934-6834-4b4e-b521-942a24f64388\",\n      \"name\": \"Choose Instance\",\n      \"type\": \"n8n-nodes-base.form\",\n      \"position\": [\n        900,\n        -240\n      ],\n      \"webhookId\": \"b1fc6927-ebe8-4a02-9d64-24bf6f6d0db6\",\n      \"parameters\": {\n        \"options\": {\n          \"formTitle\": \"Select Destination\",\n          \"buttonLabel\": \"Continue\",\n          \"formDescription\": \"Choose the n8n instance where the credential should be copied to\"\n        },\n        \"defineForm\": \"json\",\n        \"jsonOutput\": \"=[\\n   {\\n      \\\"fieldLabel\\\": \\\"Destination\\\",\\n      \\\"fieldType\\\": \\\"dropdown\\\",\\n      \\\"requiredField\\\": true,\\n      \\\"fieldOptions\\\": {\\n        \\\"values\\\": {{ $json.options }}\\n      }\\n   }\\n]\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"d36a41c4-6ed3-4939-8562-e3f50ffcd72b\",\n      \"name\": \"Choose Credential\",\n      \"type\": \"n8n-nodes-base.form\",\n      \"position\": [\n        1120,\n        40\n      ],\n      \"webhookId\": \"f732b37b-6623-4629-bc7d-99ebb56a9809\",\n      \"parameters\": {\n        \"options\": {\n          \"formTitle\": \"Select Credential\",\n          \"buttonLabel\": \"Copy now\",\n          \"formDescription\": \"Choose the credential which should be copied\"\n        },\n        \"defineForm\": \"json\",\n        \"jsonOutput\": \"=[\\n   {\\n      \\\"fieldLabel\\\": \\\"Credential\\\",\\n      \\\"fieldType\\\": \\\"dropdown\\\",\\n      \\\"requiredField\\\": true,\\n      \\\"fieldOptions\\\": {\\n        \\\"values\\\": {{ $json.options }}\\n      }\\n   }\\n]\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"4391f0d9-3ed5-4e2b-a761-ab7bf41959f1\",\n      \"name\": \"Prepare Request Data\",\n      \"type\": \"n8n-nodes-base.code\",\n      \"position\": [\n        240,\n        340\n      ],\n      \"parameters\": {\n        \"jsCode\": \"output = {};\\n\\nfor (const credential of $('Binary to JSON').first().json.data) {\\n  if (credential.name == $input.first().json.Credential) {\\n    output.credential = credential;\\n  }\\n}\\n\\nfor (const instance of $('Settings').first().json.remoteInstances) {\\n  if (instance.name == $('Choose Instance').first().json.Destination) {\\n    output.instance = instance;\\n  }\\n}\\n\\nreturn output;\"\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"571cd727-218b-4a5d-97fe-a8dcbcf15cce\",\n      \"name\": \"Sticky Note6\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        400,\n        -340\n      ],\n      \"parameters\": {\n        \"width\": 216.47293010628914,\n        \"height\": 255.86856541619233,\n        \"content\": \"## Setup instances\\nEach instnce requires a name, apiKey and baseURL\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"7f717bed-fac5-4b1e-acc7-a6ad9d1c4be4\",\n      \"name\": \"Sticky Note\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -360,\n        -340\n      ],\n      \"parameters\": {\n        \"color\": 5,\n        \"width\": 527.8711162255479,\n        \"height\": 223.19907940161124,\n        \"content\": \"## Instances config example\\n```\\n[\\n  {\\n    \\\"name\\\": \\\"n8n-test\\\",\\n    \\\"apiKey\\\": \\\"XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX\\\",\\n    \\\"baseUrl\\\": \\\"https://n8n-test.example.com/api/v1\\\"\\n  },\\n  {\\n    ...\\n  }\\n]\\n```\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"5e27ad60-7e65-452d-8c33-56c6c85911d3\",\n      \"name\": \"Sticky Note7\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        180,\n        -340\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 216.47293010628914,\n        \"height\": 255.86856541619233,\n        \"content\": \"A form with no input fields initiates the process.\\n*Consider securing the form using Basic Auth.*\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"0b69effa-44e4-41e1-bb5d-934ed19b8488\",\n      \"name\": \"Sticky Note8\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        180,\n        -60\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 655.5152156976209,\n        \"height\": 255.86856541619233,\n        \"content\": \"Credentials are being fetched using the cmd tools, since there is no API endpoint available for this. The data is then converted into a JSON object.\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"a0f83646-dcf3-4893-bca0-a2b0ec4942b6\",\n      \"name\": \"Sticky Note9\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        620,\n        -340\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 435.9715408127852,\n        \"height\": 255.86856541619233,\n        \"content\": \"A list of the instance names is being extracted from the settings and used as dynamic options for the dropdown in a new form page.\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"78611a9e-5949-44c4-af23-78e8f689de2b\",\n      \"name\": \"Sticky Note10\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        840,\n        -60\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 435.9715408127852,\n        \"height\": 255.86856541619233,\n        \"content\": \"A list of the credential names is being extracted from the settings and used as dynamic options for the dropdown in a new form page.\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"23e9b0ea-f6a7-4072-8e87-292ba432a24d\",\n      \"name\": \"Sticky Note11\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        180,\n        240\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 216.47293010628914,\n        \"height\": 255.86856541619233,\n        \"content\": \"Based on the selections made by the user, the necessary data is being provided.\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"f13a3bce-d92d-4e2c-bb63-b37c4aa89b9b\",\n      \"name\": \"Sticky Note12\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        400,\n        240\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 216.47293010628914,\n        \"height\": 255.86856541619233,\n        \"content\": \"The credential data is being transferred to the selected instance based using dynamic authentication\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"1788ed42-44be-41c3-8a45-3d8c74925ded\",\n      \"name\": \"Sticky Note13\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        620,\n        240\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 216.47293010628914,\n        \"height\": 376.16893354714523,\n        \"content\": \"Display a confirmation/error message to the user\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"58cbb873-906e-4215-b501-4a1b31fdcbd9\",\n      \"name\": \"On form submission\",\n      \"type\": \"n8n-nodes-base.formTrigger\",\n      \"position\": [\n        240,\n        -240\n      ],\n      \"webhookId\": \"f6c627e5-e93c-4ee1-9605-ebdfa5fff286\",\n      \"parameters\": {\n        \"options\": {\n          \"buttonLabel\": \"Begin\",\n          \"appendAttribution\": false\n        },\n        \"formTitle\": \"Credential Transfer\",\n        \"formFields\": {\n          \"values\": [\n            {\n              \"fieldLabel\": \" \",\n              \"placeholder\": \"Click \\\"Begin\\\" to continue\"\n            }\n          ]\n        },\n        \"formDescription\": \"This tool allows copying a credential to another n8n instance\"\n      },\n      \"typeVersion\": 2.2\n    }\n  ],\n  \"active\": true,\n  \"pinData\": {},\n  \"settings\": {\n    \"executionOrder\": \"v1\"\n  },\n  \"versionId\": \"e89a409f-c046-4d54-b580-7e2c0a537d1b\",\n  \"connections\": {\n    \"Settings\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Get Instance Names\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Binary to JSON\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Get Credential Names\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Choose Instance\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Export Credentials\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Choose Credential\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Prepare Request Data\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Create Credential\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Success\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Error\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Export Credentials\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Get Credentials Data\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Get Instance Names\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Choose Instance\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"On form submission\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Settings\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Get Credential Names\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Choose Credential\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Get Credentials Data\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Binary to JSON\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Prepare Request Data\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Create Credential\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}",
  "metadata": {
    "node_types": [
      "n8n-nodes-base.form",
      "n8n-nodes-base.form",
      "n8n-nodes-base.httpRequest",
      "n8n-nodes-base.code",
      "n8n-nodes-base.set",
      "n8n-nodes-base.executeCommand",
      "n8n-nodes-base.readWriteFile",
      "n8n-nodes-base.extractFromFile",
      "n8n-nodes-base.code",
      "n8n-nodes-base.form",
      "n8n-nodes-base.form",
      "n8n-nodes-base.code",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.formTrigger"
    ],
    "trigger": null
  }
}