{
  "source": "1549_Wait_Dropbox_Automation_Webhook.json",
  "index": 1,
  "content": "{\n  \"meta\": {\n    \"instanceId\": \"cd478e616d2616186f4f92b70cfe0c2ed95b5b209f749f2b873b38bdc56c47c9\"\n  },\n  \"nodes\": [\n    {\n      \"id\": \"f4b1bdd8-654d-4643-a004-ff1b2f32b5ae\",\n      \"name\": \"When clicking \\u2018Test workflow\\u2019\",\n      \"type\": \"n8n-nodes-base.manualTrigger\",\n      \"position\": [\n        580,\n        1100\n      ],\n      \"parameters\": {},\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"d6b1c410-81c3-486d-bdcb-86a4c6f7bf9e\",\n      \"name\": \"Create Asset\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        1940,\n        580\n      ],\n      \"parameters\": {\n        \"url\": \"https://pdf-services.adobe.io/assets\",\n        \"method\": \"POST\",\n        \"options\": {\n          \"redirect\": {\n            \"redirect\": {}\n          }\n        },\n        \"sendBody\": true,\n        \"sendHeaders\": true,\n        \"authentication\": \"genericCredentialType\",\n        \"bodyParameters\": {\n          \"parameters\": [\n            {\n              \"name\": \"mediaType\",\n              \"value\": \"application/pdf\"\n            }\n          ]\n        },\n        \"genericAuthType\": \"httpHeaderAuth\",\n        \"headerParameters\": {\n          \"parameters\": [\n            {\n              \"name\": \"Authorization\",\n              \"value\": \"=Bearer {{ $json.access_token }}\"\n            }\n          ]\n        }\n      },\n      \"credentials\": {\n        \"httpHeaderAuth\": {\n          \"id\": \"PU8GmSwXswwM1Fzq\",\n          \"name\": \"Adobe API calls\"\n        }\n      },\n      \"typeVersion\": 4.1\n    },\n    {\n      \"id\": \"9e900a45-d792-4dc5-938c-0d5cdfd2e647\",\n      \"name\": \"Execute Workflow Trigger\",\n      \"type\": \"n8n-nodes-base.executeWorkflowTrigger\",\n      \"position\": [\n        1140,\n        440\n      ],\n      \"parameters\": {},\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"859f369d-f36f-4c3f-a50d-a17214fef2a3\",\n      \"name\": \"Sticky Note\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        20,\n        140\n      ],\n      \"parameters\": {\n        \"color\": 5,\n        \"width\": 667.6107231291055,\n        \"height\": 715.2927406867177,\n        \"content\": \"# Adobe API Wrapper\\n\\nSee Adobe documentation:\\n- https://developer.adobe.com/document-services/docs/overview/pdf-services-api/howtos/\\n- https://developer.adobe.com/document-services/docs/overview/pdf-extract-api/gettingstarted/\\n\\nIn short, this workflow does the following steps :\\n\\n- Authentication\\n- Upload an asset (pdf) to adobe\\n- Wait for the asset to be processed by Adobe\\n- Download the result\\n\\n## Credential\\n\\nCredentials are not \\\"predefined\\\" and you'll have to create 2 custom credentials, detailed in the workflow.\\n\\n## Result\\n\\nThe result will depend on the transformation requested. It could be 1 of various files (json, zip...) accessible via download URL returned by the workflow.\\n\\nWorkflow can be tested with a PDF filed fetched with Dorpbox for example or any storage provider. \"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"450199c5-e588-486d-81cf-eb69cf729ab1\",\n      \"name\": \"Sticky Note1\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        560,\n        900\n      ],\n      \"parameters\": {\n        \"width\": 857.2064431277577,\n        \"height\": 463.937514110429,\n        \"content\": \"## Testing for development\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"311a75d6-4fbe-4d8f-89b3-d4b0ee21f7ae\",\n      \"name\": \"Adobe API Query\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        900,\n        1000\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"62bb6466-acf4-41e5-9444-c9ef608a6822\",\n              \"name\": \"endpoint\",\n              \"type\": \"string\",\n              \"value\": \"extractpdf\"\n            },\n            {\n              \"id\": \"0352f585-1434-4ab7-a704-a1e187fffa96\",\n              \"name\": \"json_payload\",\n              \"type\": \"object\",\n              \"value\": \"={{ \\n{\\n \\\"renditionsToExtract\\\": [\\n \\\"tables\\\"\\n ],\\n \\\"elementsToExtract\\\": [\\n \\\"text\\\",\\n \\\"tables\\\"\\n ]\\n }\\n}}\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 3.4\n    },\n    {\n      \"id\": \"abf20778-db50-4787-a5f4-7af5d5c76efe\",\n      \"name\": \"Load a test pdf file\",\n      \"type\": \"n8n-nodes-base.dropbox\",\n      \"position\": [\n        900,\n        1180\n      ],\n      \"parameters\": {\n        \"path\": \"/valerian/w/prod/_freelance/ADEZIF/AI/Source data/Brochures pour GPT/Brochure 3M/3M_doc_emballage VERSION FINALE.pdf\",\n        \"operation\": \"download\",\n        \"authentication\": \"oAuth2\"\n      },\n      \"credentials\": {\n        \"dropboxOAuth2Api\": {\n          \"id\": \"9\",\n          \"name\": \"Dropbox account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"8bb2ae0c-df61-4110-af44-b1040b4340a2\",\n      \"name\": \"Query + File\",\n      \"type\": \"n8n-nodes-base.merge\",\n      \"position\": [\n        1180,\n        1080\n      ],\n      \"parameters\": {\n        \"mode\": \"combine\",\n        \"options\": {},\n        \"combinationMode\": \"mergeByPosition\"\n      },\n      \"typeVersion\": 2.1\n    },\n    {\n      \"id\": \"92afa6d6-daf8-4358-8c95-36473b810dc2\",\n      \"name\": \"Query + File + Asset information\",\n      \"type\": \"n8n-nodes-base.merge\",\n      \"position\": [\n        2180,\n        580\n      ],\n      \"parameters\": {\n        \"mode\": \"combine\",\n        \"options\": {},\n        \"combinationMode\": \"mergeByPosition\"\n      },\n      \"typeVersion\": 2.1\n    },\n    {\n      \"id\": \"5d88b8e4-0b0a-463a-88db-c45d5e87e823\",\n      \"name\": \"Process Query\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        2640,\n        580\n      ],\n      \"parameters\": {\n        \"url\": \"=https://pdf-services.adobe.io/operation/{{ $('Query + File + Asset information').item.json.endpoint }}\",\n        \"method\": \"POST\",\n        \"options\": {\n          \"redirect\": {\n            \"redirect\": {}\n          },\n          \"response\": {\n            \"response\": {\n              \"fullResponse\": true\n            }\n          }\n        },\n        \"jsonBody\": \"={{ \\n{\\n...{ \\\"assetID\\\":$('Query + File + Asset information').first().json.assetID },\\n...$('Query + File + Asset information').first().json.json_payload\\n}\\n}}\",\n        \"sendBody\": true,\n        \"sendHeaders\": true,\n        \"specifyBody\": \"json\",\n        \"authentication\": \"genericCredentialType\",\n        \"genericAuthType\": \"httpHeaderAuth\",\n        \"headerParameters\": {\n          \"parameters\": [\n            {\n              \"name\": \"Authorization\",\n              \"value\": \"=Bearer {{ $('Authenticartion (get token)').first().json[\\\"access_token\\\"] }}\"\n            }\n          ]\n        }\n      },\n      \"credentials\": {\n        \"httpHeaderAuth\": {\n          \"id\": \"PU8GmSwXswwM1Fzq\",\n          \"name\": \"Adobe API calls\"\n        }\n      },\n      \"typeVersion\": 4.1\n    },\n    {\n      \"id\": \"47278b2f-dd04-4609-90ab-52f34b9a0e72\",\n      \"name\": \"Wait 5 second\",\n      \"type\": \"n8n-nodes-base.wait\",\n      \"position\": [\n        2860,\n        580\n      ],\n      \"webhookId\": \"ed00a9a8-d599-4a98-86f8-a15176352c0a\",\n      \"parameters\": {\n        \"unit\": \"seconds\",\n        \"amount\": 5\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"691b52ae-132a-4105-b1e4-bb7d55d0e347\",\n      \"name\": \"Try to download the result\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        3080,\n        580\n      ],\n      \"parameters\": {\n        \"url\": \"={{ $('Process Query').item.json[\\\"headers\\\"][\\\"location\\\"] }}\",\n        \"options\": {},\n        \"sendHeaders\": true,\n        \"authentication\": \"genericCredentialType\",\n        \"genericAuthType\": \"httpHeaderAuth\",\n        \"headerParameters\": {\n          \"parameters\": [\n            {\n              \"name\": \"Authorization\",\n              \"value\": \"=Bearer {{ $('Authenticartion (get token)').first().json[\\\"access_token\\\"] }}\"\n            }\n          ]\n        }\n      },\n      \"credentials\": {\n        \"httpHeaderAuth\": {\n          \"id\": \"PU8GmSwXswwM1Fzq\",\n          \"name\": \"Adobe API calls\"\n        }\n      },\n      \"typeVersion\": 4.1\n    },\n    {\n      \"id\": \"277dea14-de8d-4719-aff1-f4008d6d5c67\",\n      \"name\": \"Switch\",\n      \"type\": \"n8n-nodes-base.switch\",\n      \"position\": [\n        3260,\n        580\n      ],\n      \"parameters\": {\n        \"rules\": {\n          \"values\": [\n            {\n              \"outputKey\": \"in progress\",\n              \"conditions\": {\n                \"options\": {\n                  \"leftValue\": \"\",\n                  \"caseSensitive\": true,\n                  \"typeValidation\": \"strict\"\n                },\n                \"combinator\": \"and\",\n                \"conditions\": [\n                  {\n                    \"operator\": {\n                      \"type\": \"string\",\n                      \"operation\": \"equals\"\n                    },\n                    \"leftValue\": \"={{ $json.status }}\",\n                    \"rightValue\": \"in progress\"\n                  }\n                ]\n              },\n              \"renameOutput\": true\n            },\n            {\n              \"outputKey\": \"failed\",\n              \"conditions\": {\n                \"options\": {\n                  \"leftValue\": \"\",\n                  \"caseSensitive\": true,\n                  \"typeValidation\": \"strict\"\n                },\n                \"combinator\": \"and\",\n                \"conditions\": [\n                  {\n                    \"id\": \"6d6917f6-abb9-4175-a070-a2f500d9f34f\",\n                    \"operator\": {\n                      \"name\": \"filter.operator.equals\",\n                      \"type\": \"string\",\n                      \"operation\": \"equals\"\n                    },\n                    \"leftValue\": \"={{ $json.status }}\",\n                    \"rightValue\": \"failed\"\n                  }\n                ]\n              },\n              \"renameOutput\": true\n            }\n          ]\n        },\n        \"options\": {\n          \"fallbackOutput\": \"extra\"\n        }\n      },\n      \"typeVersion\": 3\n    },\n    {\n      \"id\": \"8f6f8273-43ed-4a44-bb27-6ce137000472\",\n      \"name\": \"Forward response to origin workflow\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        3820,\n        600\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": []\n        },\n        \"includeOtherFields\": true\n      },\n      \"typeVersion\": 3.4\n    },\n    {\n      \"id\": \"00e2d7e3-94cd-49e5-a975-2fdc1a7a95fd\",\n      \"name\": \"Sticky Note2\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        2780,\n        480\n      ],\n      \"parameters\": {\n        \"width\": 741.3069226712129,\n        \"height\": 336.57433650102917,\n        \"content\": \"## Wait for file do be processed\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"3667b1ba-b9a6-4e1a-94b1-61b37f1e7adc\",\n      \"name\": \"Sticky Note3\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        1324.6733934850213,\n        147.59707015795897\n      ],\n      \"parameters\": {\n        \"color\": 5,\n        \"width\": 402.63171535688423,\n        \"height\": 700.9473619571734,\n        \"content\": \"### 1- Credential for token request\\n\\nCreate a \\\"Custom Auth\\\" credential like this :\\n\\n```\\n{\\n \\\"headers\\\": {\\n \\\"Content-Type\\\":\\\"application/x-www-form-urlencoded\\\"\\n }, \\n \\\"body\\\" : {\\n \\\"client_id\\\": \\\"****\\\", \\n \\\"client_secret\\\":\\\"****\\\"\\n }\\n}\\n```\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"718bb738-8ce4-4b38-94e4-6ccac1adf9ec\",\n      \"name\": \"Sticky Note4\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        1800,\n        152.6219700851708\n      ],\n      \"parameters\": {\n        \"color\": 5,\n        \"width\": 1752.5923360342827,\n        \"height\": 692.0175575715904,\n        \"content\": \"### 2- Credential for all other Queries\\n\\nCreate a \\\"Header Auth\\\" credential like this : \\n\\n```\\nX-API-Key: **** (same value as client_id)\\n```\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"d6bc8011-699d-4388-82f5-e5f90ba8672a\",\n      \"name\": \"Sticky Note5\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        740,\n        140\n      ],\n      \"parameters\": {\n        \"color\": 5,\n        \"width\": 529.7500231395039,\n        \"height\": 718.8735380890446,\n        \"content\": \"## Workflow Input\\n\\n- endpoint: splitpdf, extractpdf, ...\\n- json_payload : all endpoint payload except assetID which is handled in current workflow\\n- **PDF Data as n8n Binary**\\n\\n\\n### Example for **split** : \\n\\n```\\n{\\n \\\"endpoint\\\": \\\"splitpdf\\\",\\n \\\"json_payload\\\": {\\n \\\"splitoption\\\": \\n { \\\"pageRanges\\\": [{\\\"start\\\": 1,\\\"end\\\": 2}]}\\n }\\n }\\n}\\n```\\n\\n### Example for **extractpdf**\\n\\n```\\n{\\n \\\"endpoint\\\": \\\"splitpdf\\\",\\n \\\"json_payload\\\": {\\n \\\"renditionsToExtract\\\": [\\n \\\"tables\\\"\\n ],\\n \\\"elementsToExtract\\\": [\\n \\\"text\\\",\\n \\\"tables\\\"\\n ]\\n }\\n}\\n```\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"2bbf6d9d-8399-49ba-94ea-b90795ef44ba\",\n      \"name\": \"Authenticartion (get token)\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        1500,\n        580\n      ],\n      \"parameters\": {\n        \"url\": \"https://pdf-services.adobe.io/token\",\n        \"method\": \"POST\",\n        \"options\": {},\n        \"sendBody\": true,\n        \"contentType\": \"form-urlencoded\",\n        \"authentication\": \"genericCredentialType\",\n        \"bodyParameters\": {\n          \"parameters\": [\n            {}\n          ]\n        },\n        \"genericAuthType\": \"httpCustomAuth\"\n      },\n      \"credentials\": {\n        \"httpCustomAuth\": {\n          \"id\": \"djeOoXpBafK4aiGX\",\n          \"name\": \"Adobe API\"\n        }\n      },\n      \"typeVersion\": 4.1\n    },\n    {\n      \"id\": \"be4e87e8-6e56-408f-b932-320023382f98\",\n      \"name\": \"Upload PDF File (asset)\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        2440,\n        580\n      ],\n      \"parameters\": {\n        \"url\": \"={{ $json.uploadUri }}\",\n        \"method\": \"PUT\",\n        \"options\": {\n          \"redirect\": {\n            \"redirect\": {}\n          }\n        },\n        \"sendBody\": true,\n        \"sendQuery\": true,\n        \"contentType\": \"binaryData\",\n        \"queryParameters\": {\n          \"parameters\": [\n            {}\n          ]\n        },\n        \"inputDataFieldName\": \"data\"\n      },\n      \"typeVersion\": 4.1\n    }\n  ],\n  \"pinData\": {},\n  \"connections\": {\n    \"Switch\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Wait 5 second\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Forward response to origin workflow\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Forward response to origin workflow\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Create Asset\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Query + File + Asset information\",\n            \"type\": \"main\",\n            \"index\": 1\n          }\n        ]\n      ]\n    },\n    \"Query + File\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Authenticartion (get token)\",\n            \"type\": \"main\",\n            \"index\": 0\n          },\n          {\n            \"node\": \"Query + File + Asset information\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Process Query\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Wait 5 second\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Wait 5 second\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Try to download the result\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Adobe API Query\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Query + File\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Load a test pdf file\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Query + File\",\n            \"type\": \"main\",\n            \"index\": 1\n          }\n        ]\n      ]\n    },\n    \"Upload PDF File (asset)\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Process Query\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Execute Workflow Trigger\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Authenticartion (get token)\",\n            \"type\": \"main\",\n            \"index\": 0\n          },\n          {\n            \"node\": \"Query + File + Asset information\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Try to download the result\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Switch\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Authenticartion (get token)\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Create Asset\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Query + File + Asset information\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Upload PDF File (asset)\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"When clicking \\u2018Test workflow\\u2019\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Load a test pdf file\",\n            \"type\": \"main\",\n            \"index\": 0\n          },\n          {\n            \"node\": \"Adobe API Query\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}",
  "metadata": {
    "node_types": [
      "n8n-nodes-base.manualTrigger",
      "n8n-nodes-base.httpRequest",
      "n8n-nodes-base.executeWorkflowTrigger",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.set",
      "n8n-nodes-base.dropbox",
      "n8n-nodes-base.merge",
      "n8n-nodes-base.merge",
      "n8n-nodes-base.httpRequest",
      "n8n-nodes-base.wait",
      "n8n-nodes-base.httpRequest",
      "n8n-nodes-base.switch",
      "n8n-nodes-base.set",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.httpRequest",
      "n8n-nodes-base.httpRequest"
    ],
    "trigger": "execute workflow trigger"
  }
}