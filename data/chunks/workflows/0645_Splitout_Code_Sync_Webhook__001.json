{
  "source": "0645_Splitout_Code_Sync_Webhook.json",
  "index": 1,
  "content": "{\n  \"meta\": {\n    \"instanceId\": \"21b41c2deb1c9e3f543253a0aa6a6e2c7bd7ef6bab90ffd478aa947c17d3b352\",\n    \"templateCredsSetupCompleted\": true\n  },\n  \"name\": \"Linear Project Status and End Date to Productboard feature Sync\",\n  \"tags\": [\n    {\n      \"id\": \"6Ek7V8f4xbM9vWLj\",\n      \"name\": \"linear\",\n      \"createdAt\": \"2024-11-08T12:12:15.330Z\",\n      \"updatedAt\": \"2024-11-08T12:12:15.330Z\"\n    },\n    {\n      \"id\": \"XpcIJ8IHNenz3bWz\",\n      \"name\": \"productboard\",\n      \"createdAt\": \"2024-11-08T12:12:17.249Z\",\n      \"updatedAt\": \"2024-11-08T12:12:17.249Z\"\n    }\n  ],\n  \"nodes\": [\n    {\n      \"id\": \"5cf79e5e-6a69-49b5-865f-6ca8009dbf75\",\n      \"name\": \"linear project id\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        3180,\n        220\n      ],\n      \"parameters\": {\n        \"fields\": {\n          \"values\": [\n            {\n              \"name\": \"linear_project_url\",\n              \"stringValue\": \"={{ $json.url }}\"\n            },\n            {\n              \"name\": \"linear_project_id\",\n              \"stringValue\": \"={{ $json.url.split('https://linear.app/<your company>/project/')[1] }}\"\n            },\n            {\n              \"name\": \"linear_project_status\",\n              \"stringValue\": \"={{ $json.data.status.name }}\"\n            },\n            {\n              \"name\": \"startDate\",\n              \"stringValue\": \"={{ $json.data.startDate }}\"\n            },\n            {\n              \"name\": \"targetDate\",\n              \"stringValue\": \"={{ $json.data.targetDate }}\"\n            }\n          ]\n        },\n        \"include\": \"none\",\n        \"options\": {}\n      },\n      \"typeVersion\": 3.2\n    },\n    {\n      \"id\": \"642e73fc-8904-4631-9e97-1ccff6dbb559\",\n      \"name\": \"get productboard feature id\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        3180,\n        400\n      ],\n      \"parameters\": {\n        \"url\": \"https://api.productboard.com/hierarchy-entities/custom-fields-values\",\n        \"options\": {},\n        \"sendQuery\": true,\n        \"sendHeaders\": true,\n        \"authentication\": \"genericCredentialType\",\n        \"genericAuthType\": \"httpHeaderAuth\",\n        \"queryParameters\": {\n          \"parameters\": [\n            {\n              \"name\": \"customField.id\",\n              \"value\": \"<productboard_customfield_uuid>\"\n            }\n          ]\n        },\n        \"headerParameters\": {\n          \"parameters\": [\n            {\n              \"name\": \"Content-Type\",\n              \"value\": \"application/json\"\n            },\n            {\n              \"name\": \"X-Version\",\n              \"value\": \"1\"\n            }\n          ]\n        }\n      },\n      \"stickyNote\": \"Fetches the Productboard feature ID using a custom field value.\",\n      \"credentials\": {\n        \"httpHeaderAuth\": {\n          \"id\": \"Z0ptr85smbBZBIYx\",\n          \"name\": \"Product Board\"\n        }\n      },\n      \"notesInFlow\": false,\n      \"typeVersion\": 4.1\n    },\n    {\n      \"id\": \"3c328300-ff68-4958-8ac3-5b8fca122bbd\",\n      \"name\": \"update productboard status & timeframe\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        5560,\n        380\n      ],\n      \"parameters\": {\n        \"url\": \"=https://api.productboard.com/features/{{ $json.feature_id }}\",\n        \"method\": \"PATCH\",\n        \"options\": {\n          \"batching\": {\n            \"batch\": {\n              \"batchSize\": 1,\n              \"batchInterval\": 2000\n            }\n          }\n        },\n        \"jsonBody\": \"={\\n  \\\"data\\\": {\\n    \\\"status\\\": {\\n      \\\"name\\\": \\\"{{ $json[\\\"productboard_status\\\"] }}\\\"\\n    },\\n    \\\"timeframe\\\": {\\n      {{ $json[\\\"targetDate\\\"] ? '\\\"granularity\\\": \\\"month\\\",': '\\\"granularity\\\": \\\"none\\\",'}}\\n      {{ $json[\\\"targetDate\\\"] ? '\\\"startDate\\\": \\\"' + $json['targetDate'].substring(0, 7) + '-01' +'\\\",': '\\\"startDate\\\": \\\"none\\\",'}}\\n      {{ $json[\\\"targetDate\\\"] \\n        ? (() => {\\n            const date = new Date($json['targetDate']);\\n            const year = date.getFullYear();\\n            const month = date.getMonth() + 1;\\n            const lastDay = new Date(year, month, 0).getDate();\\n            return `\\\"endDate\\\": \\\"${year}-${month.toString().padStart(2, '0')}-${lastDay}\\\"`;\\n          })() \\n        : '\\\"endDate\\\": \\\"none\\\"'}}\\n    }\\n  }\\n}\",\n        \"sendBody\": true,\n        \"sendHeaders\": true,\n        \"specifyBody\": \"json\",\n        \"authentication\": \"genericCredentialType\",\n        \"genericAuthType\": \"httpHeaderAuth\",\n        \"headerParameters\": {\n          \"parameters\": [\n            {\n              \"name\": \"X-Version\",\n              \"value\": \"1\"\n            },\n            {\n              \"name\": \"accept\",\n              \"value\": \"application/json\"\n            }\n          ]\n        }\n      },\n      \"credentials\": {\n        \"httpHeaderAuth\": {\n          \"id\": \"Z0ptr85smbBZBIYx\",\n          \"name\": \"Product Board\"\n        }\n      },\n      \"typeVersion\": 4.1\n    },\n    {\n      \"id\": \"ec57bdeb-413b-4f71-b8c4-82b966fd4caf\",\n      \"name\": \"map linear to productboard status\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        4300,\n        280\n      ],\n      \"parameters\": {\n        \"fields\": {\n          \"values\": [\n            {\n              \"name\": \"linear_status\",\n              \"stringValue\": \"={{ $json.linear_project_status }}\"\n            }\n          ]\n        },\n        \"options\": {}\n      },\n      \"typeVersion\": 3.2\n    },\n    {\n      \"id\": \"052dcbb4-c113-4e1a-8469-e460a9bfefaf\",\n      \"name\": \"mapping\",\n      \"type\": \"n8n-nodes-base.code\",\n      \"position\": [\n        4560,\n        280\n      ],\n      \"parameters\": {\n        \"mode\": \"runOnceForEachItem\",\n        \"jsCode\": \"const linearStatus = $json.linear_status;\\nlet productboardStatus;\\n\\nswitch(linearStatus) {\\n  case 'Backlog':\\n    productboardStatus = 'Candidate';\\n    break;\\n  case 'Planned':\\n    productboardStatus = 'Planned';\\n    break;\\n  case 'Paused':\\n    productboardStatus = 'Planned';\\n    break;\\n  case 'In Progress':\\n    productboardStatus = 'In progress';\\n    break;\\n  case 'Completed':\\n    productboardStatus = 'Released';\\n    break;\\n  case 'Canceled':\\n    productboardStatus = 'Won\\\\'t do';\\n    break;\\n  default:\\n    productboardStatus = 'Candidate'; // Default or handle unknown status\\n}\\n\\nreturn { productboard_status: productboardStatus };\\n\"\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"4fee2a41-4e20-4642-badd-164c6d0b1232\",\n      \"name\": \"Merge\",\n      \"type\": \"n8n-nodes-base.merge\",\n      \"position\": [\n        4780,\n        300\n      ],\n      \"parameters\": {\n        \"mode\": \"combine\",\n        \"options\": {},\n        \"combinationMode\": \"mergeByPosition\"\n      },\n      \"typeVersion\": 2.1\n    },\n    {\n      \"id\": \"49289417-ca21-4b03-b558-61a04b6eb7dd\",\n      \"name\": \"Split Out\",\n      \"type\": \"n8n-nodes-base.splitOut\",\n      \"position\": [\n        3400,\n        400\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"fieldToSplitOut\": \"data\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"b89135b5-3c72-44a9-9d8e-b0190385cf65\",\n      \"name\": \"Merge1\",\n      \"type\": \"n8n-nodes-base.merge\",\n      \"position\": [\n        3920,\n        280\n      ],\n      \"parameters\": {\n        \"mode\": \"combine\",\n        \"options\": {},\n        \"mergeByFields\": {\n          \"values\": [\n            {\n              \"field1\": \"linear_project_url\",\n              \"field2\": \"linear_url_productboard\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 2.1\n    },\n    {\n      \"id\": \"cf533225-7507-471e-9d45-4a490b30a01d\",\n      \"name\": \"Edit Fields\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        3740,\n        400\n      ],\n      \"parameters\": {\n        \"fields\": {\n          \"values\": [\n            {\n              \"name\": \"linear_url_productboard\",\n              \"stringValue\": \"={{ $json['value'].match('^(https:\\\\/\\\\/linear\\\\.app\\\\/[^\\\\/]+\\\\/project\\\\/[^\\\\/]+)')[0] }}\"\n            },\n            {\n              \"name\": \"feature_id\",\n              \"stringValue\": \"={{ $json['hierarchyEntity'].id }}\"\n            }\n          ]\n        },\n        \"include\": \"none\",\n        \"options\": {}\n      },\n      \"typeVersion\": 3.2\n    },\n    {\n      \"id\": \"ee7f8ef5-f5a9-4a39-9621-ccf908036eeb\",\n      \"name\": \"Slack\",\n      \"type\": \"n8n-nodes-base.slack\",\n      \"position\": [\n        5820,\n        380\n      ],\n      \"parameters\": {\n        \"text\": \"=:linear: {{ $json.data.name }} with status {{ $json.data.status.name }} and dates {{ $json.data.timeframe.startDate }} - {{ $json.data.timeframe.endDate }} updated :productboard: {{ $json.data.links.html }}.\",\n        \"select\": \"channel\",\n        \"blocksUi\": \"={\\n  \\\"blocks\\\": [\\n    {\\n      \\\"type\\\": \\\"section\\\",\\n      \\\"text\\\": {\\n        \\\"type\\\": \\\"mrkdwn\\\",\\n        \\\"text\\\": \\\":linear: to :productboard: update\\\\n\\\\n*{{ $json.data.name }}*\\\\n\\\\n*Status:* {{ $json.data.status.name }}\\\\n*:dart: date:* {{ $json[\\\"data\\\"][\\\"timeframe\\\"][\\\"endDate\\\"] && $json[\\\"data\\\"][\\\"timeframe\\\"][\\\"endDate\\\"] !== \\\"none\\\" ? new Date($json[\\\"data\\\"][\\\"timeframe\\\"][\\\"endDate\\\"]).toLocaleDateString(\\\"en-US\\\", { month: \\\"long\\\", year: \\\"numeric\\\" }) : \\\"none\\\" }}\\\"\\n      }\\n    },\\n    {\\n      \\\"type\\\": \\\"divider\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"section\\\",\\n      \\\"text\\\": {\\n        \\\"type\\\": \\\"mrkdwn\\\",\\n        \\\"text\\\": \\\"You can view the update in Productboard using the link below:\\\"\\n      },\\n      \\\"accessory\\\": {\\n        \\\"type\\\": \\\"button\\\",\\n        \\\"text\\\": {\\n          \\\"type\\\": \\\"plain_text\\\",\\n          \\\"text\\\": \\\"Open Productboard\\\"\\n        },\\n        \\\"url\\\": \\\"{{ $json.data.links.html }}\\\"\\n      }\\n    }\\n  ]\\n}\\n\",\n        \"channelId\": {\n          \"__rl\": true,\n          \"mode\": \"name\",\n          \"value\": \"#product-notifications\"\n        },\n        \"messageType\": \"block\",\n        \"otherOptions\": {}\n      },\n      \"credentials\": {\n        \"slackApi\": {\n          \"id\": \"SG3oDwwLGpxwoJSO\",\n          \"name\": \"Slack\"\n        }\n      },\n      \"typeVersion\": 2.1\n    },\n    {\n      \"id\": \"4ab5c298-5947-47d1-ac10-db502a0b4b60\",\n      \"name\": \"If\",\n      \"type\": \"n8n-nodes-base.if\",\n      \"position\": [\n        5280,\n        400\n      ],\n      \"parameters\": {\n        \"options\": {\n          \"looseTypeValidation\": true\n        },\n        \"conditions\": {\n          \"options\": {\n            \"leftValue\": \"\",\n            \"caseSensitive\": true,\n            \"typeValidation\": \"loose\"\n          },\n          \"combinator\": \"or\",\n          \"conditions\": [\n            {\n              \"id\": \"f53c6eb9-61cc-4cf9-bbb6-03cc9f78b6b1\",\n              \"operator\": {\n                \"type\": \"string\",\n                \"operation\": \"notEquals\"\n              },\n              \"leftValue\": \"={{ $json.productboard_status }}\",\n              \"rightValue\": \"={{ $json.data.status.name }}\"\n            },\n            {\n              \"id\": \"a61b4bca-47b0-48bb-b93f-ba9a419740d0\",\n              \"operator\": {\n                \"type\": \"string\",\n                \"operation\": \"notEquals\"\n              },\n              \"leftValue\": \"={{ $json[\\\"targetDate\\\"] \\n        ? (() => {\\n            const date = new Date($json['targetDate']);\\n            const year = date.getFullYear();\\n            const month = date.getMonth() + 1;\\n            const lastDay = new Date(year, month, 0).getDate();\\n            return `${year}-${month.toString().padStart(2, '0')}-${lastDay}`;\\n          })() \\n        : '\\\"endDate\\\": \\\"none\\\"'}}\",\n              \"rightValue\": \"={{ $json.data.timeframe.endDate }}\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"3efe9d27-7983-419d-8ac1-9efde3751952\",\n      \"name\": \"get productboard feature details\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        4300,\n        540\n      ],\n      \"parameters\": {\n        \"url\": \"=https://api.productboard.com/features/{{ $json.feature_id }}\",\n        \"options\": {},\n        \"sendHeaders\": true,\n        \"authentication\": \"genericCredentialType\",\n        \"genericAuthType\": \"httpHeaderAuth\",\n        \"headerParameters\": {\n          \"parameters\": [\n            {\n              \"name\": \"Content-Type\",\n              \"value\": \"application/json\"\n            },\n            {\n              \"name\": \"X-Version\",\n              \"value\": \"1\"\n            }\n          ]\n        }\n      },\n      \"credentials\": {\n        \"httpHeaderAuth\": {\n          \"id\": \"Z0ptr85smbBZBIYx\",\n          \"name\": \"Product Board\"\n        }\n      },\n      \"typeVersion\": 4.1\n    },\n    {\n      \"id\": \"265b3359-c63d-4188-ad1b-a33ce5e081f5\",\n      \"name\": \"Merge2\",\n      \"type\": \"n8n-nodes-base.merge\",\n      \"position\": [\n        5040,\n        400\n      ],\n      \"parameters\": {\n        \"mode\": \"combine\",\n        \"options\": {},\n        \"joinMode\": \"keepEverything\",\n        \"mergeByFields\": {\n          \"values\": [\n            {\n              \"field1\": \"feature_id\",\n              \"field2\": \"data.id\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 2.1\n    },\n    {\n      \"id\": \"5dc1c2f5-a92d-49f4-acb9-8084bf878b05\",\n      \"name\": \"Your Linear Project 2\",\n      \"type\": \"n8n-nodes-base.linearTrigger\",\n      \"position\": [\n        2840,\n        260\n      ],\n      \"webhookId\": \"180ebe54-3ab2-439f-b44b-40be97a62b87\",\n      \"parameters\": {\n        \"teamId\": \"8434c5f8-1ce0-4733-949d-ef6a095c27fd\",\n        \"resources\": [\n          \"project\"\n        ]\n      },\n      \"credentials\": {\n        \"linearApi\": {\n          \"id\": \"hhmsOxH2jUEvGbvN\",\n          \"name\": \"Linear\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"6f70d103-cf98-4ab8-9550-a5749a40f7e3\",\n      \"name\": \"Your Linear Project 1\",\n      \"type\": \"n8n-nodes-base.linearTrigger\",\n      \"position\": [\n        2840,\n        60\n      ],\n      \"webhookId\": \"5b10cdb4-85a6-41de-a0de-ce50c75dcc6f\",\n      \"parameters\": {\n        \"teamId\": \"e7c75e79-fbcf-45cc-95bd-110efb6cb555\",\n        \"resources\": [\n          \"project\"\n        ]\n      },\n      \"credentials\": {\n        \"linearApi\": {\n          \"id\": \"hhmsOxH2jUEvGbvN\",\n          \"name\": \"Linear\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"65abdb10-dba2-4535-a155-957106ae6cdd\",\n      \"name\": \"Sticky Note\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        2960,\n        680\n      ],\n      \"parameters\": {\n        \"width\": 487.89456119016046,\n        \"height\": 156.00544089827184,\n        \"content\": \"## Tips\\n- Avoid copying and pasting the Linear node; instead, add a new one from the menu.\\n- Remember to configure the custom Productboard field in the \\\"Get Productboard Feature ID\\\" node.\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"adcb71e4-880b-4c19-acbb-0708ae4af95f\",\n      \"name\": \"Sticky Note1\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        5500,\n        620\n      ],\n      \"parameters\": {\n        \"color\": 5,\n        \"width\": 492.6340257353018,\n        \"height\": 182.8624066540728,\n        \"content\": \"## Preview Slack Message\\n:linear: to :productboard: update\\nMy awesome feature name\\nStatus: Candidate\\n:dart: date: Decembre 2024\\nYou can view the update in Productboard using the link below:\\n<link productboard feature>\"\n      },\n      \"typeVersion\": 1\n    }\n  ],\n  \"active\": false,\n  \"pinData\": {},\n  \"settings\": {\n    \"executionOrder\": \"v1\"\n  },\n  \"versionId\": \"\",\n  \"connections\": {\n    \"If\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"update productboard status & timeframe\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Merge\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Merge2\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Merge1\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"map linear to productboard status\",\n            \"type\": \"main\",\n            \"index\": 0\n          },\n          {\n            \"node\": \"get productboard feature details\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Merge2\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"If\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"mapping\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Merge\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Split Out\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Edit Fields\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Edit Fields\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Merge1\",\n            \"type\": \"main\",\n            \"index\": 1\n          }\n        ]\n      ]\n    },\n    \"linear project id\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Merge1\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Your Linear Project 1\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"get productboard feature id\",\n            \"type\": \"main\",\n            \"index\": 0\n          },\n          {\n            \"node\": \"linear project id\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Your Linear Project 2\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"linear project id\",\n            \"type\": \"main\",\n            \"index\": 0\n          },\n          {\n            \"node\": \"get productboard feature id\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"get productboard feature id\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Split Out\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"get productboard feature details\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Merge2\",\n            \"type\": \"main\",\n            \"index\": 1\n          }\n        ]\n      ]\n    },\n    \"map linear to productboard status\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"mapping\",\n            \"type\": \"main\",\n            \"index\": 0\n          },\n          {\n            \"node\": \"Merge\",\n            \"type\": \"main\",\n            \"index\": 1\n          }\n        ]\n      ]\n    },\n    \"update productboard status & timeframe\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Slack\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}",
  "metadata": {
    "node_types": [
      "n8n-nodes-base.set",
      "n8n-nodes-base.httpRequest",
      "n8n-nodes-base.httpRequest",
      "n8n-nodes-base.set",
      "n8n-nodes-base.code",
      "n8n-nodes-base.merge",
      "n8n-nodes-base.splitOut",
      "n8n-nodes-base.merge",
      "n8n-nodes-base.set",
      "n8n-nodes-base.slack",
      "n8n-nodes-base.if",
      "n8n-nodes-base.httpRequest",
      "n8n-nodes-base.merge",
      "n8n-nodes-base.linearTrigger",
      "n8n-nodes-base.linearTrigger",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote"
    ],
    "trigger": null
  }
}