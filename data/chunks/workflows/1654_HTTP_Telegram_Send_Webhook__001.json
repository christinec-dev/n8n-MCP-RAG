{
  "source": "1654_HTTP_Telegram_Send_Webhook.json",
  "index": 1,
  "content": "{\n  \"nodes\": [\n    {\n      \"name\": \"Cron\",\n      \"type\": \"n8n-nodes-base.cron\",\n      \"position\": [\n        440,\n        440\n      ],\n      \"parameters\": {\n        \"triggerTimes\": {\n          \"item\": [\n            {}\n          ]\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Airtable2\",\n      \"type\": \"n8n-nodes-base.airtable\",\n      \"notes\": \"Grab our list of chats from Airtable to send a random recipe\",\n      \"position\": [\n        660,\n        440\n      ],\n      \"parameters\": {\n        \"table\": \"Table 1\",\n        \"operation\": \"list\",\n        \"application\": \"your_sheet_id\",\n        \"additionalOptions\": {}\n      },\n      \"credentials\": {\n        \"airtableApi\": {\n          \"id\": \"5\",\n          \"name\": \"Airtable account\"\n        }\n      },\n      \"notesInFlow\": true,\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Set\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        860,\n        600\n      ],\n      \"parameters\": {\n        \"values\": {\n          \"number\": [\n            {\n              \"name\": \"chatid\",\n              \"value\": \"={{$node[\\\"Airtable2\\\"].json[\\\"fields\\\"][\\\"chatid\\\"]}}\"\n            }\n          ],\n          \"string\": []\n        },\n        \"options\": {}\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Recipe Photo\",\n      \"type\": \"n8n-nodes-base.telegram\",\n      \"position\": [\n        1240,\n        440\n      ],\n      \"parameters\": {\n        \"file\": \"={{$node[\\\"Get recipes from API\\\"].json[\\\"recipes\\\"][0][\\\"image\\\"]}}\",\n        \"chatId\": \"={{$node[\\\"Set\\\"].json[\\\"chatid\\\"]}}\",\n        \"operation\": \"sendPhoto\",\n        \"additionalFields\": {}\n      },\n      \"credentials\": {\n        \"telegramApi\": {\n          \"id\": \"1\",\n          \"name\": \"Telegram account\"\n        }\n      },\n      \"typeVersion\": 1,\n      \"continueOnFail\": true\n    },\n    {\n      \"name\": \"Recipe URL\",\n      \"type\": \"n8n-nodes-base.telegram\",\n      \"position\": [\n        1420,\n        440\n      ],\n      \"parameters\": {\n        \"text\": \"=\\n{{$node[\\\"Get recipes from API\\\"].json[\\\"recipes\\\"][0][\\\"title\\\"]}}\\n\\n{{$node[\\\"Get recipes from API\\\"].json[\\\"recipes\\\"][0][\\\"sourceUrl\\\"]}}\",\n        \"chatId\": \"={{$node[\\\"Set\\\"].json[\\\"chatid\\\"]}}\",\n        \"additionalFields\": {}\n      },\n      \"credentials\": {\n        \"telegramApi\": {\n          \"id\": \"1\",\n          \"name\": \"Telegram account\"\n        }\n      },\n      \"typeVersion\": 1,\n      \"continueOnFail\": true\n    },\n    {\n      \"name\": \"IF\",\n      \"type\": \"n8n-nodes-base.if\",\n      \"notes\": \"If the chat ID isn't in our airtable, we add it. This is to send a new recipe daily. \",\n      \"position\": [\n        860,\n        -80\n      ],\n      \"parameters\": {\n        \"conditions\": {\n          \"number\": [],\n          \"string\": [\n            {\n              \"value1\": \"= {{$node[\\\"Airtable1\\\"].parameter[\\\"fields\\\"][1]}}\",\n              \"value2\": \"= {{$node[\\\"Airtable1\\\"].parameter[\\\"fields\\\"][0]}}\",\n              \"operation\": \"notEqual\"\n            }\n          ],\n          \"boolean\": []\n        }\n      },\n      \"notesInFlow\": true,\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Airtable\",\n      \"type\": \"n8n-nodes-base.airtable\",\n      \"position\": [\n        620,\n        -80\n      ],\n      \"parameters\": {\n        \"table\": \"Table 1\",\n        \"operation\": \"list\",\n        \"application\": \"your_sheet_id\",\n        \"additionalOptions\": {}\n      },\n      \"credentials\": {\n        \"airtableApi\": {\n          \"id\": \"5\",\n          \"name\": \"Airtable account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Airtable1\",\n      \"type\": \"n8n-nodes-base.airtable\",\n      \"position\": [\n        1340,\n        -100\n      ],\n      \"parameters\": {\n        \"table\": \"Table 1\",\n        \"fields\": [\n          \"chatid\",\n          \"={{$node[\\\"Telegram Trigger - people join bot\\\"].json[\\\"message\\\"][\\\"chat\\\"][\\\"id\\\"]}}\",\n          \"Name\",\n          \"={{$node[\\\"Telegram Trigger - people join bot\\\"].json[\\\"message\\\"][\\\"from\\\"][\\\"first_name\\\"]}}\"\n        ],\n        \"options\": {},\n        \"operation\": \"append\",\n        \"application\": \"your_sheet_id\",\n        \"addAllFields\": false\n      },\n      \"credentials\": {\n        \"airtableApi\": {\n          \"id\": \"5\",\n          \"name\": \"Airtable account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Telegram Recipe Image\",\n      \"type\": \"n8n-nodes-base.telegram\",\n      \"position\": [\n        980,\n        180\n      ],\n      \"parameters\": {\n        \"file\": \"={{$node[\\\"Get recipes\\\"].json[\\\"recipes\\\"][0][\\\"image\\\"]}}\",\n        \"chatId\": \"={{$node[\\\"Telegram Trigger - people join bot\\\"].json[\\\"message\\\"][\\\"chat\\\"][\\\"id\\\"]}}\",\n        \"operation\": \"sendPhoto\",\n        \"additionalFields\": {}\n      },\n      \"credentials\": {\n        \"telegramApi\": {\n          \"id\": \"1\",\n          \"name\": \"Telegram account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Telegram Recipe URL\",\n      \"type\": \"n8n-nodes-base.telegram\",\n      \"position\": [\n        1180,\n        180\n      ],\n      \"parameters\": {\n        \"text\": \"=\\n{{$node[\\\"Get recipes\\\"].json[\\\"recipes\\\"][0][\\\"title\\\"]}}\\n\\n{{$node[\\\"Get recipes\\\"].json[\\\"recipes\\\"][0][\\\"sourceUrl\\\"]}}\",\n        \"chatId\": \"={{$node[\\\"Telegram Trigger - people join bot\\\"].json[\\\"message\\\"][\\\"chat\\\"][\\\"id\\\"]}}\",\n        \"additionalFields\": {}\n      },\n      \"credentials\": {\n        \"telegramApi\": {\n          \"id\": \"1\",\n          \"name\": \"Telegram account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Set1\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        1120,\n        -100\n      ],\n      \"parameters\": {\n        \"values\": {\n          \"string\": [\n            {\n              \"name\": \"chatid\",\n              \"value\": \"={{$node[\\\"Telegram Trigger - people join bot\\\"].json[\\\"message\\\"][\\\"chat\\\"][\\\"id\\\"]}}\"\n            },\n            {\n              \"name\": \"Name\",\n              \"value\": \"={{$node[\\\"Telegram Trigger - people join bot\\\"].json[\\\"message\\\"][\\\"from\\\"][\\\"first_name\\\"]}}\"\n            }\n          ]\n        },\n        \"options\": {}\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Get recipes from API\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"notes\": \"https://spoonacular.com/food-api/docs\",\n      \"position\": [\n        1080,\n        440\n      ],\n      \"parameters\": {\n        \"url\": \"https://api.spoonacular.com/recipes/random?apiKey=APIKEYHERE&number=1&tags=vegan\",\n        \"options\": {\n          \"fullResponse\": false\n        },\n        \"queryParametersUi\": {\n          \"parameter\": []\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Get recipes\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"notes\": \"https://spoonacular.com/food-api/docs\",\n      \"position\": [\n        800,\n        180\n      ],\n      \"parameters\": {\n        \"url\": \"https://api.spoonacular.com/recipes/random?apiKey=APIKEYHERE&number=1&tags=vegan\",\n        \"options\": {\n          \"fullResponse\": false\n        },\n        \"queryParametersUi\": {\n          \"parameter\": []\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Telegram Trigger - people join bot\",\n      \"type\": \"n8n-nodes-base.telegramTrigger\",\n      \"position\": [\n        420,\n        140\n      ],\n      \"webhookId\": \"your_bot_id\",\n      \"parameters\": {\n        \"updates\": [\n          \"message\"\n        ],\n        \"additionalFields\": {}\n      },\n      \"credentials\": {\n        \"telegramApi\": {\n          \"id\": \"1\",\n          \"name\": \"Telegram account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Telegram - Welcome Message\",\n      \"type\": \"n8n-nodes-base.telegram\",\n      \"position\": [\n        620,\n        180\n      ],\n      \"parameters\": {\n        \"text\": \"=Welcome! This bot will send you one vegan recipe a day. Here is your first recipe!\",\n        \"chatId\": \"={{$node[\\\"Telegram Trigger - people join bot\\\"].json[\\\"message\\\"][\\\"chat\\\"][\\\"id\\\"]}}\",\n        \"additionalFields\": {}\n      },\n      \"credentials\": {\n        \"telegramApi\": {\n          \"id\": \"1\",\n          \"name\": \"Telegram account\"\n        }\n      },\n      \"typeVersion\": 1\n    }\n  ],\n  \"connections\": {\n    \"IF\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Set1\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Set\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Get recipes from API\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Cron\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Airtable2\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Set1\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Airtable1\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Airtable\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"IF\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Airtable2\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Set\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Get recipes\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Telegram Recipe Image\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Recipe Photo\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Recipe URL\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Get recipes from API\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Recipe Photo\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Telegram Recipe Image\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Telegram Recipe URL\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Telegram - Welcome Message\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Get recipes\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Telegram Trigger - people join bot\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Airtable\",\n            \"type\": \"main\",\n            \"index\": 0\n          },\n          {\n            \"node\": \"Telegram - Welcome Message\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}",
  "metadata": {
    "node_types": [
      "n8n-nodes-base.cron",
      "n8n-nodes-base.airtable",
      "n8n-nodes-base.set",
      "n8n-nodes-base.telegram",
      "n8n-nodes-base.telegram",
      "n8n-nodes-base.if",
      "n8n-nodes-base.airtable",
      "n8n-nodes-base.airtable",
      "n8n-nodes-base.telegram",
      "n8n-nodes-base.telegram",
      "n8n-nodes-base.set",
      "n8n-nodes-base.httpRequest",
      "n8n-nodes-base.httpRequest",
      "n8n-nodes-base.telegramTrigger",
      "n8n-nodes-base.telegram"
    ],
    "trigger": "telegram trigger - people join bot"
  }
}