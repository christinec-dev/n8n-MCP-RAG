{
  "source": "1735_Manual_Airtop_Automation_Triggered.json",
  "index": 1,
  "content": "{\n  \"id\": \"ViCY8FzVGcRsxVcK\",\n  \"meta\": {\n    \"instanceId\": \"660cf2c29eb19fa42319afac3bd2a4a74c6354b7c006403f6cba388968b63f5d\",\n    \"templateCredsSetupCompleted\": true\n  },\n  \"name\": \"Sell a Used Car\",\n  \"tags\": [\n    {\n      \"id\": \"a8B9vqj0vNLXcKVQ\",\n      \"name\": \"template\",\n      \"createdAt\": \"2025-04-04T15:38:37.785Z\",\n      \"updatedAt\": \"2025-04-04T15:38:37.785Z\"\n    }\n  ],\n  \"nodes\": [\n    {\n      \"id\": \"282a99b3-986e-4e3e-a673-f100ebcbc7cc\",\n      \"name\": \"When clicking ‘Test workflow’\",\n      \"type\": \"n8n-nodes-base.manualTrigger\",\n      \"position\": [\n        -20,\n        150\n      ],\n      \"parameters\": {},\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"57d4671a-b782-46f1-8987-3100a2841aa4\",\n      \"name\": \"Variables\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        200,\n        150\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"3c71f7f7-072c-47a0-8fa3-67c272d40e1c\",\n              \"name\": \"car_description\",\n              \"type\": \"string\",\n              \"value\": \"VIN: 1FTRF17253NB81140  Milage: 221081  Zip code: 01952  Condition: Perfect, no interior or exterior damages, all tires are inflated, have 2 keys, working battery, has and attached catalytic converter, Airbags not deployed, No flood or fire damage. Ownership: full clean title with no debt answer yes to all other questions\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 3.4\n    },\n    {\n      \"id\": \"5ab2351d-08f5-46b6-b790-3c388572a4ae\",\n      \"name\": \"Wait 7 secs\",\n      \"type\": \"n8n-nodes-base.wait\",\n      \"position\": [\n        1080,\n        150\n      ],\n      \"webhookId\": \"ddb2af85-52a4-4ba0-bdb0-01fa489fe974\",\n      \"parameters\": {\n        \"amount\": 7\n      },\n      \"typeVersion\": 1.1\n    },\n    {\n      \"id\": \"038a36e2-ed4e-4675-b933-3e3564cb8dc0\",\n      \"name\": \"Parse response\",\n      \"type\": \"n8n-nodes-base.code\",\n      \"position\": [\n        1740,\n        -100\n      ],\n      \"parameters\": {\n        \"mode\": \"runOnceForEachItem\",\n        \"jsCode\": \"const sessionId = $json.sessionId\\nconst windowId = $json.windowId\\nconst response = JSON.parse($json.data.modelResponse)\\n\\nreturn { json: {\\n  sessionId,\\n  windowId,\\n  response\\n}}\"\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"1017f269-03ea-4cd6-866c-b91539a05844\",\n      \"name\": \"Switch\",\n      \"type\": \"n8n-nodes-base.switch\",\n      \"position\": [\n        1960,\n        -100\n      ],\n      \"parameters\": {\n        \"rules\": {\n          \"values\": [\n            {\n              \"outputKey\": \"Type\",\n              \"conditions\": {\n                \"options\": {\n                  \"version\": 2,\n                  \"leftValue\": \"\",\n                  \"caseSensitive\": true,\n                  \"typeValidation\": \"strict\"\n                },\n                \"combinator\": \"and\",\n                \"conditions\": [\n                  {\n                    \"id\": \"b35db1bb-6e63-4dee-be52-658d1b78fbbb\",\n                    \"operator\": {\n                      \"type\": \"string\",\n                      \"operation\": \"contains\"\n                    },\n                    \"leftValue\": \"={{ $json.response.action }}\",\n                    \"rightValue\": \"TYPE\"\n                  }\n                ]\n              },\n              \"renameOutput\": true\n            },\n            {\n              \"outputKey\": \"Click\",\n              \"conditions\": {\n                \"options\": {\n                  \"version\": 2,\n                  \"leftValue\": \"\",\n                  \"caseSensitive\": true,\n                  \"typeValidation\": \"strict\"\n                },\n                \"combinator\": \"and\",\n                \"conditions\": [\n                  {\n                    \"id\": \"c4710a65-293c-4df4-a716-3004ae885362\",\n                    \"operator\": {\n                      \"type\": \"string\",\n                      \"operation\": \"contains\"\n                    },\n                    \"leftValue\": \"={{ $json.response.action }}\",\n                    \"rightValue\": \"CLICK\"\n                  }\n                ]\n              },\n              \"renameOutput\": true\n            },\n            {\n              \"outputKey\": \"Got price\",\n              \"conditions\": {\n                \"options\": {\n                  \"version\": 2,\n                  \"leftValue\": \"\",\n                  \"caseSensitive\": true,\n                  \"typeValidation\": \"strict\"\n                },\n                \"combinator\": \"and\",\n                \"conditions\": [\n                  {\n                    \"id\": \"e83a9d67-a55e-4272-9410-6a79e397b291\",\n                    \"operator\": {\n                      \"type\": \"string\",\n                      \"operation\": \"contains\"\n                    },\n                    \"leftValue\": \"={{ $json.response.action }}\",\n                    \"rightValue\": \"PRICE\"\n                  }\n                ]\n              },\n              \"renameOutput\": true\n            }\n          ]\n        },\n        \"options\": {}\n      },\n      \"typeVersion\": 3.2\n    },\n    {\n      \"id\": \"a0c966af-1555-4837-a700-d2ebdc0628fa\",\n      \"name\": \"Offer received\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        2180,\n        200\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"0b75e600-36e1-4d31-bd6a-0cb9955611fc\",\n              \"name\": \"Offer_price\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.response.question }}\"\n            },\n            {\n              \"id\": \"5f13d212-852c-466a-97fb-d776491b06ea\",\n              \"name\": \"Offer_id\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.response.element }}\"\n            },\n            {\n              \"id\": \"af0e7609-85e2-4243-a1b1-52627783fbea\",\n              \"name\": \"Offer_URL\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.response.text }}\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 3.4\n    },\n    {\n      \"id\": \"a0a4c48a-568b-4ad4-9e18-a7e1167d2b06\",\n      \"name\": \"Type\",\n      \"type\": \"n8n-nodes-base.airtop\",\n      \"onError\": \"continueRegularOutput\",\n      \"position\": [\n        2180,\n        -200\n      ],\n      \"parameters\": {\n        \"text\": \"={{ $json.response.text }}\",\n        \"resource\": \"interaction\",\n        \"operation\": \"type\",\n        \"pressEnterKey\": true,\n        \"additionalFields\": {\n          \"visualScope\": \"viewport\"\n        },\n        \"elementDescription\": \"={{ $json.response.element }}\"\n      },\n      \"credentials\": {\n        \"airtopApi\": {\n          \"id\": \"byhouJF8RLH5DkmY\",\n          \"name\": \"[PROD] Airtop\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"3dfe1739-0c68-4d66-96f0-ee6999cf7cbb\",\n      \"name\": \"Click\",\n      \"type\": \"n8n-nodes-base.airtop\",\n      \"onError\": \"continueRegularOutput\",\n      \"position\": [\n        2180,\n        0\n      ],\n      \"parameters\": {\n        \"resource\": \"interaction\",\n        \"additionalFields\": {\n          \"visualScope\": \"viewport\"\n        },\n        \"elementDescription\": \"={{ $json.response.element }}\"\n      },\n      \"credentials\": {\n        \"airtopApi\": {\n          \"id\": \"byhouJF8RLH5DkmY\",\n          \"name\": \"[PROD] Airtop\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"058544cb-a5d0-4e9d-bc95-a351a7432f09\",\n      \"name\": \"Create session\",\n      \"type\": \"n8n-nodes-base.airtop\",\n      \"position\": [\n        420,\n        150\n      ],\n      \"parameters\": {},\n      \"credentials\": {\n        \"airtopApi\": {\n          \"id\": \"byhouJF8RLH5DkmY\",\n          \"name\": \"[PROD] Airtop\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"0418f412-c5e0-409c-93a6-45b281034711\",\n      \"name\": \"Load website\",\n      \"type\": \"n8n-nodes-base.airtop\",\n      \"position\": [\n        640,\n        150\n      ],\n      \"parameters\": {\n        \"url\": \"https://sell.peddle.com/instant-offer\",\n        \"resource\": \"window\",\n        \"additionalFields\": {\n          \"waitUntil\": \"domContentLoaded\"\n        }\n      },\n      \"credentials\": {\n        \"airtopApi\": {\n          \"id\": \"byhouJF8RLH5DkmY\",\n          \"name\": \"[PROD] Airtop\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"39fdcead-1709-4648-8660-575055e82284\",\n      \"name\": \"Click VIN button\",\n      \"type\": \"n8n-nodes-base.airtop\",\n      \"position\": [\n        860,\n        150\n      ],\n      \"parameters\": {\n        \"resource\": \"interaction\",\n        \"additionalFields\": {},\n        \"elementDescription\": \"Rounded white button \\\"Autofill with VIN\\\"\"\n      },\n      \"credentials\": {\n        \"airtopApi\": {\n          \"id\": \"byhouJF8RLH5DkmY\",\n          \"name\": \"[PROD] Airtop\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"74f40e8f-e6cd-4738-b98a-6871c1d75654\",\n      \"name\": \"Terminate session\",\n      \"type\": \"n8n-nodes-base.airtop\",\n      \"position\": [\n        2400,\n        200\n      ],\n      \"parameters\": {\n        \"operation\": \"terminate\",\n        \"sessionId\": \"={{ $('Create session').last().json.sessionId }}\"\n      },\n      \"credentials\": {\n        \"airtopApi\": {\n          \"id\": \"byhouJF8RLH5DkmY\",\n          \"name\": \"[PROD] Airtop\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"777542c9-c926-4d06-ad8a-2a0c43258a7d\",\n      \"name\": \"Take screenshot\",\n      \"type\": \"n8n-nodes-base.airtop\",\n      \"notes\": \"Useful to validate the current screen the agent is on\",\n      \"position\": [\n        1300,\n        -100\n      ],\n      \"parameters\": {\n        \"resource\": \"window\",\n        \"operation\": \"takeScreenshot\"\n      },\n      \"credentials\": {\n        \"airtopApi\": {\n          \"id\": \"byhouJF8RLH5DkmY\",\n          \"name\": \"[PROD] Airtop\"\n        }\n      },\n      \"notesInFlow\": true,\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"e5442c98-7382-45ef-b810-c4b8ae4cf999\",\n      \"name\": \"Think next action\",\n      \"type\": \"n8n-nodes-base.airtop\",\n      \"position\": [\n        1520,\n        -100\n      ],\n      \"parameters\": {\n        \"prompt\": \"=You are trying to get an estimate for a used car price or a purchase offer. Your task is to answer the main question presented to the user on this screen, based on the car information below, until you will get a price estimate or offer to purchase (\\\"We'd love to buy your car...\\\"). \\n\\nReview this page:\\nIf there is a question, extract the main question presented to the user on this screen. Return your answer in the following format:\\nQuestion: the main question presented to the user on this screen\\nAction: <CLICK> or <TYPE>\\nElement: description of the text box to type in or button to click, for example VIN text box or Yes button\\nText: <Text to type> (if TYPE operation)\\n\\nIf the page includes the price estimate or offer to purchase, extract the price (offer_price), the offer ID (offer_id) and current page URL (page_url) and return the following:\\nQuestion:  <offer_price>\\nAction: <PRICE>\\nElement: <offer_id>\\nText: <page_url>\\n\\nIf there is no price estimate or offer to purchase and the Next button at the bottom is yellow and clickable, return the following:\\nQuestion:  <Next>\\nAction: <CLIICK>\\nElement: Yellow Next Button at the bottom\\nText: \\n\\nHere's the info about the car: \\n{{ $('Variables').item.json.car_description }}\",\n        \"resource\": \"extraction\",\n        \"operation\": \"query\",\n        \"additionalFields\": {\n          \"outputSchema\": \"{\\n  \\\"type\\\": \\\"object\\\",\\n  \\\"properties\\\": {\\n    \\\"question\\\": {\\n      \\\"type\\\": \\\"string\\\",\\n      \\\"description\\\": \\\"The main question presented to the user on the screen.\\\"\\n    },\\n    \\\"action\\\": {\\n      \\\"type\\\": \\\"string\\\",\\n      \\\"description\\\": \\\"The action to be performed, either clicking a button or typing in a text box.\\\"\\n    },\\n    \\\"element\\\": {\\n      \\\"type\\\": \\\"string\\\",\\n      \\\"description\\\": \\\"Description of the text box to type in or button to click.\\\"\\n    },\\n    \\\"text\\\": {\\n      \\\"type\\\": \\\"string\\\",\\n      \\\"description\\\": \\\"Text to type if the action is TYPE.\\\"\\n    }\\n  },\\n  \\\"required\\\": [\\n    \\\"question\\\",\\n    \\\"action\\\",\\n    \\\"element\\\",\\n    \\\"text\\\"\\n  ],\\n  \\\"additionalProperties\\\": false,\\n  \\\"$schema\\\": \\\"http://json-schema.org/draft-07/schema#\\\"\\n}\",\n          \"includeVisualAnalysis\": true\n        }\n      },\n      \"credentials\": {\n        \"airtopApi\": {\n          \"id\": \"byhouJF8RLH5DkmY\",\n          \"name\": \"[PROD] Airtop\"\n        }\n      },\n      \"typeVersion\": 1\n    }\n  ],\n  \"active\": false,\n  \"pinData\": {},\n  \"settings\": {\n    \"executionOrder\": \"v1\"\n  },\n  \"versionId\": \"7ad89f7e-cdbc-4ec4-b5a9-cc724677be15\",\n  \"connections\": {\n    \"Type\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Wait 7 secs\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Click\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Wait 7 secs\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Switch\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Type\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Click\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Offer received\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Variables\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Create session\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Wait 7 secs\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Take screenshot\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Load website\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Click VIN button\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Create session\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Load website\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Offer received\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Terminate session\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Parse response\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Switch\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Take screenshot\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Think next action\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Click VIN button\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Wait 7 secs\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Think next action\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Parse response\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"When clicking ‘Test workflow’\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Variables\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}",
  "metadata": {
    "node_types": [
      "n8n-nodes-base.manualTrigger",
      "n8n-nodes-base.set",
      "n8n-nodes-base.wait",
      "n8n-nodes-base.code",
      "n8n-nodes-base.switch",
      "n8n-nodes-base.set",
      "n8n-nodes-base.airtop",
      "n8n-nodes-base.airtop",
      "n8n-nodes-base.airtop",
      "n8n-nodes-base.airtop",
      "n8n-nodes-base.airtop",
      "n8n-nodes-base.airtop",
      "n8n-nodes-base.airtop",
      "n8n-nodes-base.airtop"
    ],
    "trigger": null
  }
}