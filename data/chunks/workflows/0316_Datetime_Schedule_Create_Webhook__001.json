{
  "source": "0316_Datetime_Schedule_Create_Webhook.json",
  "index": 1,
  "content": "{\n  \"meta\": {\n    \"instanceId\": \"a2434c94d549548a685cca39cc4614698e94f527bcea84eefa363f1037ae14cd\"\n  },\n  \"nodes\": [\n    {\n      \"id\": \"713d2864-efd0-4938-871e-1d37a7c58b67\",\n      \"name\": \"On schedule\",\n      \"type\": \"n8n-nodes-base.scheduleTrigger\",\n      \"position\": [\n        1280,\n        840\n      ],\n      \"parameters\": {\n        \"rule\": {\n          \"interval\": [\n            {\n              \"field\": \"minutes\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 1.1\n    },\n    {\n      \"id\": \"0cedfde1-6ae1-485c-bd2c-b6114f6e4deb\",\n      \"name\": \"Try get database page\",\n      \"type\": \"n8n-nodes-base.notion\",\n      \"position\": [\n        2160,\n        900\n      ],\n      \"parameters\": {\n        \"filters\": {\n          \"conditions\": [\n            {\n              \"key\": \"Event ID|rich_text\",\n              \"condition\": \"equals\",\n              \"richTextValue\": \"={{ $json.id }}\"\n            }\n          ]\n        },\n        \"options\": {},\n        \"resource\": \"databasePage\",\n        \"operation\": \"getAll\",\n        \"returnAll\": true,\n        \"databaseId\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"6318457d-052d-4107-9c5b-8041f530fa03\",\n          \"cachedResultUrl\": \"https://www.notion.so/6318457d052d41079c5b8041f530fa03\",\n          \"cachedResultName\": \"Outlook Calendar\"\n        },\n        \"filterType\": \"manual\"\n      },\n      \"credentials\": {\n        \"notionApi\": {\n          \"id\": \"18\",\n          \"name\": \"[UPDATE ME]\"\n        }\n      },\n      \"typeVersion\": 2,\n      \"alwaysOutputData\": true\n    },\n    {\n      \"id\": \"92ebdd55-0950-471c-aa44-2fed31b17870\",\n      \"name\": \"Merge\",\n      \"type\": \"n8n-nodes-base.merge\",\n      \"position\": [\n        2380,\n        780\n      ],\n      \"parameters\": {\n        \"mode\": \"combine\",\n        \"options\": {},\n        \"joinMode\": \"enrichInput1\",\n        \"mergeByFields\": {\n          \"values\": [\n            {\n              \"field1\": \"id\",\n              \"field2\": \"property_event_id\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 2.1\n    },\n    {\n      \"id\": \"d38e4228-b3ab-443f-bfac-ffd0bc10fd08\",\n      \"name\": \"If database page not found\",\n      \"type\": \"n8n-nodes-base.if\",\n      \"position\": [\n        2600,\n        840\n      ],\n      \"parameters\": {\n        \"conditions\": {\n          \"string\": [\n            {\n              \"value1\": \"={{ $json.property_event_id }}\",\n              \"operation\": \"isEmpty\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"6ef0f18c-51fe-42e7-9e42-fd6ca8564e6e\",\n      \"name\": \"Create database page\",\n      \"type\": \"n8n-nodes-base.notion\",\n      \"position\": [\n        2820,\n        740\n      ],\n      \"parameters\": {\n        \"title\": \"={{ $json.subject }}\",\n        \"options\": {\n          \"icon\": \"https://avatars.githubusercontent.com/u/45487711?s=280&v=4\",\n          \"iconType\": \"file\"\n        },\n        \"resource\": \"databasePage\",\n        \"databaseId\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"6318457d-052d-4107-9c5b-8041f530fa03\",\n          \"cachedResultUrl\": \"https://www.notion.so/6318457d052d41079c5b8041f530fa03\",\n          \"cachedResultName\": \"Outlook Calendar\"\n        },\n        \"propertiesUi\": {\n          \"propertyValues\": [\n            {\n              \"key\": \"Date|date\",\n              \"range\": true,\n              \"dateEnd\": \"={{ $json.end.dateTime }}\",\n              \"timezone\": \"={{ $json.start.timeZone }}\",\n              \"dateStart\": \"={{ $json.start.dateTime }}\"\n            },\n            {\n              \"key\": \"Event ID|rich_text\",\n              \"textContent\": \"={{ $json.id }}\"\n            },\n            {\n              \"key\": \"Link|url\",\n              \"urlValue\": \"={{ $json.webLink }}\"\n            }\n          ]\n        }\n      },\n      \"credentials\": {\n        \"notionApi\": {\n          \"id\": \"18\",\n          \"name\": \"[UPDATE ME]\"\n        }\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"2d324002-348b-4f23-bffe-57f685a8a761\",\n      \"name\": \"Update database page\",\n      \"type\": \"n8n-nodes-base.notion\",\n      \"position\": [\n        2820,\n        940\n      ],\n      \"parameters\": {\n        \"pageId\": {\n          \"__rl\": true,\n          \"mode\": \"id\",\n          \"value\": \"={{ $json.id }}\"\n        },\n        \"resource\": \"databasePage\",\n        \"operation\": \"update\",\n        \"propertiesUi\": {\n          \"propertyValues\": [\n            {\n              \"key\": \"Date|date\",\n              \"range\": true,\n              \"dateEnd\": \"={{ $json.end.dateTime }}\",\n              \"timezone\": \"={{ $json.start.timeZone }}\",\n              \"dateStart\": \"={{ $json.start.dateTime }}\"\n            },\n            {\n              \"key\": \"Link|url\",\n              \"urlValue\": \"={{ $json.webLink }}\"\n            },\n            {\n              \"key\": \"Name|title\",\n              \"title\": \"={{ $json.subject }}\"\n            }\n          ]\n        }\n      },\n      \"credentials\": {\n        \"notionApi\": {\n          \"id\": \"18\",\n          \"name\": \"[UPDATE ME]\"\n        }\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"ee4792c4-d71c-4fd3-a8a3-babae5ff3479\",\n      \"name\": \"X days into the future\",\n      \"type\": \"n8n-nodes-base.dateTime\",\n      \"position\": [\n        1500,\n        840\n      ],\n      \"parameters\": {\n        \"duration\": 365,\n        \"magnitude\": \"={{ $json.timestamp }}\",\n        \"operation\": \"addToDate\",\n        \"outputFieldName\": \"Future date\"\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"00b53a21-97c7-4293-a5eb-8321afddd4bc\",\n      \"name\": \"Split out items\",\n      \"type\": \"n8n-nodes-base.itemLists\",\n      \"position\": [\n        1940,\n        840\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"fieldToSplitOut\": \"value\"\n      },\n      \"typeVersion\": 2.2\n    },\n    {\n      \"id\": \"a7541bb9-0c0d-48b5-a39e-57e5681330da\",\n      \"name\": \"Get Outlook Calendar events\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        1720,\n        840\n      ],\n      \"parameters\": {\n        \"url\": \"https://graph.microsoft.com/v1.0/me/calendarview\",\n        \"options\": {},\n        \"sendQuery\": true,\n        \"authentication\": \"genericCredentialType\",\n        \"genericAuthType\": \"oAuth2Api\",\n        \"queryParameters\": {\n          \"parameters\": [\n            {\n              \"name\": \"startdatetime\",\n              \"value\": \"={{ new Date($('On schedule').item.json.timestamp).toISOString() }}\"\n            },\n            {\n              \"name\": \"enddatetime\",\n              \"value\": \"={{ new Date($json['Future date']).toISOString() }}\"\n            }\n          ]\n        }\n      },\n      \"credentials\": {\n        \"oAuth2Api\": {\n          \"id\": \"dxBfWhTrnERPMHGs\",\n          \"name\": \"REPLACE ME\"\n        }\n      },\n      \"typeVersion\": 4.1\n    }\n  ],\n  \"connections\": {\n    \"Merge\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"If database page not found\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"On schedule\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"X days into the future\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Split out items\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Merge\",\n            \"type\": \"main\",\n            \"index\": 0\n          },\n          {\n            \"node\": \"Try get database page\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Try get database page\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Merge\",\n            \"type\": \"main\",\n            \"index\": 1\n          }\n        ]\n      ]\n    },\n    \"X days into the future\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Get Outlook Calendar events\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"If database page not found\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Create database page\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Update database page\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Get Outlook Calendar events\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Split out items\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}",
  "metadata": {
    "node_types": [
      "n8n-nodes-base.scheduleTrigger",
      "n8n-nodes-base.notion",
      "n8n-nodes-base.merge",
      "n8n-nodes-base.if",
      "n8n-nodes-base.notion",
      "n8n-nodes-base.notion",
      "n8n-nodes-base.dateTime",
      "n8n-nodes-base.itemLists",
      "n8n-nodes-base.httpRequest"
    ],
    "trigger": null
  }
}