{
  "source": "0935_HTTP_GoogleSheets_Sync_Webhook.json",
  "index": 1,
  "content": "{\n  \"id\": \"3\",\n  \"name\": \"Clockify to Syncro\",\n  \"nodes\": [\n    {\n      \"name\": \"Webhook\",\n      \"type\": \"n8n-nodes-base.webhook\",\n      \"position\": [\n        280,\n        350\n      ],\n      \"webhookId\": \"82b654d7-aeb2-4cc1-97a8-0ebd1a729202\",\n      \"parameters\": {\n        \"path\": \"82b654d7-aeb2-4cc1-97a8-0ebd1a729202\",\n        \"options\": {},\n        \"httpMethod\": \"POST\",\n        \"responseData\": \"allEntries\",\n        \"responseMode\": \"lastNode\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Google Sheets\",\n      \"type\": \"n8n-nodes-base.googleSheets\",\n      \"position\": [\n        1830,\n        350\n      ],\n      \"parameters\": {\n        \"range\": \"A:B\",\n        \"options\": {\n          \"valueInputMode\": \"USER_ENTERED\"\n        },\n        \"sheetId\": \"xxx\",\n        \"operation\": \"append\"\n      },\n      \"credentials\": {\n        \"googleApi\": \"Google\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"ForGoogle\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        1650,\n        350\n      ],\n      \"parameters\": {\n        \"values\": {\n          \"string\": [\n            {\n              \"name\": \"Syncro\",\n              \"value\": \"={{$json[\\\"id\\\"]}}\"\n            },\n            {\n              \"name\": \"Clockify\",\n              \"value\": \"={{$node[\\\"Webhook\\\"].json[\\\"body\\\"][\\\"id\\\"]}}\"\n            }\n          ]\n        },\n        \"options\": {},\n        \"keepOnlySet\": true\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"ForSyncro\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        730,\n        350\n      ],\n      \"parameters\": {\n        \"values\": {\n          \"string\": [\n            {\n              \"name\": \"id\",\n              \"value\": \"={{ $json[\\\"body\\\"][\\\"project\\\"][\\\"name\\\"].match(/\\\\[(\\\\d+)]/)[1] }}\"\n            }\n          ]\n        },\n        \"options\": {},\n        \"keepOnlySet\": true\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"FindMatch\",\n      \"type\": \"n8n-nodes-base.googleSheets\",\n      \"position\": [\n        1130,\n        350\n      ],\n      \"parameters\": {\n        \"range\": \"A:B\",\n        \"options\": {\n          \"valueRenderMode\": \"UNFORMATTED_VALUE\",\n          \"returnAllMatches\": true\n        },\n        \"sheetId\": \"xxx\",\n        \"operation\": \"lookup\",\n        \"lookupValue\": \"={{$node[\\\"Webhook\\\"].json[\\\"body\\\"][\\\"id\\\"]}}\",\n        \"lookupColumn\": \"=Clockify\"\n      },\n      \"credentials\": {\n        \"googleApi\": \"Google\"\n      },\n      \"typeVersion\": 1,\n      \"alwaysOutputData\": true\n    },\n    {\n      \"name\": \"IF\",\n      \"type\": \"n8n-nodes-base.if\",\n      \"position\": [\n        1300,\n        350\n      ],\n      \"parameters\": {\n        \"conditions\": {\n          \"string\": [],\n          \"boolean\": [\n            {\n              \"value1\": \"={{!!Object.keys($node[\\\"FindMatch\\\"].data).length}}\",\n              \"value2\": true\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 1,\n      \"alwaysOutputData\": false\n    },\n    {\n      \"name\": \"NewSyncroTimer\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        1490,\n        350\n      ],\n      \"parameters\": {\n        \"url\": \"={{$node[\\\"EnvVariables\\\"].json[\\\"syncro_baseurl\\\"]}}/api/v1/tickets/{{$node[\\\"ForSyncro\\\"].json[\\\"id\\\"]}}/timer_entry\",\n        \"options\": {},\n        \"requestMethod\": \"POST\",\n        \"authentication\": \"headerAuth\",\n        \"bodyParametersUi\": {\n          \"parameter\": [\n            {\n              \"name\": \"start_at\",\n              \"value\": \"={{$node[\\\"Webhook\\\"].json[\\\"body\\\"][\\\"timeInterval\\\"][\\\"start\\\"]}}\"\n            },\n            {\n              \"name\": \"end_at\",\n              \"value\": \"={{$node[\\\"Webhook\\\"].json[\\\"body\\\"][\\\"timeInterval\\\"][\\\"end\\\"]}}\"\n            },\n            {\n              \"name\": \"notes\",\n              \"value\": \"={{$node[\\\"Webhook\\\"].json[\\\"body\\\"][\\\"description\\\"]}}\"\n            },\n            {\n              \"name\": \"user_id\",\n              \"value\": \"={{$node[\\\"MatchTechnician\\\"].json[\\\"id\\\"]}}\"\n            }\n          ]\n        }\n      },\n      \"credentials\": {\n        \"httpHeaderAuth\": \"Syncro\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"UpdateSyncroTimer\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        1490,\n        580\n      ],\n      \"parameters\": {\n        \"url\": \"={{$node[\\\"EnvVariables\\\"].json[\\\"syncro_baseurl\\\"]}}/api/v1/tickets/{{$node[\\\"ForSyncro\\\"].json[\\\"id\\\"]}}/update_timer_entry\",\n        \"options\": {\n          \"followRedirect\": true\n        },\n        \"requestMethod\": \"PUT\",\n        \"authentication\": \"headerAuth\",\n        \"bodyParametersUi\": {\n          \"parameter\": [\n            {\n              \"name\": \"timer_entry_id\",\n              \"value\": \"={{$node[\\\"IF\\\"].json[\\\"Syncro\\\"]}}\"\n            },\n            {\n              \"name\": \"start_time\",\n              \"value\": \"={{$node[\\\"Webhook\\\"].json[\\\"body\\\"][\\\"timeInterval\\\"][\\\"start\\\"]}}\"\n            },\n            {\n              \"name\": \"end_time\",\n              \"value\": \"={{$node[\\\"Webhook\\\"].json[\\\"body\\\"][\\\"timeInterval\\\"][\\\"end\\\"]}}\"\n            },\n            {\n              \"name\": \"notes\",\n              \"value\": \"={{$node[\\\"Webhook\\\"].json[\\\"body\\\"][\\\"description\\\"]}}\"\n            },\n            {\n              \"name\": \"user_id\",\n              \"value\": \"={{$node[\\\"MatchTechnician\\\"].json[\\\"id\\\"]}}\"\n            }\n          ]\n        }\n      },\n      \"credentials\": {\n        \"httpHeaderAuth\": \"Syncro\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"EnvVariables\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        580,\n        350\n      ],\n      \"parameters\": {\n        \"values\": {\n          \"string\": [\n            {\n              \"name\": \"syncro_baseurl\",\n              \"value\": \"https://subdomain.syncromsp.com\"\n            }\n          ]\n        },\n        \"options\": {}\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"SetTechnicians\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        870,\n        350\n      ],\n      \"parameters\": {\n        \"values\": {\n          \"string\": [\n            {\n              \"name\": \"Tech 1\",\n              \"value\": \"1234\"\n            },\n            {\n              \"name\": \"Tech 2\",\n              \"value\": \"5678\"\n            }\n          ]\n        },\n        \"options\": {},\n        \"keepOnlySet\": true\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"MatchTechnician\",\n      \"type\": \"n8n-nodes-base.function\",\n      \"position\": [\n        1000,\n        350\n      ],\n      \"parameters\": {\n        \"functionCode\": \"\\nconst results = [];\\n\\nconst user = $node[\\\"Webhook\\\"].json[\\\"body\\\"][\\\"user\\\"];\\n\\nconst persons = items[0].json\\n\\nfor (key of Object.keys(persons)) {\\n  if (key === user.name) {\\n    results.push({ json: { id: persons[key], name: key } })\\n  }\\n}\\n\\nreturn results;\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"IF1\",\n      \"type\": \"n8n-nodes-base.if\",\n      \"position\": [\n        420,\n        350\n      ],\n      \"parameters\": {\n        \"conditions\": {\n          \"string\": [\n            {\n              \"value1\": \"={{$json[\\\"body\\\"][\\\"project\\\"][\\\"name\\\"]}}\",\n              \"value2\": \"Ticket\",\n              \"operation\": \"contains\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"NoOp\",\n      \"type\": \"n8n-nodes-base.noOp\",\n      \"position\": [\n        480,\n        520\n      ],\n      \"parameters\": {},\n      \"typeVersion\": 1\n    }\n  ],\n  \"active\": true,\n  \"settings\": {},\n  \"connections\": {\n    \"IF\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"UpdateSyncroTimer\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"NewSyncroTimer\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"IF1\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"EnvVariables\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"NoOp\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Webhook\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"IF1\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"FindMatch\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"IF\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"ForGoogle\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Google Sheets\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"ForSyncro\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"SetTechnicians\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"EnvVariables\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"ForSyncro\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"NewSyncroTimer\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"ForGoogle\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"SetTechnicians\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"MatchTechnician\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"MatchTechnician\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"FindMatch\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}",
  "metadata": {
    "node_types": [
      "n8n-nodes-base.webhook",
      "n8n-nodes-base.googleSheets",
      "n8n-nodes-base.set",
      "n8n-nodes-base.set",
      "n8n-nodes-base.googleSheets",
      "n8n-nodes-base.if",
      "n8n-nodes-base.httpRequest",
      "n8n-nodes-base.httpRequest",
      "n8n-nodes-base.set",
      "n8n-nodes-base.set",
      "n8n-nodes-base.function",
      "n8n-nodes-base.if",
      "n8n-nodes-base.noOp"
    ],
    "trigger": null
  }
}