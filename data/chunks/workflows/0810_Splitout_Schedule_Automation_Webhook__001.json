{
  "source": "0810_Splitout_Schedule_Automation_Webhook.json",
  "index": 1,
  "content": "{\n  \"meta\": {\n    \"instanceId\": \"e634e668fe1fc93a75c4f2a7fc0dad807ca318b79654157eadb9578496acbc76\"\n  },\n  \"nodes\": [\n    {\n      \"id\": \"754006f5-1a7e-4e29-9850-e38b1d0c0d09\",\n      \"name\": \"On clicking 'execute'\",\n      \"type\": \"n8n-nodes-base.manualTrigger\",\n      \"position\": [\n        360,\n        80\n      ],\n      \"parameters\": {},\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"6b7b0d05-38cc-4c2d-8a71-874ff5ad29d9\",\n      \"name\": \"Split Out Order \",\n      \"type\": \"n8n-nodes-base.splitOut\",\n      \"position\": [\n        1080,\n        200\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"fieldToSplitOut\": \"result\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"1494f1ff-f377-4d56-8da7-274f0c182588\",\n      \"name\": \"Globals\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        600,\n        200\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"7411b768-9861-414c-aeaa-2743b3d61a3b\",\n              \"name\": \"api-version\",\n              \"type\": \"string\",\n              \"value\": \"1.0\"\n            },\n            {\n              \"id\": \"6cf546c5-5737-4dbd-851b-17d68e0a3780\",\n              \"name\": \"modifiedAfter\",\n              \"type\": \"string\",\n              \"value\": \"\"\n            },\n            {\n              \"id\": \"452efa28-2dc6-4ea3-a7a2-c35d100d0382\",\n              \"name\": \"modifiedBefore\",\n              \"type\": \"string\",\n              \"value\": \"\"\n            },\n            {\n              \"id\": \"81c4dc54-86bf-4432-a23f-22c7ea831e74\",\n              \"name\": \"cursor\",\n              \"type\": \"string\",\n              \"value\": \"\"\n            },\n            {\n              \"id\": \"fa31a552-0d2d-4eb3-8476-44024e1fdc81\",\n              \"name\": \"fulfillmentStatus\",\n              \"type\": \"string\",\n              \"value\": \"PENDING\"\n            },\n            {\n              \"id\": \"489ff3e6-7bc3-4940-9312-e4ace8e1db9f\",\n              \"name\": \"maxPage\",\n              \"type\": \"number\",\n              \"value\": -1\n            }\n          ]\n        }\n      },\n      \"notesInFlow\": true,\n      \"typeVersion\": 3.4\n    },\n    {\n      \"id\": \"01557e82-9f89-4030-af0f-6663ea945191\",\n      \"name\": \"Sticky Note3\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        540,\n        80\n      ],\n      \"parameters\": {\n        \"color\": 4,\n        \"width\": 150,\n        \"height\": 80,\n        \"content\": \"## Edit this node ðŸ‘‡\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"9d9d361a-dd12-4c57-9f76-7c4738b5af1e\",\n      \"name\": \"Schedule Trigger\",\n      \"type\": \"n8n-nodes-base.scheduleTrigger\",\n      \"position\": [\n        360,\n        340\n      ],\n      \"parameters\": {\n        \"rule\": {\n          \"interval\": [\n            {}\n          ]\n        }\n      },\n      \"typeVersion\": 1.2\n    },\n    {\n      \"id\": \"a3e41614-ca4e-4730-a4ab-1e9933ef71d5\",\n      \"name\": \"Sticky Note\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        0,\n        0\n      ],\n      \"parameters\": {\n        \"width\": 320,\n        \"height\": 660,\n        \"content\": \"## Squarespace Fulfillment Automation with n8n\\nRetrieves all Squarespace Orders and mark them as fulfilled automatically Squarespace Commerce API\\n\\n### Setup\\nOpen `Globals` node and update the values below ðŸ‘‡\\n\\n- **api-version** (string, required) â€“ The current API version (see Squarespace Orders API documentation).\\n- **modifiedAfter**={a-datetime} (string, conditional) â€“ Fetch orders modified after a specific date (ISO 8601 format).\\n- **modifiedBefore**={b-datetime} (string, conditional) â€“ Fetch orders modified before a specific date (ISO 8601 format).\\n- **cursor**={c} (string, conditional) â€“ Used for pagination, cannot be combined with other filters.\\n- **fulfillmentStatus**: PENDING, FULFILLED, or CANCELED.\\n- **maxPage** â€“ Set -1 to enables infinite pagination to fetch all available orders.\\n\\n\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"bc78dac5-3fa9-4b65-a5c3-2196ed53a81c\",\n      \"name\": \"Query pending Orders\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        840,\n        200\n      ],\n      \"parameters\": {\n        \"url\": \"=https://api.squarespace.com/{{ $json[\\\"api-version\\\"] }}/commerce/orders\",\n        \"options\": {\n          \"pagination\": {\n            \"pagination\": {\n              \"parameters\": {\n                \"parameters\": [\n                  {\n                    \"name\": \"cursor\",\n                    \"value\": \"={{ $response.body.pagination.nextPageCursor }}\"\n                  }\n                ]\n              },\n              \"maxRequests\": \"={{ $json.maxPage === -1 ? Infinity : $json.maxPage }}\",\n              \"limitPagesFetched\": true,\n              \"completeExpression\": \"={{ !$response.body.pagination.nextPageCursor }}\",\n              \"paginationCompleteWhen\": \"other\"\n            }\n          }\n        },\n        \"sendQuery\": true,\n        \"authentication\": \"genericCredentialType\",\n        \"genericAuthType\": \"httpHeaderAuth\",\n        \"queryParameters\": {\n          \"parameters\": [\n            {\n              \"name\": \"modifiedAfter\",\n              \"value\": \"={{ $json.modifiedAfter }}\"\n            },\n            {\n              \"name\": \"=modifiedBefore\",\n              \"value\": \"={{ $json.modifiedBefore }}\"\n            },\n            {\n              \"name\": \"cursor\",\n              \"value\": \"={{ $json.cursor }}\"\n            },\n            {\n              \"name\": \"=fulfillmentStatus\",\n              \"value\": \"={{ $json.fulfillmentStatus }}\"\n            }\n          ]\n        }\n      },\n      \"credentials\": {\n        \"oAuth2Api\": {\n          \"id\": \"5eAFOixVzslPr99y\",\n          \"name\": \"Squarespace OAuth 2.0\"\n        },\n        \"httpHeaderAuth\": {\n          \"id\": \"iiLmD473RYjGLbCA\",\n          \"name\": \"Squarespace API key - Apps script\"\n        }\n      },\n      \"typeVersion\": 4.2\n    },\n    {\n      \"id\": \"a5723a03-41d1-49a9-9baa-c7482fdf82a3\",\n      \"name\": \"Loop Over Items\",\n      \"type\": \"n8n-nodes-base.splitInBatches\",\n      \"position\": [\n        1640,\n        200\n      ],\n      \"parameters\": {\n        \"options\": {}\n      },\n      \"typeVersion\": 3\n    },\n    {\n      \"id\": \"7e656389-ca9c-4ff4-9db1-68f84a13e605\",\n      \"name\": \"Fulfill Order\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        1940,\n        200\n      ],\n      \"parameters\": {\n        \"url\": \"=https://api.squarespace.com/{{ $('Globals').item.json[\\\"api-version\\\"] }}/commerce/orders/{{ $('Filter Orders').item.json.id }}/fulfillments\",\n        \"method\": \"POST\",\n        \"options\": {},\n        \"jsonBody\": \"{\\n  \\\"shouldSendNotification\\\": true\\n}\",\n        \"sendBody\": true,\n        \"specifyBody\": \"json\",\n        \"authentication\": \"genericCredentialType\",\n        \"genericAuthType\": \"oAuth2Api\"\n      },\n      \"credentials\": {\n        \"oAuth2Api\": {\n          \"id\": \"5eAFOixVzslPr99y\",\n          \"name\": \"Squarespace OAuth 2.0\"\n        },\n        \"httpHeaderAuth\": {\n          \"id\": \"iiLmD473RYjGLbCA\",\n          \"name\": \"Squarespace API key - Apps script\"\n        }\n      },\n      \"typeVersion\": 4.2\n    },\n    {\n      \"id\": \"b14b6db8-a027-41c2-a030-aa09b0003d73\",\n      \"name\": \"Sticky Note4\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        1880,\n        0\n      ],\n      \"parameters\": {\n        \"width\": 232,\n        \"height\": 346,\n        \"content\": \"## Create fulfillment  ðŸ‘‡\\n\\n[Fulfill an order](https://developers.squarespace.com/commerce-apis/fulfill-order)\\n- `shouldSendNotification` to send notifications to customer\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"effd0876-0003-4e3f-ad61-cfe3d4391e67\",\n      \"name\": \"Sticky Note1\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        1280,\n        -80\n      ],\n      \"parameters\": {\n        \"height\": 440,\n        \"content\": \"## Filtering orders for fulfillment ðŸ‘‡\\nFilter the valid orders for programatically fulfillments\\n\\n- you exclusively sell digital downloads or digital gift cards\\n- you use fulfillment services for all your products\\n\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"ac8538f5-b93b-43c5-9100-33fe3f6cd70b\",\n      \"name\": \"Filter Orders\",\n      \"type\": \"n8n-nodes-base.filter\",\n      \"position\": [\n        1340,\n        200\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"conditions\": {\n          \"options\": {\n            \"version\": 2,\n            \"leftValue\": \"\",\n            \"caseSensitive\": true,\n            \"typeValidation\": \"strict\"\n          },\n          \"combinator\": \"and\",\n          \"conditions\": [\n            {\n              \"id\": \"298103c1-a5b4-407e-aba6-bee37463422f\",\n              \"operator\": {\n                \"type\": \"number\",\n                \"operation\": \"gt\"\n              },\n              \"leftValue\": \"={{ (new Date().getTime() - new Date($json.createdOn).getTime()) / (1000 * 60 * 60) }}\",\n              \"rightValue\": 24\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 2.2\n    }\n  ],\n  \"pinData\": {},\n  \"connections\": {\n    \"Globals\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Query pending Orders\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Filter Orders\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Loop Over Items\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Fulfill Order\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Loop Over Items\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Loop Over Items\": {\n      \"main\": [\n        [],\n        [\n          {\n            \"node\": \"Fulfill Order\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Schedule Trigger\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Globals\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Split Out Order \": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Filter Orders\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Query pending Orders\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Split Out Order \",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"On clicking 'execute'\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Globals\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}",
  "metadata": {
    "node_types": [
      "n8n-nodes-base.manualTrigger",
      "n8n-nodes-base.splitOut",
      "n8n-nodes-base.set",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.scheduleTrigger",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.httpRequest",
      "n8n-nodes-base.splitInBatches",
      "n8n-nodes-base.httpRequest",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.filter"
    ],
    "trigger": "schedule trigger"
  }
}