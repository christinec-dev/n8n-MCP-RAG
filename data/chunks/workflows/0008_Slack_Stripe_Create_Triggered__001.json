{
  "source": "0008_Slack_Stripe_Create_Triggered.json",
  "index": 1,
  "content": "{\n  \"id\": 100,\n  \"name\": \"On new Stripe Invoice Payment update Hubspot and notify the team in Slack\",\n  \"nodes\": [\n    {\n      \"name\": \"When Invoice Paid\",\n      \"type\": \"n8n-nodes-base.stripeTrigger\",\n      \"position\": [\n        400,\n        460\n      ],\n      \"webhookId\": \"47727266-5233-48e5-b7f7-e47252840a4e\",\n      \"parameters\": {\n        \"events\": [\n          \"invoice.payment_succeeded\"\n        ]\n      },\n      \"credentials\": {\n        \"stripeApi\": {\n          \"id\": \"39\",\n          \"name\": \"Stripe account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Update Deal to Paid\",\n      \"type\": \"n8n-nodes-base.hubspot\",\n      \"position\": [\n        1240,\n        500\n      ],\n      \"parameters\": {\n        \"dealId\": \"={{$json[\\\"id\\\"]}}\",\n        \"operation\": \"update\",\n        \"updateFields\": {\n          \"customPropertiesUi\": {\n            \"customPropertiesValues\": [\n              {\n                \"value\": \"Yes\",\n                \"property\": \"paid\"\n              }\n            ]\n          }\n        },\n        \"authentication\": \"oAuth2\"\n      },\n      \"credentials\": {\n        \"hubspotOAuth2Api\": {\n          \"id\": \"60\",\n          \"name\": \"Hubspot account 2\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Find Deal based on PO Number\",\n      \"type\": \"n8n-nodes-base.hubspot\",\n      \"position\": [\n        820,\n        480\n      ],\n      \"parameters\": {\n        \"operation\": \"search\",\n        \"filterGroupsUi\": {\n          \"filterGroupsValues\": [\n            {\n              \"filtersUi\": {\n                \"filterValues\": [\n                  {\n                    \"value\": \"={{$json[\\\"data\\\"][\\\"object\\\"][\\\"custom_fields\\\"][0][\\\"value\\\"]}}\",\n                    \"propertyName\": \"po_number\"\n                  }\n                ]\n              }\n            }\n          ]\n        },\n        \"additionalFields\": {}\n      },\n      \"credentials\": {\n        \"hubspotApi\": {\n          \"id\": \"57\",\n          \"name\": \"Hubspot account\"\n        }\n      },\n      \"typeVersion\": 1,\n      \"alwaysOutputData\": true\n    },\n    {\n      \"name\": \"If no PO Number\",\n      \"type\": \"n8n-nodes-base.if\",\n      \"position\": [\n        600,\n        460\n      ],\n      \"parameters\": {\n        \"conditions\": {\n          \"string\": [\n            {\n              \"value1\": \"={{$json[\\\"data\\\"][\\\"object\\\"][\\\"custom_fields\\\"]}}\",\n              \"operation\": \"isEmpty\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"If no deal found for PO\",\n      \"type\": \"n8n-nodes-base.if\",\n      \"position\": [\n        1020,\n        480\n      ],\n      \"parameters\": {\n        \"conditions\": {\n          \"string\": [\n            {\n              \"value1\": \"={{$json[\\\"id\\\"]}}\",\n              \"operation\": \"isEmpty\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Send invoice paid message\",\n      \"type\": \"n8n-nodes-base.slack\",\n      \"position\": [\n        1420,\n        500\n      ],\n      \"parameters\": {\n        \"text\": \":sparkles: An invoice has been paid :sparkles:\",\n        \"channel\": \"team-accounts\",\n        \"blocksUi\": {\n          \"blocksValues\": []\n        },\n        \"attachments\": [\n          {\n            \"color\": \"#00FF04\",\n            \"fields\": {\n              \"item\": [\n                {\n                  \"short\": true,\n                  \"title\": \"Amount\",\n                  \"value\": \"={{$node[\\\"When Invoice Paid\\\"].json[\\\"data\\\"][\\\"object\\\"][\\\"amount_paid\\\"]/100}}\"\n                },\n                {\n                  \"short\": true,\n                  \"title\": \"Currency\",\n                  \"value\": \"={{$node[\\\"When Invoice Paid\\\"].json[\\\"data\\\"][\\\"object\\\"][\\\"currency\\\"]}}\"\n                },\n                {\n                  \"short\": false,\n                  \"title\": \"Customer Name\",\n                  \"value\": \"={{$node[\\\"When Invoice Paid\\\"].json[\\\"data\\\"][\\\"object\\\"][\\\"customer_name\\\"]}}\"\n                },\n                {\n                  \"short\": false,\n                  \"title\": \"Customer Email\",\n                  \"value\": \"={{$node[\\\"When Invoice Paid\\\"].json[\\\"data\\\"][\\\"object\\\"][\\\"customer_email\\\"]}}\"\n                },\n                {\n                  \"short\": true,\n                  \"title\": \"PO Number\",\n                  \"value\": \"={{$node[\\\"When Invoice Paid\\\"].json[\\\"data\\\"][\\\"object\\\"][\\\"custom_fields\\\"][0][\\\"value\\\"]}}\"\n                },\n                {\n                  \"short\": true,\n                  \"title\": \"\",\n                  \"value\": \"=\"\n                }\n              ]\n            },\n            \"footer\": \"=*Transaction ID:* {{$node[\\\"When Invoice Paid\\\"].json[\\\"id\\\"]}}\"\n          }\n        ],\n        \"otherOptions\": {}\n      },\n      \"credentials\": {\n        \"slackApi\": {\n          \"id\": \"53\",\n          \"name\": \"Slack Access Token\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Send no PO Message\",\n      \"type\": \"n8n-nodes-base.slack\",\n      \"position\": [\n        800,\n        240\n      ],\n      \"parameters\": {\n        \"text\": \":x: Stripe Payment with no PO Number :x:\",\n        \"channel\": \"team-accounts\",\n        \"blocksUi\": {\n          \"blocksValues\": []\n        },\n        \"attachments\": [\n          {\n            \"color\": \"#FF3C00\",\n            \"fields\": {\n              \"item\": [\n                {\n                  \"short\": true,\n                  \"title\": \"Amount\",\n                  \"value\": \"={{$json[\\\"data\\\"][\\\"object\\\"][\\\"amount_paid\\\"] / 100}}\"\n                },\n                {\n                  \"short\": true,\n                  \"title\": \"Currency\",\n                  \"value\": \"={{$json[\\\"data\\\"][\\\"object\\\"][\\\"currency\\\"]}}\"\n                },\n                {\n                  \"short\": false,\n                  \"title\": \"Customer Name\",\n                  \"value\": \"={{$json[\\\"data\\\"][\\\"object\\\"][\\\"customer_name\\\"]}}\"\n                },\n                {\n                  \"short\": false,\n                  \"title\": \"Customer Email\",\n                  \"value\": \"={{$json[\\\"data\\\"][\\\"object\\\"][\\\"customer_email\\\"]}}\"\n                }\n              ]\n            },\n            \"footer\": \"=*Transaction ID:* {{$json[\\\"id\\\"]}}\"\n          }\n        ],\n        \"otherOptions\": {}\n      },\n      \"credentials\": {\n        \"slackApi\": {\n          \"id\": \"53\",\n          \"name\": \"Slack Access Token\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Send Deal not found message\",\n      \"type\": \"n8n-nodes-base.slack\",\n      \"position\": [\n        1180,\n        240\n      ],\n      \"parameters\": {\n        \"text\": \":x: Unable to find Deal for the below payment :x:\",\n        \"channel\": \"team-accounts\",\n        \"blocksUi\": {\n          \"blocksValues\": []\n        },\n        \"attachments\": [\n          {\n            \"color\": \"#FF3C00\",\n            \"fields\": {\n              \"item\": [\n                {\n                  \"short\": true,\n                  \"title\": \"Amount\",\n                  \"value\": \"={{$node[\\\"When Invoice Paid\\\"].json[\\\"data\\\"][\\\"object\\\"][\\\"amount_paid\\\"]/100}}\"\n                },\n                {\n                  \"short\": true,\n                  \"title\": \"Currency\",\n                  \"value\": \"={{$node[\\\"When Invoice Paid\\\"].json[\\\"data\\\"][\\\"object\\\"][\\\"currency\\\"]}}\"\n                },\n                {\n                  \"short\": false,\n                  \"title\": \"Customer Name\",\n                  \"value\": \"={{$node[\\\"When Invoice Paid\\\"].json[\\\"data\\\"][\\\"object\\\"][\\\"customer_name\\\"]}}\"\n                },\n                {\n                  \"short\": false,\n                  \"title\": \"Customer Email\",\n                  \"value\": \"={{$node[\\\"When Invoice Paid\\\"].json[\\\"data\\\"][\\\"object\\\"][\\\"customer_email\\\"]}}\"\n                },\n                {\n                  \"short\": true,\n                  \"title\": \"PO Number\",\n                  \"value\": \"={{$node[\\\"When Invoice Paid\\\"].json[\\\"data\\\"][\\\"object\\\"][\\\"custom_fields\\\"][0][\\\"value\\\"]}}\"\n                }\n              ]\n            },\n            \"footer\": \"=*Transaction ID:* {{$node[\\\"When Invoice Paid\\\"].json[\\\"id\\\"]}}\"\n          }\n        ],\n        \"otherOptions\": {}\n      },\n      \"credentials\": {\n        \"slackApi\": {\n          \"id\": \"53\",\n          \"name\": \"Slack Access Token\"\n        }\n      },\n      \"typeVersion\": 1\n    }\n  ],\n  \"active\": false,\n  \"settings\": {},\n  \"connections\": {\n    \"If no PO Number\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Send no PO Message\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Find Deal based on PO Number\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"When Invoice Paid\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"If no PO Number\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Update Deal to Paid\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Send invoice paid message\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"If no deal found for PO\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Send Deal not found message\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Update Deal to Paid\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Find Deal based on PO Number\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"If no deal found for PO\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}",
  "metadata": {
    "node_types": [
      "n8n-nodes-base.stripeTrigger",
      "n8n-nodes-base.hubspot",
      "n8n-nodes-base.hubspot",
      "n8n-nodes-base.if",
      "n8n-nodes-base.if",
      "n8n-nodes-base.slack",
      "n8n-nodes-base.slack",
      "n8n-nodes-base.slack"
    ],
    "trigger": null
  }
}