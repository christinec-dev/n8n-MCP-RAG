{
  "source": "0512_Splitout_Code_Update_Webhook.json",
  "index": 1,
  "content": "{\n  \"meta\": {\n    \"instanceId\": \"1dd912a1610cd0376bae7bb8f1b5838d2b601f42ac66a48e012166bb954fed5a\",\n    \"templateId\": \"2301\"\n  },\n  \"nodes\": [\n    {\n      \"id\": \"a6d8c7aa-c75c-4aaa-8fe2-e23f3da2b8f5\",\n      \"name\": \"get node types\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        820,\n        240\n      ],\n      \"parameters\": {\n        \"url\": \"={{ $json.instanceBaseUrl }}/types/nodes.json\",\n        \"options\": {},\n        \"authentication\": \"predefinedCredentialType\",\n        \"nodeCredentialType\": \"n8nApi\"\n      },\n      \"credentials\": {\n        \"n8nApi\": {\n          \"id\": \"xhyxmtPC3UwZ7HmL\",\n          \"name\": \"n8n account\"\n        }\n      },\n      \"typeVersion\": 4.2\n    },\n    {\n      \"id\": \"55bedad2-0096-4a59-8818-9bdbe9799230\",\n      \"name\": \"When clicking ‘Test workflow’\",\n      \"type\": \"n8n-nodes-base.manualTrigger\",\n      \"position\": [\n        380,\n        240\n      ],\n      \"parameters\": {},\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"dc37402e-558d-4c6c-883e-450f161d5766\",\n      \"name\": \"Split Out\",\n      \"type\": \"n8n-nodes-base.splitOut\",\n      \"position\": [\n        1040,\n        480\n      ],\n      \"parameters\": {\n        \"include\": \"selectedOtherFields\",\n        \"options\": {\n          \"destinationFieldName\": \"node\"\n        },\n        \"fieldToSplitOut\": \"nodes\",\n        \"fieldsToInclude\": \"name, id\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"dcaec125-684a-4b50-8cb8-fcce9763929b\",\n      \"name\": \"If\",\n      \"type\": \"n8n-nodes-base.if\",\n      \"position\": [\n        1240,\n        480\n      ],\n      \"parameters\": {\n        \"options\": {\n          \"looseTypeValidation\": true\n        },\n        \"conditions\": {\n          \"options\": {\n            \"leftValue\": \"\",\n            \"caseSensitive\": true,\n            \"typeValidation\": \"loose\"\n          },\n          \"combinator\": \"and\",\n          \"conditions\": [\n            {\n              \"id\": \"1c65a9cf-dd60-4d3f-8fe6-05e5877ab58a\",\n              \"operator\": {\n                \"type\": \"boolean\",\n                \"operation\": \"notEquals\"\n              },\n              \"leftValue\": \"={{ !!$('Aggregate').first().json.data.find(n => n.name === $json.node.type) }}\",\n              \"rightValue\": false\n            },\n            {\n              \"id\": \"dbc80785-274f-424c-9862-bed0ec7e4b63\",\n              \"operator\": {\n                \"type\": \"number\",\n                \"operation\": \"lt\"\n              },\n              \"leftValue\": \"={{ $json.node.typeVersion }}\",\n              \"rightValue\": \"={{ $('Aggregate').first().json.data.find(n => n.name === $json.node.type).version }}\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"da0d6443-81c8-4d0a-bd2d-300ce83726ad\",\n      \"name\": \"Aggregate\",\n      \"type\": \"n8n-nodes-base.aggregate\",\n      \"position\": [\n        1240,\n        240\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"aggregate\": \"aggregateAllItemData\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"df683591-1342-4140-9505-359320c08ec0\",\n      \"name\": \"extract name and latest version\",\n      \"type\": \"n8n-nodes-base.code\",\n      \"position\": [\n        1040,\n        240\n      ],\n      \"parameters\": {\n        \"jsCode\": \"// Loop over input items and add a new field called 'myNewField' to the JSON of each one\\nfor (const item of $input.all()) {\\n  item.json.myNewField = 1;\\n}\\n\\nreturn $input.all().map(({json}) => {\\n  const typeVersion = Array.isArray(json.version) ? Math.max(...json.version) : json.version;\\n  return {\\n    name: json.name,\\n    version: typeVersion\\n  }\\n})\"\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"cfa7c46e-4292-4d56-8311-a4659ed519fa\",\n      \"name\": \"Summarize\",\n      \"type\": \"n8n-nodes-base.summarize\",\n      \"position\": [\n        820,\n        720\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"fieldsToSplitBy\": \"workflowName, workflowId\",\n        \"fieldsToSummarize\": {\n          \"values\": [\n            {\n              \"field\": \"info\",\n              \"aggregation\": \"append\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"10ba8fe4-bab4-4c5f-a6ed-cd5bcf0b8b04\",\n      \"name\": \"get all workflows\",\n      \"type\": \"n8n-nodes-base.n8n\",\n      \"position\": [\n        600,\n        480\n      ],\n      \"parameters\": {\n        \"filters\": {},\n        \"requestOptions\": {}\n      },\n      \"credentials\": {\n        \"n8nApi\": {\n          \"id\": \"xhyxmtPC3UwZ7HmL\",\n          \"name\": \"n8n account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"a2fcba1a-866b-48d5-92e6-a3b98a8afbdc\",\n      \"name\": \"Sticky Note\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        553.7882961480204,\n        420\n      ],\n      \"parameters\": {\n        \"width\": 433.34242668485376,\n        \"height\": 205.3908222102156,\n        \"content\": \"Check information for all workflows or a single workflow, activate corresponding node\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"7a1216f0-5d25-46d1-9965-023d9eedbe6c\",\n      \"name\": \"prettify output\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        1040,\n        720\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"e24c81f9-fca3-4b74-bdc1-50d6933b56e7\",\n              \"name\": \"workflow\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.workflowName }}\"\n            },\n            {\n              \"id\": \"79c3faaa-5707-49a6-8b9c-7290bcf066bb\",\n              \"name\": \"Id\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.workflowId }}\"\n            },\n            {\n              \"id\": \"6c7732db-84bb-4a54-85ce-05ce60553208\",\n              \"name\": \"outdated_nodes\",\n              \"type\": \"array\",\n              \"value\": \"={{ $json.appended_info }}\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 3.4\n    },\n    {\n      \"id\": \"99d2fda2-ec3d-4d03-95cb-96c2a04b43d6\",\n      \"name\": \"instance base url\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        600,\n        240\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"ad3ffe8a-2a48-45ad-9171-bd6bffa02488\",\n              \"name\": \"instanceBaseUrl\",\n              \"type\": \"string\",\n              \"value\": \"http://localhost:5432\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 3.4\n    },\n    {\n      \"id\": \"906e1743-1f52-4d7b-b796-75f2a9c5a131\",\n      \"name\": \"Sticky Note1\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        548.1243191057811,\n        152.6859339432964\n      ],\n      \"parameters\": {\n        \"width\": 228.883554909967,\n        \"height\": 240.99660770750089,\n        \"content\": \"Set your instance URL here, it should not include API and version\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"e9a330ae-df1f-4830-9420-afdf4ca9bbbe\",\n      \"name\": \"Sticky Note2\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        800,\n        159.81134247982766\n      ],\n      \"parameters\": {\n        \"width\": 192.26610453220889,\n        \"height\": 238.64272871402878,\n        \"content\": \"Get n8n API key in settings > n8n API\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"b85366ba-ecbd-493e-a1c7-a081e51d0eb2\",\n      \"name\": \"get single workflow\",\n      \"type\": \"n8n-nodes-base.n8n\",\n      \"disabled\": true,\n      \"position\": [\n        820,\n        480\n      ],\n      \"parameters\": {\n        \"operation\": \"get\",\n        \"workflowId\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"03L3B0pAuGRa8cfx\",\n          \"cachedResultName\": \"My workflow 40 (#03L3B0pAuGRa8cfx)\"\n        },\n        \"requestOptions\": {}\n      },\n      \"credentials\": {\n        \"n8nApi\": {\n          \"id\": \"xhyxmtPC3UwZ7HmL\",\n          \"name\": \"n8n account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"669b3b8c-e835-455b-a3f8-c1c5ba411020\",\n      \"name\": \"node names that needs update\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        600,\n        720\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"01a01bc8-ffd8-4985-bd01-8ffb4dbaee6c\",\n              \"name\": \"workflowName\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.name }}\"\n            },\n            {\n              \"id\": \"dc199eab-92b1-46bd-8999-38d64ca37623\",\n              \"name\": \"info\",\n              \"type\": \"object\",\n              \"value\": \"=\\n{\\n\\\"name\\\": \\\"{{ $json.node.name }}\\\",\\n\\\"type\\\": \\\"{{ $json.node.type }}\\\",\\n\\\"version\\\": {{ $json.node.typeVersion }},\\n\\\"latestVersion\\\": {{ $('Aggregate').first().json.data.find(n => n.name === $json.node.type).version }}\\n}\"\n            },\n            {\n              \"id\": \"fe268266-f0ab-47d8-bb6d-a9fefe82f527\",\n              \"name\": \"workflowId\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.id }}\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 3.4\n    }\n  ],\n  \"pinData\": {},\n  \"connections\": {\n    \"If\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"node names that needs update\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Aggregate\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"get all workflows\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Split Out\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"If\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Summarize\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"prettify output\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"get node types\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"extract name and latest version\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"get all workflows\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"get single workflow\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"instance base url\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"get node types\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"get single workflow\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Split Out\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"node names that needs update\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Summarize\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"extract name and latest version\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Aggregate\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"When clicking ‘Test workflow’\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"instance base url\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}",
  "metadata": {
    "node_types": [
      "n8n-nodes-base.httpRequest",
      "n8n-nodes-base.manualTrigger",
      "n8n-nodes-base.splitOut",
      "n8n-nodes-base.if",
      "n8n-nodes-base.aggregate",
      "n8n-nodes-base.code",
      "n8n-nodes-base.summarize",
      "n8n-nodes-base.n8n",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.set",
      "n8n-nodes-base.set",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.n8n",
      "n8n-nodes-base.set"
    ],
    "trigger": null
  }
}