{
  "source": "1448_Telegram_Stickynote_Automation_Triggered.json",
  "index": 1,
  "content": "{\n  \"id\": \"F7CfIF10XjXhqbGb\",\n  \"meta\": {\n    \"instanceId\": \"ba8f1362d8ed4c2ce84171d2f481098de4ee775241bdc1660d1dce80434ec7d4\",\n    \"templateCredsSetupCompleted\": true\n  },\n  \"name\": \"Play with Spotify from Telegram\",\n  \"tags\": [],\n  \"nodes\": [\n    {\n      \"id\": \"0395b3e4-94ef-49ea-9b4c-8f908e62f8c6\",\n      \"name\": \"Telegram Trigger\",\n      \"type\": \"n8n-nodes-base.telegramTrigger\",\n      \"position\": [\n        -60,\n        20\n      ],\n      \"webhookId\": \"e7aa284b-5eef-4ac1-94bf-8e4d307a3b14\",\n      \"parameters\": {\n        \"updates\": [\n          \"message\"\n        ],\n        \"additionalFields\": {}\n      },\n      \"credentials\": {\n        \"telegramApi\": {\n          \"id\": \"gblW5oACGEPuccja\",\n          \"name\": \"Telegram account\"\n        }\n      },\n      \"typeVersion\": 1.1\n    },\n    {\n      \"id\": \"263edf45-58a0-45e8-91f8-601bc62c7d6f\",\n      \"name\": \"OpenAI - Ask about a track\",\n      \"type\": \"@n8n/n8n-nodes-langchain.openAi\",\n      \"position\": [\n        120,\n        -120\n      ],\n      \"parameters\": {\n        \"modelId\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"gpt-4o-mini\",\n          \"cachedResultName\": \"GPT-4O-MINI\"\n        },\n        \"options\": {},\n        \"messages\": {\n          \"values\": [\n            {\n              \"content\": \"=get artist and song name from '{{ $json.message.text }}'. Reply only eg. 'track:song name artist:artist name'\"\n            }\n          ]\n        }\n      },\n      \"credentials\": {\n        \"openAiApi\": {\n          \"id\": \"vDcge3EgslxfX3EC\",\n          \"name\": \"OpenAi account\"\n        }\n      },\n      \"typeVersion\": 1.6\n    },\n    {\n      \"id\": \"086aef8b-533a-4c33-9952-29d5adb152c8\",\n      \"name\": \"Search track\",\n      \"type\": \"n8n-nodes-base.spotify\",\n      \"onError\": \"continueErrorOutput\",\n      \"position\": [\n        540,\n        -200\n      ],\n      \"parameters\": {\n        \"limit\": 1,\n        \"query\": \"={{ $json.message.content }}\",\n        \"filters\": {},\n        \"resource\": \"track\",\n        \"operation\": \"search\"\n      },\n      \"credentials\": {\n        \"spotifyOAuth2Api\": {\n          \"id\": \"wylKghFNQa8IKy1U\",\n          \"name\": \"Spotify account\"\n        }\n      },\n      \"typeVersion\": 1,\n      \"alwaysOutputData\": true\n    },\n    {\n      \"id\": \"08af6055-ba52-4cb2-a561-ea04ac55279f\",\n      \"name\": \"Add song\",\n      \"type\": \"n8n-nodes-base.spotify\",\n      \"onError\": \"continueErrorOutput\",\n      \"position\": [\n        780,\n        -240\n      ],\n      \"parameters\": {\n        \"id\": \"=spotify:track:{{ $json.id }}\"\n      },\n      \"credentials\": {\n        \"spotifyOAuth2Api\": {\n          \"id\": \"wylKghFNQa8IKy1U\",\n          \"name\": \"Spotify account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"2dbdafa4-3b6f-4a14-813c-4e10da10abad\",\n      \"name\": \"Next Song\",\n      \"type\": \"n8n-nodes-base.spotify\",\n      \"onError\": \"continueErrorOutput\",\n      \"position\": [\n        980,\n        -280\n      ],\n      \"parameters\": {\n        \"operation\": \"nextSong\"\n      },\n      \"credentials\": {\n        \"spotifyOAuth2Api\": {\n          \"id\": \"wylKghFNQa8IKy1U\",\n          \"name\": \"Spotify account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"cb8d42aa-0c7e-45a5-90b5-b91e483dd13a\",\n      \"name\": \"Resume play\",\n      \"type\": \"n8n-nodes-base.spotify\",\n      \"notes\": \"We don't have to stop here on error. An error is thrown from Spotify if the player is already playing.\",\n      \"onError\": \"continueRegularOutput\",\n      \"position\": [\n        1240,\n        -380\n      ],\n      \"parameters\": {\n        \"operation\": \"resume\"\n      },\n      \"credentials\": {\n        \"spotifyOAuth2Api\": {\n          \"id\": \"wylKghFNQa8IKy1U\",\n          \"name\": \"Spotify account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"089e1070-b013-454c-9f6c-55b909e06c1d\",\n      \"name\": \"Currently Playing\",\n      \"type\": \"n8n-nodes-base.spotify\",\n      \"onError\": \"continueErrorOutput\",\n      \"position\": [\n        1420,\n        -300\n      ],\n      \"parameters\": {\n        \"operation\": \"currentlyPlaying\"\n      },\n      \"credentials\": {\n        \"spotifyOAuth2Api\": {\n          \"id\": \"wylKghFNQa8IKy1U\",\n          \"name\": \"Spotify account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"e9df0dcf-b166-45a3-910b-787b3718bbcf\",\n      \"name\": \"Sticky Note\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        120,\n        -300\n      ],\n      \"parameters\": {\n        \"color\": 5,\n        \"width\": 254.05813953488382,\n        \"content\": \"## Telegram to Spotify \\nAsk AI about a track with artist and song name or if you can't remember describe it and AI does it's thing.\\n\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"77bae9be-2d92-4028-ae78-7887b6a2d394\",\n      \"name\": \"Merge\",\n      \"type\": \"n8n-nodes-base.merge\",\n      \"position\": [\n        440,\n        220\n      ],\n      \"parameters\": {\n        \"mode\": \"combine\",\n        \"options\": {},\n        \"combineBy\": \"combineAll\"\n      },\n      \"typeVersion\": 3\n    },\n    {\n      \"id\": \"0d95000d-7efd-402a-9a34-47ababb2f53e\",\n      \"name\": \"If\",\n      \"type\": \"n8n-nodes-base.if\",\n      \"position\": [\n        620,\n        -440\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"conditions\": {\n          \"options\": {\n            \"version\": 2,\n            \"leftValue\": \"\",\n            \"caseSensitive\": true,\n            \"typeValidation\": \"strict\"\n          },\n          \"combinator\": \"and\",\n          \"conditions\": [\n            {\n              \"id\": \"02af5387-07d2-4a16-bd83-e1359d091165\",\n              \"operator\": {\n                \"type\": \"string\",\n                \"operation\": \"notEmpty\",\n                \"singleValue\": true\n              },\n              \"leftValue\": \"={{ $json?.id }}\",\n              \"rightValue\": \"\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 2.2\n    },\n    {\n      \"id\": \"363f89ad-34d0-4445-8ff3-693d991dad09\",\n      \"name\": \"Message parser\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        1280,\n        -40\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"93cd2545-c6e9-4717-96b7-d49eb056ac70\",\n              \"name\": \"message\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.error }}\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 3.4\n    },\n    {\n      \"id\": \"8b80f80d-8c8e-44de-9838-6d05199bb734\",\n      \"name\": \"Not found error message\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        880,\n        -460\n      ],\n      \"parameters\": {\n        \"mode\": \"raw\",\n        \"options\": {},\n        \"jsonOutput\": \"{\\n  \\\"error\\\": \\\"Song not found\\\"\\n}\\n\"\n      },\n      \"typeVersion\": 3.4\n    },\n    {\n      \"id\": \"f1785140-8e97-43e1-9d84-aedc8b8d5e06\",\n      \"name\": \"Return message to Telegram\",\n      \"type\": \"n8n-nodes-base.telegram\",\n      \"position\": [\n        760,\n        220\n      ],\n      \"parameters\": {\n        \"text\": \"={{ $('Message parser').item.json.message }}\",\n        \"chatId\": \"={{ $json.message.chat.id }}\",\n        \"additionalFields\": {}\n      },\n      \"credentials\": {\n        \"telegramApi\": {\n          \"id\": \"gblW5oACGEPuccja\",\n          \"name\": \"Telegram account\"\n        }\n      },\n      \"typeVersion\": 1.2\n    },\n    {\n      \"id\": \"e3e16535-094b-41bf-88c6-166bb6805d53\",\n      \"name\": \"Define Now Playing\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"notes\": \"We use the object \\\"error\\\" as a returned bject so we can re-use the Message Parser node.\",\n      \"position\": [\n        1660,\n        -240\n      ],\n      \"parameters\": {\n        \"mode\": \"raw\",\n        \"options\": {},\n        \"jsonOutput\": \"={\\n  \\\"error\\\": \\\"Now playing {{ $json.item.name }} - {{ $json.item.artists[0].name }} - {{ $json.item.album.name }}\\\"\\n}\\n\"\n      },\n      \"typeVersion\": 3.4\n    }\n  ],\n  \"active\": true,\n  \"pinData\": {},\n  \"settings\": {\n    \"executionOrder\": \"v1\"\n  },\n  \"versionId\": \"6f219c9e-f17a-45b1-ab8d-09d991fd8e34\",\n  \"connections\": {\n    \"If\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Add song\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Not found error message\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Merge\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Return message to Telegram\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Add song\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Next Song\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Message parser\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Next Song\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Resume play\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Message parser\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Resume play\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Currently Playing\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        []\n      ]\n    },\n    \"Search track\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"If\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Message parser\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Message parser\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Merge\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Telegram Trigger\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"OpenAI - Ask about a track\",\n            \"type\": \"main\",\n            \"index\": 0\n          },\n          {\n            \"node\": \"Merge\",\n            \"type\": \"main\",\n            \"index\": 1\n          }\n        ]\n      ]\n    },\n    \"Currently Playing\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Define Now Playing\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Message parser\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Define Now Playing\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Message parser\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Not found error message\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Message parser\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"OpenAI - Ask about a track\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Search track\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}",
  "metadata": {
    "node_types": [
      "n8n-nodes-base.telegramTrigger",
      "@n8n/n8n-nodes-langchain.openAi",
      "n8n-nodes-base.spotify",
      "n8n-nodes-base.spotify",
      "n8n-nodes-base.spotify",
      "n8n-nodes-base.spotify",
      "n8n-nodes-base.spotify",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.merge",
      "n8n-nodes-base.if",
      "n8n-nodes-base.set",
      "n8n-nodes-base.set",
      "n8n-nodes-base.telegram",
      "n8n-nodes-base.set"
    ],
    "trigger": "telegram trigger"
  }
}