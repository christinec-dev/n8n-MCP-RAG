{
  "source": "1362_Wait_Webhook_Create_Webhook.json",
  "index": 1,
  "content": "{\n  \"id\": \"QO4Mg23JvVfNCICy\",\n  \"meta\": {\n    \"instanceId\": \"a2b23892dd6989fda7c1209b381f5850373a7d2b85609624d7c2b7a092671d44\",\n    \"templateCredsSetupCompleted\": true\n  },\n  \"name\": \"Build a Phone Agent to qualify outbound leads and inbound calls with RetellAI -vide\",\n  \"tags\": [\n    {\n      \"id\": \"12w64ydbjEKDaM0B\",\n      \"name\": \"inbound\",\n      \"createdAt\": \"2025-05-06T20:31:43.427Z\",\n      \"updatedAt\": \"2025-05-06T20:31:43.427Z\"\n    },\n    {\n      \"id\": \"xSqaFWDcbJCRECKZ\",\n      \"name\": \"outbound\",\n      \"createdAt\": \"2025-05-06T20:31:38.072Z\",\n      \"updatedAt\": \"2025-05-06T20:31:38.072Z\"\n    }\n  ],\n  \"nodes\": [\n    {\n      \"id\": \"78f39980-c9f8-49b6-93bb-a1f61d347ac3\",\n      \"name\": \"Sticky Note\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -240,\n        0\n      ],\n      \"parameters\": {\n        \"width\": 1260,\n        \"height\": 320,\n        \"content\": \"# Outbound lead qualification call workflow\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"661006b9-dac7-4ac0-882a-2e0cba9dbae1\",\n      \"name\": \"Sticky Note4\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -240,\n        360\n      ],\n      \"parameters\": {\n        \"color\": 5,\n        \"width\": 1260,\n        \"height\": 320,\n        \"content\": \"# Inbound call appointment scheduler workflow\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"96a278b9-8d2e-4f85-9f6a-2997932a7ca4\",\n      \"name\": \"Sticky Note2\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        1060,\n        -420\n      ],\n      \"parameters\": {\n        \"color\": 4,\n        \"width\": 1400,\n        \"height\": 1100,\n        \"content\": \"# Post-call workflow\\n## Triggers when a new lead is added in Google Sheets:\\n\\n### 1 -Sends SMS to remind rep to call in 5 min\\n### 2- (Optional delay step)\\n### 3- Triggers RetellAI to place an automated call to the lead\\n\\n## ðŸ’¡ Requires phone numbers to be formatted in E.164\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"d082f904-f185-4615-b0d8-9438c731786f\",\n      \"name\": \"Detect new lead in Google Sheets\",\n      \"type\": \"n8n-nodes-base.googleSheetsTrigger\",\n      \"position\": [\n        -160,\n        100\n      ],\n      \"parameters\": {\n        \"event\": \"rowAdded\",\n        \"options\": {},\n        \"pollTimes\": {\n          \"item\": [\n            {\n              \"mode\": \"everyHour\"\n            }\n          ]\n        },\n        \"sheetName\": {\n          \"__rl\": true,\n          \"mode\": \"id\",\n          \"value\": \"=\"\n        },\n        \"documentId\": {\n          \"__rl\": true,\n          \"mode\": \"id\",\n          \"value\": \"=\"\n        }\n      },\n      \"credentials\": {\n        \"googleSheetsTriggerOAuth2Api\": {\n          \"id\": \"pXaVMshaL2QzVDYh\",\n          \"name\": \"Google Sheets Trigger account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"c61172c2-7795-47be-acaa-d4824ca69680\",\n      \"name\": \"Send SMS reminder to call lead in 5 minutes\",\n      \"type\": \"n8n-nodes-base.twilio\",\n      \"position\": [\n        140,\n        100\n      ],\n      \"parameters\": {\n        \"to\": \"={{ $json['Phone Number'] }}\",\n        \"from\": \"+33600000000\",\n        \"message\": \"Hello, thanks for your interest in our roofing services. We'll be calling you shortly to ask about your project!\",\n        \"options\": {},\n        \"resource\": \"call\"\n      },\n      \"credentials\": {\n        \"twilioApi\": {\n          \"id\": \"udXVmM3xHYZbMW4g\",\n          \"name\": \"Twilio account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"d88573d4-ec99-40e4-8603-f1e910d034d1\",\n      \"name\": \"Wait 5 minutes before making call\",\n      \"type\": \"n8n-nodes-base.wait\",\n      \"position\": [\n        460,\n        100\n      ],\n      \"webhookId\": \"344c2d5d-5629-4466-866b-ac6359b3b042\",\n      \"parameters\": {\n        \"unit\": \"minutes\",\n        \"amount\": 1\n      },\n      \"typeVersion\": 1.1\n    },\n    {\n      \"id\": \"d6778895-90dd-471e-9d9d-c48a35154291\",\n      \"name\": \"Call new lead using RetellAI\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        760,\n        100\n      ],\n      \"parameters\": {\n        \"url\": \"https://api.retellai.com/v2/create-phone-call\",\n        \"method\": \"POST\",\n        \"options\": {},\n        \"jsonBody\": \"={\\n  \\\"from_number\\\": \\\"+33600000000\\\",\\n  \\\"to_number\\\": \\\"{{ $json['Phone Number'] }}\\\",\\n  \\\"retell_llm_dynamic_variables\\\": {\\n    \\\"uuid\\\": \\\"{{ $('Detect new lead in Google Sheets').item.json.UUID }}\\\"\\n  }\\n}\",\n        \"sendBody\": true,\n        \"sendHeaders\": true,\n        \"specifyBody\": \"json\",\n        \"headerParameters\": {\n          \"parameters\": [\n            {\n              \"name\": \"Authorization\",\n              \"value\": \"Bearer key_XXXXXXXXX\"\n            },\n            {\n              \"name\": \"Content-Type\",\n              \"value\": \"application/json\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 4.2\n    },\n    {\n      \"id\": \"8e7e7c0c-2600-4b20-ba30-b855d456d302\",\n      \"name\": \"Receive inbound call from RetellAI (webhook)\",\n      \"type\": \"n8n-nodes-base.webhook\",\n      \"position\": [\n        -160,\n        460\n      ],\n      \"webhookId\": \"ebd11c9b-129c-4b59-8c27-9a4b567305f7\",\n      \"parameters\": {\n        \"path\": \"ebd11c9b-129c-4b59-8c27-9a4b567305f7\",\n        \"options\": {},\n        \"httpMethod\": \"POST\",\n        \"responseMode\": \"responseNode\"\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"36bf25b0-d39d-4127-b005-5e3619069744\",\n      \"name\": \"Check if phone number exists in Google Sheets\",\n      \"type\": \"n8n-nodes-base.googleSheets\",\n      \"position\": [\n        300,\n        460\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"filtersUI\": {\n          \"values\": [\n            {\n              \"lookupValue\": \"={{ $json.body.call_inbound.from_number }}\",\n              \"lookupColumn\": \"Phone Number\"\n            }\n          ]\n        },\n        \"sheetName\": {\n          \"__rl\": true,\n          \"mode\": \"id\",\n          \"value\": \"=\"\n        },\n        \"documentId\": {\n          \"__rl\": true,\n          \"mode\": \"id\",\n          \"value\": \"=\"\n        }\n      },\n      \"credentials\": {\n        \"googleSheetsOAuth2Api\": {\n          \"id\": \"51us92xkOlrvArhV\",\n          \"name\": \"Google Sheets account\"\n        }\n      },\n      \"typeVersion\": 4.5\n    },\n    {\n      \"id\": \"0b2dc7b9-84c1-488b-9d02-47cf6ee460c7\",\n      \"name\": \"Send response to inbound webhook call\",\n      \"type\": \"n8n-nodes-base.respondToWebhook\",\n      \"position\": [\n        760,\n        460\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"respondWith\": \"json\",\n        \"responseBody\": \"={\\n  \\\"call_inbound\\\": {\\n    \\\"dynamic_variables\\\": {\\n        \\\"name\\\": \\\"{{ $json.Name }}\\\"\\n    }\\n  }\\n}\"\n      },\n      \"typeVersion\": 1.1\n    },\n    {\n      \"id\": \"063a4a31-429f-4cf0-b248-869131e92633\",\n      \"name\": \"Receive post-call data from RetellAI (webhook)\",\n      \"type\": \"n8n-nodes-base.webhook\",\n      \"position\": [\n        1180,\n        80\n      ],\n      \"webhookId\": \"f8878b78-43ea-4caa-b16c-cde9aaf2e9b1\",\n      \"parameters\": {\n        \"path\": \"f8878b78-43ea-4caa-b16c-cde9aaf2e9b1\",\n        \"options\": {},\n        \"httpMethod\": \"POST\"\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"215e2031-983a-4785-b46d-026f64c115e4\",\n      \"name\": \"Filter for analyzed calls only\",\n      \"type\": \"n8n-nodes-base.filter\",\n      \"position\": [\n        1400,\n        80\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"conditions\": {\n          \"options\": {\n            \"version\": 2,\n            \"leftValue\": \"\",\n            \"caseSensitive\": true,\n            \"typeValidation\": \"strict\"\n          },\n          \"combinator\": \"and\",\n          \"conditions\": [\n            {\n              \"id\": \"a0e40476-0054-43ec-b7a7-e872d1c6061a\",\n              \"operator\": {\n                \"name\": \"filter.operator.equals\",\n                \"type\": \"string\",\n                \"operation\": \"equals\"\n              },\n              \"leftValue\": \"={{ $json.body.event }}\",\n              \"rightValue\": \"call_analyzed\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 2.2\n    },\n    {\n      \"id\": \"f8cae0c3-1b5d-47e6-b7fd-b47558c30d3f\",\n      \"name\": \"Check if call was outbound\",\n      \"type\": \"n8n-nodes-base.if\",\n      \"position\": [\n        1620,\n        80\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"conditions\": {\n          \"options\": {\n            \"version\": 2,\n            \"leftValue\": \"\",\n            \"caseSensitive\": true,\n            \"typeValidation\": \"strict\"\n          },\n          \"combinator\": \"and\",\n          \"conditions\": [\n            {\n              \"id\": \"46590184-4e33-48fd-a9f4-c63b13f88c1f\",\n              \"operator\": {\n                \"type\": \"string\",\n                \"operation\": \"equals\"\n              },\n              \"leftValue\": \"={{ $json.body.call.direction }}\",\n              \"rightValue\": \"outbound\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 2.2\n    },\n    {\n      \"id\": \"8997d5ec-bfb9-4ce9-9e13-6035f02b634e\",\n      \"name\": \"Update lead record in Google Sheets\",\n      \"type\": \"n8n-nodes-base.googleSheets\",\n      \"position\": [\n        1860,\n        -40\n      ],\n      \"parameters\": {\n        \"columns\": {\n          \"value\": {\n            \"UUID\": \"={{ $json.body.call.retell_llm_dynamic_variables.uuid }}\",\n            \"Qualification\": \"={{ $json.body.call.call_analysis.custom_analysis_data.qualification }}\"\n          },\n          \"schema\": [\n            {\n              \"id\": \"UUID\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"UUID\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"Name\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"required\": false,\n              \"displayName\": \"Name\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"Phone Number\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"required\": false,\n              \"displayName\": \"Phone Number\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"Datetime Called\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"required\": false,\n              \"displayName\": \"Datetime Called\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"Qualification\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"required\": false,\n              \"displayName\": \"Qualification\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"row_number\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": true,\n              \"readOnly\": true,\n              \"required\": false,\n              \"displayName\": \"row_number\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            }\n          ],\n          \"mappingMode\": \"defineBelow\",\n          \"matchingColumns\": [\n            \"UUID\"\n          ],\n          \"attemptToConvertTypes\": false,\n          \"convertFieldsToString\": false\n        },\n        \"options\": {},\n        \"operation\": \"update\",\n        \"sheetName\": {\n          \"__rl\": true,\n          \"mode\": \"id\",\n          \"value\": \"=\"\n        },\n        \"documentId\": {\n          \"__rl\": true,\n          \"mode\": \"id\",\n          \"value\": \"=\"\n        }\n      },\n      \"credentials\": {\n        \"googleSheetsOAuth2Api\": {\n          \"id\": \"51us92xkOlrvArhV\",\n          \"name\": \"Google Sheets account\"\n        }\n      },\n      \"typeVersion\": 4.5\n    },\n    {\n      \"id\": \"20757ff8-6604-4c80-96ec-32bfac983ed7\",\n      \"name\": \"Send call summary email\",\n      \"type\": \"n8n-nodes-base.gmail\",\n      \"position\": [\n        2220,\n        -40\n      ],\n      \"webhookId\": \"806ec3f9-8bcb-48ef-8e22-9d1ce3b06bf0\",\n      \"parameters\": {\n        \"sendTo\": \"youremail@gmail.com\",\n        \"message\": \"=Name:\\n{{ $json.body.call.call_analysis.custom_analysis_data.first_name }}\\n\\nNumber:\\n{{ $json.body.call.call_analysis.custom_analysis_data.phone_number }}\\n\\nQualification:\\n{{ $json.body.call.call_analysis.custom_analysis_data.qualification }}\\n\\n\\nCall Summary:\\n{{ $json.body.call.call_analysis.custom_analysis_data.call_summary }}\",\n        \"options\": {},\n        \"subject\": \"=New Lead - Call Summary\",\n        \"emailType\": \"text\"\n      },\n      \"credentials\": {\n        \"gmailOAuth2\": {\n          \"id\": \"rKxQHWZ2F5XLJmwF\",\n          \"name\": \"Gmail account\"\n        }\n      },\n      \"typeVersion\": 2.1\n    },\n    {\n      \"id\": \"753bd92d-b95b-4710-bf49-6da89a43223f\",\n      \"name\": \"Generate call summary with OpenAI\",\n      \"type\": \"@n8n/n8n-nodes-langchain.openAi\",\n      \"position\": [\n        1860,\n        180\n      ],\n      \"parameters\": {\n        \"modelId\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"gpt-4.1\",\n          \"cachedResultName\": \"GPT-4.1\"\n        },\n        \"options\": {},\n        \"messages\": {\n          \"values\": [\n            {\n              \"content\": \"=Analyze this call transcript to identify how the call went and identify possible improvements to the voice prompt:\\n\\n{{ $json.body.call.transcript }}\"\n            }\n          ]\n        }\n      },\n      \"credentials\": {\n        \"openAiApi\": {\n          \"id\": \"6h3DfVhNPw9I25nO\",\n          \"name\": \"OpenAi account\"\n        }\n      },\n      \"typeVersion\": 1.8\n    },\n    {\n      \"id\": \"cf600277-bb07-4f7a-a9b7-3e20017f716d\",\n      \"name\": \"Send confirmation email to lead\",\n      \"type\": \"n8n-nodes-base.gmail\",\n      \"position\": [\n        2220,\n        180\n      ],\n      \"webhookId\": \"453fe9d9-1de6-40a2-bd0c-88cb9c1cc7ef\",\n      \"parameters\": {\n        \"sendTo\": \"youremail@gmail.com\",\n        \"message\": \"=New roofing appointment:\\n\\nClient Name:\\n{{ $('Check if call was outbound').item.json.body.call.call_analysis.custom_analysis_data.first_name }}\\n\\nClient Number:\\n{{ $('Check if call was outbound').item.json.body.call.call_analysis.custom_analysis_data.phone_number }}\\n\\nAvailabilities:\\n{{ $('Check if call was outbound').item.json.body.call.call_analysis.custom_analysis_data.availabilities }}\\n\\n\\nCall Summary:\\n{{ $('Check if call was outbound').item.json.body.call.call_analysis.call_summary }}\\n\\n\\nChatGPT analysis of how the call went and suggestions for improving the voice prompt:\\n{{ $json.message.content }}\",\n        \"options\": {},\n        \"subject\": \"=Roofing Appointment Scheduled\",\n        \"emailType\": \"text\"\n      },\n      \"credentials\": {\n        \"gmailOAuth2\": {\n          \"id\": \"rKxQHWZ2F5XLJmwF\",\n          \"name\": \"Gmail account\"\n        }\n      },\n      \"typeVersion\": 2.1\n    },\n    {\n      \"id\": \"f75763b6-0867-4625-89e1-cafa3c9e6e44\",\n      \"name\": \"Sticky Note1\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -240,\n        -420\n      ],\n      \"parameters\": {\n        \"width\": 1260,\n        \"height\": 400,\n        \"content\": \"# âœ… General Workflow Explanation\\n##  This workflow automates outbound and inbound lead calls with RetellAI, Google Sheets, OpenAI, and Gmail. It handles:\\n\\nScheduling and reminding outbound qualification calls\\nHandling inbound appointment calls\\nAutomatically updating records and sending summaries post-call\\n\\n## ðŸ‘‰ Dependencies:\\n\\nActive RetellAI API key\\nGoogle Sheet set up with lead data\\nGmail API credentials configured\"\n      },\n      \"typeVersion\": 1\n    }\n  ],\n  \"active\": false,\n  \"pinData\": {},\n  \"settings\": {\n    \"executionOrder\": \"v1\"\n  },\n  \"versionId\": \"879f8e4d-91d7-41fc-825d-08f2ef283c25\",\n  \"connections\": {\n    \"Check if call was outbound\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Update lead record in Google Sheets\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Generate call summary with OpenAI\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Filter for analyzed calls only\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Check if call was outbound\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Detect new lead in Google Sheets\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Send SMS reminder to call lead in 5 minutes\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Generate call summary with OpenAI\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Send confirmation email to lead\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Wait 5 minutes before making call\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Call new lead using RetellAI\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Update lead record in Google Sheets\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Send call summary email\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Send SMS reminder to call lead in 5 minutes\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Wait 5 minutes before making call\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Receive inbound call from RetellAI (webhook)\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Check if phone number exists in Google Sheets\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Check if phone number exists in Google Sheets\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Send response to inbound webhook call\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Receive post-call data from RetellAI (webhook)\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Filter for analyzed calls only\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}",
  "metadata": {
    "node_types": [
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.googleSheetsTrigger",
      "n8n-nodes-base.twilio",
      "n8n-nodes-base.wait",
      "n8n-nodes-base.httpRequest",
      "n8n-nodes-base.webhook",
      "n8n-nodes-base.googleSheets",
      "n8n-nodes-base.respondToWebhook",
      "n8n-nodes-base.webhook",
      "n8n-nodes-base.filter",
      "n8n-nodes-base.if",
      "n8n-nodes-base.googleSheets",
      "n8n-nodes-base.gmail",
      "@n8n/n8n-nodes-langchain.openAi",
      "n8n-nodes-base.gmail",
      "n8n-nodes-base.stickyNote"
    ],
    "trigger": null
  }
}