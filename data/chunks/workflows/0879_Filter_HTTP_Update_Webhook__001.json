{
  "source": "0879_Filter_HTTP_Update_Webhook.json",
  "index": 1,
  "content": "{\n  \"meta\": {\n    \"instanceId\": \"408f9fb9940c3cb18ffdef0e0150fe342d6e655c3a9fac21f0f644e8bedabcd9\",\n    \"templateCredsSetupCompleted\": true\n  },\n  \"nodes\": [\n    {\n      \"id\": \"4bdd4360-b518-4b46-81fa-0d3183ce642d\",\n      \"name\": \"When Executed by Another Workflow\",\n      \"type\": \"n8n-nodes-base.executeWorkflowTrigger\",\n      \"position\": [\n        680,\n        260\n      ],\n      \"parameters\": {\n        \"workflowInputs\": {\n          \"values\": [\n            {\n              \"name\": \"operation\"\n            },\n            {\n              \"name\": \"query\"\n            },\n            {\n              \"name\": \"employeeId\"\n            },\n            {\n              \"name\": \"values\",\n              \"type\": \"object\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 1.1\n    },\n    {\n      \"id\": \"74bdcff0-0615-4d81-82ff-ff8340939399\",\n      \"name\": \"Operation\",\n      \"type\": \"n8n-nodes-base.switch\",\n      \"position\": [\n        1040,\n        260\n      ],\n      \"parameters\": {\n        \"rules\": {\n          \"values\": [\n            {\n              \"outputKey\": \"searchEmployee\",\n              \"conditions\": {\n                \"options\": {\n                  \"version\": 2,\n                  \"leftValue\": \"\",\n                  \"caseSensitive\": true,\n                  \"typeValidation\": \"strict\"\n                },\n                \"combinator\": \"and\",\n                \"conditions\": [\n                  {\n                    \"id\": \"81b134bc-d671-4493-b3ad-8df9be3f49a6\",\n                    \"operator\": {\n                      \"type\": \"string\",\n                      \"operation\": \"equals\"\n                    },\n                    \"leftValue\": \"={{ $('When Executed by Another Workflow').first().json.operation }}\",\n                    \"rightValue\": \"searchEmployees\"\n                  }\n                ]\n              },\n              \"renameOutput\": true\n            },\n            {\n              \"outputKey\": \"getEmployeeById\",\n              \"conditions\": {\n                \"options\": {\n                  \"version\": 2,\n                  \"leftValue\": \"\",\n                  \"caseSensitive\": true,\n                  \"typeValidation\": \"strict\"\n                },\n                \"combinator\": \"and\",\n                \"conditions\": [\n                  {\n                    \"id\": \"8d57914f-6587-4fb3-88e0-aa1de6ba56c1\",\n                    \"operator\": {\n                      \"name\": \"filter.operator.equals\",\n                      \"type\": \"string\",\n                      \"operation\": \"equals\"\n                    },\n                    \"leftValue\": \"={{ $('When Executed by Another Workflow').first().json.operation }}\",\n                    \"rightValue\": \"getEmployeeById\"\n                  }\n                ]\n              },\n              \"renameOutput\": true\n            },\n            {\n              \"outputKey\": \"updateEmployee\",\n              \"conditions\": {\n                \"options\": {\n                  \"version\": 2,\n                  \"leftValue\": \"\",\n                  \"caseSensitive\": true,\n                  \"typeValidation\": \"strict\"\n                },\n                \"combinator\": \"and\",\n                \"conditions\": [\n                  {\n                    \"id\": \"7c38f238-213a-46ec-aefe-22e0bcb8dffc\",\n                    \"operator\": {\n                      \"name\": \"filter.operator.equals\",\n                      \"type\": \"string\",\n                      \"operation\": \"equals\"\n                    },\n                    \"leftValue\": \"={{ $('When Executed by Another Workflow').first().json.operation }}\",\n                    \"rightValue\": \"updateEmployee\"\n                  }\n                ]\n              },\n              \"renameOutput\": true\n            }\n          ]\n        },\n        \"options\": {}\n      },\n      \"typeVersion\": 3.2\n    },\n    {\n      \"id\": \"8850cd57-9bc1-43b7-9366-7d91afc7bc42\",\n      \"name\": \"Sticky Note\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -80,\n        -120\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 680,\n        \"height\": 660,\n        \"content\": \"## 1. Set up an MCP Server Trigger\\n[Read more about the MCP Server Trigger](https://docs.n8n.io/integrations/builtin/core-nodes/n8n-nodes-langchain.mcptrigger)\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"ad541df3-44ed-4ef4-af91-841dc9986b4c\",\n      \"name\": \"Sticky Note1\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        620,\n        -120\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 600,\n        \"height\": 260,\n        \"content\": \"## 2. Build Your MCP Server from Existing APIs\\n[Read more about the HTTP Request Node](https://docs.n8n.io/integrations/builtin/core-nodes/n8n-nodes-base.httprequest)\\n\\nN8N allows any organisation to quickly build and host their own MCP server by leveraging existing APIs. Here's a quick example for PayCaptain.com - a cloud-based payroll software for modern companies.\\n\\nWith this set of tools, Paycaptain customers can simplify employee management from within their favourite MCP client such as Claude Desktop. Better yet, n8n also handles distribution so this MCP server can serve entire departments as well.\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"962cb379-8916-4a9f-8a7b-5aa9d31d5d88\",\n      \"name\": \"Sticky Note3\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -80,\n        -240\n      ],\n      \"parameters\": {\n        \"color\": 5,\n        \"width\": 380,\n        \"height\": 100,\n        \"content\": \"### Always Authenticate Your Server!\\nBefore going to production, it's always advised to enable authentication on your MCP server trigger.\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"27163110-36d7-46f3-92fc-dce7d000655e\",\n      \"name\": \"Paycaptain MCP Server\",\n      \"type\": \"@n8n/n8n-nodes-langchain.mcpTrigger\",\n      \"position\": [\n        80,\n        40\n      ],\n      \"webhookId\": \"5f6728df-d3e8-48bb-9a38-0f2e54c7962c\",\n      \"parameters\": {\n        \"path\": \"5f6728df-d3e8-48bb-9a38-0f2e54c7962c\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"13a69580-de33-489a-85c8-582877efbfe0\",\n      \"name\": \"Update Employee\",\n      \"type\": \"@n8n/n8n-nodes-langchain.toolWorkflow\",\n      \"position\": [\n        380,\n        260\n      ],\n      \"parameters\": {\n        \"name\": \"updateEmployee\",\n        \"workflowId\": {\n          \"__rl\": true,\n          \"mode\": \"id\",\n          \"value\": \"={{ $workflow.id }}\"\n        },\n        \"description\": \"Updates an employee's details.\",\n        \"workflowInputs\": {\n          \"value\": {\n            \"query\": \"null\",\n            \"values\": \"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('values', ``, 'string') }}\",\n            \"operation\": \"updateEmployee\",\n            \"employeeId\": \"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('employeeId', ``, 'string') }}\"\n          },\n          \"schema\": [\n            {\n              \"id\": \"operation\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"required\": false,\n              \"displayName\": \"operation\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"query\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"query\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"employeeId\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"employeeId\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"values\",\n              \"type\": \"object\",\n              \"display\": true,\n              \"required\": false,\n              \"displayName\": \"values\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            }\n          ],\n          \"mappingMode\": \"defineBelow\",\n          \"matchingColumns\": [],\n          \"attemptToConvertTypes\": false,\n          \"convertFieldsToString\": false\n        }\n      },\n      \"typeVersion\": 2.1\n    },\n    {\n      \"id\": \"68c066f0-657c-46cb-a9fe-b31e9850c512\",\n      \"name\": \"Get Employee\",\n      \"type\": \"@n8n/n8n-nodes-langchain.toolWorkflow\",\n      \"position\": [\n        240,\n        360\n      ],\n      \"parameters\": {\n        \"name\": \"getEmployeeById\",\n        \"workflowId\": {\n          \"__rl\": true,\n          \"mode\": \"id\",\n          \"value\": \"={{ $workflow.id }}\"\n        },\n        \"description\": \"Returns an employee's details by employee ID.\",\n        \"workflowInputs\": {\n          \"value\": {\n            \"query\": \"null\",\n            \"values\": \"null\",\n            \"operation\": \"getEmployeeById\",\n            \"employeeId\": \"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('employeeId', ``, 'string') }}\"\n          },\n          \"schema\": [\n            {\n              \"id\": \"operation\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"operation\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"query\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"query\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"employeeId\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"employeeId\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"values\",\n              \"type\": \"object\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"values\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            }\n          ],\n          \"mappingMode\": \"defineBelow\",\n          \"matchingColumns\": [],\n          \"attemptToConvertTypes\": false,\n          \"convertFieldsToString\": false\n        }\n      },\n      \"typeVersion\": 2.1\n    },\n    {\n      \"id\": \"87661e95-b618-4701-b0f3-9f0532d5fc75\",\n      \"name\": \"Get Employees\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        1380,\n        60\n      ],\n      \"parameters\": {\n        \"url\": \"https://api.paycaptain.com/employees\",\n        \"options\": {\n          \"pagination\": {\n            \"pagination\": {\n              \"parameters\": {\n                \"parameters\": [\n                  {\n                    \"name\": \"page\",\n                    \"value\": \"={{ $request.qs.page + 1 }}\"\n                  }\n                ]\n              },\n              \"maxRequests\": 3,\n              \"requestInterval\": 1000,\n              \"limitPagesFetched\": true\n            }\n          }\n        },\n        \"sendQuery\": true,\n        \"authentication\": \"genericCredentialType\",\n        \"genericAuthType\": \"httpHeaderAuth\",\n        \"queryParameters\": {\n          \"parameters\": [\n            {\n              \"name\": \"company\",\n              \"value\": \"paycaptain\"\n            },\n            {\n              \"name\": \"page\",\n              \"value\": \"={{ $json.page ?? 1 }}\"\n            }\n          ]\n        }\n      },\n      \"credentials\": {\n        \"httpHeaderAuth\": {\n          \"id\": \"sPolCkoJ1zhzWabJ\",\n          \"name\": \"JWT TOKEN\"\n        }\n      },\n      \"typeVersion\": 4.2\n    },\n    {\n      \"id\": \"866868e2-e0b0-4d8d-bf3c-57d68fea8b86\",\n      \"name\": \"Search Employees\",\n      \"type\": \"@n8n/n8n-nodes-langchain.toolWorkflow\",\n      \"position\": [\n        100,\n        260\n      ],\n      \"parameters\": {\n        \"name\": \"searchEmployees\",\n        \"workflowId\": {\n          \"__rl\": true,\n          \"mode\": \"id\",\n          \"value\": \"={{ $workflow.id }}\"\n        },\n        \"description\": \"Searches for and returns an employee's details.\",\n        \"workflowInputs\": {\n          \"value\": {\n            \"query\": \"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('query', ``, 'string') }}\",\n            \"values\": \"null\",\n            \"operation\": \"searchEmployees\",\n            \"employeeId\": \"null\"\n          },\n          \"schema\": [\n            {\n              \"id\": \"operation\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"operation\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"query\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"query\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"employeeId\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"employeeId\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"values\",\n              \"type\": \"object\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"values\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            }\n          ],\n          \"mappingMode\": \"defineBelow\",\n          \"matchingColumns\": [],\n          \"attemptToConvertTypes\": false,\n          \"convertFieldsToString\": false\n        }\n      },\n      \"typeVersion\": 2.1\n    },\n    {\n      \"id\": \"679a2413-448f-43d8-98fc-7fd8b83775e7\",\n      \"name\": \"Log Call\",\n      \"type\": \"n8n-nodes-base.googleSheets\",\n      \"position\": [\n        860,\n        260\n      ],\n      \"parameters\": {\n        \"columns\": {\n          \"value\": {\n            \"query\": \"={{ $json.query }}\",\n            \"values\": \"={{ $json.values.toJsonString() }}\",\n            \"operation\": \"={{ $json.operation }}\",\n            \"timestamp\": \"={{ $now.toISO() }}\",\n            \"employeeId\": \"={{ $json.employeeId }}\"\n          },\n          \"schema\": [\n            {\n              \"id\": \"timestamp\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"timestamp\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"operation\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"operation\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"query\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"query\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"employeeId\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"employeeId\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"values\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"values\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            }\n          ],\n          \"mappingMode\": \"defineBelow\",\n          \"matchingColumns\": [],\n          \"attemptToConvertTypes\": false,\n          \"convertFieldsToString\": false\n        },\n        \"options\": {\n          \"useAppend\": true\n        },\n        \"operation\": \"append\",\n        \"sheetName\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"gid=0\",\n          \"cachedResultUrl\": \"https://docs.google.com/spreadsheets/d/1Ls_3pmzIafl1NUAzzflkJgyq1smPW6vfGjbVuVzdkac/edit#gid=0\",\n          \"cachedResultName\": \"Sheet1\"\n        },\n        \"documentId\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"1Ls_3pmzIafl1NUAzzflkJgyq1smPW6vfGjbVuVzdkac\",\n          \"cachedResultUrl\": \"https://docs.google.com/spreadsheets/d/1Ls_3pmzIafl1NUAzzflkJgyq1smPW6vfGjbVuVzdkac/edit?usp=drivesdk\",\n          \"cachedResultName\": \"98. MCP Audit\"\n        }\n      },\n      \"credentials\": {\n        \"googleSheetsOAuth2Api\": {\n          \"id\": \"XHvC7jIRR8A2TlUl\",\n          \"name\": \"Google Sheets account\"\n        }\n      },\n      \"typeVersion\": 4.5\n    },\n    {\n      \"id\": \"7723947c-94a3-4bf1-b6c8-b595027a33dc\",\n      \"name\": \"Filter Matches\",\n      \"type\": \"n8n-nodes-base.filter\",\n      \"position\": [\n        1580,\n        60\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"conditions\": {\n          \"options\": {\n            \"version\": 2,\n            \"leftValue\": \"\",\n            \"caseSensitive\": true,\n            \"typeValidation\": \"strict\"\n          },\n          \"combinator\": \"and\",\n          \"conditions\": [\n            {\n              \"id\": \"baa681eb-d6d9-450b-99ab-58d33e81cef4\",\n              \"operator\": {\n                \"name\": \"filter.operator.equals\",\n                \"type\": \"string\",\n                \"operation\": \"equals\"\n              },\n              \"leftValue\": \"={{\\n[\\n  $json.hrEmployeeId,\\n  $json.payrollCode,\\n  $json.firstName + ' ' + $json.lastName,\\n  $json.email,\\n  $json.niNumber,\\n  $json.mailingCity,\\n  $json.jobTitle,\\n  $json.jobGrade,\\n  $json.department,\\n  $json.team\\n]\\n  .join(' ')\\n  .toLowerCase()\\n}}\",\n              \"rightValue\": \"={{ $('When Executed by Another Workflow').first().json.query.toLowerCase() }}\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 2.2\n    },\n    {\n      \"id\": \"f4d1ddd9-dde7-437f-9aa2-969ea0832f71\",\n      \"name\": \"Aggregate Search Results\",\n      \"type\": \"n8n-nodes-base.aggregate\",\n      \"position\": [\n        2020,\n        60\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"aggregate\": \"aggregateAllItemData\",\n        \"destinationFieldName\": \"response\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"45076cec-f554-44ae-b314-e43ba080abb5\",\n      \"name\": \"Get Employees1\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        1380,\n        260\n      ],\n      \"parameters\": {\n        \"url\": \"https://api.paycaptain.com/employees\",\n        \"options\": {\n          \"pagination\": {\n            \"pagination\": {\n              \"parameters\": {\n                \"parameters\": [\n                  {\n                    \"name\": \"page\",\n                    \"value\": \"={{ $request.qs.page + 1 }}\"\n                  }\n                ]\n              },\n              \"maxRequests\": 3,\n              \"requestInterval\": 1000,\n              \"limitPagesFetched\": true\n            }\n          }\n        },\n        \"sendQuery\": true,\n        \"authentication\": \"genericCredentialType\",\n        \"genericAuthType\": \"httpHeaderAuth\",\n        \"queryParameters\": {\n          \"parameters\": [\n            {\n              \"name\": \"company\",\n              \"value\": \"paycaptain\"\n            },\n            {\n              \"name\": \"page\",\n              \"value\": \"={{ $json.page ?? 1 }}\"\n            }\n          ]\n        }\n      },\n      \"credentials\": {\n        \"httpHeaderAuth\": {\n          \"id\": \"sPolCkoJ1zhzWabJ\",\n          \"name\": \"JWT TOKEN\"\n        }\n      },\n      \"typeVersion\": 4.2\n    },\n    {\n      \"id\": \"b6f3a56f-5cd2-4f4d-904b-49e82ec591b8\",\n      \"name\": \"Filter Matching ID\",\n      \"type\": \"n8n-nodes-base.filter\",\n      \"position\": [\n        1580,\n        260\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"conditions\": {\n          \"options\": {\n            \"version\": 2,\n            \"leftValue\": \"\",\n            \"caseSensitive\": true,\n            \"typeValidation\": \"strict\"\n          },\n          \"combinator\": \"and\",\n          \"conditions\": [\n            {\n              \"id\": \"cfb2ba5b-14c0-4867-be4d-180306c896ae\",\n              \"operator\": {\n                \"name\": \"filter.operator.equals\",\n                \"type\": \"string\",\n                \"operation\": \"equals\"\n              },\n              \"leftValue\": \"={{ $json.hrEmployeeId }}\",\n              \"rightValue\": \"={{ $('When Executed by Another Workflow').first().json.employeeId }}\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 2.2\n    },\n    {\n      \"id\": \"ecc2d8d5-4a23-4bfd-840b-63c28980462f\",\n      \"name\": \"Strip Sensitive Fields1\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        1800,\n        260\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"e20217cf-7c70-4907-9da6-a114104a099e\",\n              \"name\": \"company\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.company }}\"\n            },\n            {\n              \"id\": \"2dfe8342-c442-4ac3-90bd-92fe7d38d407\",\n              \"name\": \"hrEmployeeId\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.hrEmployeeId }}\"\n            },\n            {\n              \"id\": \"57fe4519-246b-44aa-a0c9-22e1e865041c\",\n              \"name\": \"payrollCode\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.payrollCode }}\"\n            },\n            {\n              \"id\": \"d296021c-09b2-43b2-8b8e-ebb5d7d9d14d\",\n              \"name\": \"firstName\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.firstName }}\"\n            },\n            {\n              \"id\": \"661e0049-d28f-4f78-83fc-7a1b21f742c2\",\n              \"name\": \"lastName\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.lastName }}\"\n            },\n            {\n              \"id\": \"59f7fd87-ba84-426a-ad61-c682cf8227bf\",\n              \"name\": \"email\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.email }}\"\n            },\n            {\n              \"id\": \"9769c078-c5f5-4d56-b467-765dd73444f9\",\n              \"name\": \"phone\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.phone }}\"\n            },\n            {\n              \"id\": \"e387bc11-dccf-4baf-b87f-a2abb5f61b5d\",\n              \"name\": \"mailingStreet\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.mailingStreet }}\"\n            },\n            {\n              \"id\": \"415451c5-c3c1-42d4-9f5b-829277bfb7f3\",\n              \"name\": \"mailingStateProvince\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.mailingStateProvince }}\"\n            },\n            {\n              \"id\": \"cf2a83f4-28a8-44bd-9d06-780db1406f8f\",\n              \"name\": \"mailingPostalCode\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.mailingPostalCode }}\"\n            },\n            {\n              \"id\": \"94ee2e05-9969-43f2-a732-57356f8b4dfe\",\n              \"name\": \"mailingCountry\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.mailingCountry }}\"\n            },\n            {\n              \"id\": \"b01a56c9-fc42-4bff-9443-27075699986f\",\n              \"name\": \"location\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.location }}\"\n            },\n            {\n              \"id\": \"b9175d72-6976-4765-b773-f4521668d130\",\n              \"name\": \"department\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.department }}\"\n            },\n            {\n              \"id\": \"d784e800-e13b-4d43-907c-11aaaf4ee24f\",\n              \"name\": \"team\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.team }}\"\n            },\n            {\n              \"id\": \"1ff68eb6-35f9-4a2d-9a37-14b3a6f6e0ee\",\n              \"name\": \"jobGrade\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.jobGrade }}\"\n            },\n            {\n              \"id\": \"5628bbf8-872d-4e3a-bf37-c36f13c0f4b1\",\n              \"name\": \"jobTitle\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.jobTitle }}\"\n            },\n            {\n              \"id\": \"34f26d59-43b3-4f2c-955b-f6d5ab22a083\",\n              \"name\": \"jobEffectiveDate\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.jobEffectiveDate }}\"\n            },\n            {\n              \"id\": \"e3023e94-fbc8-4e9b-b106-687ea533e3f8\",\n              \"name\": \"contractType\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.contractType }}\"\n            },\n            {\n              \"id\": \"d3dcf24c-5e9b-40e5-9f54-fca930ab1528\",\n              \"name\": \"normalWeeklyHours\",\n              \"type\": \"number\",\n              \"value\": \"={{ $json.normalWeeklyHours }}\"\n            },\n            {\n              \"id\": \"65ed75a6-1ec1-456f-b19b-4492e31f5c18\",\n              \"name\": \"daysWorkedPerWeek\",\n              \"type\": \"number\",\n              \"value\": \"={{ $json.daysWorkedPerWeek }}\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 3.4\n    },\n    {\n      \"id\": \"77a71a55-f0cf-4f76-b697-b31dba447f30\",\n      \"name\": \"Strip Sensitive Fields\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        1800,\n        60\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"e20217cf-7c70-4907-9da6-a114104a099e\",\n              \"name\": \"company\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.company }}\"\n            },\n            {\n              \"id\": \"2dfe8342-c442-4ac3-90bd-92fe7d38d407\",\n              \"name\": \"hrEmployeeId\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.hrEmployeeId }}\"\n            },\n            {\n              \"id\": \"57fe4519-246b-44aa-a0c9-22e1e865041c\",\n              \"name\": \"payrollCode\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.payrollCode }}\"\n            },\n            {\n              \"id\": \"d296021c-09b2-43b2-8b8e-ebb5d7d9d14d\",\n              \"name\": \"firstName\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.firstName }}\"\n            },\n            {\n              \"id\": \"661e0049-d28f-4f78-83fc-7a1b21f742c2\",\n              \"name\": \"lastName\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.lastName }}\"\n            },\n            {\n              \"id\": \"59f7fd87-ba84-426a-ad61-c682cf8227bf\",\n              \"name\": \"email\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.email }}\"\n            },\n            {\n              \"id\": \"9769c078-c5f5-4d56-b467-765dd73444f9\",\n              \"name\": \"phone\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.phone }}\"\n            },\n            {\n              \"id\": \"e387bc11-dccf-4baf-b87f-a2abb5f61b5d\",\n              \"name\": \"mailingStreet\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.mailingStreet }}\"\n            },\n            {\n              \"id\": \"415451c5-c3c1-42d4-9f5b-829277bfb7f3\",\n              \"name\": \"mailingStateProvince\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.mailingStateProvince }}\"\n            },\n            {\n              \"id\": \"cf2a83f4-28a8-44bd-9d06-780db1406f8f\",\n              \"name\": \"mailingPostalCode\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.mailingPostalCode }}\"\n            },\n            {\n              \"id\": \"94ee2e05-9969-43f2-a732-57356f8b4dfe\",\n              \"name\": \"mailingCountry\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.mailingCountry }}\"\n            },\n            {\n              \"id\": \"b01a56c9-fc42-4bff-9443-27075699986f\",\n              \"name\": \"location\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.location }}\"\n            },\n            {\n              \"id\": \"b9175d72-6976-4765-b773-f4521668d130\",\n              \"name\": \"department\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.department }}\"\n            },\n            {\n              \"id\": \"d784e800-e13b-4d43-907c-11aaaf4ee24f\",\n              \"name\": \"team\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.team }}\"\n            },\n            {\n              \"id\": \"1ff68eb6-35f9-4a2d-9a37-14b3a6f6e0ee\",\n              \"name\": \"jobGrade\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.jobGrade }}\"\n            },\n            {\n              \"id\": \"5628bbf8-872d-4e3a-bf37-c36f13c0f4b1\",\n              \"name\": \"jobTitle\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.jobTitle }}\"\n            },\n            {\n              \"id\": \"34f26d59-43b3-4f2c-955b-f6d5ab22a083\",\n              \"name\": \"jobEffectiveDate\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.jobEffectiveDate }}\"\n            },\n            {\n              \"id\": \"e3023e94-fbc8-4e9b-b106-687ea533e3f8\",\n              \"name\": \"contractType\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.contractType }}\"\n            },\n            {\n              \"id\": \"d3dcf24c-5e9b-40e5-9f54-fca930ab1528\",\n              \"name\": \"normalWeeklyHours\",\n              \"type\": \"number\",\n              \"value\": \"={{ $json.normalWeeklyHours }}\"\n            },\n            {\n              \"id\": \"65ed75a6-1ec1-456f-b19b-4492e31f5c18\",\n              \"name\": \"daysWorkedPerWeek\",\n              \"type\": \"number\",\n              \"value\": \"={{ $json.daysWorkedPerWeek }}\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 3.4\n    },\n    {\n      \"id\": \"86f73b12-afc8-4694-a79d-45c908cc88dd\",\n      \"name\": \"Update Employee1\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        1800,\n        460\n      ],\n      \"parameters\": {\n        \"url\": \"https://api.paycaptain.com/employee\",\n        \"method\": \"POST\",\n        \"options\": {\n          \"pagination\": {\n            \"pagination\": {\n              \"parameters\": {\n                \"parameters\": [\n                  {\n                    \"name\": \"page\",\n                    \"value\": \"={{ $request.qs.page + 1 }}\"\n                  }\n                ]\n              },\n              \"maxRequests\": 3,\n              \"requestInterval\": 1000,\n              \"limitPagesFetched\": true\n            }\n          }\n        },\n        \"jsonBody\": \"={{\\n{\\n  hrEmployeeId: $('When Executed by Another Workflow').item.json.employeeId,\\n  ..\\n}\\n}}\",\n        \"sendBody\": true,\n        \"specifyBody\": \"json\",\n        \"authentication\": \"genericCredentialType\",\n        \"genericAuthType\": \"httpHeaderAuth\"\n      },\n      \"credentials\": {\n        \"httpHeaderAuth\": {\n          \"id\": \"sPolCkoJ1zhzWabJ\",\n          \"name\": \"JWT TOKEN\"\n        }\n      },\n      \"typeVersion\": 4.2\n    },\n    {\n      \"id\": \"122fe6f7-3bcd-4f29-a95c-c727a799e1fd\",\n      \"name\": \"Valid Fields Only\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        1380,\n        460\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"4f3d0703-21f3-4ca1-bf7a-9c80d9efc936\",\n              \"name\": \"values\",\n              \"type\": \"object\",\n              \"value\": \"={{\\n([\\n  \\\"firstname\\\",\\n  \\\"middlename\\\",\\n  \\\"lastname\\\",\\n  \\\"mailingStreet\\\",\\n  \\\"mailingCity\\\",\\n  \\\"mailingStateProvince\\\",\\n  \\\"mailingPostalCode\\\",\\n  \\\"mailingCountry\\\",\\n  \\\"email\\\",\\n  \\\"phone\\\",\\n  \\\"niNumber\\\",\\n  \\\"location\\\",\\n  \\\"department\\\",\\n  \\\"team\\\",\\n  \\\"jobGrade\\\",\\n  \\\"jobTitle\\\",\\n]\\n  .reduce((acc, key) => ({\\n    ...acc,\\n    [key]: $('When Executed by Another Workflow').item.json.values[key] ?? undefined\\n  }), {}))\\n}}\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 3.4\n    },\n    {\n      \"id\": \"13e5f143-1abf-444c-b86c-ae51fe839894\",\n      \"name\": \"Has Valid Request?\",\n      \"type\": \"n8n-nodes-base.if\",\n      \"position\": [\n        1580,\n        460\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"conditions\": {\n          \"options\": {\n            \"version\": 2,\n            \"leftValue\": \"\",\n            \"caseSensitive\": true,\n            \"typeValidation\": \"strict\"\n          },\n          \"combinator\": \"and\",\n          \"conditions\": [\n            {\n              \"id\": \"54d35a49-e698-427d-9fca-280b83f2827d\",\n              \"operator\": {\n                \"type\": \"object\",\n                \"operation\": \"notEmpty\",\n                \"singleValue\": true\n              },\n              \"leftValue\": \"={{ $json.values }}\",\n              \"rightValue\": \"\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 2.2\n    },\n    {\n      \"id\": \"b98f1d73-a994-4040-b421-75e626ec4ce6\",\n      \"name\": \"Get Error Response\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        1800,\n        640\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"b33ebf1d-d0e8-4dda-90e7-b53c21b2a410\",\n              \"name\": \"response\",\n              \"type\": \"string\",\n              \"value\": \"=Request included fields which cannot be updated. Editable fields are: {{ [\\n  \\\"firstname\\\",\\n  \\\"middlename\\\",\\n  \\\"lastname\\\",\\n  \\\"mailingStreet\\\",\\n  \\\"mailingCity\\\",\\n  \\\"mailingStateProvince\\\",\\n  \\\"mailingPostalCode\\\",\\n  \\\"mailingCountry\\\",\\n  \\\"email\\\",\\n  \\\"phone\\\",\\n  \\\"niNumber\\\",\\n  \\\"location\\\",\\n  \\\"department\\\",\\n  \\\"team\\\",\\n  \\\"jobGrade\\\",\\n  \\\"jobTitle\\\",\\n].join(', ')}}\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 3.4\n    },\n    {\n      \"id\": \"cb140f3f-571c-49a4-a24d-dcee11c5b7e1\",\n      \"name\": \"Get Success Response\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        2020,\n        460\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"a1d245c9-b1e5-4cec-a901-4a6ecc9bd98d\",\n              \"name\": \"response\",\n              \"type\": \"string\",\n              \"value\": \"ok\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 3.4\n    },\n    {\n      \"id\": \"39cd1188-5f2e-45ce-8bbc-0586812491ec\",\n      \"name\": \"Aggregate Get Response\",\n      \"type\": \"n8n-nodes-base.aggregate\",\n      \"position\": [\n        2020,\n        260\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"aggregate\": \"aggregateAllItemData\",\n        \"destinationFieldName\": \"response\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"d9c1ed21-29e4-41a6-9855-36f1568f7944\",\n      \"name\": \"Sticky Note2\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        620,\n        -360\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 400,\n        \"height\": 220,\n        \"content\": \"![](https://cdn.prod.website-files.com/6628137b611845ebff95551f/6628137b611845ebff9556e7_paycaptain-logo.svg#full-width)\\n**Website**: https://paycaptain.com\\n**DeveloperHub**: https://developer.paycaptain.com\\n\\n**Good to know:** PayCaptain also sponsors the n8n London Meetups - Definitely check them out!\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"efc7ab35-202d-4a1f-98ce-7ae310c22250\",\n      \"name\": \"Sticky Note4\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -540,\n        -640\n      ],\n      \"parameters\": {\n        \"width\": 440,\n        \"height\": 1180,\n        \"content\": \"## Try It Out!\\n### This n8n demonstrates how any organisation can quickly and easily build and offer MCP servers to their customers or internal staff to improve productivity.\\n\\nThis MCP example uses PayCaptain.com as an example and shows how to create an MCP server which can search for and update employee data.\\n\\n### How it works\\n* A MCP server trigger is used and connected to 3 custom workflow tools: Search Employee, Get Employee by ID and Update Employee.\\n* Each tool makes calls to the PayCaptain API to perform their respective tasks. Extra care  is performed to strip out sensitive data and ensure we're not sharing too much.\\n* The Update Employee too also guards against updating fields which would preferably remain readonly. When you control the MCP server, you can determine behaviour of the tool.\\n* Finally, a Google Sheet node is used to log all operations for later audit. This will add a tiny bit of latency but recommended if sensitive data is being accessed.\\n\\n### How to use\\n* This MCP server allows any compatible MCP client to manage their PayCaptain employee database. You will need to have a PayCaptain account and developer key to use it.\\n* Connect your MCP client by following the n8n guidelines here - https://docs.n8n.io/integrations/builtin/core-nodes/n8n-nodes-langchain.mcptrigger/#integrating-with-claude-desktop\\n* Try the following queries in your MCP client:\\n  * \\\"When did Sarah start here employment at the company?\\\"\\n  * \\\"Does Jack work Wednesdays or Fridays?\\\"\\n  * \\\"Please update Tracy's NI number to ABCD123456\\\"\\n\\n### Requirements\\n* PayCaptain Account and Developer Key.\\n* Google Sheets to log actions for later audit.\\n* MCP Client or Agent for usage such as Claude Desktop - https://claude.ai/download\\n\\n### Customising this workflow\\n* Add or remove employee attributes as required for your user case.\\n* If Google Sheets is too slow, consider an API call to a faster service to log calls to the MCP server.\\n* Remember to set the MCP server to require credentials before going to production and sharing this MCP server with others!\"\n      },\n      \"typeVersion\": 1\n    }\n  ],\n  \"pinData\": {},\n  \"connections\": {\n    \"Log Call\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Operation\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Operation\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Get Employees\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Get Employees1\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Valid Fields Only\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Get Employee\": {\n      \"ai_tool\": [\n        [\n          {\n            \"node\": \"Paycaptain MCP Server\",\n            \"type\": \"ai_tool\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Get Employees\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Filter Matches\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Filter Matches\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Strip Sensitive Fields\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Get Employees1\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Filter Matching ID\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Update Employee\": {\n      \"ai_tool\": [\n        [\n          {\n            \"node\": \"Paycaptain MCP Server\",\n            \"type\": \"ai_tool\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Search Employees\": {\n      \"ai_tool\": [\n        [\n          {\n            \"node\": \"Paycaptain MCP Server\",\n            \"type\": \"ai_tool\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Update Employee1\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Get Success Response\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Valid Fields Only\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Has Valid Request?\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Filter Matching ID\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Strip Sensitive Fields1\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Has Valid Request?\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Update Employee1\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Get Error Response\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Strip Sensitive Fields\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Aggregate Search Results\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Strip Sensitive Fields1\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Aggregate Get Response\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"When Executed by Another Workflow\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Log Call\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}",
  "metadata": {
    "node_types": [
      "n8n-nodes-base.executeWorkflowTrigger",
      "n8n-nodes-base.switch",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "@n8n/n8n-nodes-langchain.mcpTrigger",
      "@n8n/n8n-nodes-langchain.toolWorkflow",
      "@n8n/n8n-nodes-langchain.toolWorkflow",
      "n8n-nodes-base.httpRequest",
      "@n8n/n8n-nodes-langchain.toolWorkflow",
      "n8n-nodes-base.googleSheets",
      "n8n-nodes-base.filter",
      "n8n-nodes-base.aggregate",
      "n8n-nodes-base.httpRequest",
      "n8n-nodes-base.filter",
      "n8n-nodes-base.set",
      "n8n-nodes-base.set",
      "n8n-nodes-base.httpRequest",
      "n8n-nodes-base.set",
      "n8n-nodes-base.if",
      "n8n-nodes-base.set",
      "n8n-nodes-base.set",
      "n8n-nodes-base.aggregate",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote"
    ],
    "trigger": null
  }
}