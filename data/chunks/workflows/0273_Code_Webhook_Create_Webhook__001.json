{
  "source": "0273_Code_Webhook_Create_Webhook.json",
  "index": 1,
  "content": "{\n  \"meta\": {\n    \"instanceId\": \"237600ca44303ce91fa31ee72babcdc8493f55ee2c0e8aa2b78b3b4ce6f70bd9\"\n  },\n  \"nodes\": [\n    {\n      \"id\": \"b220e0c7-3c34-4221-8fee-11c133a5345b\",\n      \"name\": \"Get ticket\",\n      \"type\": \"n8n-nodes-base.zendesk\",\n      \"position\": [\n        740,\n        540\n      ],\n      \"parameters\": {\n        \"id\": \"={{$node[\\\"On new Zendesk ticket\\\"].json[\\\"body\\\"][\\\"id\\\"]}}\",\n        \"operation\": \"get\"\n      },\n      \"credentials\": {\n        \"zendeskApi\": {\n          \"id\": \"24\",\n          \"name\": \"[UPDATE ME]\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"e58834a7-1a94-429f-a50c-2e27293c32a0\",\n      \"name\": \"IF\",\n      \"type\": \"n8n-nodes-base.if\",\n      \"position\": [\n        1140,\n        540\n      ],\n      \"parameters\": {\n        \"conditions\": {\n          \"string\": [\n            {\n              \"value1\": \"={{$node[\\\"Determine\\\"].json[\\\"Slack Thread ID\\\"]}}\",\n              \"operation\": \"isNotEmpty\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"c6f82ab9-54f4-4f91-a4d9-018739c6519d\",\n      \"name\": \"Update ticket\",\n      \"type\": \"n8n-nodes-base.zendesk\",\n      \"notes\": \"Update the Zendesk ticket by adding the Jira issue key to the \\\"Jira Issue Key\\\" field.\",\n      \"position\": [\n        1540,\n        640\n      ],\n      \"parameters\": {\n        \"id\": \"={{$node[\\\"On new Zendesk ticket\\\"].json[\\\"body\\\"][\\\"id\\\"]}}\",\n        \"operation\": \"update\",\n        \"updateFields\": {\n          \"customFieldsUi\": {\n            \"customFieldsValues\": [\n              {\n                \"id\": 7022397804317,\n                \"value\": \"={{$node[\\\"Create thread\\\"].json[\\\"ts\\\"]}}\"\n              }\n            ]\n          }\n        }\n      },\n      \"credentials\": {\n        \"zendeskApi\": {\n          \"id\": \"24\",\n          \"name\": \"[UPDATE ME]\"\n        }\n      },\n      \"notesInFlow\": true,\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"74d93ba5-d82d-4cc4-a177-bd86dbc18534\",\n      \"name\": \"On new Zendesk ticket\",\n      \"type\": \"n8n-nodes-base.webhook\",\n      \"position\": [\n        540,\n        540\n      ],\n      \"webhookId\": \"b7845b15-0a44-4be5-b513-f4f4bb8989a6\",\n      \"parameters\": {\n        \"path\": \"b7845b15-0a44-4be5-b513-f4f4bb8989a6\",\n        \"options\": {},\n        \"httpMethod\": \"POST\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"65d387cd-5c7a-4567-9a3c-9fa033f98ac9\",\n      \"name\": \"Create thread\",\n      \"type\": \"n8n-nodes-base.slack\",\n      \"position\": [\n        1340,\n        640\n      ],\n      \"parameters\": {\n        \"text\": \"={{$node[\\\"Get ticket\\\"].json[\\\"subject\\\"]}}\",\n        \"channel\": \"={{$node[\\\"Configure\\\"].parameter[\\\"values\\\"][\\\"string\\\"][0][\\\"value\\\"]}}\",\n        \"attachments\": [],\n        \"otherOptions\": {},\n        \"authentication\": \"oAuth2\"\n      },\n      \"credentials\": {\n        \"slackOAuth2Api\": {\n          \"id\": \"28\",\n          \"name\": \"[UPDATE ME]\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"50f5aa84-70bc-4b08-a9cc-576fbed72636\",\n      \"name\": \"Create reply on existing thread\",\n      \"type\": \"n8n-nodes-base.slack\",\n      \"position\": [\n        1340,\n        440\n      ],\n      \"parameters\": {\n        \"text\": \"={{$node[\\\"On new Zendesk ticket\\\"].json[\\\"body\\\"][\\\"comment\\\"]}}\",\n        \"channel\": \"={{$node[\\\"Configure\\\"].parameter[\\\"values\\\"][\\\"string\\\"][0][\\\"value\\\"]}}\",\n        \"attachments\": [],\n        \"otherOptions\": {\n          \"thread_ts\": \"={{$node[\\\"Determine\\\"].json[\\\"Slack Thread ID\\\"]}}\"\n        },\n        \"authentication\": \"oAuth2\"\n      },\n      \"credentials\": {\n        \"slackOAuth2Api\": {\n          \"id\": \"28\",\n          \"name\": \"[UPDATE ME]\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"6d5e8df0-4b0b-487c-81be-93359976dd90\",\n      \"name\": \"Configure\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        540,\n        360\n      ],\n      \"parameters\": {\n        \"values\": {\n          \"string\": [\n            {\n              \"name\": \"Slack channel\",\n              \"value\": \"#zendesk-updates\"\n            }\n          ]\n        },\n        \"options\": {\n          \"dotNotation\": false\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"934b95bb-2ffa-40a4-a2ca-02cfd646dd78\",\n      \"name\": \"Note\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -20,\n        360\n      ],\n      \"parameters\": {\n        \"width\": 469.4813676974197,\n        \"height\": 268.2900466166276,\n        \"content\": \"## Sync Zendesk tickets to Slack threads\\n### Setup\\n1. Add your [Zendesk credential](https://docs.n8n.io/integrations/builtin/credentials/zendesk/) to the `Get ticket` and `Update ticket` nodes.\\n2. Add your [Slack credential](https://docs.n8n.io/integrations/builtin/credentials/slack/) to `Create Thread` and `Create reply on existing thread` nodes.\\n3. Open `Configure` node and change \\\"Slack channel\\\" value to your slack channel (like #zendesk-updates).\\n4. Activate the workflow so it runs automatically each time a Zendesk ticket is created.\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"b582f7ff-7cc6-48dc-89fc-bc8bde13b06e\",\n      \"name\": \"Code\",\n      \"type\": \"n8n-nodes-base.code\",\n      \"notes\": \"if thread was created already in Slack\",\n      \"position\": [\n        940,\n        540\n      ],\n      \"parameters\": {\n        \"jsCode\": \"/* configure here =========================================================== */\\n/*  Zendesk field ID which represents the \\\"Slack Thread ID\\\" field.\\n*/\\nconst ISSUE_KEY_FIELD_ID = 7022397804317;\\n\\n/* ========================================================================== */\\nnew_items = [];\\n\\nfor (item of $items(\\\"Get ticket\\\")) {\\n    \\n    // instantiate a new variable for status\\n    var custom_fields = item.json[\\\"custom_fields\\\"];\\n    var slack_thread_id = \\\"\\\";\\n    for (var i = 0; i < custom_fields.length; i++) {\\n        if (custom_fields[i].id == ISSUE_KEY_FIELD_ID) {\\n            slack_thread_id = custom_fields[i].value;\\n            break;\\n        }\\n    }\\n\\n    // push the new item to the new_items array\\n    new_items.push({\\n        \\\"Slack Thread ID\\\": slack_thread_id\\n    });\\n}\\n\\nreturn new_items;\"\n      },\n      \"notesInFlow\": true,\n      \"typeVersion\": 1\n    }\n  ],\n  \"connections\": {\n    \"IF\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Create reply on existing thread\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Create thread\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Code\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"IF\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Get ticket\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Code\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Create thread\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Update ticket\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"On new Zendesk ticket\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Get ticket\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}",
  "metadata": {
    "node_types": [
      "n8n-nodes-base.zendesk",
      "n8n-nodes-base.if",
      "n8n-nodes-base.zendesk",
      "n8n-nodes-base.webhook",
      "n8n-nodes-base.slack",
      "n8n-nodes-base.slack",
      "n8n-nodes-base.set",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.code"
    ],
    "trigger": null
  }
}