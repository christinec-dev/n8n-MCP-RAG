{
  "source": "0344_HTTP_Emailreadimap_Create_Webhook.json",
  "index": 1,
  "content": "{\n  \"id\": 1,\n  \"name\": \"Create Nextcloud Deck card from email\",\n  \"nodes\": [\n    {\n      \"name\": \"IMAP Email\",\n      \"type\": \"n8n-nodes-base.emailReadImap\",\n      \"notes\": \"Check email\",\n      \"position\": [\n        480,\n        140\n      ],\n      \"parameters\": {\n        \"options\": {}\n      },\n      \"credentials\": {\n        \"imap\": {\n          \"id\": \"2\",\n          \"name\": \"todo@yourdomain.com\"\n        }\n      },\n      \"notesInFlow\": true,\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Function\",\n      \"type\": \"n8n-nodes-base.function\",\n      \"notes\": \"Strip HTML code\",\n      \"position\": [\n        730,\n        140\n      ],\n      \"parameters\": {\n        \"functionCode\": \"// Code here will run only once, no matter how many input items there are.\\n// More info and help: https://docs.n8n.io/nodes/n8n-nodes-base.function\\n\\n// Loop over inputs and add a new field called 'myNewField' to the JSON of each one\\nfor (item of items) {\\n  if (item.json.textHtml) {\\n    // Remove HTML, double quotations, line breaks, carriage returns\\n    item.json.body = item.json.textHtml.replace(/<br(\\\\s*?\\\\/?)>/g, \\\"\\\\\\\\n\\\").replace(/(<([^>]+)>)/g, \\\"\\\").replace(/\\\\\\\"/g, \\\"\\\");\\n    //item.json.body = item.json.textHtml.eplace(/(<([^>]+)>)/g, \\\"\\\").replace(/\\\\\\\"/g, \\\"\\\").replace(/\\\\n/g, \\\"\\\").replace(/\\\\r/g, \\\"\\\");\\n  } else {\\n    // Remove double quotations, line breaks, carriage returns\\n    item.json.body = item.json.textPlain.replace(/\\\\\\\"/g, \\\"\\\").replace(/\\\\n/g, \\\"\\\\\\\\n\\\").replace(/\\\\r/g, \\\"\\\");\\n  }\\n}\\n\\n// You can write logs to the browser console\\nconsole.log('Done!');\\n\\nreturn items;\"\n      },\n      \"notesInFlow\": true,\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"HTTP Request\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"notes\": \"Add card to Nextcloud Deck App. Configure board / stack id to your environment.\",\n      \"position\": [\n        970,\n        140\n      ],\n      \"parameters\": {\n        \"url\": \"https://your.nextcloud.com/index.php/apps/deck/api/v1.0/boards/YOUR-BOARD-ID/stacks/YOUR-STACK-ID/cards\",\n        \"options\": {},\n        \"requestMethod\": \"POST\",\n        \"authentication\": \"basicAuth\",\n        \"jsonParameters\": true,\n        \"bodyParametersJson\": \"={\\n\\\"title\\\": \\\"{{$json[\\\"subject\\\"]}}\\\",\\n\\\"type\\\": \\\"plain\\\",\\n\\\"order\\\": -1,\\n\\\"description\\\": \\\"{{$json[\\\"body\\\"]}}\\\"\\n}\",\n        \"headerParametersJson\": \"{\\n\\\"OCS-APIRequest\\\": \\\"true\\\",\\n\\\"Content-Type\\\": \\\"application/json\\\"\\n}\"\n      },\n      \"credentials\": {\n        \"httpBasicAuth\": {\n          \"id\": \"3\",\n          \"name\": \"Nextcloud credential\"\n        }\n      },\n      \"notesInFlow\": true,\n      \"typeVersion\": 1\n    }\n  ],\n  \"active\": true,\n  \"settings\": {},\n  \"connections\": {\n    \"Function\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"HTTP Request\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"IMAP Email\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Function\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}",
  "metadata": {
    "node_types": [
      "n8n-nodes-base.emailReadImap",
      "n8n-nodes-base.function",
      "n8n-nodes-base.httpRequest"
    ],
    "trigger": null
  }
}