{
  "source": "1817_Manual_HTTP_Update_Webhook.json",
  "index": 1,
  "content": "{\n  \"id\": \"cDmsWx8ASzIxE3zw\",\n  \"meta\": {\n    \"instanceId\": \"494d0146a0f47676ad70a44a32086b466621f62da855e3eaf0ee51dee1f76753\",\n    \"templateCredsSetupCompleted\": true\n  },\n  \"name\": \"Update all Zammad Roles to default values\",\n  \"tags\": [],\n  \"nodes\": [\n    {\n      \"id\": \"32904945-fd7b-413f-898c-62b04406dfb0\",\n      \"name\": \"When clicking ‘Test workflow’\",\n      \"type\": \"n8n-nodes-base.manualTrigger\",\n      \"position\": [\n        -920,\n        160\n      ],\n      \"parameters\": {},\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"cbb0abd2-e153-477a-9346-00eaa1628c78\",\n      \"name\": \"Zammad Univeral User Object\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        100,\n        220\n      ],\n      \"parameters\": {\n        \"values\": {\n          \"number\": [\n            {\n              \"name\": \"user_id\",\n              \"value\": \"={{ $json.id }}\"\n            },\n            {\n              \"name\": \"organization_id\",\n              \"value\": \"={{ $json.organization_id }}\"\n            }\n          ],\n          \"string\": [\n            {\n              \"name\": \"email\",\n              \"value\": \"={{ $json.email }}\"\n            },\n            {\n              \"name\": \"firstname\",\n              \"value\": \"={{ $json.firstname }}\"\n            },\n            {\n              \"name\": \"lastname\",\n              \"value\": \"={{ $json.lastname }}\"\n            },\n            {\n              \"name\": \"role_ids\",\n              \"value\": \"={{ $json.role_ids.join() }}\\n\"\n            },\n            {\n              \"name\": \"groups\",\n              \"value\": \"={{ $json.group_ids }}\"\n            },\n            {\n              \"name\": \"active\",\n              \"value\": \"={{ $json.active }}\"\n            }\n          ]\n        },\n        \"options\": {},\n        \"keepOnlySet\": true\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"bbf82b69-07b5-4dff-afec-ee65eeedd037\",\n      \"name\": \"Get all Users\",\n      \"type\": \"n8n-nodes-base.zammad\",\n      \"position\": [\n        -220,\n        220\n      ],\n      \"parameters\": {\n        \"filters\": {},\n        \"operation\": \"getAll\",\n        \"returnAll\": true\n      },\n      \"credentials\": {\n        \"zammadTokenAuthApi\": {\n          \"id\": \"fj5GuzcJuNLQeMxz\",\n          \"name\": \"Zammad Token Auth account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"0c122c6b-22a7-41f5-8ea1-c9a32cd12ed6\",\n      \"name\": \"If\",\n      \"type\": \"n8n-nodes-base.if\",\n      \"position\": [\n        400,\n        220\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"conditions\": {\n          \"options\": {\n            \"version\": 2,\n            \"leftValue\": \"\",\n            \"caseSensitive\": true,\n            \"typeValidation\": \"strict\"\n          },\n          \"combinator\": \"and\",\n          \"conditions\": [\n            {\n              \"id\": \"0be03c44-5017-4db6-87cd-91838b953d09\",\n              \"operator\": {\n                \"type\": \"array\",\n                \"operation\": \"notContains\",\n                \"rightType\": \"any\"\n              },\n              \"leftValue\": \"={{ $('Basic Variables').item.json.exclude_zammad_users_by_id }}\",\n              \"rightValue\": \"={{ $json.user_id }}\"\n            },\n            {\n              \"id\": \"6a730e91-fa40-4e8a-b6cb-894f2cb367c5\",\n              \"operator\": {\n                \"type\": \"boolean\",\n                \"operation\": \"true\",\n                \"singleValue\": true\n              },\n              \"leftValue\": \"={{ $json.active }}\",\n              \"rightValue\": \"\"\n            },\n            {\n              \"id\": \"b3d13440-f3fc-4172-b16d-e191f050a2bf\",\n              \"operator\": {\n                \"name\": \"filter.operator.equals\",\n                \"type\": \"string\",\n                \"operation\": \"equals\"\n              },\n              \"leftValue\": \"\",\n              \"rightValue\": \"\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 2.2\n    },\n    {\n      \"id\": \"63f98607-1f56-4f83-93be-aa3b271da11b\",\n      \"name\": \"Get all Roles\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        -220,\n        -20\n      ],\n      \"parameters\": {\n        \"url\": \"={{ $json.zammad_base_url }}/api/v1/roles\",\n        \"options\": {},\n        \"sendHeaders\": true,\n        \"headerParameters\": {\n          \"parameters\": [\n            {\n              \"name\": \"Authorization\",\n              \"value\": \"=Bearer {{ $json.zammad_api_key }}\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 4.2\n    },\n    {\n      \"id\": \"961bf663-30be-45b4-87f0-d7ec94c3435b\",\n      \"name\": \"Basic Variables\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        -620,\n        160\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"68b32087-5e23-4590-8042-0061234ce479\",\n              \"name\": \"zammad_base_url\",\n              \"type\": \"string\",\n              \"value\": \"-put-your-zammad-base-url-\"\n            },\n            {\n              \"id\": \"7db7572e-2524-4f2a-a1d6-b44330662c30\",\n              \"name\": \"zammad_api_key\",\n              \"type\": \"string\",\n              \"value\": \"-put-your-api-key-\"\n            },\n            {\n              \"id\": \"7cd0a1d2-8898-47c7-a1c6-195ff6162bb9\",\n              \"name\": \"default_roles\",\n              \"type\": \"array\",\n              \"value\": \"={{ [-put-in-the-default-roles-ids-separated-by-comma-] }}\"\n            },\n            {\n              \"id\": \"4628705c-4875-4d42-90d1-692b9b44fc24\",\n              \"name\": \"exclude_zammad_users_by_id\",\n              \"type\": \"array\",\n              \"value\": \"={{ [-put-in-the-user-ids-separated-by-comma-] }}\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 3.4\n    },\n    {\n      \"id\": \"a86577aa-1eb2-48e6-b941-bdfb37b58073\",\n      \"name\": \"Zammad Univeral Role Object\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        100,\n        -20\n      ],\n      \"parameters\": {\n        \"values\": {\n          \"number\": [\n            {\n              \"name\": \"role_id\",\n              \"value\": \"={{ $json.id }}\"\n            },\n            {\n              \"name\": \"name\",\n              \"value\": \"={{ $json.name }}\"\n            }\n          ]\n        },\n        \"options\": {},\n        \"keepOnlySet\": true\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"ecc387b3-092d-43c9-9187-784f07c4df77\",\n      \"name\": \"Convert to Excel Roles\",\n      \"type\": \"n8n-nodes-base.convertToFile\",\n      \"position\": [\n        760,\n        -40\n      ],\n      \"parameters\": {\n        \"options\": {\n          \"fileName\": \"Zammad_Roles.xlsx\"\n        },\n        \"operation\": \"xlsx\"\n      },\n      \"typeVersion\": 1.1\n    },\n    {\n      \"id\": \"e8055ae6-78d8-4736-adee-4b8c883b4000\",\n      \"name\": \"Filter Roles if needed\",\n      \"type\": \"n8n-nodes-base.if\",\n      \"position\": [\n        400,\n        -20\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"conditions\": {\n          \"options\": {\n            \"version\": 2,\n            \"leftValue\": \"\",\n            \"caseSensitive\": true,\n            \"typeValidation\": \"strict\"\n          },\n          \"combinator\": \"and\",\n          \"conditions\": [\n            {\n              \"id\": \"0ca9d3a3-b726-4396-8cec-4a74c8e3949b\",\n              \"operator\": {\n                \"type\": \"object\",\n                \"operation\": \"exists\",\n                \"singleValue\": true\n              },\n              \"leftValue\": \"={{ $json }}\",\n              \"rightValue\": 1781\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 2.2\n    },\n    {\n      \"id\": \"45b01919-ba58-4c7a-a97f-d169cb361855\",\n      \"name\": \"Update Users to default Role(s)\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"onError\": \"continueErrorOutput\",\n      \"position\": [\n        760,\n        200\n      ],\n      \"parameters\": {\n        \"url\": \"={{ $('Basic Variables').item.json.zammad_base_url }}/api/v1/users/{{ $json.user_id }}\",\n        \"method\": \"PUT\",\n        \"options\": {},\n        \"jsonBody\": \"={\\n  \\\"role_ids\\\": [\\n    {{ $('Basic Variables').item.json.default_roles }}\\n  ]\\n} \",\n        \"sendBody\": true,\n        \"sendHeaders\": true,\n        \"specifyBody\": \"json\",\n        \"headerParameters\": {\n          \"parameters\": [\n            {\n              \"name\": \"Authorization\",\n              \"value\": \"=Bearer {{ $('Basic Variables').item.json.zammad_api_key }}\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 4.2\n    }\n  ],\n  \"active\": false,\n  \"pinData\": {},\n  \"settings\": {\n    \"executionOrder\": \"v1\"\n  },\n  \"versionId\": \"4fa55089-104d-477e-8a93-c8cb0caf7bed\",\n  \"connections\": {\n    \"If\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Update Users to default Role(s)\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Get all Roles\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Zammad Univeral Role Object\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Get all Users\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Zammad Univeral User Object\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Basic Variables\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Get all Roles\",\n            \"type\": \"main\",\n            \"index\": 0\n          },\n          {\n            \"node\": \"Get all Users\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Filter Roles if needed\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Convert to Excel Roles\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Zammad Univeral Role Object\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Filter Roles if needed\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Zammad Univeral User Object\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"If\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Update Users to default Role(s)\": {\n      \"main\": [\n        [],\n        []\n      ]\n    },\n    \"When clicking ‘Test workflow’\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Basic Variables\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}",
  "metadata": {
    "node_types": [
      "n8n-nodes-base.manualTrigger",
      "n8n-nodes-base.set",
      "n8n-nodes-base.zammad",
      "n8n-nodes-base.if",
      "n8n-nodes-base.httpRequest",
      "n8n-nodes-base.set",
      "n8n-nodes-base.set",
      "n8n-nodes-base.convertToFile",
      "n8n-nodes-base.if",
      "n8n-nodes-base.httpRequest"
    ],
    "trigger": null
  }
}