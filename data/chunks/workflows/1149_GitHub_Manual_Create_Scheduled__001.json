{
  "source": "1149_GitHub_Manual_Create_Scheduled.json",
  "index": 1,
  "content": "{\n  \"nodes\": [\n    {\n      \"name\": \"On clicking 'execute'\",\n      \"type\": \"n8n-nodes-base.manualTrigger\",\n      \"position\": [\n        0,\n        150\n      ],\n      \"parameters\": {},\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"dataArray\",\n      \"type\": \"n8n-nodes-base.function\",\n      \"position\": [\n        450,\n        300\n      ],\n      \"parameters\": {\n        \"functionCode\": \"const newItems = [];\\nfor (item of items[0].json.data) {\\n  newItems.push({json: item});\\n}\\nreturn newItems;\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"N8N Workflows\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        300,\n        300\n      ],\n      \"parameters\": {\n        \"url\": \"http://localhost:8443/rest/workflows\",\n        \"options\": {}\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"GitHub\",\n      \"type\": \"n8n-nodes-base.github\",\n      \"position\": [\n        800,\n        130\n      ],\n      \"parameters\": {\n        \"owner\": \"={{$node[\\\"Globals\\\"].json[\\\"repo\\\"][\\\"owner\\\"]}}\",\n        \"filePath\": \"={{$node[\\\"Globals\\\"].json[\\\"repo\\\"][\\\"path\\\"]}}{{$json[\\\"name\\\"]}}.json\",\n        \"resource\": \"file\",\n        \"operation\": \"get\",\n        \"repository\": \"={{$node[\\\"Globals\\\"].json[\\\"repo\\\"][\\\"name\\\"]}}\",\n        \"asBinaryProperty\": false\n      },\n      \"credentials\": {\n        \"githubApi\": \"GitHub\"\n      },\n      \"typeVersion\": 1,\n      \"continueOnFail\": true,\n      \"alwaysOutputData\": true\n    },\n    {\n      \"name\": \"Merge\",\n      \"type\": \"n8n-nodes-base.merge\",\n      \"position\": [\n        1000,\n        300\n      ],\n      \"parameters\": {},\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"N8N Workflow Detail\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        800,\n        460\n      ],\n      \"parameters\": {\n        \"url\": \"=http://localhost:8443/rest/workflows/{{$json[\\\"id\\\"]}}\",\n        \"options\": {}\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"github_status\",\n      \"type\": \"n8n-nodes-base.switch\",\n      \"position\": [\n        1300,\n        300\n      ],\n      \"parameters\": {\n        \"rules\": {\n          \"rules\": [\n            {\n              \"value2\": \"same\"\n            },\n            {\n              \"output\": 1,\n              \"value2\": \"different\"\n            },\n            {\n              \"output\": 2,\n              \"value2\": \"new\"\n            }\n          ]\n        },\n        \"value1\": \"={{$json[\\\"github_status\\\"]}}\",\n        \"dataType\": \"string\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"same\",\n      \"type\": \"n8n-nodes-base.noOp\",\n      \"position\": [\n        1500,\n        130\n      ],\n      \"parameters\": {},\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"different\",\n      \"type\": \"n8n-nodes-base.noOp\",\n      \"position\": [\n        1500,\n        300\n      ],\n      \"parameters\": {},\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"new\",\n      \"type\": \"n8n-nodes-base.noOp\",\n      \"position\": [\n        1500,\n        460\n      ],\n      \"parameters\": {},\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"GitHub Edit\",\n      \"type\": \"n8n-nodes-base.github\",\n      \"position\": [\n        1700,\n        180\n      ],\n      \"parameters\": {\n        \"owner\": \"={{$node[\\\"Globals\\\"].json[\\\"repo\\\"][\\\"owner\\\"]}}\",\n        \"filePath\": \"={{$node[\\\"Globals\\\"].json[\\\"repo\\\"][\\\"path\\\"]}}{{$node[\\\"N8N Workflow Detail\\\"].json[\\\"data\\\"][\\\"name\\\"]}}.json\",\n        \"resource\": \"file\",\n        \"operation\": \"edit\",\n        \"repository\": \"={{$node[\\\"Globals\\\"].json[\\\"repo\\\"][\\\"name\\\"]}}\",\n        \"fileContent\": \"={{$node[\\\"isDiffOrNew\\\"].json[\\\"n8n_data_stringy\\\"]}}\",\n        \"commitMessage\": \"=[N8N Backup] {{$node[\\\"N8N Workflow Detail\\\"].json[\\\"data\\\"][\\\"name\\\"]}}.json ({{$json[\\\"github_status\\\"]}})\"\n      },\n      \"credentials\": {\n        \"githubApi\": \"GitHub\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"GitHub Create\",\n      \"type\": \"n8n-nodes-base.github\",\n      \"position\": [\n        1700,\n        460\n      ],\n      \"parameters\": {\n        \"owner\": \"={{$node[\\\"Globals\\\"].json[\\\"repo\\\"][\\\"owner\\\"]}}\",\n        \"filePath\": \"={{$node[\\\"Globals\\\"].json[\\\"repo\\\"][\\\"path\\\"]}}{{$node[\\\"N8N Workflow Detail\\\"].json[\\\"data\\\"][\\\"name\\\"]}}.json\",\n        \"resource\": \"file\",\n        \"repository\": \"={{$node[\\\"Globals\\\"].json[\\\"repo\\\"][\\\"name\\\"]}}\",\n        \"fileContent\": \"={{$node[\\\"isDiffOrNew\\\"].json[\\\"n8n_data_stringy\\\"]}}\",\n        \"commitMessage\": \"=[N8N Backup] {{$node[\\\"N8N Workflow Detail\\\"].json[\\\"data\\\"][\\\"name\\\"]}}.json ({{$json[\\\"github_status\\\"]}})\"\n      },\n      \"credentials\": {\n        \"githubApi\": \"GitHub\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"isDiffOrNew\",\n      \"type\": \"n8n-nodes-base.function\",\n      \"position\": [\n        1150,\n        300\n      ],\n      \"parameters\": {\n        \"functionCode\": \"// File Returned with Content\\nif (Object.keys(items[0].json).includes(\\\"content\\\")) {\\n  // Get JSON Objects\\n  var origWorkflow = eval(\\\"(\\\"+Buffer.from(items[0].json.content, 'base64').toString()+\\\")\\\");\\n  var n8nWorkflow = (items[1].json.data);\\n  \\n  // Order JSON Objects\\n  var orderedOriginal = {}\\n  var orderedActual = {}\\n  \\n  Object.keys(origWorkflow).sort().forEach(function(key) {\\n    orderedOriginal[key] = origWorkflow[key];\\n  });\\n  \\n  Object.keys(n8nWorkflow).sort().forEach(function(key) {\\n    orderedActual[key] = n8nWorkflow[key];\\n  });\\n  \\n  // Determine Difference\\n  if ( JSON.stringify(orderedOriginal) === JSON.stringify(orderedActual) ) {\\n    items[0].json.github_status = \\\"same\\\";\\n    items[0].json.content_decoded = orderedOriginal;\\n  } else {\\n    items[0].json.github_status = \\\"different\\\";\\n    items[0].json.content_decoded = orderedOriginal;\\n    items[0].json.n8n_data_stringy = JSON.stringify(orderedActual, null, 2);\\n  }\\n// No File Returned / New Workflow\\n} else {\\n  // Order JSON Object\\n  var n8nWorkflow = (items[1].json.data);\\n  var orderedActual = {}\\n  Object.keys(n8nWorkflow).sort().forEach(function(key) {\\n    orderedActual[key] = n8nWorkflow[key];\\n  });\\n  \\n  // Proper Formatting\\n  items[0].json.github_status = \\\"new\\\";\\n  items[0].json.n8n_data_stringy = JSON.stringify(orderedActual, null, 2);\\n}\\n\\n// Return Items\\nreturn items;\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Daily @ 20:00\",\n      \"type\": \"n8n-nodes-base.cron\",\n      \"position\": [\n        0,\n        450\n      ],\n      \"parameters\": {\n        \"triggerTimes\": {\n          \"item\": [\n            {\n              \"hour\": 20,\n              \"minute\": 11\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"OneAtATime\",\n      \"type\": \"n8n-nodes-base.splitInBatches\",\n      \"position\": [\n        600,\n        300\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"batchSize\": 1\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Globals\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        150,\n        300\n      ],\n      \"parameters\": {\n        \"values\": {\n          \"string\": [\n            {\n              \"name\": \"repo.owner\",\n              \"value\": \"octocat\"\n            },\n            {\n              \"name\": \"repo.name\",\n              \"value\": \"Hello-World\"\n            },\n            {\n              \"name\": \"repo.path\",\n              \"value\": \"my-team/n8n/workflows/\"\n            }\n          ]\n        },\n        \"options\": {}\n      },\n      \"typeVersion\": 1\n    }\n  ],\n  \"connections\": {\n    \"new\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"GitHub Create\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"same\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"OneAtATime\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Merge\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"isDiffOrNew\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"GitHub\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Merge\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Globals\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"N8N Workflows\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"dataArray\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"OneAtATime\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"different\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"GitHub Edit\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"OneAtATime\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"GitHub\",\n            \"type\": \"main\",\n            \"index\": 0\n          },\n          {\n            \"node\": \"N8N Workflow Detail\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"GitHub Edit\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"OneAtATime\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"isDiffOrNew\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"github_status\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Daily @ 20:00\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Globals\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"GitHub Create\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"OneAtATime\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"N8N Workflows\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"dataArray\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"github_status\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"same\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"different\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"new\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"N8N Workflow Detail\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Merge\",\n            \"type\": \"main\",\n            \"index\": 1\n          }\n        ]\n      ]\n    },\n    \"On clicking 'execute'\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Globals\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}",
  "metadata": {
    "node_types": [
      "n8n-nodes-base.manualTrigger",
      "n8n-nodes-base.function",
      "n8n-nodes-base.httpRequest",
      "n8n-nodes-base.github",
      "n8n-nodes-base.merge",
      "n8n-nodes-base.httpRequest",
      "n8n-nodes-base.switch",
      "n8n-nodes-base.noOp",
      "n8n-nodes-base.noOp",
      "n8n-nodes-base.noOp",
      "n8n-nodes-base.github",
      "n8n-nodes-base.github",
      "n8n-nodes-base.function",
      "n8n-nodes-base.cron",
      "n8n-nodes-base.splitInBatches",
      "n8n-nodes-base.set"
    ],
    "trigger": null
  }
}