{
  "source": "1965_Code_Schedule_Automation_Webhook.json",
  "index": 1,
  "content": "{\n  \"id\": \"qmmXKcpJOCm9qaCk\",\n  \"meta\": {\n    \"instanceId\": \"558d88703fb65b2d0e44613bc35916258b0f0bf983c5d4730c00c424b77ca36a\",\n    \"templateCredsSetupCompleted\": true\n  },\n  \"name\": \"SERPBear analytics template\",\n  \"tags\": [],\n  \"nodes\": [\n    {\n      \"id\": \"2ad0eb40-6628-4c6b-bc15-7081e7712f1a\",\n      \"name\": \"When clicking â€˜Test workflowâ€™\",\n      \"type\": \"n8n-nodes-base.manualTrigger\",\n      \"position\": [\n        260,\n        380\n      ],\n      \"parameters\": {},\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"5a3c9ad8-a562-4bb0-bb11-c325552d8101\",\n      \"name\": \"Schedule Trigger\",\n      \"type\": \"n8n-nodes-base.scheduleTrigger\",\n      \"position\": [\n        260,\n        160\n      ],\n      \"parameters\": {\n        \"rule\": {\n          \"interval\": [\n            {\n              \"field\": \"weeks\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 1.2\n    },\n    {\n      \"id\": \"bdfa7388-f9b3-4145-90de-2e58138e14bf\",\n      \"name\": \"Get data from SerpBear\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        580,\n        260\n      ],\n      \"parameters\": {\n        \"url\": \"https://myserpbearinstance.com/api/keyword?id=22\",\n        \"options\": {},\n        \"sendQuery\": true,\n        \"authentication\": \"genericCredentialType\",\n        \"genericAuthType\": \"httpHeaderAuth\",\n        \"queryParameters\": {\n          \"parameters\": [\n            {\n              \"name\": \"domain\",\n              \"value\": \"rumjahn.com\"\n            }\n          ]\n        }\n      },\n      \"credentials\": {\n        \"httpHeaderAuth\": {\n          \"id\": \"3fshHb4fyI5XfLyq\",\n          \"name\": \"Header Auth account 6\"\n        }\n      },\n      \"executeOnce\": false,\n      \"typeVersion\": 4.2,\n      \"alwaysOutputData\": false\n    },\n    {\n      \"id\": \"c169f4e3-ab60-4b46-9f49-cf27a13dd7c6\",\n      \"name\": \"Parse data from SerpBear\",\n      \"type\": \"n8n-nodes-base.code\",\n      \"position\": [\n        820,\n        260\n      ],\n      \"parameters\": {\n        \"jsCode\": \"const keywords = items[0].json.keywords;\\nconst today = new Date().toISOString().split('T')[0];\\n\\n// Create summary for each keyword\\nconst keywordSummaries = keywords.map(kw => {\\n  const position = kw.position || 0;\\n  const lastWeekPositions = Object.values(kw.history || {}).slice(-7);\\n  const avgPosition = lastWeekPositions.reduce((a, b) => a + b, 0) / lastWeekPositions.length;\\n  \\n  return {\\n    keyword: kw.keyword,\\n    currentPosition: position,\\n    averagePosition: Math.round(avgPosition * 10) / 10,\\n    trend: position < avgPosition ? 'improving' : position > avgPosition ? 'declining' : 'stable',\\n    url: kw.url || 'not ranking'\\n  };\\n});\\n\\n// Create the prompt\\nconst prompt = `Here's the SEO ranking data for rumjahn.com as of ${today}:\\n\\n${keywordSummaries.map(kw => `\\nKeyword: \\\"${kw.keyword}\\\"\\nCurrent Position: ${kw.currentPosition}\\n7-Day Average: ${kw.averagePosition}\\nTrend: ${kw.trend}\\nRanking URL: ${kw.url}\\n`).join('\\\\n')}\\n\\nPlease analyze this data and provide:\\n1. Key observations about ranking performance\\n2. Keywords showing the most improvement\\n3. Keywords needing attention\\n4. Suggested actions for improvement`;\\n\\nreturn {\\n  prompt\\n};\"\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"cc6e16a7-db46-42fe-837a-59ce635c906c\",\n      \"name\": \"Send data to A.I. for analysis\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        1060,\n        260\n      ],\n      \"parameters\": {\n        \"url\": \"https://openrouter.ai/api/v1/chat/completions\",\n        \"method\": \"POST\",\n        \"options\": {},\n        \"jsonBody\": \"={\\n  \\\"model\\\": \\\"meta-llama/llama-3.1-70b-instruct:free\\\",\\n  \\\"messages\\\": [\\n    {\\n      \\\"role\\\": \\\"user\\\",\\n      \\\"content\\\": \\\"You are an SEO expert. This is keyword data for my site. Can you summarize the data into a table and then give me some suggestions:{{ encodeURIComponent($json.prompt)}}\\\" \\n    }\\n  ]\\n}\",\n        \"sendBody\": true,\n        \"specifyBody\": \"json\",\n        \"authentication\": \"genericCredentialType\",\n        \"genericAuthType\": \"httpHeaderAuth\"\n      },\n      \"credentials\": {\n        \"httpHeaderAuth\": {\n          \"id\": \"WY7UkF14ksPKq3S8\",\n          \"name\": \"Header Auth account 2\"\n        }\n      },\n      \"typeVersion\": 4.2,\n      \"alwaysOutputData\": false\n    },\n    {\n      \"id\": \"a623f06c-1dfe-4d04-a7fd-fed7049a7588\",\n      \"name\": \"Save data to Baserow\",\n      \"type\": \"n8n-nodes-base.baserow\",\n      \"position\": [\n        1340,\n        260\n      ],\n      \"parameters\": {\n        \"tableId\": 644,\n        \"fieldsUi\": {\n          \"fieldValues\": [\n            {\n              \"fieldId\": 6264,\n              \"fieldValue\": \"={{ DateTime.now().toFormat('yyyy-MM-dd') }}\"\n            },\n            {\n              \"fieldId\": 6265,\n              \"fieldValue\": \"={{ $json.choices[0].message.content }}\"\n            },\n            {\n              \"fieldId\": 6266,\n              \"fieldValue\": \"Rumjahn\"\n            }\n          ]\n        },\n        \"operation\": \"create\",\n        \"databaseId\": 121\n      },\n      \"credentials\": {\n        \"baserowApi\": {\n          \"id\": \"8w0zXhycIfCAgja3\",\n          \"name\": \"Baserow account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"e8048faf-bbed-4e48-b273-d1a50a767e76\",\n      \"name\": \"Sticky Note\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        220,\n        -360\n      ],\n      \"parameters\": {\n        \"color\": 5,\n        \"width\": 614.709677419355,\n        \"height\": 208.51612903225802,\n        \"content\": \"## Send Matomo analytics to A.I. and save results to baserow\\n\\nThis workflow will check the Google keywords for your site and it's rank.\\n\\n[ðŸ’¡ You can read more about this workflow here](https://rumjahn.com/how-to-create-an-a-i-agent-to-analyze-serpbear-keyword-rankings-using-n8n-for-free-without-any-coding-skills-required/)\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"1a18e685-79db-423f-992a-5e0d4ddeb672\",\n      \"name\": \"Sticky Note1\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        520,\n        -80\n      ],\n      \"parameters\": {\n        \"width\": 214.75050403225822,\n        \"height\": 531.7318548387107,\n        \"content\": \"## Get SERPBear Data\\n \\n1. Enter your SerpBear API keys and URL. You need to find your website ID which is probably 1.\\n2. Navigate to Administration > Personal > Security > Auth tokens within your Matomo dashboard. Click on Create new token and provide a purpose for reference.\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"99895baf-75d0-4af2-87de-5b8951186e78\",\n      \"name\": \"Sticky Note2\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        980,\n        -60\n      ],\n      \"parameters\": {\n        \"color\": 3,\n        \"width\": 225.99936321742769,\n        \"height\": 508.95792207792226,\n        \"content\": \"## Send data to A.I.\\n\\nFill in your Openrouter A.I. credentials. Use Header Auth.\\n- Username: Authorization\\n- Password: Bearer {insert your API key}\\n\\nRemember to add a space after bearer. Also, feel free to modify the prompt to A.1.\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"07d03511-98b0-4f4a-8e68-96ca177fb246\",\n      \"name\": \"Sticky Note3\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        1240,\n        -40\n      ],\n      \"parameters\": {\n        \"color\": 6,\n        \"width\": 331.32883116883124,\n        \"height\": 474.88,\n        \"content\": \"## Send data to Baserow\\n\\nCreate a table first with the following columns:\\n- Date\\n- Note\\n- Blog\\n\\nEnter the name of your website under \\\"Blog\\\" field.\"\n      },\n      \"typeVersion\": 1\n    }\n  ],\n  \"active\": false,\n  \"pinData\": {},\n  \"settings\": {\n    \"executionOrder\": \"v1\"\n  },\n  \"versionId\": \"8b7e7da7-1965-4ca4-8e15-889eda819723\",\n  \"connections\": {\n    \"Schedule Trigger\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Get data from SerpBear\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Get data from SerpBear\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Parse data from SerpBear\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Parse data from SerpBear\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Send data to A.I. for analysis\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Send data to A.I. for analysis\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Save data to Baserow\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"When clicking â€˜Test workflowâ€™\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Get data from SerpBear\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}",
  "metadata": {
    "node_types": [
      "n8n-nodes-base.manualTrigger",
      "n8n-nodes-base.scheduleTrigger",
      "n8n-nodes-base.httpRequest",
      "n8n-nodes-base.code",
      "n8n-nodes-base.httpRequest",
      "n8n-nodes-base.baserow",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote"
    ],
    "trigger": "schedule trigger"
  }
}