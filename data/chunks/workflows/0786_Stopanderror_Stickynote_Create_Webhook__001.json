{
  "source": "0786_Stopanderror_Stickynote_Create_Webhook.json",
  "index": 1,
  "content": "{\n  \"meta\": {\n    \"instanceId\": \"568298fde06d3db80a2eea77fe5bf45f0c7bb898dea20b769944e9ac7c6c5a80\"\n  },\n  \"nodes\": [\n    {\n      \"id\": \"99bbf837-2834-4cae-af13-37b6cdf963bb\",\n      \"name\": \"Webhook\",\n      \"type\": \"n8n-nodes-base.webhook\",\n      \"position\": [\n        -480,\n        -40\n      ],\n      \"webhookId\": \"83f4e1de-2011-487c-a9f7-be6ccbac0782\",\n      \"parameters\": {\n        \"path\": \"83f4e1de-2011-487c-a9f7-be6ccbac0782\",\n        \"options\": {},\n        \"httpMethod\": \"POST\"\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"0f7c13ea-196b-40a7-bf1e-4829caaaba4c\",\n      \"name\": \"Stop and Error\",\n      \"type\": \"n8n-nodes-base.stopAndError\",\n      \"position\": [\n        180,\n        60\n      ],\n      \"parameters\": {\n        \"errorMessage\": \"Invalid verification token\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"7ddb4cfc-5917-4b19-acf8-c7db3eaab56a\",\n      \"name\": \"Donation\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        400,\n        -420\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"67607a8e-55e2-46ec-92f5-1c8ef3addf9c\",\n              \"name\": \"from_name\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.body.from_name }}\"\n            },\n            {\n              \"id\": \"3e6e86ac-b6c2-4b5f-9e33-22367b9fb9e5\",\n              \"name\": \"message\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.body.message }}\"\n            },\n            {\n              \"id\": \"4973525a-21b0-442c-8919-24c312f3ff0c\",\n              \"name\": \"amount\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.body.amount }}\"\n            },\n            {\n              \"id\": \"b7e2d9e1-61c2-4ad1-9cbd-d8a754993fbe\",\n              \"name\": \"url\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.body.email }}\"\n            },\n            {\n              \"id\": \"da26860f-c1c4-4918-9447-ed080e921fe7\",\n              \"name\": \"currency\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.body.currency }}\"\n            },\n            {\n              \"id\": \"380dbd53-eb04-4659-aa54-b6bde0ba7034\",\n              \"name\": \"is_public\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.body.is_public }}\"\n            },\n            {\n              \"id\": \"4fd65c21-3043-4513-96b3-d2e11656e94a\",\n              \"name\": \"timestamp\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.body.timestamp }}\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 3.4\n    },\n    {\n      \"id\": \"9c29ae0e-d80c-4613-ba11-535cc59d5603\",\n      \"name\": \"Subscription\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        400,\n        -140\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"886b9cca-15b1-49b4-a123-6f3ceb46279e\",\n              \"name\": \"timestamp\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.body.timestamp }}\"\n            },\n            {\n              \"id\": \"3c4d9c0e-3cd6-41d2-8223-c48f1dcccedc\",\n              \"name\": \"from_name\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.body.from_name }}\"\n            },\n            {\n              \"id\": \"7199ad4d-06ad-4bed-939b-e97d6d118d9b\",\n              \"name\": \"message\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.body.message }}\"\n            },\n            {\n              \"id\": \"270eeac1-b7f9-4cfb-9ac8-b0799b36482e\",\n              \"name\": \"amount\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.body.amount }}\"\n            },\n            {\n              \"id\": \"dbf3a671-715c-4e29-96d5-2767b6a620d8\",\n              \"name\": \"url\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.body.url }}\"\n            },\n            {\n              \"id\": \"79ae8427-e5fe-470f-bdc0-df0d8bcbad00\",\n              \"name\": \"email\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.body.email }}\"\n            },\n            {\n              \"id\": \"90c73e4d-197a-4ba3-b6fb-b7b79b62e69c\",\n              \"name\": \"currency\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.body.currency }}\"\n            },\n            {\n              \"id\": \"3e23aaad-70f4-429b-bee1-3ae0156aaa86\",\n              \"name\": \"is_first_subscription_payment\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.body.is_first_subscription_payment }}\"\n            },\n            {\n              \"id\": \"3ca5ca22-d8b7-4a90-a97e-aaed032ef705\",\n              \"name\": \"tier_name\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.body.tier_name }}\"\n            },\n            {\n              \"id\": \"1347258b-1f6d-4d44-bd64-95fb948cbff9\",\n              \"name\": \"is_public\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.body.is_public }}\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 3.4\n    },\n    {\n      \"id\": \"a050d88e-bbe8-4ee1-b1c6-31782b5b2f20\",\n      \"name\": \"Shop Order\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        400,\n        140\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"9f2d01f6-d172-4aea-b2ea-e64857592191\",\n              \"name\": \"from_name\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.body.from_name }}\"\n            },\n            {\n              \"id\": \"bbc1fcba-ec29-4599-9d78-4e1a37ecede3\",\n              \"name\": \"amount\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.body.amount }}\"\n            },\n            {\n              \"id\": \"2ea190ac-700b-4682-9baa-7d733f89b819\",\n              \"name\": \"email\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.body.email }}\"\n            },\n            {\n              \"id\": \"eb0af9d5-9650-4457-b0fd-44f679972a79\",\n              \"name\": \"currency\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.body.currency }}\"\n            },\n            {\n              \"id\": \"9acec88b-61d5-4520-bf51-f71b4e2e26f6\",\n              \"name\": \"shop_items\",\n              \"type\": \"array\",\n              \"value\": \"={{ $json.body.shop_items }}\"\n            },\n            {\n              \"id\": \"2e1fb035-b32c-492f-9705-7159ef0b2c5d\",\n              \"name\": \"url\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.body.url }}\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 3.4\n    },\n    {\n      \"id\": \"f9926fda-9a37-467e-b86b-ce9dbb051a88\",\n      \"name\": \"Is new subscriber?\",\n      \"type\": \"n8n-nodes-base.if\",\n      \"position\": [\n        620,\n        -140\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"conditions\": {\n          \"options\": {\n            \"version\": 2,\n            \"leftValue\": \"\",\n            \"caseSensitive\": true,\n            \"typeValidation\": \"strict\"\n          },\n          \"combinator\": \"and\",\n          \"conditions\": [\n            {\n              \"id\": \"87fbcc71-a0a4-4820-bb67-9551d44e0500\",\n              \"operator\": {\n                \"name\": \"filter.operator.equals\",\n                \"type\": \"string\",\n                \"operation\": \"equals\"\n              },\n              \"leftValue\": \"={{ $json.is_first_subscription_payment }}\",\n              \"rightValue\": \"true\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 2.2\n    },\n    {\n      \"id\": \"b158a59d-5166-4469-b999-5235768855c0\",\n      \"name\": \"Prepare\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        -260,\n        -40\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"aabaa149-d74b-464c-bbb6-12e2e8a884d9\",\n              \"name\": \"verificationToken\",\n              \"type\": \"string\",\n              \"value\": \"7dd9d4ef-8412-4add-a0d0-b548ad4564b9\"\n            },\n            {\n              \"id\": \"c2f7a7ce-99b0-44c7-b2cf-1ebf85e0917d\",\n              \"name\": \"body\",\n              \"type\": \"object\",\n              \"value\": \"={{ $json.body.data }}\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 3.4\n    },\n    {\n      \"id\": \"a4fd9607-6d5b-4fbd-a4ce-53e9960887e0\",\n      \"name\": \"Check token\",\n      \"type\": \"n8n-nodes-base.if\",\n      \"position\": [\n        -40,\n        -40\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"conditions\": {\n          \"options\": {\n            \"version\": 2,\n            \"leftValue\": \"\",\n            \"caseSensitive\": true,\n            \"typeValidation\": \"strict\"\n          },\n          \"combinator\": \"and\",\n          \"conditions\": [\n            {\n              \"id\": \"439af86e-c768-4165-ae64-86cd32a07084\",\n              \"operator\": {\n                \"name\": \"filter.operator.equals\",\n                \"type\": \"string\",\n                \"operation\": \"equals\"\n              },\n              \"leftValue\": \"={{ $json.body.verification_token }}\",\n              \"rightValue\": \"={{ $json.verificationToken }}\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 2.2\n    },\n    {\n      \"id\": \"6c34228e-434c-4ab3-b0ce-0b5c1721ffc8\",\n      \"name\": \"Check type\",\n      \"type\": \"n8n-nodes-base.switch\",\n      \"position\": [\n        180,\n        -140\n      ],\n      \"parameters\": {\n        \"rules\": {\n          \"values\": [\n            {\n              \"conditions\": {\n                \"options\": {\n                  \"version\": 2,\n                  \"leftValue\": \"\",\n                  \"caseSensitive\": true,\n                  \"typeValidation\": \"strict\"\n                },\n                \"combinator\": \"and\",\n                \"conditions\": [\n                  {\n                    \"id\": \"edd5eaa2-60c7-459a-9846-b952b390b1db\",\n                    \"operator\": {\n                      \"type\": \"string\",\n                      \"operation\": \"equals\"\n                    },\n                    \"leftValue\": \"={{ $json.body.type }}\",\n                    \"rightValue\": \"Donation\"\n                  }\n                ]\n              }\n            },\n            {\n              \"conditions\": {\n                \"options\": {\n                  \"version\": 2,\n                  \"leftValue\": \"\",\n                  \"caseSensitive\": true,\n                  \"typeValidation\": \"strict\"\n                },\n                \"combinator\": \"and\",\n                \"conditions\": [\n                  {\n                    \"id\": \"0cc7f0bf-4d1b-45a5-88ed-5b84050222f8\",\n                    \"operator\": {\n                      \"name\": \"filter.operator.equals\",\n                      \"type\": \"string\",\n                      \"operation\": \"equals\"\n                    },\n                    \"leftValue\": \"={{ $json.body.type }}\",\n                    \"rightValue\": \"Subscription\"\n                  }\n                ]\n              }\n            },\n            {\n              \"conditions\": {\n                \"options\": {\n                  \"version\": 2,\n                  \"leftValue\": \"\",\n                  \"caseSensitive\": true,\n                  \"typeValidation\": \"strict\"\n                },\n                \"combinator\": \"and\",\n                \"conditions\": [\n                  {\n                    \"id\": \"a1b74233-7700-434b-be5c-76129c4cd88c\",\n                    \"operator\": {\n                      \"name\": \"filter.operator.equals\",\n                      \"type\": \"string\",\n                      \"operation\": \"equals\"\n                    },\n                    \"leftValue\": \"={{ $json.body.type }}\",\n                    \"rightValue\": \"Shop Order\"\n                  }\n                ]\n              }\n            }\n          ]\n        },\n        \"options\": {}\n      },\n      \"typeVersion\": 3.2\n    },\n    {\n      \"id\": \"87fd0134-5eb4-4c47-acb5-137f24e819f4\",\n      \"name\": \"Sticky Note\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -300,\n        -140\n      ],\n      \"parameters\": {\n        \"color\": 6,\n        \"width\": 200,\n        \"height\": 260,\n        \"content\": \"### Set verification token\\nSet your Ko-fi  verification token in this node. Available [here](https://ko-fi.com/manage/webhooks).\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"78ac15cb-1336-424e-a235-6e7a66090b9d\",\n      \"name\": \"Sticky Note1\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -520,\n        -140\n      ],\n      \"parameters\": {\n        \"color\": 6,\n        \"width\": 200,\n        \"height\": 260,\n        \"content\": \"### Setup your webhook\\nFind your webhook URL in this node and set it  [here](https://ko-fi.com/manage/webhooks).\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"30892b66-66fb-4926-b817-e280cbadf5ea\",\n      \"name\": \"Sticky Note2\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        360,\n        -520\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 540,\n        \"height\": 260,\n        \"content\": \"### We received a donation\\nDo your thing.\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"3b849d93-ffa5-4dfe-8743-d43ca7d06e60\",\n      \"name\": \"Sticky Note3\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        360,\n        -240\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 540,\n        \"height\": 260,\n        \"content\": \"### We received a payment for a subscription\\nDo your thing.\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"bff1913d-1c18-4447-8448-aa059d7b020f\",\n      \"name\": \"Sticky Note4\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        360,\n        40\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 540,\n        \"height\": 260,\n        \"content\": \"### We received a shop order\\nDo your thing.\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"07da890d-5cc8-4f51-b0c2-c50831c84a64\",\n      \"name\": \"Sticky Note5\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -520,\n        -560\n      ],\n      \"parameters\": {\n        \"width\": 860,\n        \"height\": 400,\n        \"content\": \"## Receive and handle Ko-fi payment webhooks \\nThis workflow receives [Ko-fi payment webhooks](https://ko-fi.com/manage/webhooks), checks the verification token and then check what kind of payment it is.\\n\\n### Set up\\n1. Edit the `Webhook` node and find your webhook URL.\\n2. Go to your [Ko-fi webhooks settings](https://ko-fi.com/manage/webhooks) and set your URL\\n3. Get your `verification token` from the same page (under advanced) and set it in the `Prepare` node\\n4. Enable your workflow and test it from [Ko-fi webhooks settings](https://ko-fi.com/manage/webhooks)\\n5. Profit 🎉\\n\\n**👋 Hello! I'm Audun / xqus** \\n🔗 My work: [xqus.com](https://xqus.com)\\n💸 n8n shop: [xqus.gumroad.com](https://xqus.gumroad.com)\\n\\n### Want to trigger my workflow?\\nSupport my work on [Ko-fi](https://ko-fi.com/xquscom) 💸\"\n      },\n      \"typeVersion\": 1\n    }\n  ],\n  \"pinData\": {},\n  \"connections\": {\n    \"Prepare\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Check token\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Webhook\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Prepare\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Check type\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Donation\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Subscription\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Shop Order\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Check token\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Check type\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Stop and Error\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Subscription\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Is new subscriber?\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}",
  "metadata": {
    "node_types": [
      "n8n-nodes-base.webhook",
      "n8n-nodes-base.stopAndError",
      "n8n-nodes-base.set",
      "n8n-nodes-base.set",
      "n8n-nodes-base.set",
      "n8n-nodes-base.if",
      "n8n-nodes-base.set",
      "n8n-nodes-base.if",
      "n8n-nodes-base.switch",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote"
    ],
    "trigger": null
  }
}