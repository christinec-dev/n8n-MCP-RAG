{
  "source": "0319_Gmail_Googlecalendartool_Send_Triggered.json",
  "index": 1,
  "content": "{\n  \"meta\": {\n    \"instanceId\": \"408f9fb9940c3cb18ffdef0e0150fe342d6e655c3a9fac21f0f644e8bedabcd9\",\n    \"templateCredsSetupCompleted\": true\n  },\n  \"nodes\": [\n    {\n      \"id\": \"eaa31cde-3017-400d-aac8-999def8cc227\",\n      \"name\": \"Sticky Note\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -340,\n        -780\n      ],\n      \"parameters\": {\n        \"width\": 617,\n        \"height\": 490,\n        \"content\": \"## Check if incoming email is about appointment\\nWe use LLM to check subject and body of the email and determine if it's an appointment request. \"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"b03d3f72-d1d8-49a7-bcc1-a476fd5c4ad7\",\n      \"name\": \"Sticky Note1\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        400,\n        -780\n      ],\n      \"parameters\": {\n        \"width\": 796,\n        \"height\": 482,\n        \"content\": \"## Get calendar availability and compose a response\\nMake sure to update the Workflow ID if you are running this as 2 workflows\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"29ce0093-c4c8-41cc-be69-334de3a1d1a2\",\n      \"name\": \"OpenAI Chat Model\",\n      \"type\": \"@n8n/n8n-nodes-langchain.lmChatOpenAi\",\n      \"position\": [\n        -60,\n        -460\n      ],\n      \"parameters\": {\n        \"model\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"gpt-4o-mini\"\n        },\n        \"options\": {}\n      },\n      \"credentials\": {\n        \"openAiApi\": {\n          \"id\": \"8gccIjcuf3gvaoEr\",\n          \"name\": \"OpenAi account\"\n        }\n      },\n      \"typeVersion\": 1.2\n    },\n    {\n      \"id\": \"5176f475-704b-446e-b368-ffa395bb089e\",\n      \"name\": \"OpenAI Chat Model1\",\n      \"type\": \"@n8n/n8n-nodes-langchain.lmChatOpenAi\",\n      \"position\": [\n        480,\n        -460\n      ],\n      \"parameters\": {\n        \"model\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"gpt-4o-mini\"\n        },\n        \"options\": {}\n      },\n      \"credentials\": {\n        \"openAiApi\": {\n          \"id\": \"8gccIjcuf3gvaoEr\",\n          \"name\": \"OpenAi account\"\n        }\n      },\n      \"typeVersion\": 1.2\n    },\n    {\n      \"id\": \"0e8a75dd-ce68-46c3-972c-32b15e04b254\",\n      \"name\": \"Send reply\",\n      \"type\": \"n8n-nodes-base.gmail\",\n      \"position\": [\n        940,\n        -660\n      ],\n      \"webhookId\": \"0f18d414-1b14-4d2e-9fc2-d2d302372dc6\",\n      \"parameters\": {\n        \"message\": \"={{ $json.output }}\",\n        \"options\": {},\n        \"messageId\": \"={{ $('Gmail Trigger').first().json.id }}\",\n        \"operation\": \"reply\"\n      },\n      \"credentials\": {\n        \"gmailOAuth2\": {\n          \"id\": \"Sf5Gfl9NiFTNXFWb\",\n          \"name\": \"Gmail account\"\n        }\n      },\n      \"typeVersion\": 2.1\n    },\n    {\n      \"id\": \"bf154384-274a-4cdd-977d-890220948a9d\",\n      \"name\": \"Gmail Trigger\",\n      \"type\": \"n8n-nodes-base.gmailTrigger\",\n      \"position\": [\n        -280,\n        -640\n      ],\n      \"parameters\": {\n        \"filters\": {\n          \"readStatus\": \"unread\",\n          \"includeSpamTrash\": false\n        },\n        \"pollTimes\": {\n          \"item\": [\n            {\n              \"mode\": \"everyMinute\"\n            }\n          ]\n        }\n      },\n      \"credentials\": {\n        \"gmailOAuth2\": {\n          \"id\": \"Sf5Gfl9NiFTNXFWb\",\n          \"name\": \"Gmail account\"\n        }\n      },\n      \"typeVersion\": 1.2\n    },\n    {\n      \"id\": \"5a268b34-38ea-4e55-87ab-8a616e2aa1fa\",\n      \"name\": \"Classify appointment\",\n      \"type\": \"@n8n/n8n-nodes-langchain.textClassifier\",\n      \"position\": [\n        -60,\n        -640\n      ],\n      \"parameters\": {\n        \"options\": {\n          \"fallback\": \"discard\"\n        },\n        \"inputText\": \"=Please evaluate the following email to determine if it suggests scheduling a meeting or a call:\\nSubject: {{ $json.Subject }}\\nSnippet: {{ $json.snippet }}\",\n        \"categories\": {\n          \"categories\": [\n            {\n              \"category\": \"is_appointment\",\n              \"description\": \"email Is requesting an appointment\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"7b5a8468-09e5-4575-97cb-9175ee02b19d\",\n      \"name\": \"Agent\",\n      \"type\": \"@n8n/n8n-nodes-langchain.agent\",\n      \"position\": [\n        500,\n        -660\n      ],\n      \"parameters\": {\n        \"text\": \"=Sender: {{ $('Gmail Trigger').first().json.From }}\\nSubject: {{ $('Gmail Trigger').first().json.Subject }}\\nEmail Text: {{ $('Gmail Trigger').first().json.snippet }}\",\n        \"options\": {\n          \"systemMessage\": \"=You are an email scheduling assistant. Based on the received email, check my availability and propose an appropriate response. \\nAim to get a specific time, rather than just a day. When checking my availability, make sure that there's enough time in between meetings.\\nIf I'm not available, ALWAYS propose a new time based on my availability. When proposing a new time, always leave 15 minutes buffer from previous meeting.\\nToday date and time is: {{ $now.toISO() }}.\"\n        },\n        \"promptType\": \"define\"\n      },\n      \"typeVersion\": 1.8\n    },\n    {\n      \"id\": \"b61e8061-5719-4c30-97da-e306e7b79b76\",\n      \"name\": \"Google Calendar\",\n      \"type\": \"n8n-nodes-base.googleCalendarTool\",\n      \"position\": [\n        680,\n        -460\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"timeMax\": \"={{ $now.plus(1, 'month').toISO() }}\",\n        \"timeMin\": \"={{ $now.minus(1, 'day').toISO() }}\",\n        \"calendar\": {\n          \"__rl\": true,\n          \"mode\": \"id\",\n          \"value\": \"your_email@gmail.com\"\n        },\n        \"operation\": \"getAll\",\n        \"returnAll\": true\n      },\n      \"credentials\": {\n        \"googleCalendarOAuth2Api\": {\n          \"id\": \"kWMxmDbMDDJoYFVK\",\n          \"name\": \"Google Calendar account\"\n        }\n      },\n      \"typeVersion\": 1.3\n    },\n    {\n      \"id\": \"47e07b6c-d432-4111-b33e-56d6c305c40c\",\n      \"name\": \"Mark as read\",\n      \"type\": \"n8n-nodes-base.gmail\",\n      \"position\": [\n        940,\n        -480\n      ],\n      \"webhookId\": \"7e2d851b-c9f3-471c-875d-0da7c2c3b561\",\n      \"parameters\": {\n        \"messageId\": \"={{ $('Gmail Trigger').first().json.id }}\",\n        \"operation\": \"markAsRead\"\n      },\n      \"credentials\": {\n        \"gmailOAuth2\": {\n          \"id\": \"Sf5Gfl9NiFTNXFWb\",\n          \"name\": \"Gmail account\"\n        }\n      },\n      \"typeVersion\": 2.1\n    }\n  ],\n  \"pinData\": {},\n  \"connections\": {\n    \"Agent\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Send reply\",\n            \"type\": \"main\",\n            \"index\": 0\n          },\n          {\n            \"node\": \"Mark as read\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Gmail Trigger\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Classify appointment\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Google Calendar\": {\n      \"ai_tool\": [\n        [\n          {\n            \"node\": \"Agent\",\n            \"type\": \"ai_tool\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"OpenAI Chat Model\": {\n      \"ai_languageModel\": [\n        [\n          {\n            \"node\": \"Classify appointment\",\n            \"type\": \"ai_languageModel\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"OpenAI Chat Model1\": {\n      \"ai_languageModel\": [\n        [\n          {\n            \"node\": \"Agent\",\n            \"type\": \"ai_languageModel\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Classify appointment\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Agent\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        []\n      ]\n    }\n  }\n}",
  "metadata": {
    "node_types": [
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "n8n-nodes-base.gmail",
      "n8n-nodes-base.gmailTrigger",
      "@n8n/n8n-nodes-langchain.textClassifier",
      "@n8n/n8n-nodes-langchain.agent",
      "n8n-nodes-base.googleCalendarTool",
      "n8n-nodes-base.gmail"
    ],
    "trigger": "gmail trigger"
  }
}