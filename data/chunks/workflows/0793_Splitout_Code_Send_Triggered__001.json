{
  "source": "0793_Splitout_Code_Send_Triggered.json",
  "index": 1,
  "content": "{\n  \"meta\": {\n    \"instanceId\": \"6a5e68bcca67c4cdb3e0b698d01739aea084e1ec06e551db64aeff43d174cb23\",\n    \"templateCredsSetupCompleted\": true\n  },\n  \"nodes\": [\n    {\n      \"id\": \"bc49829b-45f2-4910-9c37-907271982f14\",\n      \"name\": \"Sticky Note3\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -4200,\n        -560\n      ],\n      \"parameters\": {\n        \"width\": 780,\n        \"height\": 540,\n        \"content\": \"### 5. Do you need more details?\\nFind a step-by-step guide in this tutorial\\n![Guide](https://www.samirsaci.com/content/images/2025/04/EDI-Message-Parser.png)\\n[ðŸŽ¥ Watch My Tutorial](https://youtu.be/-phwXeYk7Es)\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"fca5a1f8-874b-4b25-92af-066e7ca03f67\",\n      \"name\": \"Order Information\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        -4360,\n        -1000\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"a55ebbb4-3eba-4584-8894-9e8d623d498f\",\n              \"name\": \"documentType\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.summary.documentType }}\"\n            },\n            {\n              \"id\": \"cbbff4da-4679-4258-bc3c-848075c5f1df\",\n              \"name\": \"documentNumber\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.summary.documentNumber }}\"\n            },\n            {\n              \"id\": \"a2eb5f07-8d1b-4c3a-b08b-a785045aeb34\",\n              \"name\": \"orderDate\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.summary.orderDate }}\"\n            },\n            {\n              \"id\": \"7e319d29-463b-4875-b556-684cb0c06c59\",\n              \"name\": \"lineItemCount\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.summary.lineItemCount }}\"\n            },\n            {\n              \"id\": \"5c9fc86c-e5c0-411f-a7d5-1121b5779906\",\n              \"name\": \"totalQuantity\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.summary.totalQuantity }}\"\n            }\n          ]\n        }\n      },\n      \"notesInFlow\": true,\n      \"typeVersion\": 3.4\n    },\n    {\n      \"id\": \"3598dc97-a0d3-4d34-8220-b91925014e4a\",\n      \"name\": \"Return Orders\",\n      \"type\": \"n8n-nodes-base.googleSheets\",\n      \"position\": [\n        -3620,\n        -960\n      ],\n      \"parameters\": {\n        \"columns\": {\n          \"value\": {},\n          \"schema\": [\n            {\n              \"id\": \"documentType\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"documentType\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"documentNumber\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"documentNumber\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"orderDate\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"orderDate\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"lineItemCount\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"lineItemCount\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"totalQuantity\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"totalQuantity\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"header_Document_Type\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"header_Document_Type\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"header_Document_Number\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"header_Document_Number\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"header_Message_Function\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"header_Message_Function\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"header_Sender_ID\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"header_Sender_ID\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"header_Receiver_ID\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"header_Receiver_ID\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"header_Date\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"header_Date\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"header_Time\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"header_Time\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"header_Control_Reference\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"header_Control_Reference\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"date1_Qualifier\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"date1_Qualifier\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"date1_Description\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"date1_Description\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"date1_Date\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"date1_Date\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"date1_Format\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"date1_Format\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"date2_Qualifier\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"date2_Qualifier\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"date2_Description\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"date2_Description\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"date2_Date\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"date2_Date\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"date2_Format\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"date2_Format\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"date3_Qualifier\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"date3_Qualifier\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"date3_Description\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"date3_Description\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"date3_Date\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"date3_Date\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"date3_Format\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"date3_Format\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"party1_Type\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"party1_Type\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"party1_Description\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"party1_Description\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"party1_ID\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"party1_ID\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"party1_Name\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"party1_Name\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"party2_Type\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"party2_Type\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"party2_Description\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"party2_Description\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"party2_ID\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"party2_ID\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"party2_Name\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"party2_Name\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"party3_Type\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"party3_Type\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"party3_Description\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"party3_Description\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"party3_ID\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"party3_ID\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"party3_Name\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"party3_Name\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"party4_Type\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"party4_Type\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"party4_Description\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"party4_Description\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"party4_ID\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"party4_ID\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"party4_Name\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"party4_Name\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"line_Number\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"line_Number\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"line_Product_ID\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"line_Product_ID\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"line_Product_ID_Type\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"line_Product_ID_Type\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"line_Description\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"line_Description\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"line_Quantity\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"line_Quantity\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"line_Unit\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"line_Unit\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"line_Price\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"line_Price\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"line_Price_Qualifier\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"line_Price_Qualifier\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            }\n          ],\n          \"mappingMode\": \"autoMapInputData\",\n          \"matchingColumns\": [],\n          \"attemptToConvertTypes\": false,\n          \"convertFieldsToString\": false\n        },\n        \"options\": {},\n        \"operation\": \"append\",\n        \"sheetName\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": 1261096359,\n          \"cachedResultUrl\": \"=\",\n          \"cachedResultName\": \"=\"\n        },\n        \"documentId\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"1SaSFnJx80wrArf6DLx8zZx2y5VFOAmp0u-a26wliTbU\",\n          \"cachedResultUrl\": \"=\",\n          \"cachedResultName\": \"=\"\n        }\n      },\n      \"notesInFlow\": true,\n      \"typeVersion\": 4.5\n    },\n    {\n      \"id\": \"edfa5ef9-3095-47c2-ad80-c09cac647823\",\n      \"name\": \"Outbound Orders\",\n      \"type\": \"n8n-nodes-base.googleSheets\",\n      \"position\": [\n        -3640,\n        -780\n      ],\n      \"parameters\": {\n        \"columns\": {\n          \"value\": {},\n          \"schema\": [\n            {\n              \"id\": \"documentType\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"documentType\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"documentNumber\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"documentNumber\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"orderDate\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"orderDate\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"lineItemCount\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"lineItemCount\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"totalQuantity\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"totalQuantity\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"header_Document_Type\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"header_Document_Type\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"header_Document_Number\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"header_Document_Number\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"header_Message_Function\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"header_Message_Function\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"header_Sender_ID\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"header_Sender_ID\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"header_Receiver_ID\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"header_Receiver_ID\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"header_Date\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"header_Date\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"header_Time\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"header_Time\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"header_Control_Reference\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"header_Control_Reference\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"date1_Qualifier\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"date1_Qualifier\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"date1_Description\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"date1_Description\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"date1_Date\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"date1_Date\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"date1_Format\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"date1_Format\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"date2_Qualifier\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"date2_Qualifier\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"date2_Description\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"date2_Description\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"date2_Date\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"date2_Date\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"date2_Format\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"date2_Format\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"date3_Qualifier\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"date3_Qualifier\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"date3_Description\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"date3_Description\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"date3_Date\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"date3_Date\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"date3_Format\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"date3_Format\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"party1_Type\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"party1_Type\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"party1_Description\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"party1_Description\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"party1_ID\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"party1_ID\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"party1_Name\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"party1_Name\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"party2_Type\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"party2_Type\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"party2_Description\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"party2_Description\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"party2_ID\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"party2_ID\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"party2_Name\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"party2_Name\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"party3_Type\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"party3_Type\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"party3_Description\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"party3_Description\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"party3_ID\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"party3_ID\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"party3_Name\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"party3_Name\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"party4_Type\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"party4_Type\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"party4_Description\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"party4_Description\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"party4_ID\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"party4_ID\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"party4_Name\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"party4_Name\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"line_Number\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"line_Number\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"line_Product_ID\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"line_Product_ID\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"line_Product_ID_Type\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"line_Product_ID_Type\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"line_Description\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"line_Description\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"line_Quantity\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"line_Quantity\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"line_Unit\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"line_Unit\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"line_Price\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"line_Price\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"line_Price_Qualifier\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"line_Price_Qualifier\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            }\n          ],\n          \"mappingMode\": \"autoMapInputData\",\n          \"matchingColumns\": [],\n          \"attemptToConvertTypes\": false,\n          \"convertFieldsToString\": false\n        },\n        \"options\": {},\n        \"operation\": \"append\",\n        \"sheetName\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": 1261096359,\n          \"cachedResultUrl\": \"=\",\n          \"cachedResultName\": \"=\"\n        },\n        \"documentId\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"1SaSFnJx80wrArf6DLx8zZx2y5VFOAmp0u-a26wliTbU\",\n          \"cachedResultUrl\": \"=\",\n          \"cachedResultName\": \"=\"\n        }\n      },\n      \"notesInFlow\": true,\n      \"typeVersion\": 4.5\n    },\n    {\n      \"id\": \"6d1c614f-9301-4f25-ab11-350018f145e3\",\n      \"name\": \"Order Type\",\n      \"type\": \"n8n-nodes-base.if\",\n      \"position\": [\n        -3840,\n        -880\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"conditions\": {\n          \"options\": {\n            \"version\": 2,\n            \"leftValue\": \"\",\n            \"caseSensitive\": true,\n            \"typeValidation\": \"strict\"\n          },\n          \"combinator\": \"and\",\n          \"conditions\": [\n            {\n              \"id\": \"fc591c63-edfe-4e6d-8074-6ab3079988c8\",\n              \"operator\": {\n                \"name\": \"filter.operator.equals\",\n                \"type\": \"string\",\n                \"operation\": \"equals\"\n              },\n              \"leftValue\": \"={{ $json.documentType }}\",\n              \"rightValue\": \"Return Order\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 2.2\n    },\n    {\n      \"id\": \"fc206367-2fbf-4943-b2ce-9fe399dd2730\",\n      \"name\": \"Sticky Note1\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -5420,\n        -1240\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 380,\n        \"height\": 620,\n        \"content\": \"### 1. Workflow Trigger with Gmail Trigger\\nThe workflow is triggered by a new email received in your Gmail mailbox. \\nIf the subject includes the string \\\"EDI\\\" we proceed, if not we do nothing.\\n\\n#### How to setup?\\n- **Gmail Trigger Node:** set up your Gmail API credentials\\n[Learn more about the Gmail Trigger Node](https://docs.n8n.io/integrations/builtin/trigger-nodes/n8n-nodes-base.gmailtrigger)\\n\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"c6da1a85-d725-4a41-b63f-504fa8b552fb\",\n      \"name\": \"Sticky Note\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -5420,\n        -540\n      ],\n      \"parameters\": {\n        \"width\": 800,\n        \"height\": 880,\n        \"content\": \"### Example of EDI Message\\nYou can send yourself this email to test the workflow.\\n\\nUNA:+.? '\\nUNB+UNOC:3+SENDER_ID+RECEIVER_ID+240317:1200+ORDER67890'\\nUNH+1+ORDERS:D:96A:UN'\\nBGM+220+PO56789012+9'\\nDTM+137:20250318:102'      \\nDTM+2:20250325:102'        \\nDTM+10:20250324:102'      \\nNAD+BY+BUYER_ABC::91'\\nNAD+SU+SUPPLIER_XYZ::91'\\nNAD+DP+WAREHOUSE_001::91'\\nNAD+DP+Main Distribution Center'\\nLIN+1++987654:IN'\\nIMD+F++:::Product X Description'\\nQTY+21:50:EA'\\nPRI+AAA:20.00'\\nLIN+2++654987:IN'\\nIMD+F++:::Product Y Description'\\nQTY+21:150:EA'\\nPRI+AAA:12.75'\\nUNT+10+1'\\nUNZ+1+ORDER67890'UNA:+.? '\\nUNB+UNOC:3+SENDER_ID+RECEIVER_ID+240317:1200+ORDER67890'\\nUNH+1+ORDERS:D:96A:UN'\\nBGM+220+PO56789012+9'\\nDTM+137:20250318:102'      \\nDTM+2:20250325:102'        \\nDTM+10:20250324:102'      \\nNAD+BY+BUYER_ABC::91'\\nNAD+SU+SUPPLIER_XYZ::91'\\nNAD+DP+WAREHOUSE_001::91'\\nNAD+DP+Main Distribution Center'\\nLIN+1++987654:IN'\\nIMD+F++:::Product X Description'\\nQTY+21:50:EA'\\nPRI+AAA:20.00'\\nLIN+2++654987:IN'\\nIMD+F++:::Product Y Description'\\nQTY+21:150:EA'\\nPRI+AAA:12.75'\\nUNT+10+1'\\nUNZ+1+ORDER67890'\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"4c82f8ff-e405-4e5f-8386-9c622805023a\",\n      \"name\": \"Sticky Note2\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -4980,\n        -1240\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 440,\n        \"height\": 620,\n        \"content\": \"### 2. Get Email Body & Parse EDI Message\\nThe first node extracts the email body using the ID from the trigger. This body is parsed using the code node to extract order information.\\n\\n#### How to setup?\\n- **Gmail Node:** set up your Gmail API credentials\\n[Learn more about the Gmail Node](https://docs.n8n.io/integrations/builtin/app-nodes/n8n-nodes-base.gmail)\\n\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"e90096b1-ad36-4b18-96a2-9259377b4873\",\n      \"name\": \"Email Trigger\",\n      \"type\": \"n8n-nodes-base.gmailTrigger\",\n      \"position\": [\n        -5400,\n        -860\n      ],\n      \"parameters\": {\n        \"filters\": {},\n        \"pollTimes\": {\n          \"item\": [\n            {\n              \"mode\": \"everyMinute\"\n            }\n          ]\n        }\n      },\n      \"notesInFlow\": true,\n      \"typeVersion\": 1.2\n    },\n    {\n      \"id\": \"26433f0f-487d-49dc-8de7-d4bd3bcf895c\",\n      \"name\": \"Subject includes EDI\",\n      \"type\": \"n8n-nodes-base.if\",\n      \"position\": [\n        -5180,\n        -860\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"conditions\": {\n          \"options\": {\n            \"version\": 2,\n            \"leftValue\": \"\",\n            \"caseSensitive\": true,\n            \"typeValidation\": \"strict\"\n          },\n          \"combinator\": \"and\",\n          \"conditions\": [\n            {\n              \"id\": \"3bc8a327-7e66-48e3-b442-38125b6f8670\",\n              \"operator\": {\n                \"type\": \"string\",\n                \"operation\": \"contains\"\n              },\n              \"leftValue\": \"={{ $json.Subject }}\",\n              \"rightValue\": \"EDI\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 2.2\n    },\n    {\n      \"id\": \"6960941f-6b49-41c2-88c6-9442bcb7cb34\",\n      \"name\": \"Extract Body\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        -4820,\n        -860\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"38358bb8-1b5a-4adc-816d-6710f53f7c0d\",\n              \"name\": \"body\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.text.replace(/\\\\\\\\n/g, '\\\\n').replace(/^'|'$/g, '') }}\"\n            }\n          ]\n        }\n      },\n      \"notesInFlow\": true,\n      \"typeVersion\": 3.4\n    },\n    {\n      \"id\": \"6e64556e-07ce-4d9d-89fc-07971dd9c553\",\n      \"name\": \"Get Email\",\n      \"type\": \"n8n-nodes-base.gmail\",\n      \"position\": [\n        -4960,\n        -860\n      ],\n      \"webhookId\": \"7476ecd4-e3ba-471d-a73a-ddef7b3ffd28\",\n      \"parameters\": {\n        \"simple\": false,\n        \"options\": {},\n        \"messageId\": \"={{ $json.id }}\",\n        \"operation\": \"get\"\n      },\n      \"notesInFlow\": true,\n      \"typeVersion\": 2.1\n    },\n    {\n      \"id\": \"0346eabe-552a-47d8-ac9e-9619926d0242\",\n      \"name\": \"Parse EDI Message\",\n      \"type\": \"n8n-nodes-base.code\",\n      \"position\": [\n        -4660,\n        -860\n      ],\n      \"parameters\": {\n        \"jsCode\": \"// EDI Parser function for n8n JavaScript node\\nfunction parseEDI(ediMessage) {\\n  // Define the data structure to store parsed results\\n  const result = {\\n    interchangeHeader: {},\\n    messageHeader: {},\\n    orderDetails: {},\\n    dates: [],\\n    parties: [],\\n    lineItems: []\\n  };\\n  \\n  // Split the message into lines and remove empty lines\\n  const lines = ediMessage.split(\\\"'\\\").filter(line => line.trim().length > 0);\\n  \\n  // Parse each line\\n  let currentLineItem = null;\\n  \\n  for (const line of lines) {\\n    const segments = line.trim().split('+');\\n    const segmentName = segments[0];\\n    \\n    switch (segmentName) {\\n      case 'UNA':\\n        // Service String Advice - contains delimiter information\\n        break;\\n        \\n      case 'UNB':\\n        // Interchange Header\\n        // UNB+UNOC:3+SENDER_ID+RECEIVER_ID+240318:1200+ORDER54321\\n        result.interchangeHeader = {\\n          syntax: segments[1],\\n          senderId: segments[2],\\n          receiverId: segments[3],\\n          dateTime: segments[4]?.split(':')[0] || '',\\n          time: segments[4]?.split(':')[1] || '',\\n          controlReference: segments[5] || ''\\n        };\\n        break;\\n        \\n      case 'UNH':\\n        // Message Header\\n        // UNH+1+ORDERS:D:96A:UN\\n        if (segments.length > 2) {\\n          const messageParts = segments[2].split(':');\\n          result.messageHeader = {\\n            messageReference: segments[1],\\n            messageType: messageParts[0],\\n            messageVersion: messageParts[1],\\n            messageRelease: messageParts[2],\\n            controlAgency: messageParts[3]\\n          };\\n        }\\n        break;\\n        \\n      case 'BGM':\\n        // Beginning of Message\\n        // BGM+230+RT54321098+9\\n        result.orderDetails = {\\n          documentType: segments[1],\\n          documentNumber: segments[2],\\n          messageFunction: segments[3]\\n        };\\n        break;\\n        \\n      case 'DTM':\\n        // Date/Time/Period\\n        // DTM+137:20250319:102\\n        if (segments[1]) {\\n          const dateParts = segments[1].split(':');\\n          const dateObj = {\\n            qualifier: dateParts[0],\\n            date: dateParts[1],\\n            format: dateParts[2]\\n          };\\n          \\n          // Add human-readable description based on qualifier\\n          switch (dateParts[0]) {\\n            case '137':\\n              dateObj.description = 'Document Date';\\n              break;\\n            case '2':\\n              dateObj.description = 'Delivery Date';\\n              break;\\n            case '10':\\n              dateObj.description = 'Shipment Date';\\n              break;\\n            default:\\n              dateObj.description = 'Other Date';\\n          }\\n          \\n          result.dates.push(dateObj);\\n        }\\n        break;\\n      \\n      case 'NAD':\\n        // Name and Address\\n        // NAD+BY+CUSTOMER_123::91\\n        if (segments.length > 1) {\\n          const partyCode = segments[1];\\n          const partyId = segments[2]?.split(':')[0] || '';\\n          \\n          const party = {\\n            partyQualifier: partyCode,\\n            partyId: partyId,\\n            qualifierDescription: ''\\n          };\\n          \\n          // Add human-readable description\\n          switch (partyCode) {\\n            case 'BY':\\n              party.qualifierDescription = 'Buyer';\\n              break;\\n            case 'SU':\\n              party.qualifierDescription = 'Supplier';\\n              break;\\n            case 'DP':\\n              party.qualifierDescription = 'Delivery Party';\\n              break;\\n            default:\\n              party.qualifierDescription = 'Other Party';\\n          }\\n          \\n          // If there's a full name instead of a code (like \\\"Returns Processing Hub\\\")\\n          if (segments[2] && !segments[2].includes(':')) {\\n            party.partyName = segments[2];\\n            party.partyId = '';\\n          }\\n          \\n          result.parties.push(party);\\n        }\\n        break;\\n      \\n      case 'LIN':\\n        // Line Item\\n        // LIN+1++321654:IN\\n        currentLineItem = {\\n          lineNumber: segments[1],\\n          productId: '',\\n          productIdType: '',\\n          description: '',\\n          quantity: 0,\\n          unit: '',\\n          price: 0\\n        };\\n        \\n        // Parse product ID if present\\n        if (segments[3]) {\\n          const productParts = segments[3].split(':');\\n          currentLineItem.productId = productParts[0];\\n          currentLineItem.productIdType = productParts[1] || '';\\n        }\\n        \\n        result.lineItems.push(currentLineItem);\\n        break;\\n      \\n      case 'IMD':\\n        // Item Description\\n        // IMD+F++:::Defective Product A\\n        if (currentLineItem && segments.length > 3) {\\n          // The description is typically in the last component after multiple colons\\n          const descriptionParts = segments[3].split(':');\\n          currentLineItem.description = descriptionParts[descriptionParts.length - 1];\\n        }\\n        break;\\n      \\n      case 'QTY':\\n        // Quantity\\n        // QTY+21:10:EA\\n        if (currentLineItem && segments[1]) {\\n          const quantityParts = segments[1].split(':');\\n          currentLineItem.quantityQualifier = quantityParts[0];\\n          currentLineItem.quantity = parseFloat(quantityParts[1] || '0');\\n          currentLineItem.unit = quantityParts[2] || '';\\n        }\\n        break;\\n      \\n      case 'PRI':\\n        // Price Details\\n        // PRI+AAA:0.00\\n        if (currentLineItem && segments[1]) {\\n          const priceParts = segments[1].split(':');\\n          currentLineItem.priceQualifier = priceParts[0];\\n          currentLineItem.price = parseFloat(priceParts[1] || '0');\\n        }\\n        break;\\n      \\n      case 'UNT':\\n        // Message Trailer\\n        break;\\n      \\n      case 'UNZ':\\n        // Interchange Trailer\\n        break;\\n    }\\n  }\\n  \\n  // Add some summary info\\n  result.summary = {\\n    documentType: 'Return Order',\\n    documentNumber: result.orderDetails.documentNumber,\\n    orderDate: result.dates.find(d => d.qualifier === '137')?.date || '',\\n    lineItemCount: result.lineItems.length,\\n    totalQuantity: result.lineItems.reduce((sum, item) => sum + item.quantity, 0)\\n  };\\n  \\n  return result;\\n}\\n\\n// Return the parsed EDI data\\nconst ediMessage =  $input.first().json.body;\\n\\nif (!ediMessage) {\\n  throw new Error('No EDI message found in input. Please provide the EDI message in the \\\"ediMessage\\\" property.');\\n}\\n\\nconst parsedData = parseEDI(ediMessage);\\nreturn { json: parsedData };\"\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"0fa4b446-bb37-48ab-a44b-8b2c52e2660b\",\n      \"name\": \"Sticky Note4\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -4100,\n        -1240\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 700,\n        \"height\": 620,\n        \"content\": \"### 4. Store the Transactions in a Google Sheet\\nThis block will filter the order based on the order type (Return Orders, Outbound Orders) extracted from the order information node. Results are stored in two distinct sheets of the same Google Sheet file.\\n\\n#### How to setup?\\n- **Add Results in Google Sheets**:\\n   1. Add your Google Sheet API credentials to access the Google Sheet file\\n   2. Select the file using the list, an URL or an ID\\n   3. Select the sheet in which the vocabulary list is stored\\n   4. You don't need to create columns as the mapping is automatic.\\n  [Learn more about the Google Sheet Node](https://docs.n8n.io/integrations/builtin/app-nodes/n8n-nodes-base.googlesheets)\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"7a1451db-9390-431f-bca5-54a537ff8016\",\n      \"name\": \"Order Info + Orderlines\",\n      \"type\": \"n8n-nodes-base.merge\",\n      \"position\": [\n        -4040,\n        -880\n      ],\n      \"parameters\": {\n        \"mode\": \"combineBySql\"\n      },\n      \"typeVersion\": 3\n    },\n    {\n      \"id\": \"e64a1db7-4c22-4925-9597-9c14fdddbfe4\",\n      \"name\": \"Flatten Data to Orderlines\",\n      \"type\": \"n8n-nodes-base.code\",\n      \"position\": [\n        -4460,\n        -860\n      ],\n      \"parameters\": {\n        \"jsCode\": \"// EDI to Flattened Tabular Data Transformer for n8n JavaScript node\\nfunction transformToFlattened(parsedEDI) {\\n  const flattened = [];\\n  \\n  // Create a header object with all order header fields\\n  const headerObj = {\\n    header_Document_Type: parsedEDI.orderDetails.documentType || '',\\n    header_Document_Number: parsedEDI.orderDetails.documentNumber || '',\\n    header_Message_Function: parsedEDI.orderDetails.messageFunction || '',\\n    header_Sender_ID: parsedEDI.interchangeHeader.senderId || '',\\n    header_Receiver_ID: parsedEDI.interchangeHeader.receiverId || '',\\n    header_Date: parsedEDI.interchangeHeader.dateTime || '',\\n    header_Time: parsedEDI.interchangeHeader.time || '',\\n    header_Control_Reference: parsedEDI.interchangeHeader.controlReference || ''\\n  };\\n  \\n  // Process all dates\\n  const dateObjs = {};\\n  if (parsedEDI.dates && Array.isArray(parsedEDI.dates)) {\\n    parsedEDI.dates.forEach((date, index) => {\\n      const prefix = `date${index + 1}_`;\\n      dateObjs[`${prefix}Qualifier`] = date.qualifier || '';\\n      dateObjs[`${prefix}Description`] = date.description || '';\\n      dateObjs[`${prefix}Date`] = date.date || '';\\n      dateObjs[`${prefix}Format`] = date.format || '';\\n    });\\n  }\\n  \\n  // Process all parties\\n  const partyObjs = {};\\n  if (parsedEDI.parties && Array.isArray(parsedEDI.parties)) {\\n    parsedEDI.parties.forEach((party, index) => {\\n      const prefix = `party${index + 1}_`;\\n      partyObjs[`${prefix}Type`] = party.partyQualifier || '';\\n      partyObjs[`${prefix}Description`] = party.qualifierDescription || '';\\n      partyObjs[`${prefix}ID`] = party.partyId || '';\\n      partyObjs[`${prefix}Name`] = party.partyName || '';\\n    });\\n  }\\n  \\n  // Create one row for each line item with all header, date, and party info\\n  if (parsedEDI.lineItems && Array.isArray(parsedEDI.lineItems)) {\\n    parsedEDI.lineItems.forEach((item) => {\\n      const lineItem = {\\n        line_Number: item.lineNumber || '',\\n        line_Product_ID: item.productId || '',\\n        line_Product_ID_Type: item.productIdType || '',\\n        line_Description: item.description || '',\\n        line_Quantity: item.quantity || 0,\\n        line_Unit: item.unit || '',\\n        line_Price: item.price || 0,\\n        line_Price_Qualifier: item.priceQualifier || ''\\n      };\\n      \\n      // Combine all information into one flat object\\n      const flatRow = {\\n        ...headerObj,\\n        ...dateObjs,\\n        ...partyObjs,\\n        ...lineItem\\n      };\\n      \\n      flattened.push(flatRow);\\n    });\\n  }\\n  \\n  // If there are no line items, create at least one row with header info\\n  if (flattened.length === 0) {\\n    flattened.push({\\n      ...headerObj,\\n      ...dateObjs,\\n      ...partyObjs\\n    });\\n  }\\n  \\n  return flattened;\\n}\\n\\nconst parsedEDI = $input.all()[0].json;\\n\\n// Make sure we have valid data\\nif (!parsedEDI || !parsedEDI.orderDetails) {\\n  throw new Error('Invalid EDI data format. Please ensure the input is from the EDI parser.');\\n}\\n\\nconst flattenedData = transformToFlattened(parsedEDI);\\n\\n// Return the flattened data\\nreturn { json: { data: flattenedData } };\"\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"5b56fe40-9cfb-4668-946d-470dc9e3a39e\",\n      \"name\": \"Split Out by Line\",\n      \"type\": \"n8n-nodes-base.splitOut\",\n      \"position\": [\n        -4280,\n        -860\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"fieldToSplitOut\": \"data\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"903399b2-cdee-40c0-99cb-1c44d84e96d2\",\n      \"name\": \"Sticky Note5\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -4480,\n        -1240\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 320,\n        \"height\": 620,\n        \"content\": \"### 3. Process Parsed Data\\nThis block extract order information and format the orderlines to be stored in a google sheet.\\n\\n#### How to setup?\\nNothing to do.\"\n      },\n      \"typeVersion\": 1\n    }\n  ],\n  \"pinData\": {},\n  \"connections\": {\n    \"Get Email\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Extract Body\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Order Type\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Return Orders\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Outbound Orders\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Extract Body\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Parse EDI Message\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Email Trigger\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Subject includes EDI\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Order Information\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Order Info + Orderlines\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Parse EDI Message\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Order Information\",\n            \"type\": \"main\",\n            \"index\": 0\n          },\n          {\n            \"node\": \"Flatten Data to Orderlines\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Split Out by Line\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Order Info + Orderlines\",\n            \"type\": \"main\",\n            \"index\": 1\n          }\n        ]\n      ]\n    },\n    \"Subject includes EDI\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Get Email\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Order Info + Orderlines\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Order Type\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Flatten Data to Orderlines\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Split Out by Line\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}",
  "metadata": {
    "node_types": [
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.set",
      "n8n-nodes-base.googleSheets",
      "n8n-nodes-base.googleSheets",
      "n8n-nodes-base.if",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.gmailTrigger",
      "n8n-nodes-base.if",
      "n8n-nodes-base.set",
      "n8n-nodes-base.gmail",
      "n8n-nodes-base.code",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.merge",
      "n8n-nodes-base.code",
      "n8n-nodes-base.splitOut",
      "n8n-nodes-base.stickyNote"
    ],
    "trigger": "email trigger"
  }
}