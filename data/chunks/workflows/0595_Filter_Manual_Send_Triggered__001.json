{
  "source": "0595_Filter_Manual_Send_Triggered.json",
  "index": 1,
  "content": "{\n  \"meta\": {\n    \"instanceId\": \"67d4d33d8b0ad4e5e12f051d8ad92fc35893d7f48d7f801bc6da4f39967b3592\"\n  },\n  \"nodes\": [\n    {\n      \"id\": \"30f5203b-469d-4f0c-8493-e8f08e14e4fe\",\n      \"name\": \"When clicking â€˜Test workflowâ€™\",\n      \"type\": \"n8n-nodes-base.manualTrigger\",\n      \"position\": [\n        -560,\n        440\n      ],\n      \"parameters\": {},\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"d16f59dd-f54e-487b-9aac-67f109ba9869\",\n      \"name\": \"Sticky Note8\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        1000,\n        -280\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 727.9032097745135,\n        \"height\": 110.58643966444157,\n        \"content\": \"# Auto Categorise Outlook Emails with AI\\nBuilt by [Wayne Simpson](https://www.linkedin.com/in/simpsonwayne/) at [nocodecreative.io](https://nocodecreative.io)\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"4e110412-8530-4322-bc5c-7f9df2b63bcb\",\n      \"name\": \"Sticky Note9\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        1100,\n        -120\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 506.8102696237577,\n        \"height\": 337.24177957113216,\n        \"content\": \"### Watch Set Up Video ðŸ‘‡\\n[![Auto Categorise Outlook Emails with AI](https://vdyfnvnstovfxpabhdjc.supabase.co/storage/v1/object/public/images/Thumbnails/auto-categories-emails.png?t=2024-10-11T09%3A56%3A37.961Z#full-width)](https://www.youtube.com/watch?v=EhRBkkjv_3c)\\n\\n\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"9d79875f-148e-46ef-967a-95c07298456d\",\n      \"name\": \"Ollama Chat Model1\",\n      \"type\": \"@n8n/n8n-nodes-langchain.lmChatOllama\",\n      \"position\": [\n        1129,\n        684\n      ],\n      \"parameters\": {\n        \"model\": \"qwen2.5:14b\",\n        \"options\": {\n          \"temperature\": 0.2\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"bcf92a71-ff5f-46a7-bec3-cedb5be2bf98\",\n      \"name\": \"Microsoft Outlook10\",\n      \"type\": \"n8n-nodes-base.microsoftOutlook\",\n      \"position\": [\n        3020,\n        8\n      ],\n      \"parameters\": {\n        \"folderId\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"AQMkAGE3ZTU5MGMzLTFkNGItNGQ5Zi04MDQ1LThmNGFlMTVhYjMwYgAuAAAD8UhruVwm402lgPBG2Tj-aQEAnz-IOcWBGE2lrVuQgAF6zAAAAgFJAAAA\",\n          \"cachedResultUrl\": \"https://outlook.office365.com/mail/AQMkAGE3ZTU5MGMzLTFkNGItNGQ5Zi04MDQ1LThmNGFlMTVhYjMwYgAuAAAD8UhruVwm402lgPBG2Tj%2FaQEAnz%2FIOcWBGE2lrVuQgAF6zAAAAgFJAAAA\",\n          \"cachedResultName\": \"Junk Email\"\n        },\n        \"messageId\": {\n          \"__rl\": true,\n          \"mode\": \"id\",\n          \"value\": \"={{ $('varID & Category1').item.json.id }}\"\n        },\n        \"operation\": \"move\"\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"100db1cb-3819-43c7-a74b-5c087ad4f2da\",\n      \"name\": \"Microsoft Outlook12\",\n      \"type\": \"n8n-nodes-base.microsoftOutlook\",\n      \"position\": [\n        2700,\n        8\n      ],\n      \"parameters\": {\n        \"messageId\": {\n          \"__rl\": true,\n          \"mode\": \"id\",\n          \"value\": \"={{ $('varID & Category1').item.json.id }}\"\n        },\n        \"operation\": \"update\",\n        \"updateFields\": {\n          \"categories\": \"={{ \\n  [$('varJSON1').first().json.output.category, $('varJSON1').first().json.output.subCategory]\\n    .filter(item => item && item.trim() !== \\\"\\\")\\n    .map(item => item.charAt(0).toUpperCase() + item.slice(1))\\n}}\"\n        }\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"d4969259-a3ae-473d-82ef-0c9f7933c899\",\n      \"name\": \"Loop Over Items1\",\n      \"type\": \"n8n-nodes-base.splitInBatches\",\n      \"position\": [\n        160,\n        448\n      ],\n      \"parameters\": {\n        \"options\": {}\n      },\n      \"typeVersion\": 3\n    },\n    {\n      \"id\": \"524f6be3-7708-4aae-b9ab-e0ef8180a627\",\n      \"name\": \"Microsoft Outlook13\",\n      \"type\": \"n8n-nodes-base.microsoftOutlook\",\n      \"position\": [\n        2700,\n        188\n      ],\n      \"parameters\": {\n        \"messageId\": {\n          \"__rl\": true,\n          \"mode\": \"id\",\n          \"value\": \"={{ $('varID & Category1').item.json.id }}\"\n        },\n        \"operation\": \"update\",\n        \"updateFields\": {\n          \"categories\": \"={{ \\n  [$('varJSON1').first().json.output.category, $('varJSON1').first().json.output.subCategory]\\n    .filter(item => item && item.trim() !== \\\"\\\")\\n    .map(item => item.charAt(0).toUpperCase() + item.slice(1))\\n}}\"\n        }\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"72cb54f3-4e4e-4ad2-8845-11a38fc29f1a\",\n      \"name\": \"Microsoft Outlook15\",\n      \"type\": \"n8n-nodes-base.microsoftOutlook\",\n      \"position\": [\n        3020,\n        188\n      ],\n      \"parameters\": {\n        \"folderId\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"AQMkAGE3ZTU5MGMzLTFkNGItNGQ5Zi04MDQ1LThmNGFlMTVhYjMwYgAuAAAD8UhruVwm402lgPBG2Tj-aQEAnz-IOcWBGE2lrVuQgAF6zAADLJmrBwAAAA==\",\n          \"cachedResultUrl\": \"https://outlook.office365.com/mail/AQMkAGE3ZTU5MGMzLTFkNGItNGQ5Zi04MDQ1LThmNGFlMTVhYjMwYgAuAAAD8UhruVwm402lgPBG2Tj%2FaQEAnz%2FIOcWBGE2lrVuQgAF6zAADLJmrBwAAAA%3D%3D\",\n          \"cachedResultName\": \"Receipt\"\n        },\n        \"messageId\": {\n          \"__rl\": true,\n          \"mode\": \"id\",\n          \"value\": \"={{ $('varID & Category1').item.json.id }}\"\n        },\n        \"operation\": \"move\"\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"e4446e84-c05e-4d04-b415-7608e39024ee\",\n      \"name\": \"Microsoft Outlook16\",\n      \"type\": \"n8n-nodes-base.microsoftOutlook\",\n      \"position\": [\n        2709,\n        504\n      ],\n      \"parameters\": {\n        \"messageId\": {\n          \"__rl\": true,\n          \"mode\": \"id\",\n          \"value\": \"={{ $('varID & Category1').item.json.id }}\"\n        },\n        \"operation\": \"update\",\n        \"updateFields\": {\n          \"categories\": \"={{ \\n  [$('varJSON1').first().json.output.category, $('varJSON1').first().json.output.subCategory]\\n    .filter(item => item && item.trim() !== \\\"\\\")\\n    .map(item => item.charAt(0).toUpperCase() + item.slice(1))\\n}}\"\n        }\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"3ee05cfe-a528-472e-aa3d-c890fd88b6c4\",\n      \"name\": \"Microsoft Outlook17\",\n      \"type\": \"n8n-nodes-base.microsoftOutlook\",\n      \"position\": [\n        3020,\n        508\n      ],\n      \"parameters\": {\n        \"folderId\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"AQMkAGE3ZTU5MGMzLTFkNGItNGQ5Zi04MDQ1LThmNGFlMTVhYjMwYgAuAAAD8UhruVwm402lgPBG2Tj-aQEAnz-IOcWBGE2lrVuQgAF6zAADLJmrCAAAAA==\",\n          \"cachedResultUrl\": \"https://outlook.office365.com/mail/AQMkAGE3ZTU5MGMzLTFkNGItNGQ5Zi04MDQ1LThmNGFlMTVhYjMwYgAuAAAD8UhruVwm402lgPBG2Tj%2FaQEAnz%2FIOcWBGE2lrVuQgAF6zAADLJmrCAAAAA%3D%3D\",\n          \"cachedResultName\": \"Community\"\n        },\n        \"messageId\": {\n          \"__rl\": true,\n          \"mode\": \"id\",\n          \"value\": \"={{ $('varID & Category1').item.json.id }}\"\n        },\n        \"operation\": \"move\"\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"2fcecd9e-95cc-489a-b874-699c54518e44\",\n      \"name\": \"Microsoft Outlook18\",\n      \"type\": \"n8n-nodes-base.microsoftOutlook\",\n      \"position\": [\n        2709,\n        344\n      ],\n      \"parameters\": {\n        \"messageId\": {\n          \"__rl\": true,\n          \"mode\": \"id\",\n          \"value\": \"={{ $('varID & Category1').item.json.id }}\"\n        },\n        \"operation\": \"update\",\n        \"updateFields\": {\n          \"categories\": \"={{ \\n  [$('varJSON1').first().json.output.category, $('varJSON1').first().json.output.subCategory]\\n    .filter(item => item && item.trim() !== \\\"\\\")\\n    .map(item => item.charAt(0).toUpperCase() + item.slice(1))\\n}}\"\n        }\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"41a39309-1a94-461f-9308-63dd5b9a94a7\",\n      \"name\": \"Microsoft Outlook19\",\n      \"type\": \"n8n-nodes-base.microsoftOutlook\",\n      \"position\": [\n        3020,\n        348\n      ],\n      \"parameters\": {\n        \"folderId\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"AQMkAGE3ZTU5MGMzLTFkNGItNGQ5Zi04MDQ1LThmNGFlMTVhYjMwYgAuAAAD8UhruVwm402lgPBG2Tj-aQEAnz-IOcWBGE2lrVuQgAF6zAADLJmrCQAAAA==\",\n          \"cachedResultUrl\": \"https://outlook.office365.com/mail/AQMkAGE3ZTU5MGMzLTFkNGItNGQ5Zi04MDQ1LThmNGFlMTVhYjMwYgAuAAAD8UhruVwm402lgPBG2Tj%2FaQEAnz%2FIOcWBGE2lrVuQgAF6zAADLJmrCQAAAA%3D%3D\",\n          \"cachedResultName\": \"SaaS\"\n        },\n        \"messageId\": {\n          \"__rl\": true,\n          \"mode\": \"id\",\n          \"value\": \"={{ $('varID & Category1').item.json.id }}\"\n        },\n        \"operation\": \"move\"\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"ebf606f9-099c-4218-b23b-66e2487262d0\",\n      \"name\": \"Markdown1\",\n      \"type\": \"n8n-nodes-base.markdown\",\n      \"notes\": \"Converts the body of the email to markdown\",\n      \"position\": [\n        420,\n        468\n      ],\n      \"parameters\": {\n        \"html\": \"={{ $('Loop Over Items1').item.json.body.content }}\",\n        \"options\": {}\n      },\n      \"notesInFlow\": true,\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"ff447dd5-3ef6-4a02-8453-3489af8bf6b5\",\n      \"name\": \"varEmal1\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"notes\": \"Set email fields\",\n      \"position\": [\n        620,\n        468\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"edb304e1-3e9f-4a77-918c-25646addbc53\",\n              \"name\": \"subject\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.subject }}\"\n            },\n            {\n              \"id\": \"57a3ef3a-2701-40d9-882f-f43a7219f148\",\n              \"name\": \"importance\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.importance }}\"\n            },\n            {\n              \"id\": \"d8317f4f-aa0e-4196-89af-cb016765490a\",\n              \"name\": \"sender\",\n              \"type\": \"object\",\n              \"value\": \"={{ $json.sender.emailAddress }}\"\n            },\n            {\n              \"id\": \"908716c8-9ff7-4bdc-a1a3-64227559635e\",\n              \"name\": \"from\",\n              \"type\": \"object\",\n              \"value\": \"={{ $json.from.emailAddress }}\"\n            },\n            {\n              \"id\": \"ce007329-e221-4c5a-8130-2f8e9130160f\",\n              \"name\": \"body\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.data\\n    .replace(/<[^>]*>/g, '')                      // Remove HTML tags\\n    .replace(/\\\\[(.*?)\\\\]\\\\((.*?)\\\\)/g, '')            // Remove Markdown links like [text](link)\\n    .replace(/!\\\\[.*?\\\\]\\\\(.*?\\\\)/g, '')               // Remove Markdown images like ![alt](image-link)\\n    .replace(/\\\\|/g, '')                            // Remove table separators \\\"|\\\"\\n    .replace(/-{3,}/g, '')                         // Remove horizontal rule \\\"---\\\"\\n    .replace(/\\\\n+/g, ' ')                          // Remove multiple newlines\\n    .replace(/([^\\\\w\\\\s.,!?@])/g, '')                // Remove special characters except essential ones\\n    .replace(/\\\\s{2,}/g, ' ')                       // Replace multiple spaces with a single space\\n    .trim()                                        // Trim leading/trailing whitespace\\n}}\\n\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 3.4\n    },\n    {\n      \"id\": \"198524cb-c9f0-4261-8c38-7c878efe7457\",\n      \"name\": \"Microsoft Outlook20\",\n      \"type\": \"n8n-nodes-base.microsoftOutlook\",\n      \"position\": [\n        2700,\n        668\n      ],\n      \"parameters\": {\n        \"messageId\": {\n          \"__rl\": true,\n          \"mode\": \"id\",\n          \"value\": \"={{ $('varID & Category1').item.json.id }}\"\n        },\n        \"operation\": \"update\",\n        \"updateFields\": {\n          \"categories\": \"={{ \\n  [$('varJSON1').first().json.output.category, $('varJSON1').first().json.output.subCategory]\\n    .filter(item => item && item.trim() !== \\\"\\\")\\n    .map(item => item.charAt(0).toUpperCase() + item.slice(1))\\n}}\"\n        }\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"ec73629c-59ac-4f0e-a432-2c06934952ab\",\n      \"name\": \"Microsoft Outlook21\",\n      \"type\": \"n8n-nodes-base.microsoftOutlook\",\n      \"position\": [\n        2709,\n        1044\n      ],\n      \"parameters\": {\n        \"messageId\": {\n          \"__rl\": true,\n          \"mode\": \"id\",\n          \"value\": \"={{ $('varID & Category1').item.json.id }}\"\n        },\n        \"operation\": \"update\",\n        \"updateFields\": {\n          \"categories\": \"={{ \\n  [$('varJSON1').first().json.output.category, $('varJSON1').first().json.output.subCategory]\\n    .filter(item => item && item.trim() !== \\\"\\\")\\n    .map(item => item.charAt(0).toUpperCase() + item.slice(1))\\n}}\"\n        }\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"0a19d15c-0cd3-4f26-9be2-4914522751fb\",\n      \"name\": \"Filter1\",\n      \"type\": \"n8n-nodes-base.filter\",\n      \"position\": [\n        -100,\n        448\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"conditions\": {\n          \"options\": {\n            \"version\": 2,\n            \"leftValue\": \"\",\n            \"caseSensitive\": true,\n            \"typeValidation\": \"strict\"\n          },\n          \"combinator\": \"and\",\n          \"conditions\": [\n            {\n              \"id\": \"c8cd6917-f94e-4fb7-8601-b8ed8f1aa8bf\",\n              \"operator\": {\n                \"type\": \"array\",\n                \"operation\": \"empty\",\n                \"singleValue\": true\n              },\n              \"leftValue\": \"={{ $json.categories }}\",\n              \"rightValue\": \"\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 2.2\n    },\n    {\n      \"id\": \"96e6e31c-6306-44a8-a57a-2b5216636b00\",\n      \"name\": \"If1\",\n      \"type\": \"n8n-nodes-base.if\",\n      \"notes\": \"Checks if the email has been read\",\n      \"position\": [\n        3320,\n        668\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"conditions\": {\n          \"options\": {\n            \"version\": 2,\n            \"leftValue\": \"\",\n            \"caseSensitive\": true,\n            \"typeValidation\": \"strict\"\n          },\n          \"combinator\": \"and\",\n          \"conditions\": [\n            {\n              \"id\": \"f8cf2a56-cea8-4150-b7a0-048dbda20f2f\",\n              \"operator\": {\n                \"type\": \"boolean\",\n                \"operation\": \"true\",\n                \"singleValue\": true\n              },\n              \"leftValue\": \"={{ $json.isRead }}\",\n              \"rightValue\": \"\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 2.2\n    },\n    {\n      \"id\": \"8a6e0118-abe3-45e2-aefc-94640348b2ec\",\n      \"name\": \"Microsoft Outlook22\",\n      \"type\": \"n8n-nodes-base.microsoftOutlook\",\n      \"position\": [\n        2709,\n        864\n      ],\n      \"parameters\": {\n        \"messageId\": {\n          \"__rl\": true,\n          \"mode\": \"id\",\n          \"value\": \"={{ $('varID & Category1').item.json.id }}\"\n        },\n        \"operation\": \"update\",\n        \"updateFields\": {\n          \"categories\": \"={{ \\n  [$('varJSON1').first().json.output.category, $('varJSON1').first().json.output.subCategory]\\n    .filter(item => item && item.trim() !== \\\"\\\")\\n    .map(item => item.charAt(0).toUpperCase() + item.slice(1))\\n}}\"\n        }\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"e2d8e7b5-4447-4327-9f4e-b8d52765667e\",\n      \"name\": \"Catch Errors1\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        1760,\n        608\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"0dc6d439-60fb-49f6-b4d5-f5cce6f030ad\",\n              \"name\": \"error\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json }}\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 3.4\n    },\n    {\n      \"id\": \"17f6ac43-51e4-4bee-b0d8-13deb3bf3cc9\",\n      \"name\": \"varJSON1\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"onError\": \"continueErrorOutput\",\n      \"position\": [\n        1540,\n        468\n      ],\n      \"parameters\": {\n        \"options\": {\n          \"ignoreConversionErrors\": true\n        },\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"0c52f57f-74eb-4385-ac6b-f3e5f4f50e73\",\n              \"name\": \"output\",\n              \"type\": \"object\",\n              \"value\": \"={{ $json.output.replace(/^.*?({.*}).*$/s, '$1') }}\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 3.4\n    },\n    {\n      \"id\": \"82dd9631-a34b-4d54-be28-6f8dcc3548f0\",\n      \"name\": \"Sticky Note10\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -360,\n        220\n      ],\n      \"parameters\": {\n        \"width\": 411.91693012378937,\n        \"height\": 401.49417117683515,\n        \"content\": \"## Outlook Business with filters\\nFilters:\\n```\\nflag/flagStatus eq 'notFlagged' and not categories/any()\\n```\\n\\nThese filters ensure we do not process flagged emails or email that already have a category set.\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"0583e196-37a5-43db-8c0a-aa624029c926\",\n      \"name\": \"Microsoft Outlook23\",\n      \"type\": \"n8n-nodes-base.microsoftOutlook\",\n      \"position\": [\n        -300,\n        448\n      ],\n      \"parameters\": {\n        \"limit\": 1,\n        \"fields\": [\n          \"flag\",\n          \"from\",\n          \"importance\",\n          \"replyTo\",\n          \"sender\",\n          \"subject\",\n          \"toRecipients\",\n          \"body\",\n          \"categories\",\n          \"isRead\"\n        ],\n        \"output\": \"fields\",\n        \"options\": {},\n        \"filtersUI\": {\n          \"values\": {\n            \"filters\": {\n              \"custom\": \"flag/flagStatus eq 'notFlagged' and not categories/any()\",\n              \"foldersToInclude\": [\n                \"AQMkAGE3ZTU5MGMzLTFkNGItNGQ5Zi04MDQ1LThmNGFlMTVhYjMwYgAuAAAD8UhruVwm402lgPBG2Tj-aQEAnz-IOcWBGE2lrVuQgAF6zAAAAgEMAAAA\"\n              ]\n            }\n          }\n        },\n        \"operation\": \"getAll\"\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"a9540e6b-929b-4460-8972-93e4d19cd934\",\n      \"name\": \"varID & Category1\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        900,\n        468\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"de2ad4f2-7381-4715-a3f4-59611e161b74\",\n              \"name\": \"id\",\n              \"type\": \"string\",\n              \"value\": \"={{ $('Microsoft Outlook23').item.json.id }}\"\n            },\n            {\n              \"id\": \"458c7a89-e4a3-46d0-8b38-72d87748e306\",\n              \"name\": \"category\",\n              \"type\": \"string\",\n              \"value\": \"\\\"action\\\", \\\"junk\\\", \\\"receipt\\\", \\\"SaaS\\\", \\\"community\\\", \\\"business\\\" or \\\"other\\\"\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 3.4\n    },\n    {\n      \"id\": \"e6b3b41e-d7d3-4c9b-8189-a005c748ff18\",\n      \"name\": \"Sticky Note11\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        360,\n        348\n      ],\n      \"parameters\": {\n        \"color\": 6,\n        \"width\": 418.7820408163265,\n        \"height\": 301.40952380952365,\n        \"content\": \"## Sanitise Email \\nRemoves HTML and useless information in preparation for the AI Agent\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"f9787a75-526c-4ef1-b0a7-0db7d890ab3f\",\n      \"name\": \"Sticky Note12\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        820,\n        348\n      ],\n      \"parameters\": {\n        \"color\": 6,\n        \"width\": 256.16108843537415,\n        \"height\": 298.37931972789124,\n        \"content\": \"## Modify Categories \\nEdit this to customise category selection\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"50223a01-34cf-4191-9dd7-3dac02a9e945\",\n      \"name\": \"Sticky Note13\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        1480,\n        328\n      ],\n      \"parameters\": {\n        \"color\": 5,\n        \"width\": 441.003537414966,\n        \"height\": 463.0204081632651,\n        \"content\": \"## Convert to JSON\\n* Ensures the Agent output to converted to JSON\\n* Catches any errors and continues processing\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"4580c532-96a6-46b4-8922-d79316d1cc01\",\n      \"name\": \"Sticky Note14\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        2120,\n        328\n      ],\n      \"parameters\": {\n        \"color\": 5,\n        \"width\": 311.71482993197264,\n        \"height\": 454.93986394557805,\n        \"content\": \"## Switch Categories\\nEnsure your categories match the **varID & Category** Edit Fields node\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"b51a7c34-2a5e-4670-81a4-d1582711c69a\",\n      \"name\": \"Sticky Note15\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        2629,\n        -76\n      ],\n      \"parameters\": {\n        \"color\": 4,\n        \"width\": 251.3480889735252,\n        \"height\": 1289.0156245602684,\n        \"content\": \"## Set Categories\\n\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"3a7ede7b-539b-49d2-8803-153ca6c9eb69\",\n      \"name\": \"Sticky Note16\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        2949,\n        -76\n      ],\n      \"parameters\": {\n        \"color\": 4,\n        \"width\": 251.3480889735252,\n        \"height\": 770.995811762121,\n        \"content\": \"## Move to Folders\\n\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"ee9a9d78-8c07-470a-9d1b-ceddfc8875ca\",\n      \"name\": \"Sticky Note17\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        3260,\n        553\n      ],\n      \"parameters\": {\n        \"color\": 4,\n        \"height\": 293.65527013262994,\n        \"content\": \"## Check if email has been read\\n\\n\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"c75b9d38-79a7-4be2-a90b-a99da1bbd745\",\n      \"name\": \"Microsoft Outlook Move Message1\",\n      \"type\": \"n8n-nodes-base.microsoftOutlook\",\n      \"position\": [\n        3609,\n        604\n      ],\n      \"parameters\": {\n        \"folderId\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"AQMkAGE3ZTU5MGMzLTFkNGItNGQ5Zi04MDQ1LThmNGFlMTVhYjMwYgAuAAAD8UhruVwm402lgPBG2Tj-aQEAnz-IOcWBGE2lrVuQgAF6zAADLJmrCwAAAA==\",\n          \"cachedResultUrl\": \"https://outlook.office365.com/mail/AQMkAGE3ZTU5MGMzLTFkNGItNGQ5Zi04MDQ1LThmNGFlMTVhYjMwYgAuAAAD8UhruVwm402lgPBG2Tj%2FaQEAnz%2FIOcWBGE2lrVuQgAF6zAADLJmrCwAAAA%3D%3D\",\n          \"cachedResultName\": \"Actioned\"\n        },\n        \"messageId\": {\n          \"__rl\": true,\n          \"mode\": \"id\",\n          \"value\": \"={{ $('varID & Category1').item.json.id }}\"\n        },\n        \"operation\": \"move\"\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"85ff0348-16dc-46e6-bf70-48a10fe0ded8\",\n      \"name\": \"AI Agent1\",\n      \"type\": \"@n8n/n8n-nodes-langchain.agent\",\n      \"position\": [\n        1160,\n        468\n      ],\n      \"parameters\": {\n        \"text\": \"=Categorise the following email\\n<email>\\n{{ $('varEmal1').first().json.toJsonString() }}\\n</email>\\n\\nEnsure your final output is valid JSON with no additional text or token in the following format:\\n\\n{\\n  \\\"subject\\\": \\\"SUBJECT_LINE\\\",1\\n  \\\"category\\\": \\\"CATEGORY\\\",\\n  \\\"subCategory\\\": \\\"SUBCATEGORY\\\", //use sparingly\\n  \\\"analysis\\\": \\\"ANALYSIS_REASONING\\\"\\n}\\n\\nRemember you can only use ONE of the following categories {{ $json.category }}. No other categories can be used. Use the subcategory for additional context, for example, if a SaaS email requires action, or if a business email requires action. Do not create any additional subcategories, you can only use ONE of the following {{ $json.category }}.\",\n        \"options\": {\n          \"systemMessage\": \"=You're an AI assistant for a freelance developer, categorizing emails as {{ $json.category }}. Email info is in <email> tags.\\n\\nCategorization priority:\\n\\nAction: Needs response or action (includes some SaaS emails), avoid sales email but include enquires.\\nJunk: Ads, sales, newsletters, promotions, daily digests, (emojis often indicate junk), phishing, scams, discounts etc.\\nReceipt: Any purchase confirmation.\\nSaaS: Account/security updates, unless action required, generic SaaS information, usually from a non-personal email address.\\nCommunity: Updates, events, forums, everything related to \\\"community\\\".\\nBusiness: Any communication related to freelance work, usually from a humans email address\\nOther: Doesn't fit into any other category.\\n\\nKey points:\\n\\nSaaS emails needing action are \\\"SaaS\\\" and subcategory \\\"action\\\".\\nAnalyze the subject, body, email addresses and other data.\\nLook for specific keywords and phrases for each category.\\nEmail can have 2 categories, primary and sub, for example, \\\"action\\\" and \\\"SaaS\\\" or \\\"action\\\" and \\\"business\\\".\\nEmails from business development executives are often junk.\\n\\n\\nOutput in valid JSON format:\\n{\\n\\\"subject\\\": \\\"SUBJECT_LINE\\\",\\n\\\"category\\\": \\\"PRIMARY CATEGORY\\\",\\n\\\"subCategory\\\": \\\"SUBCATEGORY\\\", //use sparingly\\n\\\"analysis\\\": \\\"Brief 1-2 sentence explanation of category choice\\\"\\n}\\nNo additional text or tokens outside the JSON.\\n\\nYou may only use the following categories and subcategories, do not create any more categories or subcategories: {{ $json.category }}\"\n        },\n        \"promptType\": \"define\",\n        \"hasOutputParser\": true\n      },\n      \"typeVersion\": 1.6\n    },\n    {\n      \"id\": \"93e7be79-9035-4b58-9a83-b9182a0515f8\",\n      \"name\": \"Merge1\",\n      \"type\": \"n8n-nodes-base.merge\",\n      \"position\": [\n        3989,\n        564\n      ],\n      \"parameters\": {\n        \"numberInputs\": 7\n      },\n      \"typeVersion\": 3\n    },\n    {\n      \"id\": \"cbaeaed1-cb09-4614-93f1-3fe349cd0e4e\",\n      \"name\": \"Switch1\",\n      \"type\": \"n8n-nodes-base.switch\",\n      \"position\": [\n        2220,\n        488\n      ],\n      \"parameters\": {\n        \"rules\": {\n          \"values\": [\n            {\n              \"outputKey\": \"junk\",\n              \"conditions\": {\n                \"options\": {\n                  \"version\": 2,\n                  \"leftValue\": \"\",\n                  \"caseSensitive\": false,\n                  \"typeValidation\": \"strict\"\n                },\n                \"combinator\": \"and\",\n                \"conditions\": [\n                  {\n                    \"operator\": {\n                      \"type\": \"string\",\n                      \"operation\": \"equals\"\n                    },\n                    \"leftValue\": \"={{ $json.output.category }}\",\n                    \"rightValue\": \"junk\"\n                  }\n                ]\n              },\n              \"renameOutput\": true\n            },\n            {\n              \"outputKey\": \"receipt\",\n              \"conditions\": {\n                \"options\": {\n                  \"version\": 2,\n                  \"leftValue\": \"\",\n                  \"caseSensitive\": false,\n                  \"typeValidation\": \"strict\"\n                },\n                \"combinator\": \"and\",\n                \"conditions\": [\n                  {\n                    \"id\": \"0c61c7a8-e8b4-49c5-a96c-402d5eae7089\",\n                    \"operator\": {\n                      \"name\": \"filter.operator.equals\",\n                      \"type\": \"string\",\n                      \"operation\": \"equals\"\n                    },\n                    \"leftValue\": \"={{ $json.output.category }}\",\n                    \"rightValue\": \"receipt\"\n                  }\n                ]\n              },\n              \"renameOutput\": true\n            },\n            {\n              \"outputKey\": \"SaaS\",\n              \"conditions\": {\n                \"options\": {\n                  \"version\": 2,\n                  \"leftValue\": \"\",\n                  \"caseSensitive\": false,\n                  \"typeValidation\": \"strict\"\n                },\n                \"combinator\": \"and\",\n                \"conditions\": [\n                  {\n                    \"id\": \"703f65c8-cf4a-47fe-ad1a-a5f6e0412ae7\",\n                    \"operator\": {\n                      \"name\": \"filter.operator.equals\",\n                      \"type\": \"string\",\n                      \"operation\": \"equals\"\n                    },\n                    \"leftValue\": \"={{ $json.output.category }}\",\n                    \"rightValue\": \"SaaS\"\n                  }\n                ]\n              },\n              \"renameOutput\": true\n            },\n            {\n              \"outputKey\": \"community\",\n              \"conditions\": {\n                \"options\": {\n                  \"version\": 2,\n                  \"leftValue\": \"\",\n                  \"caseSensitive\": false,\n                  \"typeValidation\": \"strict\"\n                },\n                \"combinator\": \"and\",\n                \"conditions\": [\n                  {\n                    \"id\": \"b074d5cd-9215-40df-8877-5df904edc000\",\n                    \"operator\": {\n                      \"name\": \"filter.operator.equals\",\n                      \"type\": \"string\",\n                      \"operation\": \"equals\"\n                    },\n                    \"leftValue\": \"={{ $json.output.category }}\",\n                    \"rightValue\": \"community\"\n                  }\n                ]\n              },\n              \"renameOutput\": true\n            },\n            {\n              \"outputKey\": \"action\",\n              \"conditions\": {\n                \"options\": {\n                  \"version\": 2,\n                  \"leftValue\": \"\",\n                  \"caseSensitive\": false,\n                  \"typeValidation\": \"strict\"\n                },\n                \"combinator\": \"and\",\n                \"conditions\": [\n                  {\n                    \"id\": \"bece338a-e0c5-43b5-b8cc-41229a374213\",\n                    \"operator\": {\n                      \"name\": \"filter.operator.equals\",\n                      \"type\": \"string\",\n                      \"operation\": \"equals\"\n                    },\n                    \"leftValue\": \"={{ $json.output.category }}\",\n                    \"rightValue\": \"action\"\n                  }\n                ]\n              },\n              \"renameOutput\": true\n            },\n            {\n              \"outputKey\": \"business\",\n              \"conditions\": {\n                \"options\": {\n                  \"version\": 2,\n                  \"leftValue\": \"\",\n                  \"caseSensitive\": false,\n                  \"typeValidation\": \"strict\"\n                },\n                \"combinator\": \"and\",\n                \"conditions\": [\n                  {\n                    \"id\": \"d6c9751f-0ffa-4041-a579-6957bb9c9296\",\n                    \"operator\": {\n                      \"name\": \"filter.operator.equals\",\n                      \"type\": \"string\",\n                      \"operation\": \"equals\"\n                    },\n                    \"leftValue\": \"={{ $json.output.category }}\",\n                    \"rightValue\": \"business\"\n                  }\n                ]\n              },\n              \"renameOutput\": true\n            }\n          ]\n        },\n        \"options\": {\n          \"ignoreCase\": true,\n          \"fallbackOutput\": \"extra\"\n        }\n      },\n      \"typeVersion\": 3.2\n    }\n  ],\n  \"pinData\": {},\n  \"connections\": {\n    \"If1\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Microsoft Outlook Move Message1\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Merge1\",\n            \"type\": \"main\",\n            \"index\": 5\n          }\n        ]\n      ]\n    },\n    \"Merge1\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Loop Over Items1\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Filter1\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Loop Over Items1\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Switch1\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Microsoft Outlook12\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Microsoft Outlook13\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Microsoft Outlook18\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Microsoft Outlook16\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Microsoft Outlook20\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Microsoft Outlook22\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Microsoft Outlook21\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"varEmal1\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"varID & Category1\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"varJSON1\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Switch1\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Catch Errors1\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"AI Agent1\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"varJSON1\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Markdown1\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"varEmal1\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Catch Errors1\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Loop Over Items1\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Loop Over Items1\": {\n      \"main\": [\n        null,\n        [\n          {\n            \"node\": \"Markdown1\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"varID & Category1\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"AI Agent1\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Ollama Chat Model1\": {\n      \"ai_languageModel\": [\n        [\n          {\n            \"node\": \"AI Agent1\",\n            \"type\": \"ai_languageModel\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Microsoft Outlook10\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Merge1\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Microsoft Outlook12\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Microsoft Outlook10\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Microsoft Outlook13\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Microsoft Outlook15\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Microsoft Outlook15\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Merge1\",\n            \"type\": \"main\",\n            \"index\": 1\n          }\n        ]\n      ]\n    },\n    \"Microsoft Outlook16\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Microsoft Outlook17\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Microsoft Outlook17\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Merge1\",\n            \"type\": \"main\",\n            \"index\": 3\n          }\n        ]\n      ]\n    },\n    \"Microsoft Outlook18\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Microsoft Outlook19\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Microsoft Outlook19\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Merge1\",\n            \"type\": \"main\",\n            \"index\": 2\n          }\n        ]\n      ]\n    },\n    \"Microsoft Outlook20\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"If1\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Microsoft Outlook21\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Merge1\",\n            \"type\": \"main\",\n            \"index\": 6\n          }\n        ]\n      ]\n    },\n    \"Microsoft Outlook22\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"If1\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Microsoft Outlook23\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Filter1\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Microsoft Outlook Move Message1\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Merge1\",\n            \"type\": \"main\",\n            \"index\": 4\n          }\n        ]\n      ]\n    },\n    \"When clicking â€˜Test workflowâ€™\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Microsoft Outlook23\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}",
  "metadata": {
    "node_types": [
      "n8n-nodes-base.manualTrigger",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "@n8n/n8n-nodes-langchain.lmChatOllama",
      "n8n-nodes-base.microsoftOutlook",
      "n8n-nodes-base.microsoftOutlook",
      "n8n-nodes-base.splitInBatches",
      "n8n-nodes-base.microsoftOutlook",
      "n8n-nodes-base.microsoftOutlook",
      "n8n-nodes-base.microsoftOutlook",
      "n8n-nodes-base.microsoftOutlook",
      "n8n-nodes-base.microsoftOutlook",
      "n8n-nodes-base.microsoftOutlook",
      "n8n-nodes-base.markdown",
      "n8n-nodes-base.set",
      "n8n-nodes-base.microsoftOutlook",
      "n8n-nodes-base.microsoftOutlook",
      "n8n-nodes-base.filter",
      "n8n-nodes-base.if",
      "n8n-nodes-base.microsoftOutlook",
      "n8n-nodes-base.set",
      "n8n-nodes-base.set",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.microsoftOutlook",
      "n8n-nodes-base.set",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.microsoftOutlook",
      "@n8n/n8n-nodes-langchain.agent",
      "n8n-nodes-base.merge",
      "n8n-nodes-base.switch"
    ],
    "trigger": null
  }
}