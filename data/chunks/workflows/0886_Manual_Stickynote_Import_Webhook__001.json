{
  "source": "0886_Manual_Stickynote_Import_Webhook.json",
  "index": 1,
  "content": "{\n  \"meta\": {\n    \"instanceId\": \"97d44c78f314fab340d7a5edaf7e2c274a7fbb8a7cd138f53cc742341e706fe7\",\n    \"templateCredsSetupCompleted\": true\n  },\n  \"nodes\": [\n    {\n      \"id\": \"1ec0e1ad-0666-417b-b5af-b381b06e126f\",\n      \"name\": \"When clicking ‘Test workflow’\",\n      \"type\": \"n8n-nodes-base.manualTrigger\",\n      \"position\": [\n        -120,\n        180\n      ],\n      \"parameters\": {},\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"c34a92d3-b4bd-4c2f-9fa0-66832729a31c\",\n      \"name\": \"Upload photo\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        980,\n        180\n      ],\n      \"parameters\": {\n        \"url\": \"=https://graph.microsoft.com/v1.0/sites/root/drive/root:{{ $json.TARGET_FOLDER }}/{{ $json.FILE_NAME }}:/content\",\n        \"method\": \"PUT\",\n        \"options\": {},\n        \"sendBody\": true,\n        \"contentType\": \"binaryData\",\n        \"sendHeaders\": true,\n        \"headerParameters\": {\n          \"parameters\": [\n            {\n              \"name\": \"Authorization\",\n              \"value\": \"=Bearer {{ $json.access_token }}\"\n            },\n            {\n              \"name\": \"Content-Type\",\n              \"value\": \"application/octet-stream\"\n            }\n          ]\n        },\n        \"inputDataFieldName\": \"data\"\n      },\n      \"typeVersion\": 4.2\n    },\n    {\n      \"id\": \"49ce594c-83c7-4b47-be03-6811ebdcc57b\",\n      \"name\": \"Set config (sensitive data)\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        100,\n        180\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"399d42f3-41e0-4043-9a57-85771bf5cd07\",\n              \"name\": \"TENANT_ID\",\n              \"type\": \"string\",\n              \"value\": \"00000000-0000-0000-0000-000000000000\"\n            },\n            {\n              \"id\": \"dd63a519-3681-46c4-b122-ab379ed11c42\",\n              \"name\": \"CLIENT_ID\",\n              \"type\": \"string\",\n              \"value\": \"00000000-0000-0000-0000-000000000000\"\n            },\n            {\n              \"id\": \"4d50c934-c306-4198-853a-68198b8b84eb\",\n              \"name\": \"CLIENT_SECRET\",\n              \"type\": \"string\",\n              \"value\": \"uU~8Q~THEQLIE2TX7UsecretT2g_JCADyxBxN0bx3\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 3.4\n    },\n    {\n      \"id\": \"53b78aa9-d86f-461b-bff5-bd2a63a693b5\",\n      \"name\": \"Get photo (for testing purposes)\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        540,\n        180\n      ],\n      \"parameters\": {\n        \"url\": \"https://fastly.picsum.photos/id/459/200/300.jpg?hmac=4Cn5sZqOdpuzOwSTs65XA75xvN-quC4t9rfYYyoTCEI\",\n        \"options\": {}\n      },\n      \"typeVersion\": 4.2\n    },\n    {\n      \"id\": \"a551951c-f192-4b15-accb-ca936baef9a8\",\n      \"name\": \"Set destination\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        760,\n        180\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"9f66b3f9-c161-45f4-bdc0-8cf736b53eda\",\n              \"name\": \"TARGET_FOLDER\",\n              \"type\": \"string\",\n              \"value\": \"/uploads/pictures from n8n\"\n            },\n            {\n              \"id\": \"e8584729-2746-48a0-ad80-d0308a49e195\",\n              \"name\": \"FILE_NAME\",\n              \"type\": \"string\",\n              \"value\": \"example.jpg\"\n            }\n          ]\n        },\n        \"includeOtherFields\": true\n      },\n      \"typeVersion\": 3.4\n    },\n    {\n      \"id\": \"66129973-bf5f-4799-b676-2ee40fd2b519\",\n      \"name\": \"Sticky Note\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -240,\n        -220\n      ],\n      \"parameters\": {\n        \"width\": 320,\n        \"height\": 200,\n        \"content\": \"## Prerequisites\\n1. [Create an application user](https://learn.microsoft.com/en-us/power-platform/admin/manage-application-users)\\n2. Ensure the following permissions are set:\\n- Sites.ReadWrite.All - for SharePoint site access\\n- Files.ReadWrite.All - for file upload operations\\n\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"43bbf2cd-3ac5-4c46-b3c0-bd6158dbe25e\",\n      \"name\": \"Sticky Note1\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        160,\n        -280\n      ],\n      \"parameters\": {\n        \"width\": 320,\n        \"height\": 340,\n        \"content\": \"## Authentication\\nFor a succesful authentication it is required to provide:\\n\\n- TENANT_ID\\n- CLIENT_ID\\n- CLIENT_SECRET\\n---\\n## Attention!\\nFor demonstration purposes and template restrictions we store these values in a 'Set' node but in production environment please ensure safety of such data via utilizing credentials, secure vault or any other safe way of storing such information.\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"daa3e6b9-a9ea-4bb4-8e2d-faa516c699ea\",\n      \"name\": \"Sticky Note2\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        620,\n        -280\n      ],\n      \"parameters\": {\n        \"width\": 440,\n        \"height\": 340,\n        \"content\": \"## Set destination\\nIn this step we will set the destination.\\nThe destination is made of two parameters:\\n\\n- TARGET_FOLDER\\n- FILE_NAME\\n---\\n### Example\\nLet's say this is our desired file location:\\n`https://contoso.sharepoint.com/uploads/pictures from n8n/example.jpg`\\n\\nThus we will set the following:\\n- TARGET_FOLDER = `/uploads/pictures from n8n`\\n- FILE_NAME = `example.jpg`\\n\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"52bd314b-6a5e-499a-904e-a7e9becbbd59\",\n      \"name\": \"Authentication\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"notes\": \"Get an access token for graph API\",\n      \"position\": [\n        320,\n        180\n      ],\n      \"parameters\": {\n        \"url\": \"=https://login.microsoftonline.com/{{ $json.TENANT_ID }}/oauth2/token\",\n        \"method\": \"POST\",\n        \"options\": {},\n        \"sendBody\": true,\n        \"contentType\": \"form-urlencoded\",\n        \"bodyParameters\": {\n          \"parameters\": [\n            {\n              \"name\": \"grant_type\",\n              \"value\": \"client_credentials\"\n            },\n            {\n              \"name\": \"client_id\",\n              \"value\": \"={{ $json.CLIENT_ID }}\"\n            },\n            {\n              \"name\": \"client_secret\",\n              \"value\": \"={{ $json.CLIENT_SECRET }}\"\n            },\n            {\n              \"name\": \"resource\",\n              \"value\": \"https://graph.microsoft.com\"\n            }\n          ]\n        }\n      },\n      \"notesInFlow\": true,\n      \"typeVersion\": 4.2\n    }\n  ],\n  \"pinData\": {},\n  \"connections\": {\n    \"Authentication\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Get photo (for testing purposes)\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Set destination\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Upload photo\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Set config (sensitive data)\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Authentication\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Get photo (for testing purposes)\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Set destination\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"When clicking ‘Test workflow’\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Set config (sensitive data)\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}",
  "metadata": {
    "node_types": [
      "n8n-nodes-base.manualTrigger",
      "n8n-nodes-base.httpRequest",
      "n8n-nodes-base.set",
      "n8n-nodes-base.httpRequest",
      "n8n-nodes-base.set",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.httpRequest"
    ],
    "trigger": null
  }
}