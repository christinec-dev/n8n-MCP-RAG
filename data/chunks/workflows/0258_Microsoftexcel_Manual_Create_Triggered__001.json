{
  "source": "0258_Microsoftexcel_Manual_Create_Triggered.json",
  "index": 1,
  "content": "{\n  \"nodes\": [\n    {\n      \"id\": \"e67d505c-20a3-4318-ba6b-d73db55e88e4\",\n      \"name\": \"On clicking 'execute'\",\n      \"type\": \"n8n-nodes-base.manualTrigger\",\n      \"position\": [\n        240,\n        240\n      ],\n      \"parameters\": {},\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"172d7c44-c488-4523-a0ad-1c903374c3e8\",\n      \"name\": \"Search Salesforce accounts\",\n      \"type\": \"n8n-nodes-base.salesforce\",\n      \"position\": [\n        680,\n        240\n      ],\n      \"parameters\": {\n        \"query\": \"=SELECT id, Name FROM Account WHERE Name = '{{$json[\\\"Company Name\\\"].replace(/'/g, '\\\\\\\\\\\\'')}}'\",\n        \"resource\": \"search\"\n      },\n      \"credentials\": {\n        \"salesforceOAuth2Api\": {\n          \"id\": \"40\",\n          \"name\": \"Salesforce account\"\n        }\n      },\n      \"typeVersion\": 1,\n      \"alwaysOutputData\": false\n    },\n    {\n      \"id\": \"ae559728-f82e-44d6-8cfe-512151ee6867\",\n      \"name\": \"Keep new companies\",\n      \"type\": \"n8n-nodes-base.merge\",\n      \"position\": [\n        900,\n        40\n      ],\n      \"parameters\": {\n        \"mode\": \"removeKeyMatches\",\n        \"propertyName1\": \"Company Name\",\n        \"propertyName2\": \"Name\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"e01310a4-2b47-4deb-8058-ab878cf83fc1\",\n      \"name\": \"Merge existing account data\",\n      \"type\": \"n8n-nodes-base.merge\",\n      \"position\": [\n        900,\n        440\n      ],\n      \"parameters\": {\n        \"mode\": \"mergeByKey\",\n        \"propertyName1\": \"Company Name\",\n        \"propertyName2\": \"Name\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"1bc3a47f-ad77-4e2f-a777-6259017d8551\",\n      \"name\": \"Account found?\",\n      \"type\": \"n8n-nodes-base.if\",\n      \"position\": [\n        1120,\n        440\n      ],\n      \"parameters\": {\n        \"conditions\": {\n          \"string\": [\n            {\n              \"value1\": \"={{ $json[\\\"Id\\\"] }}\",\n              \"operation\": \"isNotEmpty\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"a488fcfc-f67c-43db-8924-b8b341417aec\",\n      \"name\": \"Remove duplicate companies\",\n      \"type\": \"n8n-nodes-base.itemLists\",\n      \"position\": [\n        1120,\n        140\n      ],\n      \"parameters\": {\n        \"compare\": \"selectedFields\",\n        \"options\": {},\n        \"operation\": \"removeDuplicates\",\n        \"fieldsToCompare\": {\n          \"fields\": [\n            {\n              \"fieldName\": \"Company Name\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"c175dfee-2294-4fa1-a33a-801b66857541\",\n      \"name\": \"Set Account ID for existing accounts\",\n      \"type\": \"n8n-nodes-base.renameKeys\",\n      \"position\": [\n        1340,\n        440\n      ],\n      \"parameters\": {\n        \"keys\": {\n          \"key\": [\n            {\n              \"newKey\": \"Account ID\",\n              \"currentKey\": \"Id\"\n            }\n          ]\n        },\n        \"additionalOptions\": {}\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"9a393665-afba-4bc1-b590-19fab4b675c7\",\n      \"name\": \"Retrieve new company contacts\",\n      \"type\": \"n8n-nodes-base.merge\",\n      \"position\": [\n        1780,\n        40\n      ],\n      \"parameters\": {\n        \"mode\": \"mergeByKey\",\n        \"propertyName1\": \"Company Name\",\n        \"propertyName2\": \"Name\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"5be06058-5aa6-4160-b5e6-39677514dfcc\",\n      \"name\": \"Set new account name\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        1560,\n        140\n      ],\n      \"parameters\": {\n        \"values\": {\n          \"string\": [\n            {\n              \"name\": \"id\",\n              \"value\": \"={{ $json[\\\"id\\\"] }}\"\n            },\n            {\n              \"name\": \"Name\",\n              \"value\": \"={{ $node[\\\"Remove duplicate companies\\\"].json[\\\"Company Name\\\"] }}\"\n            }\n          ]\n        },\n        \"options\": {},\n        \"keepOnlySet\": true\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"5f535598-e50f-4ff6-a2db-687a7df3befe\",\n      \"name\": \"Create Salesforce account\",\n      \"type\": \"n8n-nodes-base.salesforce\",\n      \"position\": [\n        1340,\n        140\n      ],\n      \"parameters\": {\n        \"name\": \"={{ $json[\\\"Company Name\\\"] }}\",\n        \"resource\": \"account\",\n        \"additionalFields\": {}\n      },\n      \"credentials\": {\n        \"salesforceOAuth2Api\": {\n          \"id\": \"40\",\n          \"name\": \"Salesforce account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"75c80602-7bfd-4662-b6bd-14384a03bc24\",\n      \"name\": \"Create Salesforce contact\",\n      \"type\": \"n8n-nodes-base.salesforce\",\n      \"position\": [\n        2000,\n        240\n      ],\n      \"parameters\": {\n        \"lastname\": \"={{ $json[\\\"Last Name\\\"] }}\",\n        \"resource\": \"contact\",\n        \"operation\": \"upsert\",\n        \"externalId\": \"Email\",\n        \"externalIdValue\": \"={{ $json[\\\"Email\\\"] }}\",\n        \"additionalFields\": {\n          \"email\": \"={{ $json[\\\"Email\\\"] }}\",\n          \"firstName\": \"={{ $json[\\\"First Name\\\"] }}\",\n          \"acconuntId\": \"={{ $json[\\\"Account ID\\\"] }}\"\n        }\n      },\n      \"credentials\": {\n        \"salesforceOAuth2Api\": {\n          \"id\": \"40\",\n          \"name\": \"Salesforce account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"f73ed50e-8fa6-4baf-90d2-4167d1823d27\",\n      \"name\": \"Microsoft Excel\",\n      \"type\": \"n8n-nodes-base.microsoftExcel\",\n      \"position\": [\n        460,\n        240\n      ],\n      \"parameters\": {\n        \"range\": \"A1:E11\",\n        \"resource\": \"worksheet\",\n        \"workbook\": \"CA5C20CA5A0862D9!1122\",\n        \"operation\": \"getContent\",\n        \"worksheet\": \"{00000000-0001-0000-0000-000000000000}\"\n      },\n      \"credentials\": {\n        \"microsoftExcelOAuth2Api\": {\n          \"id\": \"44\",\n          \"name\": \"Microsoft Excel account\"\n        }\n      },\n      \"typeVersion\": 1\n    }\n  ],\n  \"connections\": {\n    \"Account found?\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Set Account ID for existing accounts\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Microsoft Excel\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Keep new companies\",\n            \"type\": \"main\",\n            \"index\": 0\n          },\n          {\n            \"node\": \"Search Salesforce accounts\",\n            \"type\": \"main\",\n            \"index\": 0\n          },\n          {\n            \"node\": \"Merge existing account data\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Keep new companies\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Remove duplicate companies\",\n            \"type\": \"main\",\n            \"index\": 0\n          },\n          {\n            \"node\": \"Retrieve new company contacts\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Set new account name\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Retrieve new company contacts\",\n            \"type\": \"main\",\n            \"index\": 1\n          }\n        ]\n      ]\n    },\n    \"On clicking 'execute'\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Microsoft Excel\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Create Salesforce account\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Set new account name\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Remove duplicate companies\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Create Salesforce account\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Search Salesforce accounts\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Keep new companies\",\n            \"type\": \"main\",\n            \"index\": 1\n          },\n          {\n            \"node\": \"Merge existing account data\",\n            \"type\": \"main\",\n            \"index\": 1\n          }\n        ]\n      ]\n    },\n    \"Merge existing account data\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Account found?\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Retrieve new company contacts\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Create Salesforce contact\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Set Account ID for existing accounts\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Create Salesforce contact\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}",
  "metadata": {
    "node_types": [
      "n8n-nodes-base.manualTrigger",
      "n8n-nodes-base.salesforce",
      "n8n-nodes-base.merge",
      "n8n-nodes-base.merge",
      "n8n-nodes-base.if",
      "n8n-nodes-base.itemLists",
      "n8n-nodes-base.renameKeys",
      "n8n-nodes-base.merge",
      "n8n-nodes-base.set",
      "n8n-nodes-base.salesforce",
      "n8n-nodes-base.salesforce",
      "n8n-nodes-base.microsoftExcel"
    ],
    "trigger": null
  }
}