{
  "source": "0850_Mattermost_Pagerduty_Automate_Webhook.json",
  "index": 1,
  "content": "{\n  \"nodes\": [\n    {\n      \"name\": \"Ack\",\n      \"type\": \"n8n-nodes-base.webhook\",\n      \"position\": [\n        -160,\n        1440\n      ],\n      \"webhookId\": \"d3025d6c-5956-439e-9c9a-db3ef524a24f\",\n      \"parameters\": {\n        \"path\": \"/ack\",\n        \"options\": {},\n        \"httpMethod\": \"POST\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Resolve\",\n      \"type\": \"n8n-nodes-base.webhook\",\n      \"position\": [\n        120,\n        1880\n      ],\n      \"webhookId\": \"92d7ddfa-20f9-49bc-976e-4f6c76c0b3b4\",\n      \"parameters\": {\n        \"path\": \"/resolve\",\n        \"options\": {},\n        \"httpMethod\": \"POST\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Webhook\",\n      \"type\": \"n8n-nodes-base.webhook\",\n      \"position\": [\n        60,\n        1040\n      ],\n      \"webhookId\": \"9888d896-dd23-4e97-9d16-c12055b64133\",\n      \"parameters\": {\n        \"path\": \"9888d896-dd23-4e97-9d16-c12055b64133\",\n        \"options\": {},\n        \"httpMethod\": \"POST\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Jira1\",\n      \"type\": \"n8n-nodes-base.jira\",\n      \"position\": [\n        680,\n        1040\n      ],\n      \"parameters\": {\n        \"project\": \"10016\",\n        \"summary\": \"={{$node[\\\"Webhook\\\"].json[\\\"body\\\"][\\\"event\\\"][\\\"data\\\"][\\\"title\\\"]}}\",\n        \"issueType\": \"10007\",\n        \"additionalFields\": {\n          \"assignee\": \"qwertz12345\"\n        }\n      },\n      \"credentials\": {\n        \"jiraSoftwareCloudApi\": {\n          \"id\": \"64\",\n          \"name\": \"Jira SW Cloud account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Jira2\",\n      \"type\": \"n8n-nodes-base.jira\",\n      \"position\": [\n        540,\n        1880\n      ],\n      \"parameters\": {\n        \"issueKey\": \"={{$node[\\\"Resolve\\\"].json[\\\"body\\\"][\\\"context\\\"][\\\"jira_key\\\"]}}\",\n        \"operation\": \"update\",\n        \"updateFields\": {\n          \"statusId\": \"31\"\n        }\n      },\n      \"credentials\": {\n        \"jiraSoftwareCloudApi\": {\n          \"id\": \"64\",\n          \"name\": \"Jira SW Cloud account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"PagerDuty1\",\n      \"type\": \"n8n-nodes-base.pagerDuty\",\n      \"position\": [\n        60,\n        1440\n      ],\n      \"parameters\": {\n        \"email\": \"address@mail.com\",\n        \"resource\": \"incident\",\n        \"operation\": \"update\",\n        \"incidentId\": \"={{$json[\\\"body\\\"][\\\"context\\\"][\\\"pagerduty_incident\\\"]}}\",\n        \"updateFields\": {\n          \"status\": \"acknowledged\"\n        },\n        \"authentication\": \"apiToken\",\n        \"conferenceBridgeUi\": {}\n      },\n      \"credentials\": {\n        \"pagerDutyApi\": {\n          \"id\": \"65\",\n          \"name\": \"PagerDuty account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"PagerDuty2\",\n      \"type\": \"n8n-nodes-base.pagerDuty\",\n      \"position\": [\n        340,\n        1880\n      ],\n      \"parameters\": {\n        \"email\": \"address@mail.com\",\n        \"resource\": \"incident\",\n        \"operation\": \"update\",\n        \"incidentId\": \"={{$json[\\\"body\\\"][\\\"context\\\"][\\\"pagerduty_incident\\\"]}}\",\n        \"updateFields\": {\n          \"status\": \"resolved\"\n        },\n        \"authentication\": \"apiToken\",\n        \"conferenceBridgeUi\": {}\n      },\n      \"credentials\": {\n        \"pagerDutyApi\": {\n          \"id\": \"65\",\n          \"name\": \"PagerDuty account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Mattermost5\",\n      \"type\": \"n8n-nodes-base.mattermost\",\n      \"position\": [\n        300,\n        1440\n      ],\n      \"parameters\": {\n        \"message\": \"💪🏼 Incident status has been changed to Acknowledged on PagerDuty.\",\n        \"channelId\": \"={{$node[\\\"Ack\\\"].json[\\\"body\\\"][\\\"channel_id\\\"]}}\",\n        \"attachments\": [],\n        \"otherOptions\": {}\n      },\n      \"credentials\": {\n        \"mattermostApi\": {\n          \"id\": \"61\",\n          \"name\": \"Mattermost account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Mattermost6\",\n      \"type\": \"n8n-nodes-base.mattermost\",\n      \"position\": [\n        760,\n        1760\n      ],\n      \"parameters\": {\n        \"message\": \"💪 This issue got closed in PagerDuty and Jira.\",\n        \"channelId\": \"={{$node[\\\"Resolve\\\"].json[\\\"body\\\"][\\\"channel_id\\\"]}}\",\n        \"attachments\": [],\n        \"otherOptions\": {}\n      },\n      \"credentials\": {\n        \"mattermostApi\": {\n          \"id\": \"61\",\n          \"name\": \"Mattermost account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Mattermost4\",\n      \"type\": \"n8n-nodes-base.mattermost\",\n      \"position\": [\n        900,\n        1180\n      ],\n      \"parameters\": {\n        \"message\": \"=⚠️ {{$node[\\\"Webhook\\\"].json[\\\"body\\\"][\\\"messages\\\"][0][\\\"log_entries\\\"][0][\\\"incident\\\"][\\\"summary\\\"]}}\\nPagerDuty incident: {{$node[\\\"Webhook\\\"].json[\\\"body\\\"][\\\"messages\\\"][0][\\\"log_entries\\\"][0][\\\"incident\\\"][\\\"html_url\\\"]}}\\nJira issue: https://n8n.atlassian.net/browse/{{$json[\\\"key\\\"]}}\",\n        \"channelId\": \"={{$node[\\\"Mattermost1\\\"].json[\\\"id\\\"]}}\",\n        \"attachments\": [\n          {\n            \"actions\": {\n              \"item\": [\n                {\n                  \"name\": \"Acknowledge\",\n                  \"type\": \"button\",\n                  \"options\": {},\n                  \"data_source\": \"custom\",\n                  \"integration\": {\n                    \"item\": {\n                      \"url\": \"https://username.app.n8n.cloud/webhook/ack\",\n                      \"context\": {\n                        \"property\": [\n                          {\n                            \"name\": \"pagerduty_incident\",\n                            \"value\": \"={{ $node[\\\"Webhook\\\"].json[\\\"body\\\"][\\\"event\\\"][\\\"data\\\"][\\\"id\\\"] }}\"\n                          }\n                        ]\n                      }\n                    }\n                  }\n                },\n                {\n                  \"name\": \"Resolve\",\n                  \"type\": \"button\",\n                  \"options\": {},\n                  \"data_source\": \"custom\",\n                  \"integration\": {\n                    \"item\": {\n                      \"url\": \"https://username.app.n8n.cloud/webhook/resolve\",\n                      \"context\": {\n                        \"property\": [\n                          {\n                            \"name\": \"jira_key\",\n                            \"value\": \"={{$json[\\\"key\\\"]}}\"\n                          },\n                          {\n                            \"name\": \"pagerduty_incident\",\n                            \"value\": \"={{ $node[\\\"Webhook\\\"].json[\\\"body\\\"][\\\"event\\\"][\\\"data\\\"][\\\"id\\\"] }}\"\n                          }\n                        ]\n                      }\n                    }\n                  }\n                }\n              ]\n            }\n          }\n        ],\n        \"otherOptions\": {}\n      },\n      \"credentials\": {\n        \"mattermostApi\": {\n          \"id\": \"61\",\n          \"name\": \"Mattermost account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Mattermost3\",\n      \"type\": \"n8n-nodes-base.mattermost\",\n      \"position\": [\n        900,\n        940\n      ],\n      \"parameters\": {\n        \"message\": \"=🚨 New incident: \\nAuxiliary Channel -> https://mattermost.internal.n8n.io/test/channels/{{$node[\\\"Mattermost1\\\"].json[\\\"name\\\"]}}\\nPagerDuty Incident -> {{$node[\\\"Webhook\\\"].json[\\\"body\\\"][\\\"event\\\"][\\\"data\\\"][\\\"html_url\\\"]}}\\nJira Issue -> https://n8n.atlassian.net/browse/{{$json[\\\"key\\\"]}}\",\n        \"channelId\": \"qwertz12345\",\n        \"attachments\": [],\n        \"otherOptions\": {}\n      },\n      \"credentials\": {\n        \"mattermostApi\": {\n          \"id\": \"61\",\n          \"name\": \"Mattermost account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Mattermost2\",\n      \"type\": \"n8n-nodes-base.mattermost\",\n      \"position\": [\n        480,\n        1040\n      ],\n      \"parameters\": {\n        \"userId\": \"qwertz12345\",\n        \"resource\": \"channel\",\n        \"channelId\": \"={{$json[\\\"id\\\"]}}\",\n        \"operation\": \"addUser\"\n      },\n      \"credentials\": {\n        \"mattermostApi\": {\n          \"id\": \"61\",\n          \"name\": \"Mattermost account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Mattermost1\",\n      \"type\": \"n8n-nodes-base.mattermost\",\n      \"position\": [\n        280,\n        1040\n      ],\n      \"parameters\": {\n        \"teamId\": \"qwertz12345\",\n        \"channel\": \"={{$json[\\\"body\\\"][\\\"event\\\"][\\\"data\\\"][\\\"incident_key\\\"]}}\",\n        \"resource\": \"channel\",\n        \"displayName\": \"={{$json[\\\"body\\\"][\\\"event\\\"][\\\"data\\\"][\\\"title\\\"]}}\"\n      },\n      \"credentials\": {\n        \"mattermostApi\": {\n          \"id\": \"61\",\n          \"name\": \"Mattermost account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Mattermost7\",\n      \"type\": \"n8n-nodes-base.mattermost\",\n      \"position\": [\n        760,\n        1980\n      ],\n      \"parameters\": {\n        \"message\": \"=🎉 The incident ({{$node[\\\"PagerDuty2\\\"].json[\\\"summary\\\"]}}) was resolved by the lovely folks in the on-call team!\",\n        \"channelId\": \"qwertz12345\",\n        \"attachments\": [],\n        \"otherOptions\": {}\n      },\n      \"credentials\": {\n        \"mattermostApi\": {\n          \"id\": \"61\",\n          \"name\": \"Mattermost account\"\n        }\n      },\n      \"typeVersion\": 1\n    }\n  ],\n  \"connections\": {\n    \"Ack\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"PagerDuty1\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Jira1\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Mattermost3\",\n            \"type\": \"main\",\n            \"index\": 0\n          },\n          {\n            \"node\": \"Mattermost4\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Jira2\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Mattermost6\",\n            \"type\": \"main\",\n            \"index\": 0\n          },\n          {\n            \"node\": \"Mattermost7\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Resolve\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"PagerDuty2\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Webhook\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Mattermost1\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"PagerDuty1\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Mattermost5\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"PagerDuty2\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Jira2\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Mattermost1\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Mattermost2\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Mattermost2\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Jira1\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}",
  "metadata": {
    "node_types": [
      "n8n-nodes-base.webhook",
      "n8n-nodes-base.webhook",
      "n8n-nodes-base.webhook",
      "n8n-nodes-base.jira",
      "n8n-nodes-base.jira",
      "n8n-nodes-base.pagerDuty",
      "n8n-nodes-base.pagerDuty",
      "n8n-nodes-base.mattermost",
      "n8n-nodes-base.mattermost",
      "n8n-nodes-base.mattermost",
      "n8n-nodes-base.mattermost",
      "n8n-nodes-base.mattermost",
      "n8n-nodes-base.mattermost",
      "n8n-nodes-base.mattermost"
    ],
    "trigger": null
  }
}