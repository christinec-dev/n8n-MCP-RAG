{
  "source": "0465_Telegram_Filter_Send_Scheduled.json",
  "index": 1,
  "content": "{\n  \"meta\": {\n    \"instanceId\": \"cb484ba7b742928a2048bf8829668bed5b5ad9787579adea888f05980292a4a7\"\n  },\n  \"nodes\": [\n    {\n      \"id\": \"06fee9d0-e11e-44f1-949f-94abb476e493\",\n      \"name\": \"Telegram\",\n      \"type\": \"n8n-nodes-base.telegram\",\n      \"position\": [\n        2100,\n        1020\n      ],\n      \"parameters\": {\n        \"text\": \"={{  $json.message.join(\\\"\\\\n\\\") }}\",\n        \"additionalFields\": {}\n      },\n      \"typeVersion\": 1.1\n    },\n    {\n      \"id\": \"cd51fa93-700e-4d86-a95b-6e65e7eaf616\",\n      \"name\": \"Schedule Trigger\",\n      \"type\": \"n8n-nodes-base.scheduleTrigger\",\n      \"position\": [\n        1080,\n        1020\n      ],\n      \"parameters\": {\n        \"rule\": {\n          \"interval\": [\n            {\n              \"daysInterval\": 7\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 1.1\n    },\n    {\n      \"id\": \"720ca9d2-456f-49a0-85df-d38d1ebdf8e1\",\n      \"name\": \"Sticky Note3\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        700,\n        560\n      ],\n      \"parameters\": {\n        \"color\": 5,\n        \"width\": 453.88352097764886,\n        \"height\": 160.98843357558172,\n        \"content\": \"### üë®‚Äçüé§ Setup\\nYou will need:\\n1. API token to your n8n instance (settings)\\n2. Paste the API token in new n8n credentials\\n3. Add telegram credentials as well\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"c168ca04-cd47-4d68-b719-7c9bb4e98920\",\n      \"name\": \"Sticky Note2\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        660,\n        400\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 721.389633253837,\n        \"height\": 432.41702029585565,\n        \"content\": \"# Weekly failures report\\n\\nThis workflow will check for past executions of a given workflow and will compile and send you a list of failures which happened in the last 7 days.\\n\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"e06a3f4f-db0c-429b-aeee-c6db84a260c7\",\n      \"name\": \"Filter for executions of the week\",\n      \"type\": \"n8n-nodes-base.filter\",\n      \"position\": [\n        1480,\n        1018\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"conditions\": {\n          \"options\": {\n            \"leftValue\": \"\",\n            \"caseSensitive\": true,\n            \"typeValidation\": \"strict\"\n          },\n          \"combinator\": \"and\",\n          \"conditions\": [\n            {\n              \"id\": \"31745f1d-793a-4674-80ab-77afede449d6\",\n              \"operator\": {\n                \"type\": \"dateTime\",\n                \"operation\": \"after\"\n              },\n              \"leftValue\": \"={{ $json.startedAt }}\",\n              \"rightValue\": \"={{ DateTime.fromMillis(DateTime.now() -  1000 * 60 * 60 * 24 * 7) }}\"\n            },\n            {\n              \"id\": \"0f3e54a2-2bed-4769-8443-c2b0b6e762a9\",\n              \"operator\": {\n                \"type\": \"boolean\",\n                \"operation\": \"false\",\n                \"singleValue\": true\n              },\n              \"leftValue\": \"={{ $json.finished }}\",\n              \"rightValue\": \"\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 2,\n      \"alwaysOutputData\": false\n    },\n    {\n      \"id\": \"93a65d99-f3c7-45c8-acec-8fc30444f363\",\n      \"name\": \"Sticky Note\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        1300,\n        1238\n      ],\n      \"parameters\": {\n        \"width\": 241,\n        \"height\": 80,\n        \"content\": \"### üëÜüèΩ Set credentials to n8n here and select workflow\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"768980da-6dcc-4f77-bc36-78ee37b4c5f8\",\n      \"name\": \"Get all previous executions\",\n      \"type\": \"n8n-nodes-base.n8n\",\n      \"position\": [\n        1280,\n        1018\n      ],\n      \"parameters\": {\n        \"filters\": {\n          \"workflowId\": {\n            \"__rl\": true,\n            \"mode\": \"list\",\n            \"value\": \"\"\n          }\n        },\n        \"options\": {\n          \"activeWorkflows\": false\n        },\n        \"resource\": \"execution\",\n        \"returnAll\": true\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"a13d93cc-75ae-4d94-a649-3bece3ad5c34\",\n      \"name\": \"Set a message for each failed execution\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        1680,\n        1018\n      ],\n      \"parameters\": {\n        \"include\": \"selected\",\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"f7698326-2df6-4fea-b129-e56b108bdc20\",\n              \"name\": \"message\",\n              \"type\": \"string\",\n              \"value\": \"=‚ö†Ô∏è Workflow `{{ $json.workflowData.name }}` failed to run! [execution]({{ $json.id }}) [date]({{ $json.startedAt }})\"\n            }\n          ]\n        },\n        \"includeOtherFields\": true\n      },\n      \"typeVersion\": 3.3\n    },\n    {\n      \"id\": \"0e86db26-099b-421d-b90d-3a51d3c5aae3\",\n      \"name\": \"Aggregate all messages\",\n      \"type\": \"n8n-nodes-base.aggregate\",\n      \"position\": [\n        1880,\n        1018\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"fieldsToAggregate\": {\n          \"fieldToAggregate\": [\n            {\n              \"fieldToAggregate\": \"message\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"3b794e81-4b9b-460e-820f-d615c816b0fe\",\n      \"name\": \"Sticky Note4\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        2120,\n        1240\n      ],\n      \"parameters\": {\n        \"width\": 241,\n        \"height\": 80,\n        \"content\": \"### üëÜüèΩ Set credentials to Telegram here as well as chat-id\"\n      },\n      \"typeVersion\": 1\n    }\n  ],\n  \"pinData\": {},\n  \"connections\": {\n    \"Schedule Trigger\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Get all previous executions\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Aggregate all messages\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Telegram\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Get all previous executions\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Filter for executions of the week\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Filter for executions of the week\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Set a message for each failed execution\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Set a message for each failed execution\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Aggregate all messages\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}",
  "metadata": {
    "node_types": [
      "n8n-nodes-base.telegram",
      "n8n-nodes-base.scheduleTrigger",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.filter",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.n8n",
      "n8n-nodes-base.set",
      "n8n-nodes-base.aggregate",
      "n8n-nodes-base.stickyNote"
    ],
    "trigger": "schedule trigger"
  }
}