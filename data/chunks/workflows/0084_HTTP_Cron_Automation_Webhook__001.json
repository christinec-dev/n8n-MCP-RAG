{
  "source": "0084_HTTP_Cron_Automation_Webhook.json",
  "index": 1,
  "content": "{\n  \"id\": \"11\",\n  \"name\": \"What To Eat\",\n  \"nodes\": [\n    {\n      \"name\": \"Cron\",\n      \"type\": \"n8n-nodes-base.cron\",\n      \"position\": [\n        100,\n        400\n      ],\n      \"parameters\": {\n        \"triggerTimes\": {\n          \"item\": [\n            {\n              \"hour\": 10\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Search Criteria\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        300,\n        400\n      ],\n      \"parameters\": {\n        \"values\": {\n          \"number\": [\n            {\n              \"name\": \"RecipeCount\",\n              \"value\": 3\n            },\n            {\n              \"name\": \"IngredientCount\",\n              \"value\": 5\n            },\n            {\n              \"name\": \"CaloriesMin\"\n            },\n            {\n              \"name\": \"CaloriesMax\",\n              \"value\": 1500\n            },\n            {\n              \"name\": \"TimeMin\"\n            },\n            {\n              \"name\": \"TimeMax\",\n              \"value\": 30\n            }\n          ],\n          \"string\": [\n            {\n              \"name\": \"Diet\",\n              \"value\": \"balanced\"\n            },\n            {\n              \"name\": \"Health\",\n              \"value\": \"random\"\n            },\n            {\n              \"name\": \"SearchItem\",\n              \"value\": \"chicken\"\n            },\n            {\n              \"name\": \"AppID\",\n              \"value\": \"Enter Your Edamam AppID Here\"\n            },\n            {\n              \"name\": \"AppKey\",\n              \"value\": \"Enter Your Edamam AppKey Here\"\n            }\n          ]\n        },\n        \"options\": {}\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Set Query Values\",\n      \"type\": \"n8n-nodes-base.function\",\n      \"position\": [\n        500,\n        400\n      ],\n      \"parameters\": {\n        \"functionCode\": \"items[0].json.calories = items[0].json.CaloriesMin + \\\"-\\\" + items[0].json.CaloriesMax;\\nitems[0].json.time = items[0].json.TimeMin + \\\"-\\\" + items[0].json.TimeMax;\\n\\nif (items[0].json.Diet.toUpperCase() == \\\"RANDOM\\\") {\\n  arrDiet = [\\\"balanced\\\",\\\"high-fiber\\\",\\\"high-protein\\\",\\\"low-carb\\\",\\\"low-fat\\\",\\\"low-sodium\\\"];\\n  intRandomNumber = Math.floor(Math.random() * 6);\\n  items[0].json.Diet = arrDiet[intRandomNumber];\\n}\\n\\nif (items[0].json.Health.toUpperCase() == \\\"RANDOM\\\") {\\n  arrHealth = [\\\"alcohol-free\\\",\\\"immuno-supportive\\\",\\\"celery-free\\\",\\\"crustacean-free\\\",\\\"dairy-free\\\",\\\"egg-free\\\",\\\"fish-free\\\",\\\"fodmap-free\\\",\\\"gluten-free\\\",\\\"keto-friendly\\\",\\\"kidney-friendly\\\",\\\"kosher\\\",\\\"low-potassium\\\",\\\"lupine-free\\\",\\\"mustard-free\\\",\\\"low-fat-abs\\\",\\\"no-oil-added\\\",\\\"low-sugar\\\",\\\"paleo\\\",\\\"peanut-free\\\",\\\"pecatarian\\\",\\\"pork-free\\\",\\\"red-meat-free\\\",\\\"sesame-free\\\",\\\"shellfish-free\\\",\\\"soy-free\\\",\\\"sugar-conscious\\\",\\\"tree-nut-free\\\",\\\"vegan\\\",\\\"vegetarian\\\",\\\"wheat-free\\\"];\\n  intRandomNumber = Math.floor(Math.random() * 31);\\n  items[0].json.Health = arrHealth[intRandomNumber];\\n}\\n\\nreturn items;\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Set Recipe ID Values\",\n      \"type\": \"n8n-nodes-base.function\",\n      \"position\": [\n        1080,\n        400\n      ],\n      \"parameters\": {\n        \"functionCode\": \"items[0].json.from = Math.floor(Math.random() * items[0].json.RecipeCount) + 1;\\nitems[0].json.to = items[0].json.from + items[0].json.ReturnCount;\\n\\nreturn items;\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Retrieve Recipe Counts\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        700,\n        400\n      ],\n      \"parameters\": {\n        \"url\": \"https://api.edamam.com/search\",\n        \"options\": {},\n        \"queryParametersUi\": {\n          \"parameter\": [\n            {\n              \"name\": \"q\",\n              \"value\": \"={{$node[\\\"Set Query Values\\\"].json[\\\"SearchItem\\\"]}}\"\n            },\n            {\n              \"name\": \"app_id\",\n              \"value\": \"={{$node[\\\"Set Query Values\\\"].json[\\\"AppID\\\"]}}\"\n            },\n            {\n              \"name\": \"app_key\",\n              \"value\": \"={{$node[\\\"Set Query Values\\\"].json[\\\"AppKey\\\"]}}\"\n            },\n            {\n              \"name\": \"ingr\",\n              \"value\": \"={{$node[\\\"Set Query Values\\\"].json[\\\"IngredientCount\\\"]}}\"\n            },\n            {\n              \"name\": \"diet\",\n              \"value\": \"={{$node[\\\"Set Query Values\\\"].json[\\\"Diet\\\"]}}\"\n            },\n            {\n              \"name\": \"calories\",\n              \"value\": \"={{$node[\\\"Set Query Values\\\"].json[\\\"calories\\\"]}}\"\n            },\n            {\n              \"name\": \"time\",\n              \"value\": \"={{$node[\\\"Set Query Values\\\"].json[\\\"time\\\"]}}\"\n            },\n            {\n              \"name\": \"from\",\n              \"value\": \"1\"\n            },\n            {\n              \"name\": \"to\",\n              \"value\": \"2\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Retrieve Recipes\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        1260,\n        400\n      ],\n      \"parameters\": {\n        \"url\": \"https://api.edamam.com/search\",\n        \"options\": {},\n        \"queryParametersUi\": {\n          \"parameter\": [\n            {\n              \"name\": \"q\",\n              \"value\": \"={{$node[\\\"Search Criteria\\\"].json[\\\"SearchItem\\\"]}}\"\n            },\n            {\n              \"name\": \"app_id\",\n              \"value\": \"={{$node[\\\"Search Criteria\\\"].json[\\\"AppID\\\"]}}\"\n            },\n            {\n              \"name\": \"app_key\",\n              \"value\": \"={{$node[\\\"Search Criteria\\\"].json[\\\"AppKey\\\"]}}\"\n            },\n            {\n              \"name\": \"from\",\n              \"value\": \"={{$node[\\\"Set Recipe ID Values\\\"].json[\\\"from\\\"]}}\"\n            },\n            {\n              \"name\": \"to\",\n              \"value\": \"={{$node[\\\"Set Recipe ID Values\\\"].json[\\\"to\\\"]}}\"\n            },\n            {\n              \"name\": \"ingr\",\n              \"value\": \"={{$node[\\\"Search Criteria\\\"].json[\\\"IngredientCount\\\"]}}\"\n            },\n            {\n              \"name\": \"diet\",\n              \"value\": \"={{$node[\\\"Search Criteria\\\"].json[\\\"Diet\\\"]}}\"\n            },\n            {\n              \"name\": \"calories\",\n              \"value\": \"={{$node[\\\"Set Query Values\\\"].json[\\\"calories\\\"]}}\"\n            },\n            {\n              \"name\": \"time\",\n              \"value\": \"={{$node[\\\"Set Query Values\\\"].json[\\\"time\\\"]}}\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Set Counts\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        880,\n        400\n      ],\n      \"parameters\": {\n        \"values\": {\n          \"number\": [\n            {\n              \"name\": \"RecipeCount\",\n              \"value\": \"={{$node[\\\"Retrieve Recipe Counts\\\"].json[\\\"count\\\"]}}\"\n            },\n            {\n              \"name\": \"ReturnCount\",\n              \"value\": \"={{$node[\\\"Search Criteria\\\"].json[\\\"RecipeCount\\\"]}}\"\n            }\n          ]\n        },\n        \"options\": {},\n        \"keepOnlySet\": true\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Send Recipes\",\n      \"type\": \"n8n-nodes-base.emailSend\",\n      \"position\": [\n        1660,\n        400\n      ],\n      \"parameters\": {\n        \"html\": \"={{$node[\\\"Create Email Body in HTML\\\"].json[\\\"emailBody\\\"]}}\",\n        \"options\": {},\n        \"subject\": \"={{$node[\\\"Set Query Values\\\"].json[\\\"RecipeCount\\\"]}} {{$node[\\\"Set Query Values\\\"].json[\\\"Diet\\\"]}}, {{$node[\\\"Set Query Values\\\"].json[\\\"Health\\\"]}} {{$node[\\\"Set Query Values\\\"].json[\\\"SearchItem\\\"]}} recipes under {{$node[\\\"Set Query Values\\\"].json[\\\"CaloriesMax\\\"]}} calories ready in under {{$node[\\\"Set Query Values\\\"].json[\\\"TimeMax\\\"]}} minutes\",\n        \"toEmail\": \"Enter Your Email Address Here\",\n        \"fromEmail\": \"Enter Your Email Address Here\"\n      },\n      \"credentials\": {\n        \"smtp\": \"Gmail Creds\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Create Email Body in HTML\",\n      \"type\": \"n8n-nodes-base.function\",\n      \"position\": [\n        1460,\n        400\n      ],\n      \"parameters\": {\n        \"functionCode\": \"arrRecipes = items[0].json.hits;\\nitems[0].json = {};\\n\\nstrEmailBody = \\\"Here are your recipes for today:<br><ul>\\\";\\n\\narrRecipes.forEach(createHTML);\\n\\nfunction createHTML(value, index, array) {\\n  strEmailBody = strEmailBody + \\\"<li><a href=\\\\\\\"\\\"+ value.recipe.shareAs + \\\"\\\\\\\">\\\" + value.recipe.label + \\\"</a></li>\\\";\\n}\\n\\nstrEmailBody = strEmailBody + \\\"</ul>\\\";\\n\\nitems[0].json.emailBody = strEmailBody\\n\\nreturn items;\"\n      },\n      \"typeVersion\": 1\n    }\n  ],\n  \"active\": true,\n  \"settings\": {},\n  \"connections\": {\n    \"Cron\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Search Criteria\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Set Counts\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Set Recipe ID Values\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Search Criteria\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Set Query Values\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Retrieve Recipes\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Create Email Body in HTML\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Set Query Values\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Retrieve Recipe Counts\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Set Recipe ID Values\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Retrieve Recipes\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Retrieve Recipe Counts\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Set Counts\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Create Email Body in HTML\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Send Recipes\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}",
  "metadata": {
    "node_types": [
      "n8n-nodes-base.cron",
      "n8n-nodes-base.set",
      "n8n-nodes-base.function",
      "n8n-nodes-base.function",
      "n8n-nodes-base.httpRequest",
      "n8n-nodes-base.httpRequest",
      "n8n-nodes-base.set",
      "n8n-nodes-base.emailSend",
      "n8n-nodes-base.function"
    ],
    "trigger": null
  }
}