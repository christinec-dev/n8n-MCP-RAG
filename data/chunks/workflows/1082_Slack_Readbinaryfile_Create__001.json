{
  "source": "1082_Slack_Readbinaryfile_Create.json",
  "index": 1,
  "content": "{\n  \"nodes\": [\n    {\n      \"name\": \"Read Harvey's Email\",\n      \"type\": \"n8n-nodes-base.emailReadImap\",\n      \"position\": [\n        270,\n        390\n      ],\n      \"parameters\": {\n        \"options\": {}\n      },\n      \"credentials\": {\n        \"imap\": \"Read Harvey's Mail\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Who Is The Email From?\",\n      \"type\": \"n8n-nodes-base.switch\",\n      \"position\": [\n        460,\n        390\n      ],\n      \"parameters\": {\n        \"rules\": {\n          \"rules\": [\n            {\n              \"value2\": \"Louis Litt <louis_litt_1970@yahoo.com>\"\n            }\n          ]\n        },\n        \"value1\": \"={{$node[\\\"Read Harvey's Email\\\"].json[\\\"from\\\"]}}\",\n        \"dataType\": \"string\",\n        \"fallbackOutput\": 3\n      },\n      \"typeVersion\": 1,\n      \"alwaysOutputData\": false\n    },\n    {\n      \"name\": \"Read Excuses File\",\n      \"type\": \"n8n-nodes-base.readBinaryFile\",\n      \"position\": [\n        670,\n        230\n      ],\n      \"parameters\": {\n        \"filePath\": \"/home/n8n/Excuse_Generator.xlsx\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Retrieve Excuses Spreadsheet Data\",\n      \"type\": \"n8n-nodes-base.spreadsheetFile\",\n      \"position\": [\n        860,\n        230\n      ],\n      \"parameters\": {\n        \"options\": {}\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Generate Excuse\",\n      \"type\": \"n8n-nodes-base.function\",\n      \"position\": [\n        1040,\n        230\n      ],\n      \"parameters\": {\n        \"functionCode\": \"var leadinmax = 24;\\nvar perpmax = 25;\\nvar delaymax = 23;\\nvar leadin = Math.floor((Math.random() * leadinmax ) + 1);\\nvar perp = Math.floor((Math.random() * perpmax ) + 1);\\nvar delay = Math.floor((Math.random() * delaymax) + 1);\\n\\nvar excuse = items[leadin].json.Leadin + \\\" \\\" + items[perp].json.Perpetrator + \\\" \\\" + items[delay].json.Delay;\\n\\nitems = [{json:{}}];\\n\\nitems[0].json.excuse = excuse;\\nreturn items;\\n\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Merge Excuse and Mail Data\",\n      \"type\": \"n8n-nodes-base.merge\",\n      \"position\": [\n        1230,\n        330\n      ],\n      \"parameters\": {\n        \"mode\": \"mergeByIndex\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Send Email\",\n      \"type\": \"n8n-nodes-base.emailSend\",\n      \"position\": [\n        1460,\n        250\n      ],\n      \"parameters\": {\n        \"text\": \"= {{$node[\\\"Merge Excuse and Mail Data\\\"].json[\\\"excuse\\\"]}}\\n\\nMaybe next time.\\n\\nHarvey\",\n        \"options\": {},\n        \"subject\": \"=RE: {{$node[\\\"Merge Excuse and Mail Data\\\"].json[\\\"subject\\\"]}}\",\n        \"toEmail\": \"={{$node[\\\"Merge Excuse and Mail Data\\\"].json[\\\"from\\\"]}}\",\n        \"fromEmail\": \"={{$node[\\\"Merge Excuse and Mail Data\\\"].json[\\\"to\\\"]}}\"\n      },\n      \"credentials\": {\n        \"smtp\": \"Send Harvey's Mail\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Slack (Louis)\",\n      \"type\": \"n8n-nodes-base.slack\",\n      \"position\": [\n        1470,\n        410\n      ],\n      \"parameters\": {\n        \"text\": \"=Here is what Louis emailed you:\\n```\\n{{$node[\\\"Merge Excuse and Mail Data\\\"].json[\\\"textPlain\\\"]}}\\n```\\n\\nHere is how \\\"you\\\" responded:\\n> {{$node[\\\"Merge Excuse and Mail Data\\\"].json[\\\"excuse\\\"]}}\\n\\n:+1: *You're Welcome!* :smirk:\",\n        \"channel\": \"private\",\n        \"attachments\": [],\n        \"otherOptions\": {\n          \"mrkdwn\": true\n        }\n      },\n      \"credentials\": {\n        \"slackApi\": \"Nathan's Slack API Token\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Slack (General)\",\n      \"type\": \"n8n-nodes-base.slack\",\n      \"position\": [\n        890,\n        470\n      ],\n      \"parameters\": {\n        \"text\": \"You've just received an email. You may wish to check it out.\",\n        \"channel\": \"private\",\n        \"attachments\": [],\n        \"otherOptions\": {\n          \"mrkdwn\": true\n        }\n      },\n      \"credentials\": {\n        \"slackApi\": \"Nathan's Slack API Token\"\n      },\n      \"typeVersion\": 1\n    }\n  ],\n  \"connections\": {\n    \"Generate Excuse\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Merge Excuse and Mail Data\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Read Excuses File\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Retrieve Excuses Spreadsheet Data\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Read Harvey's Email\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Who Is The Email From?\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Who Is The Email From?\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Read Excuses File\",\n            \"type\": \"main\",\n            \"index\": 0\n          },\n          {\n            \"node\": \"Merge Excuse and Mail Data\",\n            \"type\": \"main\",\n            \"index\": 1\n          }\n        ],\n        [\n          {\n            \"node\": \"Slack (General)\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Merge Excuse and Mail Data\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Send Email\",\n            \"type\": \"main\",\n            \"index\": 0\n          },\n          {\n            \"node\": \"Slack (Louis)\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Retrieve Excuses Spreadsheet Data\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Generate Excuse\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}",
  "metadata": {
    "node_types": [
      "n8n-nodes-base.emailReadImap",
      "n8n-nodes-base.switch",
      "n8n-nodes-base.readBinaryFile",
      "n8n-nodes-base.spreadsheetFile",
      "n8n-nodes-base.function",
      "n8n-nodes-base.merge",
      "n8n-nodes-base.emailSend",
      "n8n-nodes-base.slack",
      "n8n-nodes-base.slack"
    ],
    "trigger": null
  }
}