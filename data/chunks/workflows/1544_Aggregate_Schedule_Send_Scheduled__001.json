{
  "source": "1544_Aggregate_Schedule_Send_Scheduled.json",
  "index": 1,
  "content": "{\n  \"id\": \"M8oLW9Qd59zNJzg2\",\n  \"meta\": {\n    \"instanceId\": \"1abe0e4c2be794795d12bf72aa530a426a6f87aabad209ed6619bcaf0f666fb0\",\n    \"templateCredsSetupCompleted\": true\n  },\n  \"name\": \"Email Summary Agent\",\n  \"tags\": [\n    {\n      \"id\": \"G1v7CnFpOHsReVhM\",\n      \"name\": \"Product\",\n      \"createdAt\": \"2025-01-13T17:04:34.969Z\",\n      \"updatedAt\": \"2025-01-13T17:04:34.969Z\"\n    },\n    {\n      \"id\": \"RagrXIh5iBDseqvj\",\n      \"name\": \"AI\",\n      \"createdAt\": \"2025-01-09T09:18:12.756Z\",\n      \"updatedAt\": \"2025-01-09T09:18:12.756Z\"\n    },\n    {\n      \"id\": \"Yg2lfYteJZAoIeaC\",\n      \"name\": \"Building blocks\",\n      \"createdAt\": \"2025-01-13T17:05:49.788Z\",\n      \"updatedAt\": \"2025-01-13T17:05:49.788Z\"\n    },\n    {\n      \"id\": \"ZuS1C3NpE8uBlFq4\",\n      \"name\": \"Finance\",\n      \"createdAt\": \"2025-01-13T17:05:03.996Z\",\n      \"updatedAt\": \"2025-01-13T17:05:03.996Z\"\n    },\n    {\n      \"id\": \"aqlZb2qfWiaT4Xr5\",\n      \"name\": \"IT Ops\",\n      \"createdAt\": \"2025-01-03T12:20:11.917Z\",\n      \"updatedAt\": \"2025-01-03T12:20:11.917Z\"\n    },\n    {\n      \"id\": \"fX8hRnEv4D8sLSzF\",\n      \"name\": \"OpenAI\",\n      \"createdAt\": \"2025-01-09T09:18:12.757Z\",\n      \"updatedAt\": \"2025-01-09T09:18:12.757Z\"\n    },\n    {\n      \"id\": \"j1qBXzFADkR3sHSa\",\n      \"name\": \"Marketing\",\n      \"createdAt\": \"2025-01-13T17:03:54.468Z\",\n      \"updatedAt\": \"2025-01-13T17:03:54.468Z\"\n    },\n    {\n      \"id\": \"x3OVvOuZkLx1hYpW\",\n      \"name\": \"Support\",\n      \"createdAt\": \"2025-01-13T17:05:40.900Z\",\n      \"updatedAt\": \"2025-01-13T17:05:40.900Z\"\n    },\n    {\n      \"id\": \"xBOhq1kP3lza5ajE\",\n      \"name\": \"HR\",\n      \"createdAt\": \"2025-01-13T17:04:57.045Z\",\n      \"updatedAt\": \"2025-01-13T17:04:57.045Z\"\n    },\n    {\n      \"id\": \"yy04JQqCaXepPdSa\",\n      \"name\": \"Project Management\",\n      \"createdAt\": \"2024-10-30T18:27:57.309Z\",\n      \"updatedAt\": \"2024-10-30T18:27:57.309Z\"\n    },\n    {\n      \"id\": \"zJaZorWWcGpTp35U\",\n      \"name\": \"DevOps\",\n      \"createdAt\": \"2025-01-03T12:19:34.273Z\",\n      \"updatedAt\": \"2025-01-03T12:19:34.273Z\"\n    }\n  ],\n  \"nodes\": [\n    {\n      \"id\": \"94c09c05-539b-452e-83b7-0a029bbe6b7f\",\n      \"name\": \"Sticky Note\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -120,\n        -140\n      ],\n      \"parameters\": {\n        \"width\": 248.47086922498647,\n        \"height\": 314.47468983163634,\n        \"content\": \"- Starts the workflow every day at 7 AM.\\n- Adjust the time if you want the workflow to run at a different hour.\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"5e5cbc87-5c01-438b-a1c0-e8468d3ee20b\",\n      \"name\": \"Sticky Note1\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        160,\n        -137.04548301590512\n      ],\n      \"parameters\": {\n        \"width\": 213.36643278764896,\n        \"height\": 313.40934714314244,\n        \"content\": \"Fetches all emails received in the past 24 hours from the email address\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"9a82f5e9-7d0b-430f-9dbb-d8ae0b129dad\",\n      \"name\": \"Daily 7AM Trigger\",\n      \"type\": \"n8n-nodes-base.scheduleTrigger\",\n      \"position\": [\n        -40,\n        0\n      ],\n      \"parameters\": {\n        \"rule\": {\n          \"interval\": [\n            {\n              \"triggerAtHour\": 7\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 1.2\n    },\n    {\n      \"id\": \"dd3e4b10-187b-45ce-b999-f0143e5af134\",\n      \"name\": \"Fetch Emails - Past 24 Hours\",\n      \"type\": \"n8n-nodes-base.gmail\",\n      \"position\": [\n        220,\n        0\n      ],\n      \"webhookId\": \"20f1d11d-8a69-43f3-9323-33eaf1b3b600\",\n      \"parameters\": {\n        \"filters\": {\n          \"q\": \"={{ \\n  (() => {\\n    const yesterday = new Date();\\n    yesterday.setDate(yesterday.getDate() - 1);\\n    return `isb.quantana@quantana.in after:${yesterday.getFullYear()}/${(yesterday.getMonth() + 1).toString().padStart(2, '0')}/${yesterday.getDate().toString().padStart(2, '0')}`;\\n  })()\\n}}\"\n        },\n        \"operation\": \"getAll\",\n        \"returnAll\": true\n      },\n      \"credentials\": {\n        \"gmailOAuth2\": {\n          \"id\": \"YFARhQXJAjbwXjSO\",\n          \"name\": \"Vishal Gmail\"\n        }\n      },\n      \"typeVersion\": 2.1\n    },\n    {\n      \"id\": \"4a8fdfd9-93d7-43a2-92b0-88d845f217bf\",\n      \"name\": \"Organize Email Data - Morning\",\n      \"type\": \"n8n-nodes-base.aggregate\",\n      \"position\": [\n        460,\n        0\n      ],\n      \"parameters\": {\n        \"include\": \"specifiedFields\",\n        \"options\": {},\n        \"aggregate\": \"aggregateAllItemData\",\n        \"fieldsToInclude\": \"id, From, To, CC, snippet\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"9e2426e8-57ba-4708-b66f-b58bd19eabff\",\n      \"name\": \"Summarize Emails with OpenAI - Morning\",\n      \"type\": \"@n8n/n8n-nodes-langchain.openAi\",\n      \"position\": [\n        680,\n        0\n      ],\n      \"parameters\": {\n        \"modelId\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"gpt-4o-mini\",\n          \"cachedResultName\": \"GPT-4O-MINI\"\n        },\n        \"options\": {},\n        \"messages\": {\n          \"values\": [\n            {\n              \"content\": \"=Go through this email summary and identify all key details mentioned, any specific issues to look at, and action items.\\nUse this format to output\\n{\\n  \\\"summary_of_emails\\\": [\\n    \\\"Point 1\\\",\\n    \\\"Point 2\\\",\\n    \\\"Point 3\\\"\\n  ],\\n  \\\"actions\\\": [\\n    {\\n      \\\"name\\\": \\\"Name 1\\\",\\n      \\\"action\\\": \\\"Action 1\\\"\\n    },\\n    {\\n      \\\"name\\\": \\\"Name 1\\\",\\n      \\\"action\\\": \\\"Action 2\\\"\\n    },\\n    {\\n      \\\"name\\\": \\\"Name 2\\\",\\n      \\\"action\\\": \\\"Action 3\\\"\\n    }\\n  ]\\n}\\n\\nInput Data:\\n\\n {{ $json.data.toJsonString() }}\\n\\n\"\n            }\n          ]\n        },\n        \"jsonOutput\": true\n      },\n      \"credentials\": {\n        \"openAiApi\": {\n          \"id\": \"ksU2WMcMqe2lPgRw\",\n          \"name\": \"OpenAi account\"\n        }\n      },\n      \"typeVersion\": 1.7\n    },\n    {\n      \"id\": \"4aa68ee8-d38f-418a-9f20-6cc76850c638\",\n      \"name\": \"Send Summary - Morning\",\n      \"type\": \"n8n-nodes-base.gmail\",\n      \"position\": [\n        1040,\n        0\n      ],\n      \"webhookId\": \"83f2aeb9-7b6c-4336-b5ed-8acfcd259850\",\n      \"parameters\": {\n        \"sendTo\": \"team-email@example.com\",\n        \"message\": \"=<!DOCTYPE html>\\n<html lang=\\\"en\\\">\\n<head>\\n    <meta charset=\\\"UTF-8\\\">\\n    <meta name=\\\"viewport\\\" content=\\\"width=device-width, initial-scale=1.0\\\">\\n    <title>Email Summary - isbonline@quantana.in</title>\\n    <style>\\n        body {\\n            font-family: Arial, sans-serif;\\n            margin: 0;\\n            padding: 0;\\n            background-color: #f9f9f9;\\n            color: #333;\\n            line-height: 1.6;\\n        }\\n        .email-container {\\n            max-width: 600px;\\n            margin: 20px auto;\\n            background: #ffffff;\\n            border: 1px solid #ddd;\\n            border-radius: 10px;\\n            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);\\n        }\\n        .email-header {\\n            background-color: #0073e6;\\n            color: #fff;\\n            padding: 20px;\\n            text-align: center;\\n            border-top-left-radius: 10px;\\n            border-top-right-radius: 10px;\\n        }\\n        .email-header h1 {\\n            margin: 0;\\n            font-size: 24px;\\n        }\\n        .email-content {\\n            padding: 20px;\\n        }\\n        .section-title {\\n            font-size: 20px;\\n            color: #0073e6;\\n            margin-bottom: 10px;\\n        }\\n        ul {\\n            list-style: none;\\n            padding: 0;\\n        }\\n        ul li {\\n            margin: 10px 0;\\n            padding: 10px;\\n            background: #f4f4f4;\\n            border-left: 4px solid #0073e6;\\n            border-radius: 5px;\\n        }\\n        .action-item {\\n            font-weight: bold;\\n            margin: 5px 0;\\n        }\\n        .action-detail {\\n            margin-left: 10px;\\n        }\\n        .email-footer {\\n            background-color: #0073e6;\\n            color: #fff;\\n            text-align: center;\\n            padding: 10px;\\n            font-size: 14px;\\n            border-bottom-left-radius: 10px;\\n            border-bottom-right-radius: 10px;\\n        }\\n    </style>\\n</head>\\n<body>\\n    <div class=\\\"email-container\\\">\\n        <div class=\\\"email-header\\\">\\n            <h1>Email Summary</h1>\\n        </div>\\n        <div class=\\\"email-content\\\">\\n            <div>\\n                <h2 class=\\\"section-title\\\">Summary of Emails:</h2>\\n                <ul>\\n                    {{ $json.message.content.summary_of_emails.map(email => `<li>${email}</li>`).join('') }}\\n                </ul>\\n            </div>\\n            <div>\\n                <h2 class=\\\"section-title\\\">Actions:</h2>\\n                <ul>\\n                    {{ $json.message.content.actions.map(action => `\\n                        <li>\\n                            <span class=\\\"action-item\\\">${action.name}:</span>\\n                            <span class=\\\"action-detail\\\">${action.action}</span>\\n                        </li>\\n                    `).join('') }}\\n                </ul>\\n            </div>\\n        </div>\\n        <div class=\\\"email-footer\\\">\\n            <p>Generated by Quantana ESAgent <br /> A Quantana AI Labs Initiative\\n        </div>\\n    </div>\\n</body>\\n</html>\",\n        \"options\": {\n          \"ccList\": \"cc-list@example.com\",\n          \"appendAttribution\": false,\n          \"replyToSenderOnly\": false\n        },\n        \"subject\": \"=ESAgent - {{ new Date(new Date().setDate(new Date().getDate() - 1)).toLocaleDateString('en-GB', { day: '2-digit', month: 'short', year: 'numeric' }) }}-00:00 to {{ new Date(new Date().setDate(new Date().getDate())).toLocaleDateString('en-GB', { day: '2-digit', month: 'short', year: 'numeric' }) }}-07:00AM\"\n      },\n      \"credentials\": {\n        \"gmailOAuth2\": {\n          \"id\": \"YFARhQXJAjbwXjSO\",\n          \"name\": \"Vishal Gmail\"\n        }\n      },\n      \"typeVersion\": 2.1\n    },\n    {\n      \"id\": \"c7667667-9533-40cb-9c09-914a11560600\",\n      \"name\": \"Sticky Note2\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        400,\n        -132.6641804468672\n      ],\n      \"parameters\": {\n        \"width\": 226.7095107678671,\n        \"height\": 305.83657700487913,\n        \"content\": \"Organizes the fetched email data, extracting fields like sender, receiver, CC, and a preview snippet.\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"43955af4-3a18-44d7-8c8d-cf8051b18bdd\",\n      \"name\": \"Sticky Note4\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        980,\n        -180\n      ],\n      \"parameters\": {\n        \"width\": 232.8435827211592,\n        \"height\": 359.7308639651144,\n        \"content\": \"- Sends the summarized email report to recipients with a styled HTML layout.\\n- Update the \\\"sendTo\\\" and \\\"ccList\\\" fields with the email addresses of your recipients.\\n\\n\"\n      },\n      \"typeVersion\": 1\n    }\n  ],\n  \"active\": false,\n  \"pinData\": {},\n  \"settings\": {\n    \"timezone\": \"Asia/Kolkata\",\n    \"callerPolicy\": \"workflowsFromSameOwner\",\n    \"executionOrder\": \"v1\"\n  },\n  \"versionId\": \"b18912ed-6c1f-4912-b75a-1553f7620917\",\n  \"connections\": {\n    \"Daily 7AM Trigger\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Fetch Emails - Past 24 Hours\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Fetch Emails - Past 24 Hours\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Organize Email Data - Morning\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Organize Email Data - Morning\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Summarize Emails with OpenAI - Morning\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Summarize Emails with OpenAI - Morning\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Send Summary - Morning\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}",
  "metadata": {
    "node_types": [
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.scheduleTrigger",
      "n8n-nodes-base.gmail",
      "n8n-nodes-base.aggregate",
      "@n8n/n8n-nodes-langchain.openAi",
      "n8n-nodes-base.gmail",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote"
    ],
    "trigger": "daily 7am trigger"
  }
}