{
  "source": "0247_Functionitem_HTTP_Create_Webhook.json",
  "index": 1,
  "content": "{\n  \"meta\": {\n    \"instanceId\": \"237600ca44303ce91fa31ee72babcdc8493f55ee2c0e8aa2b78b3b4ce6f70bd9\"\n  },\n  \"nodes\": [\n    {\n      \"id\": \"e95fc182-b13e-4eab-852b-66ea821c4129\",\n      \"name\": \"On product created\",\n      \"type\": \"n8n-nodes-base.pipedriveTrigger\",\n      \"position\": [\n        440,\n        500\n      ],\n      \"webhookId\": \"4a700bc2-a3bf-43fb-902c-5ca5a74bf38d\",\n      \"parameters\": {\n        \"action\": \"added\",\n        \"object\": \"product\"\n      },\n      \"credentials\": {\n        \"pipedriveApi\": {\n          \"id\": \"1\",\n          \"name\": \"Pipedrive account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"a64af9df-3084-4376-ace9-50f0f21bbf35\",\n      \"name\": \"Set item to only current product data\",\n      \"type\": \"n8n-nodes-base.functionItem\",\n      \"position\": [\n        680,\n        500\n      ],\n      \"parameters\": {\n        \"functionCode\": \"// Code here will run once per input item.\\n// More info and help: https://docs.n8n.io/nodes/n8n-nodes-base.functionItem\\n// Tip: You can use luxon for dates and $jmespath for querying JSON structures\\n\\n// Add a new field called 'myNewField' to the JSON of the item\\nitem = item.current;\\n\\n// You can write logs to the browser console\\nconsole.log('Done!');\\n\\nreturn item;\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"79b265a9-4021-4a1a-9b4a-4f3aeace9fe5\",\n      \"name\": \"Create product in Stripe\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        900,\n        660\n      ],\n      \"parameters\": {\n        \"url\": \"https://api.stripe.com/v1/products\",\n        \"options\": {},\n        \"requestMethod\": \"POST\",\n        \"authentication\": \"predefinedCredentialType\",\n        \"queryParametersUi\": {\n          \"parameter\": [\n            {\n              \"name\": \"name\",\n              \"value\": \"={{ $json[\\\"name\\\"] }}\"\n            },\n            {\n              \"name\": \"description\",\n              \"value\": \"={{ $json[\\\"description\\\"] || ' '}}\"\n            }\n          ]\n        },\n        \"nodeCredentialType\": \"stripeApi\"\n      },\n      \"credentials\": {\n        \"stripeApi\": {\n          \"id\": \"3\",\n          \"name\": \"Stripe account\"\n        }\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"69e40a2b-1680-42f9-add9-cbef9bc0f63f\",\n      \"name\": \"Add created product Id to data\",\n      \"type\": \"n8n-nodes-base.merge\",\n      \"position\": [\n        1320,\n        520\n      ],\n      \"parameters\": {\n        \"mode\": \"mergeByIndex\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"bc7428ba-829f-4a9b-af61-ea11c102d1d3\",\n      \"name\": \"Keep only productId of created product\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        1100,\n        660\n      ],\n      \"parameters\": {\n        \"values\": {\n          \"string\": [\n            {\n              \"name\": \"StripeCreatedProductId\",\n              \"value\": \"={{ $json[\\\"id\\\"] }}\"\n            }\n          ]\n        },\n        \"options\": {},\n        \"keepOnlySet\": true\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"8571acfb-8ee9-410d-a5ca-9b173d034202\",\n      \"name\": \"Create price records in Stripe\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        1760,\n        520\n      ],\n      \"parameters\": {\n        \"url\": \"https://api.stripe.com/v1/prices\",\n        \"options\": {},\n        \"requestMethod\": \"POST\",\n        \"authentication\": \"predefinedCredentialType\",\n        \"queryParametersUi\": {\n          \"parameter\": [\n            {\n              \"name\": \"currency\",\n              \"value\": \"={{ $json[\\\"prices\\\"].currency }}\"\n            },\n            {\n              \"name\": \"unit_amount\",\n              \"value\": \"={{ $json[\\\"prices\\\"].price * 100 }}\"\n            },\n            {\n              \"name\": \"product\",\n              \"value\": \"={{ $json[\\\"StripeCreatedProductId\\\"] }}\"\n            }\n          ]\n        },\n        \"nodeCredentialType\": \"stripeApi\"\n      },\n      \"credentials\": {\n        \"stripeApi\": {\n          \"id\": \"3\",\n          \"name\": \"Stripe account\"\n        }\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"f849ae73-aa7d-49b2-81a9-7470278d30a3\",\n      \"name\": \"Split prices to seperate items\",\n      \"type\": \"n8n-nodes-base.itemLists\",\n      \"position\": [\n        1540,\n        520\n      ],\n      \"parameters\": {\n        \"include\": \"selectedOtherFields\",\n        \"options\": {},\n        \"fieldToSplitOut\": \"prices\",\n        \"fieldsToInclude\": {\n          \"fields\": [\n            {\n              \"fieldName\": \"StripeCreatedProductId\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 1\n    }\n  ],\n  \"connections\": {\n    \"On product created\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Set item to only current product data\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Create product in Stripe\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Keep only productId of created product\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Add created product Id to data\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Split prices to seperate items\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Split prices to seperate items\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Create price records in Stripe\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Set item to only current product data\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Create product in Stripe\",\n            \"type\": \"main\",\n            \"index\": 0\n          },\n          {\n            \"node\": \"Add created product Id to data\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Keep only productId of created product\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Add created product Id to data\",\n            \"type\": \"main\",\n            \"index\": 1\n          }\n        ]\n      ]\n    }\n  }\n}",
  "metadata": {
    "node_types": [
      "n8n-nodes-base.pipedriveTrigger",
      "n8n-nodes-base.functionItem",
      "n8n-nodes-base.httpRequest",
      "n8n-nodes-base.merge",
      "n8n-nodes-base.set",
      "n8n-nodes-base.httpRequest",
      "n8n-nodes-base.itemLists"
    ],
    "trigger": null
  }
}