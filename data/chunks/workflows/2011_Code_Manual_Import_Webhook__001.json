{
  "source": "2011_Code_Manual_Import_Webhook.json",
  "index": 1,
  "content": "{\n  \"id\": \"xLjE4IkQXARXOCZy\",\n  \"meta\": {\n    \"instanceId\": \"24bd2f3b51439b955590389bfa4dd9889fbd30343962de0b7daedce624cf4a71\"\n  },\n  \"name\": \"Import multiple Manufacturers from Google Sheets to Shopware 6\",\n  \"tags\": [\n    {\n      \"id\": \"Bpo3iitXqy2zfvPW\",\n      \"name\": \"tutorial\",\n      \"createdAt\": \"2024-01-06T22:57:17.318Z\",\n      \"updatedAt\": \"2024-01-06T22:57:17.318Z\"\n    },\n    {\n      \"id\": \"NfcTamKf2RPwzXbo\",\n      \"name\": \"automate-everything\",\n      \"createdAt\": \"2024-02-14T20:01:44.966Z\",\n      \"updatedAt\": \"2024-02-14T20:01:44.966Z\"\n    },\n    {\n      \"id\": \"2Vgn1rq99D9L11Gq\",\n      \"name\": \"submitted\",\n      \"createdAt\": \"2024-02-15T16:09:47.798Z\",\n      \"updatedAt\": \"2024-02-15T16:09:47.798Z\"\n    }\n  ],\n  \"nodes\": [\n    {\n      \"id\": \"460ed5fb-cc70-41ed-b6e2-07bc2266603f\",\n      \"name\": \"When clicking \\\"Execute Workflow\\\"\",\n      \"type\": \"n8n-nodes-base.manualTrigger\",\n      \"position\": [\n        340,\n        360\n      ],\n      \"parameters\": {},\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"291e6fc4-31b4-4c7c-91e8-261581664759\",\n      \"name\": \"Settings\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        620,\n        360\n      ],\n      \"parameters\": {\n        \"fields\": {\n          \"values\": [\n            {\n              \"name\": \"shopware_url\",\n              \"stringValue\": \"https://your-shopware-url.com\"\n            },\n            {\n              \"name\": \"default_language_code\",\n              \"stringValue\": \"de_DE\"\n            }\n          ]\n        },\n        \"options\": {}\n      },\n      \"typeVersion\": 3.2\n    },\n    {\n      \"id\": \"38f62300-bbc9-4c2e-a1ba-1d1a49e9cecc\",\n      \"name\": \"Create Import Request Body\",\n      \"type\": \"n8n-nodes-base.code\",\n      \"position\": [\n        1260,\n        360\n      ],\n      \"parameters\": {\n        \"jsCode\": \"// importing crypto package to create md5 hashes for the media ids\\nconst crypto = require('crypto');\\nconst md5 = data => crypto.createHash('md5').update(data).digest(\\\"hex\\\")\\n\\nfunction addTranslation(translations, code, name, description) {\\n  return translations = {\\n    ...translations,\\n    [code]: {\\n      ...name && {\\n        name: name\\n      },\\n      ...description && {\\n        description: description\\n      }\\n    }\\n  }\\n}\\n\\nfor (const item of $input.all()) {\\n  const { name, website, description, logo_url } = item.json\\n\\n  // If you add another language to the Google Sheet, extract values here\\n  const { translation_language_code_1, translation_language_code_2, translation_language_code_3, translation_name_1, translation_name_2, translation_name_3, translation_description_1, translation_description_2, translation_description_3 } = item.json\\n  \\n  let translations = {}\\n\\n  if(translation_language_code_1 && (translation_name_1 || translation_description_1)){\\n    translations = addTranslation(translations, translation_language_code_1, translation_name_1, translation_description_1)\\n  }\\n\\n  if(translation_language_code_2 && (translation_name_2 || translation_description_2)){\\n    translations = addTranslation(translations, translation_language_code_2, translation_name_2, translation_description_2)\\n  }\\n\\n    if(translation_language_code_3 && (translation_name_3 || translation_description_3)){\\n    translations = addTranslation(translations, translation_language_code_3, translation_name_3, translation_description_3)\\n  }\\n\\n  //If you add another language to the Google Sheet, call addTranslation with the values of the new language as already done above with three languages\\n  \\n  item.json.manufacturer = {\\n    entity: \\\"product_manufacturer\\\",\\n    action: \\\"upsert\\\",\\n    payload: [\\n      {\\n        name: name,\\n        link: website,\\n        description: description,\\n        ...Object.keys(translations).length && {\\n          translations: translations\\n        },\\n        ...logo_url &&  { \\n          media:{\\n            id: md5(\\\"media-\\\"+item.json.name)\\n          }\\n        }\\n      }\\n    ]\\n  }\\n}\\n\\nreturn $input.all();\"\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"2e6d1b94-ffb0-46bf-8197-32865764e753\",\n      \"name\": \"Upload Manufacturer Logo\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        2300,\n        360\n      ],\n      \"parameters\": {\n        \"url\": \"={{ $('Settings').item.json.shopware_url }}/api/_action/media/{{ $('Loop Over Manufacturers').item.json.manufacturer.payload[0].media.id }}/upload\",\n        \"method\": \"POST\",\n        \"options\": {},\n        \"sendBody\": true,\n        \"sendQuery\": true,\n        \"authentication\": \"genericCredentialType\",\n        \"bodyParameters\": {\n          \"parameters\": [\n            {\n              \"name\": \"url\",\n              \"value\": \"={{ $('Get Manufacturer from Google Sheet').item.json.logo_url }}\"\n            }\n          ]\n        },\n        \"genericAuthType\": \"oAuth2Api\",\n        \"queryParameters\": {\n          \"parameters\": [\n            {\n              \"name\": \"extension\",\n              \"value\": \"={{ $('Get Manufacturer from Google Sheet').item.json.logo_url.split(\\\".\\\").pop() }}\"\n            },\n            {\n              \"name\": \"fileName\",\n              \"value\": \"={{ $('Get Manufacturer from Google Sheet').item.json.name }}\"\n            }\n          ]\n        }\n      },\n      \"credentials\": {\n        \"oAuth2Api\": {\n          \"id\": \"hrFvifgKqhhV11RK\",\n          \"name\": \"SW6 Demo\"\n        }\n      },\n      \"typeVersion\": 4.1\n    },\n    {\n      \"id\": \"6c219e67-1547-475a-aa4f-0018d10ccf5f\",\n      \"name\": \"Import Manufacturer\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        1800,\n        380\n      ],\n      \"parameters\": {\n        \"url\": \"={{ $('Settings').item.json.shopware_url }}/api/_action/sync\",\n        \"method\": \"POST\",\n        \"options\": {},\n        \"sendBody\": true,\n        \"sendQuery\": true,\n        \"authentication\": \"genericCredentialType\",\n        \"bodyParameters\": {\n          \"parameters\": [\n            {\n              \"name\": \"import-manufacturer\",\n              \"value\": \"={{ $json.manufacturer }}\"\n            }\n          ]\n        },\n        \"genericAuthType\": \"oAuth2Api\",\n        \"queryParameters\": {\n          \"parameters\": [\n            {\n              \"name\": \"_response\",\n              \"value\": \"details\"\n            }\n          ]\n        }\n      },\n      \"credentials\": {\n        \"oAuth2Api\": {\n          \"id\": \"hrFvifgKqhhV11RK\",\n          \"name\": \"SW6 Demo\"\n        }\n      },\n      \"typeVersion\": 4.1\n    },\n    {\n      \"id\": \"f4dc392f-8679-4624-a045-ff560f282f5f\",\n      \"name\": \"Sticky Note\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        540,\n        240\n      ],\n      \"parameters\": {\n        \"width\": 271,\n        \"height\": 330,\n        \"content\": \"## Settings\\n**Todo**: Configure your Shopware URL\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"15b857a8-ef6a-4212-ac73-7ab16ffcb6e5\",\n      \"name\": \"Sticky Note1\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        900,\n        120\n      ],\n      \"parameters\": {\n        \"width\": 272,\n        \"height\": 450,\n        \"content\": \"## Google Sheet\\n**Todo:** Create a Google Sheet with the columns:\\n- name (**unique**)\\n- website\\n- description\\n- logo_url\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"52f5804c-65a9-4772-99e5-fdde53ff3f3d\",\n      \"name\": \"Loop Over Manufacturers\",\n      \"type\": \"n8n-nodes-base.splitInBatches\",\n      \"position\": [\n        1520,\n        360\n      ],\n      \"parameters\": {\n        \"options\": {}\n      },\n      \"typeVersion\": 3\n    },\n    {\n      \"id\": \"f37d7f57-b86b-4296-9114-0a1b97178bc9\",\n      \"name\": \"Get Manufacturer from Google Sheet\",\n      \"type\": \"n8n-nodes-base.googleSheets\",\n      \"position\": [\n        980,\n        360\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"sheetName\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"gid=0\",\n          \"cachedResultUrl\": \"https://docs.google.com/spreadsheets/d/1Qmsjs8usT90fPNnCIaI605W77zoKkOB3t3i8UsdpA5Q/edit#gid=0\",\n          \"cachedResultName\": \"Sheet1\"\n        },\n        \"documentId\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"1Qmsjs8usT90fPNnCIaI605W77zoKkOB3t3i8UsdpA5Q\",\n          \"cachedResultUrl\": \"https://docs.google.com/spreadsheets/d/1Qmsjs8usT90fPNnCIaI605W77zoKkOB3t3i8UsdpA5Q/edit?usp=drivesdk\",\n          \"cachedResultName\": \"SW6 Manufacturer\"\n        }\n      },\n      \"credentials\": {\n        \"googleSheetsOAuth2Api\": {\n          \"id\": \"dmSqFI4zNuhZqIvL\",\n          \"name\": \"Google Sheets account\"\n        }\n      },\n      \"typeVersion\": 4.2\n    },\n    {\n      \"id\": \"dfe522c5-f481-4bc1-ba95-85f8f471b20a\",\n      \"name\": \"If has Logo\",\n      \"type\": \"n8n-nodes-base.if\",\n      \"position\": [\n        2040,\n        380\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"conditions\": {\n          \"options\": {\n            \"leftValue\": \"\",\n            \"caseSensitive\": true,\n            \"typeValidation\": \"strict\"\n          },\n          \"combinator\": \"and\",\n          \"conditions\": [\n            {\n              \"id\": \"1cd0654f-b088-420a-be28-4468dc901890\",\n              \"operator\": {\n                \"type\": \"array\",\n                \"operation\": \"exists\",\n                \"singleValue\": true\n              },\n              \"leftValue\": \"={{ $json.data['import-manufacturer'].result[0].entities.media }}\",\n              \"rightValue\": \"\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"b006dce3-16c6-4ebb-b752-67e5972841f5\",\n      \"name\": \"Sticky Note2\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        1740,\n        60\n      ],\n      \"parameters\": {\n        \"height\": 499.67801857585135,\n        \"content\": \"## Shopware Manufacturer Import\\n**Todo**: Connect your Shopware Account by creating a [Shopware Integration](https://docs.shopware.com/en/shopware-6-en/settings/system/integrationen) and using a Generic OAuth2 API Authentication with Grant Type \\\"Client Credentials\\\" to authenticate the request. The Access Token URL is https://*your-shopware-domain.com*/api/oauth/token.\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"681e7c0a-6e6f-4896-8e86-6eacfc4fd2ab\",\n      \"name\": \"Sticky Note3\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        2240,\n        160\n      ],\n      \"parameters\": {\n        \"height\": 399.1455108359133,\n        \"content\": \"## Shopware Manufacturer Logo Upload\\n**Todo**: Connect your Shopware Account as you did two nodes before.\"\n      },\n      \"typeVersion\": 1\n    }\n  ],\n  \"active\": false,\n  \"pinData\": {},\n  \"settings\": {\n    \"executionOrder\": \"v1\"\n  },\n  \"versionId\": \"1d0510a7-b383-481a-801b-f0f77f144858\",\n  \"connections\": {\n    \"Settings\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Get Manufacturer from Google Sheet\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"If has Logo\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Upload Manufacturer Logo\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Loop Over Manufacturers\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Import Manufacturer\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"If has Logo\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Loop Over Manufacturers\": {\n      \"main\": [\n        [],\n        [\n          {\n            \"node\": \"Import Manufacturer\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Upload Manufacturer Logo\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Loop Over Manufacturers\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Create Import Request Body\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Loop Over Manufacturers\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"When clicking \\\"Execute Workflow\\\"\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Settings\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Get Manufacturer from Google Sheet\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Create Import Request Body\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}",
  "metadata": {
    "node_types": [
      "n8n-nodes-base.manualTrigger",
      "n8n-nodes-base.set",
      "n8n-nodes-base.code",
      "n8n-nodes-base.httpRequest",
      "n8n-nodes-base.httpRequest",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.splitInBatches",
      "n8n-nodes-base.googleSheets",
      "n8n-nodes-base.if",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote"
    ],
    "trigger": null
  }
}