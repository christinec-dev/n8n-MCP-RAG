{
  "source": "0158_Telegram_Functionitem_Create_Scheduled.json",
  "index": 1,
  "content": "{\n  \"nodes\": [\n    {\n      \"name\": \"On clicking 'execute'\",\n      \"type\": \"n8n-nodes-base.manualTrigger\",\n      \"position\": [\n        340,\n        380\n      ],\n      \"parameters\": {},\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Write Binary File\",\n      \"type\": \"n8n-nodes-base.writeBinaryFile\",\n      \"position\": [\n        1680,\n        280\n      ],\n      \"parameters\": {\n        \"fileName\": \"={{$node[\\\"Config\\\"].parameter[\\\"values\\\"][\\\"string\\\"][0][\\\"value\\\"]}}\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Read Binary File\",\n      \"type\": \"n8n-nodes-base.readBinaryFile\",\n      \"position\": [\n        580,\n        460\n      ],\n      \"parameters\": {\n        \"filePath\": \"={{$node[\\\"Config\\\"].parameter[\\\"values\\\"][\\\"string\\\"][0][\\\"value\\\"]}}\"\n      },\n      \"typeVersion\": 1,\n      \"continueOnFail\": true,\n      \"alwaysOutputData\": true\n    },\n    {\n      \"name\": \"HTTP Request\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        1020,\n        460\n      ],\n      \"parameters\": {\n        \"url\": \"https://readwise.io/reader/api/state/\",\n        \"options\": {},\n        \"authentication\": \"headerAuth\",\n        \"queryParametersUi\": {\n          \"parameter\": [\n            {\n              \"name\": \"schemaVersion\",\n              \"value\": \"5\"\n            },\n            {\n              \"name\": \"filter[updated_at][gt]\",\n              \"value\": \"={{$json[\\\"last_synced\\\"]}}\"\n            }\n          ]\n        },\n        \"headerParametersUi\": {\n          \"parameter\": []\n        }\n      },\n      \"credentials\": {\n        \"httpHeaderAuth\": {\n          \"id\": \"10\",\n          \"name\": \"Header Auth account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Telegram\",\n      \"type\": \"n8n-nodes-base.telegram\",\n      \"position\": [\n        1480,\n        460\n      ],\n      \"parameters\": {\n        \"text\": \"={{$json[\\\"title\\\"]}} by {{$json[\\\"author\\\"]}}\\n\\n{{$json[\\\"summary\\\"]}}\\n\\n{{$json[\\\"url\\\"]}}\",\n        \"chatId\": \"={{$node[\\\"Config\\\"].parameter[\\\"values\\\"][\\\"number\\\"][0][\\\"value\\\"]}}\",\n        \"additionalFields\": {}\n      },\n      \"credentials\": {\n        \"telegramApi\": {\n          \"id\": \"2\",\n          \"name\": \"my bot\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Binary to json\",\n      \"type\": \"n8n-nodes-base.moveBinaryData\",\n      \"position\": [\n        800,\n        460\n      ],\n      \"parameters\": {\n        \"options\": {}\n      },\n      \"typeVersion\": 1,\n      \"alwaysOutputData\": true\n    },\n    {\n      \"name\": \"Json to binary\",\n      \"type\": \"n8n-nodes-base.moveBinaryData\",\n      \"position\": [\n        1480,\n        280\n      ],\n      \"parameters\": {\n        \"mode\": \"jsonToBinary\",\n        \"options\": {}\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Set new update time\",\n      \"type\": \"n8n-nodes-base.functionItem\",\n      \"position\": [\n        1280,\n        280\n      ],\n      \"parameters\": {\n        \"functionCode\": \"return {\\n  last_synced: new Date().getTime()\\n};\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Split into baches\",\n      \"type\": \"n8n-nodes-base.function\",\n      \"position\": [\n        1280,\n        460\n      ],\n      \"parameters\": {\n        \"functionCode\": \"const newValue = Object.values(items[0].json.documents).filter(it => it.category === 'article').filter(it => it.children.length === 0).map(it => ({\\n  json: {\\n      url: it.url,\\n  title: it.title,\\n  author: it.author,\\n  summary: it.summary,\\n  saved_at: new Date(it.saved_at),\\n  }\\n}))\\n\\n\\nreturn newValue;\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Cron\",\n      \"type\": \"n8n-nodes-base.cron\",\n      \"position\": [\n        340,\n        540\n      ],\n      \"parameters\": {\n        \"triggerTimes\": {\n          \"item\": [\n            {\n              \"mode\": \"everyX\",\n              \"unit\": \"minutes\",\n              \"value\": 10\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Config\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        800,\n        300\n      ],\n      \"parameters\": {\n        \"values\": {\n          \"number\": [\n            {\n              \"name\": \"Telegram chat it\",\n              \"value\": 19999\n            }\n          ],\n          \"string\": [\n            {\n              \"name\": \"file path\",\n              \"value\": \"/whatever/readwiseLastSynced.json\"\n            }\n          ]\n        },\n        \"options\": {}\n      },\n      \"typeVersion\": 1\n    }\n  ],\n  \"connections\": {\n    \"Cron\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Read Binary File\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"HTTP Request\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Split into baches\",\n            \"type\": \"main\",\n            \"index\": 0\n          },\n          {\n            \"node\": \"Set new update time\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Binary to json\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"HTTP Request\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Json to binary\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Write Binary File\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Read Binary File\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Binary to json\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Split into baches\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Telegram\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Set new update time\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Json to binary\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"On clicking 'execute'\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Read Binary File\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}",
  "metadata": {
    "node_types": [
      "n8n-nodes-base.manualTrigger",
      "n8n-nodes-base.writeBinaryFile",
      "n8n-nodes-base.readBinaryFile",
      "n8n-nodes-base.httpRequest",
      "n8n-nodes-base.telegram",
      "n8n-nodes-base.moveBinaryData",
      "n8n-nodes-base.moveBinaryData",
      "n8n-nodes-base.functionItem",
      "n8n-nodes-base.function",
      "n8n-nodes-base.cron",
      "n8n-nodes-base.set"
    ],
    "trigger": null
  }
}