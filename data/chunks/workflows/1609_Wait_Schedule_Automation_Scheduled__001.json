{
  "source": "1609_Wait_Schedule_Automation_Scheduled.json",
  "index": 1,
  "content": "{\n  \"id\": \"QCbb7Bm12gDIH0mI\",\n  \"meta\": {\n    \"instanceId\": \"d189560122cb823898b8eca8996614abf14798d923f2ff7c4d7220fb10f8e6f7\",\n    \"templateCredsSetupCompleted\": true\n  },\n  \"name\": \"Keep discord clean\",\n  \"tags\": [\n    {\n      \"id\": \"CgBu2Sxr4mqipxlK\",\n      \"name\": \"template\",\n      \"createdAt\": \"2025-01-08T19:56:24.079Z\",\n      \"updatedAt\": \"2025-01-08T19:56:24.079Z\"\n    }\n  ],\n  \"nodes\": [\n    {\n      \"id\": \"dde530b8-edd5-4f1d-a3c8-326925c97269\",\n      \"name\": \"Loop Over Channels\",\n      \"type\": \"n8n-nodes-base.splitInBatches\",\n      \"position\": [\n        560,\n        400\n      ],\n      \"parameters\": {\n        \"options\": {}\n      },\n      \"retryOnFail\": false,\n      \"typeVersion\": 3\n    },\n    {\n      \"id\": \"3e2684b1-08ad-41bd-930f-cbb229e16617\",\n      \"name\": \"Loop Over Messages\",\n      \"type\": \"n8n-nodes-base.splitInBatches\",\n      \"position\": [\n        1260,\n        320\n      ],\n      \"parameters\": {\n        \"options\": {}\n      },\n      \"typeVersion\": 3\n    },\n    {\n      \"id\": \"430d13be-670f-4e5d-acdf-ffe1a65a49e3\",\n      \"name\": \"Every day at 9pm\",\n      \"type\": \"n8n-nodes-base.scheduleTrigger\",\n      \"position\": [\n        -160,\n        400\n      ],\n      \"parameters\": {\n        \"rule\": {\n          \"interval\": [\n            {\n              \"triggerAtHour\": 21\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 1.2\n    },\n    {\n      \"id\": \"6d40f036-c87a-4b68-9ec6-523a3372447c\",\n      \"name\": \"Sticky Note2\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        40,\n        600\n      ],\n      \"parameters\": {\n        \"color\": 6,\n        \"width\": 294,\n        \"height\": 80,\n        \"content\": \"**Note ‚òùÔ∏è**\\nDon‚Äôt forget to setup an error workflow to get notified if something goes wrong\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"93290300-084b-4f91-95bc-f34c1aef93cd\",\n      \"name\": \"Sticky Note\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        420,\n        -60\n      ],\n      \"parameters\": {\n        \"color\": 5,\n        \"width\": 327,\n        \"height\": 152,\n        \"content\": \"### üë®‚Äçüé§ Setup\\n1. Add your **Discord** credentials\\n2. Change the server in each **Discord** node to the correct one\\n3. Click the Test Workflow button\\n3. Activate the workflow to run on a schedule\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"5fead80a-de3a-4f45-a524-5228def7b4ad\",\n      \"name\": \"Cool down Discord API rate limits\",\n      \"type\": \"n8n-nodes-base.wait\",\n      \"position\": [\n        280,\n        400\n      ],\n      \"webhookId\": \"cea120e2-5bb9-45cf-83e6-55fd458d6cf4\",\n      \"parameters\": {\n        \"amount\": 2\n      },\n      \"typeVersion\": 1.1\n    },\n    {\n      \"id\": \"5a8d6402-458c-4c24-b379-6a41908a5af3\",\n      \"name\": \"Get all Discord channels\",\n      \"type\": \"n8n-nodes-base.discord\",\n      \"position\": [\n        40,\n        400\n      ],\n      \"webhookId\": \"a77d1495-df40-4afd-ad0a-8f5b851b16da\",\n      \"parameters\": {\n        \"guildId\": {\n          \"__rl\": true,\n          \"mode\": \"id\",\n          \"value\": \"\"\n        },\n        \"options\": {\n          \"filter\": [\n            0,\n            2\n          ]\n        },\n        \"operation\": \"getAll\",\n        \"returnAll\": true\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"a2b1d905-849d-4392-95db-e545f542ba78\",\n      \"name\": \"Cool down Message deletion API rate limits\",\n      \"type\": \"n8n-nodes-base.wait\",\n      \"position\": [\n        1680,\n        340\n      ],\n      \"webhookId\": \"fcd9f62a-f08b-44bc-afa3-87d960fdc380\",\n      \"parameters\": {\n        \"amount\": 1\n      },\n      \"typeVersion\": 1.1\n    },\n    {\n      \"id\": \"8c134cfe-dcb1-400d-a518-17ed3f1cbf62\",\n      \"name\": \"Cool down Get messages API rate limits\",\n      \"type\": \"n8n-nodes-base.wait\",\n      \"position\": [\n        1000,\n        480\n      ],\n      \"webhookId\": \"5d8de5eb-8445-4a64-8b8b-8577ffa52ef0\",\n      \"parameters\": {\n        \"amount\": 2\n      },\n      \"typeVersion\": 1.1\n    },\n    {\n      \"id\": \"18ba10df-dcec-4d27-8ecf-06171939b7eb\",\n      \"name\": \"Get messages from Channel\",\n      \"type\": \"n8n-nodes-base.discord\",\n      \"onError\": \"continueRegularOutput\",\n      \"position\": [\n        800,\n        480\n      ],\n      \"webhookId\": \"b36f85bb-1237-415d-81bb-598703d3d4cd\",\n      \"parameters\": {\n        \"guildId\": {\n          \"__rl\": true,\n          \"mode\": \"id\",\n          \"value\": \"\"\n        },\n        \"options\": {},\n        \"resource\": \"message\",\n        \"channelId\": {\n          \"__rl\": true,\n          \"mode\": \"id\",\n          \"value\": \"={{ $json.id }}\"\n        },\n        \"operation\": \"getAll\",\n        \"returnAll\": true\n      },\n      \"retryOnFail\": false,\n      \"typeVersion\": 2,\n      \"alwaysOutputData\": true,\n      \"waitBetweenTries\": 5000\n    },\n    {\n      \"id\": \"57f2395a-b624-41d3-aada-4107b21a3359\",\n      \"name\": \"Delete Message\",\n      \"type\": \"n8n-nodes-base.discord\",\n      \"onError\": \"continueRegularOutput\",\n      \"position\": [\n        1500,\n        340\n      ],\n      \"webhookId\": \"4b43cc2e-59db-46c9-ae4c-9716146c25bf\",\n      \"parameters\": {\n        \"guildId\": {\n          \"__rl\": true,\n          \"mode\": \"id\",\n          \"value\": \"\"\n        },\n        \"resource\": \"message\",\n        \"channelId\": {\n          \"__rl\": true,\n          \"mode\": \"id\",\n          \"value\": \"={{ $json.channel_id }}\"\n        },\n        \"messageId\": \"={{ $json.id }}\",\n        \"operation\": \"deleteMessage\"\n      },\n      \"retryOnFail\": false,\n      \"typeVersion\": 2,\n      \"alwaysOutputData\": true,\n      \"waitBetweenTries\": 5000\n    },\n    {\n      \"id\": \"c224ef25-57d8-4fe6-b14a-b09131ce8c1c\",\n      \"name\": \"Filter Messages older than 7 days\",\n      \"type\": \"n8n-nodes-base.filter\",\n      \"position\": [\n        1000,\n        320\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"conditions\": {\n          \"options\": {\n            \"version\": 2,\n            \"leftValue\": \"\",\n            \"caseSensitive\": true,\n            \"typeValidation\": \"strict\"\n          },\n          \"combinator\": \"and\",\n          \"conditions\": [\n            {\n              \"id\": \"2864fc65-1d9d-433f-bd61-766278a7e54c\",\n              \"operator\": {\n                \"type\": \"dateTime\",\n                \"operation\": \"exists\",\n                \"singleValue\": true\n              },\n              \"leftValue\": \"={{ $json.timestamp }}\",\n              \"rightValue\": \"\"\n            },\n            {\n              \"id\": \"a05636ea-8663-4398-8a55-a03ab34f83a5\",\n              \"operator\": {\n                \"type\": \"dateTime\",\n                \"operation\": \"before\"\n              },\n              \"leftValue\": \"={{ $json.timestamp }}\",\n              \"rightValue\": \"={{ $today.minus({days: 7}) }}\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 2.2\n    },\n    {\n      \"id\": \"c3654c25-6318-4652-9f76-82770cc28324\",\n      \"name\": \"Sticky Note3\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        40,\n        300\n      ],\n      \"parameters\": {\n        \"color\": 6,\n        \"width\": 194,\n        \"height\": 80,\n        \"content\": \"**Tip üëá**\\nOAuth2 Authentication is very easy to setup\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"f3d8b35e-6b13-4df9-bd33-2d44381e6fc5\",\n      \"name\": \"Sticky Note1\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -200,\n        -60\n      ],\n      \"parameters\": {\n        \"color\": 4,\n        \"width\": 600,\n        \"height\": 280,\n        \"content\": \"# Nightly Discord Channel Cleanup\\n### This workflow runs every day at 9:00 p.m. and:\\n- Retrieves all Discord channels using your provided credentials.\\n- Pauses briefly to respect Discord API rate limits.\\n- Loops through each channel and fetches messages.\\n- Filters out messages older than seven days.\\n- Deletes those older messages, again pausing to stay within deletion rate limits.\\n\\nBy setting up this workflow on a schedule, you can automatically keep Discord channels tidy and compliant with retention policies.\"\n      },\n      \"typeVersion\": 1\n    }\n  ],\n  \"active\": false,\n  \"pinData\": {},\n  \"settings\": {\n    \"callerPolicy\": \"workflowsFromSameOwner\",\n    \"errorWorkflow\": \"C3NlThVZU7vFr4Um\",\n    \"executionOrder\": \"v1\",\n    \"saveManualExecutions\": true\n  },\n  \"versionId\": \"a4b9f5d2-d905-4c86-9fa6-2a274909ecce\",\n  \"connections\": {\n    \"Delete Message\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Cool down Message deletion API rate limits\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Every day at 9pm\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Get all Discord channels\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Loop Over Channels\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Filter Messages older than 7 days\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Get messages from Channel\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Loop Over Messages\": {\n      \"main\": [\n        [],\n        [\n          {\n            \"node\": \"Delete Message\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Get all Discord channels\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Cool down Discord API rate limits\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Get messages from Channel\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Cool down Get messages API rate limits\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Cool down Discord API rate limits\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Loop Over Channels\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Filter Messages older than 7 days\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Loop Over Messages\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Cool down Get messages API rate limits\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Loop Over Channels\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Cool down Message deletion API rate limits\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Loop Over Messages\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}",
  "metadata": {
    "node_types": [
      "n8n-nodes-base.splitInBatches",
      "n8n-nodes-base.splitInBatches",
      "n8n-nodes-base.scheduleTrigger",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.wait",
      "n8n-nodes-base.discord",
      "n8n-nodes-base.wait",
      "n8n-nodes-base.wait",
      "n8n-nodes-base.discord",
      "n8n-nodes-base.discord",
      "n8n-nodes-base.filter",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote"
    ],
    "trigger": null
  }
}