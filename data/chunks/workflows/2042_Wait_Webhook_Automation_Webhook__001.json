{
  "source": "2042_Wait_Webhook_Automation_Webhook.json",
  "index": 1,
  "content": "{\n  \"id\": \"OvuZIXwt9mdU2JGK\",\n  \"meta\": {\n    \"instanceId\": \"fb924c73af8f703905bc09c9ee8076f48c17b596ed05b18c0ff86915ef8a7c4a\",\n    \"templateCredsSetupCompleted\": true\n  },\n  \"name\": \"FLUX-fill standalone\",\n  \"tags\": [],\n  \"nodes\": [\n    {\n      \"id\": \"9f051c89-0243-48fb-baa4-666af3fe54b3\",\n      \"name\": \"Merge\",\n      \"type\": \"n8n-nodes-base.merge\",\n      \"position\": [\n        940,\n        120\n      ],\n      \"parameters\": {\n        \"mode\": \"combine\",\n        \"options\": {},\n        \"combineBy\": \"combineByPosition\"\n      },\n      \"typeVersion\": 3\n    },\n    {\n      \"id\": \"5da963f7-4320-4359-aefa-bf8f6d6ef815\",\n      \"name\": \"Respond to Webhook\",\n      \"type\": \"n8n-nodes-base.respondToWebhook\",\n      \"position\": [\n        1520,\n        120\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"respondWith\": \"text\",\n        \"responseBody\": \"={{ $json.html }}\"\n      },\n      \"typeVersion\": 1.1\n    },\n    {\n      \"id\": \"05d877bc-b591-478c-b112-32b7efe1ca3f\",\n      \"name\": \"Wait 3 sec\",\n      \"type\": \"n8n-nodes-base.wait\",\n      \"position\": [\n        920,\n        680\n      ],\n      \"webhookId\": \"90f31c1f-6707-4f2f-b525-d3961432cd81\",\n      \"parameters\": {\n        \"amount\": 3\n      },\n      \"typeVersion\": 1.1\n    },\n    {\n      \"id\": \"a3cc4a50-4218-4a01-ab20-151fd707dd66\",\n      \"name\": \"Is Ready?\",\n      \"type\": \"n8n-nodes-base.if\",\n      \"position\": [\n        1340,\n        680\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"conditions\": {\n          \"options\": {\n            \"version\": 2,\n            \"leftValue\": \"\",\n            \"caseSensitive\": true,\n            \"typeValidation\": \"strict\"\n          },\n          \"combinator\": \"and\",\n          \"conditions\": [\n            {\n              \"id\": \"3cf5b451-9ff5-4c2a-864f-9aa7d286871a\",\n              \"operator\": {\n                \"name\": \"filter.operator.equals\",\n                \"type\": \"string\",\n                \"operation\": \"equals\"\n              },\n              \"leftValue\": \"={{ $json.status }}\",\n              \"rightValue\": \"Ready\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 2.2\n    },\n    {\n      \"id\": \"76a2dcd4-0e57-461d-a8b9-8f52baa3f86a\",\n      \"name\": \"Sticky Note\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        520,\n        -100\n      ],\n      \"parameters\": {\n        \"width\": 1193,\n        \"height\": 479,\n        \"content\": \"# Deliver the editor with links to the images\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"b32e8e0b-a449-47d9-8de4-c0062235ff99\",\n      \"name\": \"FLUX Fill\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        660,\n        680\n      ],\n      \"parameters\": {\n        \"url\": \"https://api.bfl.ml/v1/flux-pro-1.0-fill\",\n        \"method\": \"POST\",\n        \"options\": {},\n        \"sendBody\": true,\n        \"authentication\": \"genericCredentialType\",\n        \"bodyParameters\": {\n          \"parameters\": [\n            {\n              \"name\": \"prompt\",\n              \"value\": \"={{ $json.body.prompt }}\"\n            },\n            {\n              \"name\": \"steps\",\n              \"value\": \"={{ $json.body.steps }}\"\n            },\n            {\n              \"name\": \"prompt_upsampling\",\n              \"value\": \"={{ $json.body.prompt_upsampling }}\"\n            },\n            {\n              \"name\": \"guidance\",\n              \"value\": \"={{ $json.body.guidance }}\"\n            },\n            {\n              \"name\": \"output_format\",\n              \"value\": \"png\"\n            },\n            {\n              \"name\": \"safety_tolerance\",\n              \"value\": \"6\"\n            },\n            {\n              \"name\": \"image\",\n              \"value\": \"={{ $json.body.image.split(',')[1] }}\"\n            },\n            {\n              \"name\": \"mask\",\n              \"value\": \"={{ $json.body.mask.split(',')[1] }}\"\n            }\n          ]\n        },\n        \"genericAuthType\": \"httpHeaderAuth\"\n      },\n      \"credentials\": {\n        \"httpHeaderAuth\": {\n          \"id\": \"4eQN9wBw8SniKcPw\",\n          \"name\": \"bfl-FLUX\"\n        }\n      },\n      \"typeVersion\": 4.2\n    },\n    {\n      \"id\": \"d7d70191-5316-4f20-b570-b8f138b77762\",\n      \"name\": \"Check FLUX status\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        1120,\n        680\n      ],\n      \"parameters\": {\n        \"url\": \"https://api.bfl.ml/v1/get_result\",\n        \"options\": {},\n        \"sendQuery\": true,\n        \"authentication\": \"genericCredentialType\",\n        \"genericAuthType\": \"httpHeaderAuth\",\n        \"queryParameters\": {\n          \"parameters\": [\n            {\n              \"name\": \"id\",\n              \"value\": \"={{ $json.id }}\"\n            }\n          ]\n        }\n      },\n      \"credentials\": {\n        \"httpHeaderAuth\": {\n          \"id\": \"4eQN9wBw8SniKcPw\",\n          \"name\": \"bfl-FLUX\"\n        }\n      },\n      \"typeVersion\": 4.2\n    },\n    {\n      \"id\": \"dafc2712-114f-4723-b587-08ff853513f5\",\n      \"name\": \"Get Fill Image\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        1560,\n        780\n      ],\n      \"parameters\": {\n        \"url\": \"={{ $json.result.sample }}\",\n        \"options\": {}\n      },\n      \"typeVersion\": 4.2\n    },\n    {\n      \"id\": \"68672890-62c3-4020-a09c-9ea691cba361\",\n      \"name\": \"Show the image to user\",\n      \"type\": \"n8n-nodes-base.respondToWebhook\",\n      \"position\": [\n        1900,\n        780\n      ],\n      \"parameters\": {\n        \"options\": {\n          \"responseHeaders\": {\n            \"entries\": [\n              {\n                \"name\": \"Content-Type\",\n                \"value\": \"={{ $binary.data.mimeType }}\"\n              }\n            ]\n          }\n        },\n        \"respondWith\": \"binary\",\n        \"responseDataSource\": \"set\"\n      },\n      \"typeVersion\": 1.1\n    },\n    {\n      \"id\": \"7546ce49-56e9-44fd-96fd-324831f38f32\",\n      \"name\": \"Sticky Note1\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        560,\n        420\n      ],\n      \"parameters\": {\n        \"color\": 4,\n        \"width\": 1142,\n        \"height\": 502,\n        \"content\": \"# Image processing part\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"cee89c8c-7b88-4cc5-84e4-eb7b404e5042\",\n      \"name\": \"Sticky Note2\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        1720,\n        660\n      ],\n      \"parameters\": {\n        \"width\": 506,\n        \"height\": 272,\n        \"content\": \"# Send back edited image\\n## Add extra steps to save an edited image\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"a340cd78-56dd-4ac8-a1c1-f3fc03771ae6\",\n      \"name\": \"Mockups\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        660,\n        220\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"20c39c67-3cf8-4e29-b871-3202f2e20a3c\",\n              \"name\": \"Images\",\n              \"type\": \"array\",\n              \"value\": \"={{\\n[\\n{\\\"url\\\":\\\"https://byuroscope.fra1.digitaloceanspaces.com/nc/uploads/noco/fluxtest/creative-arrangement-minimalist-podium_23-2148959328.jpg\\\",\\n \\\"title\\\":\\\"Stage\\\" },\\n{\\\"url\\\":\\\"https://byuroscope.fra1.digitaloceanspaces.com/nc/uploads/noco/fluxtest/Standing-Big-Paper-Bag-Mockup.jpg\\\",\\n \\\"title\\\":\\\"Paper Bag\\\" },\\n{\\\"url\\\":\\\"https://byuroscope.fra1.digitaloceanspaces.com/nc/uploads/noco/fluxtest/Ceramic-Mug-on-Table-Mockup.jpg\\\",\\n \\\"title\\\":\\\"Big Mug\\\" },\\n{\\\"url\\\":\\\"https://byuroscope.fra1.digitaloceanspaces.com/nc/uploads/noco/fluxtest/Transparent-Bottle-on-Sunny-Beach-Mockup-D.jpg\\\",\\n \\\"title\\\":\\\"Transparent-Bottle\\\" },\\n{\\\"url\\\":\\\"https://byuroscope.fra1.digitaloceanspaces.com/nc/uploads/noco/fluxtest/skin-products-arrangement-wooden-blocks_23-2148761445.jpg\\\",\\n \\\"title\\\":\\\"Cosmetics\\\" }\\n]\\n}}\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 3.4\n    },\n    {\n      \"id\": \"da82cb73-af4a-4042-bf4e-17894155fb87\",\n      \"name\": \"Webhook\",\n      \"type\": \"n8n-nodes-base.webhook\",\n      \"position\": [\n        260,\n        120\n      ],\n      \"webhookId\": \"9c864ee6-e4d3-46e7-98d4-bea43739963e\",\n      \"parameters\": {\n        \"path\": \"flux-fill\",\n        \"options\": {},\n        \"responseMode\": \"responseNode\",\n        \"multipleMethods\": true\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"0f35da2f-112c-45f9-9cbe-d64eb8bdc6d8\",\n      \"name\": \"Editor page\",\n      \"type\": \"n8n-nodes-base.html\",\n      \"position\": [\n        1240,\n        120\n      ],\n      \"parameters\": {\n        \"html\": \"<!DOCTYPE html>\\n<html lang=\\\"en\\\">\\n<head>\\n <meta charset=\\\"UTF-8\\\">\\n <meta name=\\\"viewport\\\" content=\\\"width=device-width, initial-scale=1.0\\\">\\n <title>Konva Image Editor</title>\\n <script src=\\\"https://unpkg.com/konva@9/konva.min.js\\\"></script>\\n <script defer src=\\\"https://unpkg.com/img-comparison-slider@8/dist/index.js\\\"></script>\\n <link rel=\\\"stylesheet\\\" href=\\\"https://unpkg.com/img-comparison-slider@8/dist/styles.css\\\" />\\n <link rel=\\\"stylesheet\\\" href=\\\"https://cdn.jsdelivr.net/gh/ed-parsadanyan/n8n-flux-fill-demo/flux-fill-style.css\\\" />\\n <script src=\\\"https://cdn.jsdelivr.net/gh/ed-parsadanyan/n8n-flux-fill-demo/flux-fill-canvas.js\\\"></script>\\n</head>\\n<body>\\n <div class=\\\"controls-wrapper\\\">\\n <div class=\\\"left-panel\\\">\\n <div class=\\\"image-controls\\\">\\n <select id=\\\"imageSelector\\\">\\n <option value=\\\"\\\">Select an image...</option>\\n <option value=\\\"local\\\">Load from PC...</option>\\n </select>\\n <input type=\\\"file\\\" id=\\\"fileInput\\\" style=\\\"display: none\\\" accept=\\\"image/*\\\">\\n <button id=\\\"clearButton\\\">Clear All</button>\\n </div>\\n \\n <div class=\\\"brush-controls\\\">\\n <label for=\\\"brushSize\\\" title=\\\"Use mouse wheel to adjust brush size\\\">Brush Size:</label>\\n <div class=\\\"slider-container\\\">\\n <input type=\\\"range\\\" id=\\\"brushSize\\\" min=\\\"5\\\" max=\\\"40\\\" value=\\\"20\\\">\\n <span class=\\\"slider-value\\\" id=\\\"brushSizeValue\\\">20px</span>\\n </div>\\n </div>\\n </div>\\n\\n <div class=\\\"right-panel\\\">\\n <div class=\\\"prompt-row\\\">\\n <input type=\\\"text\\\" id=\\\"promptInput\\\" placeholder=\\\"Enter your prompt (optional)\\\">\\n </div>\\n \\n <div class=\\\"main-controls\\\">\\n <label class=\\\"checkbox-container\\\">\\n <input type=\\\"checkbox\\\" id=\\\"improvePrompt\\\" checked>\\n <span>Improve prompt</span>\\n </label>\\n \\n <div>\\n <button id=\\\"sendButton\\\">Generate</button>\\n <span class=\\\"loading\\\" id=\\\"loadingIndicator\\\">Processing...</span>\\n </div>\\n </div>\\n \\n <div class=\\\"parameters\\\">\\n <div class=\\\"slider-container\\\">\\n <label for=\\\"stepsSlider\\\">Steps:</label>\\n <input type=\\\"range\\\" id=\\\"stepsSlider\\\" min=\\\"15\\\" max=\\\"50\\\" value=\\\"40\\\">\\n <span class=\\\"slider-value\\\" id=\\\"stepsValue\\\">40</span>\\n </div>\\n \\n <div class=\\\"slider-container\\\">\\n <label for=\\\"guidanceSlider\\\">Guidance:</label>\\n <input type=\\\"range\\\" id=\\\"guidanceSlider\\\" min=\\\"1.5\\\" max=\\\"100\\\" value=\\\"60\\\" step=\\\"0.1\\\">\\n <span class=\\\"slider-value\\\" id=\\\"guidanceValue\\\">60.0</span>\\n </div>\\n </div>\\n </div>\\n </div>\\n\\n <div class=\\\"info\\\" id=\\\"imageInfo\\\"></div>\\n <div id=\\\"container\\\"></div>\\n <div id=\\\"cursor\\\"></div>\\n\\n <div id=\\\"resultModal\\\" class=\\\"modal\\\">\\n <div class=\\\"modal-content\\\">\\n <div class=\\\"modal-image-container\\\">\\n <div class=\\\"comparison-container\\\">\\n <div class=\\\"image-container\\\">\\n <img class=\\\"image-before\\\" id=\\\"originalImage\\\" src=\\\"\\\" alt=\\\"Original\\\">\\n <img class=\\\"image-after\\\" id=\\\"resultImage\\\" src=\\\"\\\" alt=\\\"Generated\\\">\\n </div>\\n <input type=\\\"range\\\" min=\\\"0\\\" max=\\\"100\\\" value=\\\"10\\\" class=\\\"slider\\\">\\n <div class=\\\"slider-line\\\"></div>\\n <div class=\\\"slider-button\\\" aria-hidden=\\\"true\\\">\\n &lt; &gt;\\n </div>\\n <div class=\\\"labels\\\">\\n <div class=\\\"label-before\\\">Original</div>\\n <div class=\\\"label-after\\\">Generated</div>\\n </div>\\n </div>\\n </div>\\n <div class=\\\"modal-buttons\\\">\\n <button id=\\\"reuseButton\\\">Use Generated</button>\\n <button id=\\\"saveButton\\\">Save Image</button>\\n <button id=\\\"closeButton\\\">Close</button>\\n </div>\\n </div>\\n </div>\\n\\n<script>\\n const urlParams = new URLSearchParams(window.location.search);\\n const pageId = urlParams.get('id');\\n\\n // Image data will be populated by n8n\\n const imageData = {{ JSON.stringify($json.Images,'',2) }};\\n const webhookUrl = '{{ $json.webhookUrl }}';\\n\\n // Initialize the editor when the page loads\\n document.addEventListener('DOMContentLoaded', function() {\\n initializeEditor({\\n images: imageData,\\n webhookUrl: webhookUrl,\\n pageId: pageId\\n });\\n });\\n</script>\\n</body>\\n</html>\\n\"\n      },\n      \"typeVersion\": 1.2\n    },\n    {\n      \"id\": \"2ff87261-8a7f-451e-b8ae-b4274776ce28\",\n      \"name\": \"Sticky Note3\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        540,\n        20\n      ],\n      \"parameters\": {\n        \"color\": 5,\n        \"width\": 360,\n        \"height\": 340,\n        \"content\": \"## Image array\\n* Load from PC\\n* Select one of the default images\\n\\n### Change this node to\\n### get image URLs from your data source\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"08bb17fd-1440-4194-8c4f-e18222a68bf2\",\n      \"name\": \"Sticky Note4\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        1080,\n        -20\n      ],\n      \"parameters\": {\n        \"color\": 5,\n        \"width\": 400,\n        \"height\": 300,\n        \"content\": \"## HTML code of the editor\\n* Konva.js\\n* img-comparison-slider to compare edits vs original file\\n* Additional css + js files for the editor logic\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"13a820d0-e83b-4d1e-81d1-738ef8ca4d47\",\n      \"name\": \"Sticky Note5\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        580,\n        500\n      ],\n      \"parameters\": {\n        \"color\": 5,\n        \"width\": 280,\n        \"height\": 340,\n        \"content\": \"## Call FLUX-Fill Tool\\nPass the following data:\\n* original image\\n* alpha mask from the editor\\n* text prompt\\n* additional settings\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"f4ab042c-d4da-4f1e-aa05-fdd2cca62d66\",\n      \"name\": \"NO OP\",\n      \"type\": \"n8n-nodes-base.noOp\",\n      \"position\": [\n        420,\n        680\n      ],\n      \"parameters\": {},\n      \"typeVersion\": 1\n    }\n  ],\n  \"active\": true,\n  \"pinData\": {\n    \"Webhook\": []\n  },\n  \"settings\": {\n    \"callerPolicy\": \"workflowsFromSameOwner\",\n    \"executionOrder\": \"v1\",\n    \"executionTimeout\": 120,\n    \"saveDataSuccessExecution\": \"all\"\n  },\n  \"versionId\": \"6d4112be-fb6f-4702-ac5f-2c49ff0117d4\",\n  \"connections\": {\n    \"Merge\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Editor page\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"NO OP\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"FLUX Fill\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Mockups\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Merge\",\n            \"type\": \"main\",\n            \"index\": 1\n          }\n        ]\n      ]\n    },\n    \"Webhook\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Merge\",\n            \"type\": \"main\",\n            \"index\": 0\n          },\n          {\n            \"node\": \"Mockups\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"NO OP\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"FLUX Fill\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Wait 3 sec\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Is Ready?\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Get Fill Image\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Wait 3 sec\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Wait 3 sec\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Check FLUX status\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Editor page\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Respond to Webhook\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Get Fill Image\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Show the image to user\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Check FLUX status\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Is Ready?\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}",
  "metadata": {
    "node_types": [
      "n8n-nodes-base.merge",
      "n8n-nodes-base.respondToWebhook",
      "n8n-nodes-base.wait",
      "n8n-nodes-base.if",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.httpRequest",
      "n8n-nodes-base.httpRequest",
      "n8n-nodes-base.httpRequest",
      "n8n-nodes-base.respondToWebhook",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.set",
      "n8n-nodes-base.webhook",
      "n8n-nodes-base.html",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.noOp"
    ],
    "trigger": null
  }
}