{
  "source": "0386_Splitout_Filter_Update_Scheduled.json",
  "index": 1,
  "content": "{\n  \"meta\": {\n    \"instanceId\": \"dbd43d88d26a9e30d8aadc002c9e77f1400c683dd34efe3778d43d27250dde50\"\n  },\n  \"nodes\": [\n    {\n      \"id\": \"6d80ce75-833e-4565-9b03-0280e29d5b47\",\n      \"name\": \"Split Out\",\n      \"type\": \"n8n-nodes-base.splitOut\",\n      \"notes\": \"Format response\",\n      \"position\": [\n        920,\n        600\n      ],\n      \"parameters\": {\n        \"options\": {\n          \"destinationFieldName\": \"Transfers\"\n        },\n        \"fieldToSplitOut\": \"token_transfers\"\n      },\n      \"notesInFlow\": true,\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"a6a299cf-4c43-46c1-98a8-e4ce6cd3ca48\",\n      \"name\": \"Edit Fields\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"notes\": \"Wallet Config\",\n      \"position\": [\n        640,\n        600\n      ],\n      \"parameters\": {\n        \"fields\": {\n          \"values\": [\n            {\n              \"name\": \"Your Wallet Address\",\n              \"stringValue\": \"<Your TRC20 Wallet Address here>\"\n            },\n            {\n              \"name\": \"Number of transactions to retrieve per request\",\n              \"type\": \"numberValue\",\n              \"numberValue\": \"20\"\n            }\n          ]\n        },\n        \"options\": {}\n      },\n      \"notesInFlow\": true,\n      \"typeVersion\": 3.2\n    },\n    {\n      \"id\": \"e4e91632-bccb-468f-bbb4-a918a5815bbe\",\n      \"name\": \"Filter\",\n      \"type\": \"n8n-nodes-base.filter\",\n      \"notes\": \"Received in last 15m only\",\n      \"position\": [\n        1060,\n        600\n      ],\n      \"parameters\": {\n        \"conditions\": {\n          \"number\": [\n            {\n              \"value1\": \"={{ $json.Transfers.block_ts }}\",\n              \"value2\": \"={{ Date.now() - 900000 }}\",\n              \"operation\": \"smallerEqual\"\n            }\n          ],\n          \"string\": [\n            {\n              \"value1\": \"={{ $json.Transfers.to_address }}\",\n              \"value2\": \"={{ $('Edit Fields').item.json['Your Wallet Address'] }}\",\n              \"operation\": \"regex\"\n            }\n          ]\n        }\n      },\n      \"notesInFlow\": true,\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"1f9f2f52-bbbe-4d4c-a309-64424f9392c0\",\n      \"name\": \"Sticky Note\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        460,\n        460\n      ],\n      \"parameters\": {\n        \"color\": 4,\n        \"width\": 1120.1887804878038,\n        \"height\": 353.65439024390236,\n        \"content\": \"## USDT TRC20 Wallet Tracker\\n**This workflow** Is a basic concept of integrating your TRC20 wallet with n8n nodes.\\n\\n\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"31c8c3db-8f48-4cd7-ae1b-9caf579ebb9b\",\n      \"name\": \"TronScan API\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"notes\": \"Request Wallet Status\",\n      \"position\": [\n        780,\n        600\n      ],\n      \"parameters\": {\n        \"url\": \"https://apilist.tronscanapi.com/api/filter/trc20/transfers\",\n        \"options\": {\n          \"timeout\": 10000,\n          \"redirect\": {\n            \"redirect\": {}\n          },\n          \"allowUnauthorizedCerts\": true\n        },\n        \"sendQuery\": true,\n        \"sendHeaders\": true,\n        \"queryParameters\": {\n          \"parameters\": [\n            {\n              \"name\": \"limit\",\n              \"value\": \"={{ $json['Number of transactions to retrieve'] | '20' }}\"\n            },\n            {\n              \"name\": \"start\",\n              \"value\": \"0\"\n            },\n            {\n              \"name\": \"sort\",\n              \"value\": \"-timestamp\"\n            },\n            {\n              \"name\": \"count\",\n              \"value\": \"true\"\n            },\n            {\n              \"name\": \"filterTokenValue\",\n              \"value\": \"0\"\n            },\n            {\n              \"name\": \"relatedAddress\",\n              \"value\": \"={{ $json['Your Wallet Address']}}\"\n            }\n          ]\n        },\n        \"headerParameters\": {\n          \"parameters\": [\n            {\n              \"name\": \"User-Agent\",\n              \"value\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:122.0) Gecko/20100101 Firefox/122.0\"\n            },\n            {\n              \"name\": \"Accept\",\n              \"value\": \"application/json, text/plain, */*\"\n            },\n            {\n              \"name\": \"Accept-Language\",\n              \"value\": \"en-US,en;q=0.5\"\n            },\n            {\n              \"name\": \"Accept-Encoding\",\n              \"value\": \"gzip, deflate, br\"\n            },\n            {\n              \"name\": \"Origin\",\n              \"value\": \"https://tronscan.org\"\n            },\n            {\n              \"name\": \"DNT\",\n              \"value\": \"1\"\n            },\n            {\n              \"name\": \"Connection\",\n              \"value\": \"keep-alive\"\n            },\n            {\n              \"name\": \"Referer\",\n              \"value\": \"https://tronscan.org/\"\n            },\n            {\n              \"name\": \"Sec-Fetch-Dest\",\n              \"value\": \"empty\"\n            },\n            {\n              \"name\": \"Sec-Fetch-Mode\",\n              \"value\": \"cors\"\n            },\n            {\n              \"name\": \"Sec-Fetch-Site\",\n              \"value\": \"cross-site\"\n            },\n            {\n              \"name\": \"Sec-GPC\",\n              \"value\": \"1\"\n            },\n            {\n              \"name\": \"Pragma\",\n              \"value\": \"no-cache\"\n            },\n            {\n              \"name\": \"Cache-Control\",\n              \"value\": \"no-cache\"\n            }\n          ]\n        }\n      },\n      \"notesInFlow\": true,\n      \"typeVersion\": 4.1\n    },\n    {\n      \"id\": \"d9e1df8b-0bd7-41c4-a4a9-5df909821534\",\n      \"name\": \"Final Results\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"notes\": \"Keep only required fields\",\n      \"position\": [\n        1220,\n        600\n      ],\n      \"parameters\": {\n        \"fields\": {\n          \"values\": [\n            {\n              \"name\": \"Coin\",\n              \"stringValue\": \"={{ $json.Transfers.tokenInfo.tokenName }} ({{ $json.Transfers.tokenInfo.tokenAbbr }})\"\n            },\n            {\n              \"name\": \"Network\",\n              \"stringValue\": \"={{ $json.Transfers.tokenInfo.tokenType }}\"\n            },\n            {\n              \"name\": \"From Address\",\n              \"stringValue\": \"={{ $json.Transfers.from_address.replace($('Edit Fields').item.json['Your Wallet Address'],\\\"Your Wallet Address\\\") || $json.Transfers.from_address_tag.from_address_tag }}\"\n            },\n            {\n              \"name\": \"To Address\",\n              \"stringValue\": \"={{ $json.Transfers.to_address.replace($('Edit Fields').item.json['Your Wallet Address'],\\\"Your Wallet Address\\\") }}\"\n            },\n            {\n              \"name\": \"Amount\",\n              \"stringValue\": \"={{ ($('Filter').item.json[\\\"Transfers\\\"][\\\"tokenInfo\\\"][\\\"tokenAbbr\\\"]+' ' + (($json.Transfers.trigger_info.parameter._value || $json.Transfers.quant) / Math.pow(10, $json.Transfers.tokenInfo.tokenDecimal)).toFixed(2)).replace('USDT ','\\\\$') }}\"\n            },\n            {\n              \"name\": \"Record Type\",\n              \"stringValue\": \"={{ $json.Transfers.event_type }}\"\n            },\n            {\n              \"name\": \"Record Status\",\n              \"stringValue\": \"={{ ($json.Transfers.confirmed+'').replace('true','Confirmed').replace('false','Not confirmed yet.') }}\"\n            },\n            {\n              \"name\": \"Transaction Result\",\n              \"stringValue\": \"={{ $json.Transfers.finalResult.replace('SUCCESS','Received') }}\"\n            },\n            {\n              \"name\": \"Record URL\",\n              \"stringValue\": \"=https://tronscan.org/#/transaction/{{ $json.Transfers.transaction_id }}\"\n            }\n          ]\n        },\n        \"include\": \"none\",\n        \"options\": {}\n      },\n      \"notesInFlow\": true,\n      \"typeVersion\": 3.2\n    },\n    {\n      \"id\": \"e6fcf3ba-ac81-49ce-86b5-a51df76dbf00\",\n      \"name\": \"Schedule Trigger\",\n      \"type\": \"n8n-nodes-base.scheduleTrigger\",\n      \"notes\": \"Run Every 15 minutes\",\n      \"position\": [\n        500,\n        600\n      ],\n      \"parameters\": {\n        \"rule\": {\n          \"interval\": [\n            {\n              \"field\": \"minutes\",\n              \"minutesInterval\": 15\n            }\n          ]\n        }\n      },\n      \"notesInFlow\": true,\n      \"typeVersion\": 1.1\n    },\n    {\n      \"id\": \"5149f131-a87e-40ed-88df-7fb0591fe31c\",\n      \"name\": \"Aggregate\",\n      \"type\": \"n8n-nodes-base.aggregate\",\n      \"notes\": \"Combine records into one list\",\n      \"position\": [\n        1400,\n        600\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"aggregate\": \"aggregateAllItemData\",\n        \"destinationFieldName\": \"Transactions\"\n      },\n      \"notesInFlow\": true,\n      \"typeVersion\": 1,\n      \"alwaysOutputData\": false\n    }\n  ],\n  \"pinData\": {},\n  \"connections\": {\n    \"Filter\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Final Results\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Split Out\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Filter\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Edit Fields\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"TronScan API\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"TronScan API\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Split Out\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Final Results\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Aggregate\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Schedule Trigger\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Edit Fields\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}",
  "metadata": {
    "node_types": [
      "n8n-nodes-base.splitOut",
      "n8n-nodes-base.set",
      "n8n-nodes-base.filter",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.httpRequest",
      "n8n-nodes-base.set",
      "n8n-nodes-base.scheduleTrigger",
      "n8n-nodes-base.aggregate"
    ],
    "trigger": "schedule trigger"
  }
}