{
  "source": "1403_Splitout_Datetime_Send_Webhook.json",
  "index": 1,
  "content": "{\n  \"id\": \"DNqCvzBvS7GAFWm4\",\n  \"meta\": {\n    \"instanceId\": \"d47f3738b860eed937a1b18d7345fa2c65cf4b4957554e29477cb064a7039870\",\n    \"templateCredsSetupCompleted\": true\n  },\n  \"name\": \"Send Emails from Obsidian\",\n  \"tags\": [],\n  \"nodes\": [\n    {\n      \"id\": \"9bd809d6-c270-4429-945d-1e519384acae\",\n      \"name\": \"Sticky Note\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -320,\n        20\n      ],\n      \"parameters\": {\n        \"width\": 395.06030313757196,\n        \"height\": 388.5681601162638,\n        \"content\": \"## Obsidian to Email Overview\\n\\nThis workflow allows you to send your Obsidian notes (including attachments) via email, with YAML metadata for customization.\\n\\n### Key Features:\\n- Trigger email sending through [Obsidian's Post Webhook plugin](https://github.com/Masterb1234/obsidian-post-webhook/).\\n- Parse YAML frontmatter for email metadata like recipients, subject, and more.\\n- Automatic handling of attachments (images/files) via base64 encoding.\\n- Append Webhook response automatically to the bottom of your note in Obsidian\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"bc2376ea-31db-43dc-84c4-7933bc7a96f8\",\n      \"name\": \"Sticky Note1\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -320,\n        439\n      ],\n      \"parameters\": {\n        \"color\": 3,\n        \"width\": 398.9156829431131,\n        \"height\": 447.41755555994735,\n        \"content\": \"## YAML Frontmatter Example\\n\\nUse YAML frontmatter in your Obsidian notes to define key email details such as recipients, subject, and more.\\n\\n### Example YAML:\\n```yaml\\n---\\nto: \\\"recipient@example.com\\\"\\ncc: \\\"cc@example.com\\\"\\nbcc: \\\"bcc@example.com\\\"\\nsubject: \\\"Your Obsidian Note\\\"\\nsender-name: \\\"Your Name\\\"\\nsend-replies-to: \\\"replies@example.com\\\"\\n---\\nNote content goes here...\\n\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"1e439841-cc53-4913-b23b-040746bab5ec\",\n      \"name\": \"Check if attachments exist\",\n      \"type\": \"n8n-nodes-base.if\",\n      \"position\": [\n        340,\n        380\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"conditions\": {\n          \"options\": {\n            \"version\": 2,\n            \"leftValue\": \"\",\n            \"caseSensitive\": true,\n            \"typeValidation\": \"strict\"\n          },\n          \"combinator\": \"and\",\n          \"conditions\": [\n            {\n              \"id\": \"3d870306-d912-4582-960d-f031538a5045\",\n              \"operator\": {\n                \"type\": \"array\",\n                \"operation\": \"notEmpty\",\n                \"singleValue\": true\n              },\n              \"leftValue\": \"={{ $json.body.attachments }}\",\n              \"rightValue\": \"\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 2.2\n    },\n    {\n      \"id\": \"39cf3ab8-47be-4153-afb8-a1a68c7c04f6\",\n      \"name\": \"Separate attachment data\",\n      \"type\": \"n8n-nodes-base.splitOut\",\n      \"position\": [\n        600,\n        220\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"fieldToSplitOut\": \"body.attachments\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"f4b75a54-2cd8-4f6c-afd8-486fea552f00\",\n      \"name\": \"Sticky Note3\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        540,\n        20\n      ],\n      \"parameters\": {\n        \"color\": 4,\n        \"width\": 493.7005132824585,\n        \"height\": 874.8910456745886,\n        \"content\": \"## Attachment Handling\\n\\nThe plugin automatically handles attachments in your Obsidian notes.\\n\\nThis workflow automates the processing of attachments by converting each attachment into a binary format.\\n\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"b5df08f3-c0a1-429a-a003-24c77fd00461\",\n      \"name\": \"Process Each Attachment\",\n      \"type\": \"n8n-nodes-base.splitInBatches\",\n      \"position\": [\n        600,\n        480\n      ],\n      \"parameters\": {\n        \"options\": {}\n      },\n      \"typeVersion\": 3\n    },\n    {\n      \"id\": \"220f49b2-9cf8-4395-ae8e-4167ac452954\",\n      \"name\": \"Convert Attachment to File\",\n      \"type\": \"n8n-nodes-base.convertToFile\",\n      \"position\": [\n        900,\n        580\n      ],\n      \"parameters\": {\n        \"options\": {\n          \"fileName\": \"={{ $json.name }}\"\n        },\n        \"operation\": \"toBinary\",\n        \"sourceProperty\": \"data\"\n      },\n      \"typeVersion\": 1.1\n    },\n    {\n      \"id\": \"7e5c643f-4545-47b1-91cb-c306900f7842\",\n      \"name\": \"Prepare Attachments for Email\",\n      \"type\": \"n8n-nodes-base.aggregate\",\n      \"position\": [\n        900,\n        400\n      ],\n      \"parameters\": {\n        \"options\": {\n          \"includeBinaries\": true\n        },\n        \"fieldsToAggregate\": {\n          \"fieldToAggregate\": [\n            {\n              \"fieldToAggregate\": \"data\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"4fc9dffb-ad6b-4e7a-a814-3bb63189e4e7\",\n      \"name\": \"Email With Attachments\",\n      \"type\": \"n8n-nodes-base.gmail\",\n      \"position\": [\n        1100,\n        480\n      ],\n      \"webhookId\": \"479fab78-5e9c-4dc9-ac36-fb656222cae7\",\n      \"parameters\": {\n        \"sendTo\": \"={{ Array.isArray($('Webhook').item.json.body.to) ? $('Webhook').item.json.body.to.join('; ') : $('Webhook').item.json.body.to }}\",\n        \"message\": \"={{ $('Webhook').item.json.body.content }}\",\n        \"options\": {\n          \"ccList\": \"={{ $('Webhook').item.json.body.cc ?? '' }}\",\n          \"bccList\": \"={{ $('Webhook').item.json.body.bcc ?? '' }}\",\n          \"replyTo\": \"={{ $('Webhook').item.json.body['send-replies-to'] ?? '' }}\",\n          \"senderName\": \"={{ $('Webhook').item.json.body['sender-name'] ?? '' }}\",\n          \"attachmentsUi\": {\n            \"attachmentsBinary\": [\n              {\n                \"property\": \"={{ Object.keys($binary).join(',') }}\"\n              }\n            ]\n          },\n          \"appendAttribution\": false\n        },\n        \"subject\": \"={{ $('Webhook').item.json.body.subject }}\",\n        \"emailType\": \"text\"\n      },\n      \"credentials\": {\n        \"gmailOAuth2\": {\n          \"id\": \"ZrIpZzOgpMHYvvVQ\",\n          \"name\": \"Gmail account\"\n        }\n      },\n      \"typeVersion\": 2.1\n    },\n    {\n      \"id\": \"8457e27f-449d-43eb-baa8-cd2dedbd27c3\",\n      \"name\": \"Email Without Attachments\",\n      \"type\": \"n8n-nodes-base.gmail\",\n      \"position\": [\n        1100,\n        720\n      ],\n      \"webhookId\": \"479fab78-5e9c-4dc9-ac36-fb656222cae7\",\n      \"parameters\": {\n        \"sendTo\": \"={{ $json.body.to }}\",\n        \"message\": \"={{ $json.body.content }}\",\n        \"options\": {\n          \"ccList\": \"={{ $json.body?.cc ?? '' }}\",\n          \"bccList\": \"={{ $json.body?.bcc ?? '' }}\",\n          \"replyTo\": \"={{ $json.body?.send-replies-to ?? '' }}\",\n          \"senderName\": \"={{ $json.body?.sender-name ?? '' }}\"\n        },\n        \"subject\": \"={{ $json.body.subject }}\",\n        \"emailType\": \"text\"\n      },\n      \"credentials\": {\n        \"gmailOAuth2\": {\n          \"id\": \"ZrIpZzOgpMHYvvVQ\",\n          \"name\": \"Gmail account\"\n        }\n      },\n      \"typeVersion\": 2.1\n    },\n    {\n      \"id\": \"647de484-8a8f-479b-844c-69669d783a66\",\n      \"name\": \"Sticky Note2\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        104,\n        20\n      ],\n      \"parameters\": {\n        \"color\": 6,\n        \"width\": 410.45568358442864,\n        \"height\": 866.9256684369553,\n        \"content\": \"## Obsidian Configuration\\n\\nInstall the [Obsidian Post Webhook plugin](https://github.com/Masterb1234/obsidian-post-webhook/).\\n\\n### How to set-up webhook connection:\\n1. Set your webhook URL in the plugin settings.\\n2. Use the built-in testing functionality to ensure your webhook is set up correctly.\\n3. Open any note in Obsidian.\\n4. Use the command palette (`Ctrl/Cmd + P`) to search for \\\"Send to Webhook\\\".\\n5. Once sent, this workflow begins.\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"97f0c5dc-e8c8-4b98-8b49-baafe41dad60\",\n      \"name\": \"Sticky Note4\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        1260,\n        180\n      ],\n      \"parameters\": {\n        \"color\": 5,\n        \"height\": 264.2421600929918,\n        \"content\": \"![logo](https://upload.wikimedia.org/wikipedia/commons/thumb/1/10/2023_Obsidian_logo.svg/512px-2023_Obsidian_logo.svg.png)\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"5eeec7cd-0bef-4bc2-a2ba-fd6f88300e04\",\n      \"name\": \"Check if it is a test\",\n      \"type\": \"n8n-nodes-base.if\",\n      \"position\": [\n        160,\n        700\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"conditions\": {\n          \"options\": {\n            \"version\": 2,\n            \"leftValue\": \"\",\n            \"caseSensitive\": true,\n            \"typeValidation\": \"strict\"\n          },\n          \"combinator\": \"and\",\n          \"conditions\": [\n            {\n              \"id\": \"f9864a1c-3188-4640-82bd-2cddc8798b0f\",\n              \"operator\": {\n                \"type\": \"boolean\",\n                \"operation\": \"true\",\n                \"singleValue\": true\n              },\n              \"leftValue\": \"={{ $json.body.test }}\",\n              \"rightValue\": \"true\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 2.2\n    },\n    {\n      \"id\": \"36bce77b-6ef1-4a5a-898b-80a8c935a811\",\n      \"name\": \"Sticky Note5\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        1060,\n        27.003515763841165\n      ],\n      \"parameters\": {\n        \"color\": 5,\n        \"width\": 457.22695080436733,\n        \"height\": 863.6667893577376,\n        \"content\": \"## Send Email and Respond\\n\\nAfter the email is sent, the workflow confirms the email's status and sends a response back to Obsidian.\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"c11f11a4-7e45-46f9-8450-628b9b73de64\",\n      \"name\": \"Respond to Obsidian\",\n      \"type\": \"n8n-nodes-base.respondToWebhook\",\n      \"position\": [\n        1400,\n        600\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"respondWith\": \"text\",\n        \"responseBody\": \"=E-mail sent on  {{ new Date($json.currentDate).toLocaleString('en-GB', { day: '2-digit', month: 'long', year: 'numeric', hour: '2-digit', minute: '2-digit', hour12: false }).replace(':', 'h') }}\\n\"\n      },\n      \"typeVersion\": 1.1\n    },\n    {\n      \"id\": \"fc3b3aa0-a90b-4e1e-a491-fb93d50494ec\",\n      \"name\": \"Fix Base64 string\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        760,\n        220\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"b72a1b54-978d-408c-876a-d3e103b1f667\",\n              \"name\": \"data\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.data.replace(/^data:.*?,/, '') }}\"\n            }\n          ]\n        },\n        \"includeOtherFields\": true\n      },\n      \"typeVersion\": 3.4\n    },\n    {\n      \"id\": \"f3c5d9d2-7c76-48f4-8dd6-df665bd32ec1\",\n      \"name\": \"Test Succesfull\",\n      \"type\": \"n8n-nodes-base.respondToWebhook\",\n      \"position\": [\n        360,\n        620\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"respondWith\": \"text\",\n        \"responseBody\": \"=Test succesfull\\n\"\n      },\n      \"typeVersion\": 1.1\n    },\n    {\n      \"id\": \"e7ac7407-f2fc-4cdb-bd18-97f746335103\",\n      \"name\": \"Get date\",\n      \"type\": \"n8n-nodes-base.dateTime\",\n      \"position\": [\n        1260,\n        600\n      ],\n      \"parameters\": {\n        \"options\": {}\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"4be431e2-e21b-48bd-8425-eac17e3174c8\",\n      \"name\": \"Webhook\",\n      \"type\": \"n8n-nodes-base.webhook\",\n      \"position\": [\n        140,\n        380\n      ],\n      \"webhookId\": \"e634d721-48b0-4985-8a57-62ca4c7b3cfb\",\n      \"parameters\": {\n        \"path\": \"e634d721-48b0-4985-8a57-62ca4c7b3cfb\",\n        \"options\": {\n          \"allowedOrigins\": \"*\"\n        },\n        \"httpMethod\": \"POST\",\n        \"responseMode\": \"responseNode\"\n      },\n      \"typeVersion\": 2\n    }\n  ],\n  \"active\": true,\n  \"pinData\": {},\n  \"settings\": {\n    \"executionOrder\": \"v1\"\n  },\n  \"versionId\": \"20900eaa-66cf-4e40-9cdf-fa224b991e86\",\n  \"connections\": {\n    \"Webhook\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Check if attachments exist\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Get date\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Respond to Obsidian\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Fix Base64 string\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Process Each Attachment\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Check if it is a test\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Test Succesfull\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Email Without Attachments\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Email With Attachments\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Get date\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Process Each Attachment\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Prepare Attachments for Email\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Convert Attachment to File\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Separate attachment data\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Fix Base64 string\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Email Without Attachments\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Get date\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Check if attachments exist\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Separate attachment data\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Check if it is a test\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Convert Attachment to File\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Process Each Attachment\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Prepare Attachments for Email\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Email With Attachments\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}",
  "metadata": {
    "node_types": [
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.if",
      "n8n-nodes-base.splitOut",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.splitInBatches",
      "n8n-nodes-base.convertToFile",
      "n8n-nodes-base.aggregate",
      "n8n-nodes-base.gmail",
      "n8n-nodes-base.gmail",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.if",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.respondToWebhook",
      "n8n-nodes-base.set",
      "n8n-nodes-base.respondToWebhook",
      "n8n-nodes-base.dateTime",
      "n8n-nodes-base.webhook"
    ],
    "trigger": null
  }
}