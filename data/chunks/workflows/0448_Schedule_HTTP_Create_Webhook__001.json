{
  "source": "0448_Schedule_HTTP_Create_Webhook.json",
  "index": 1,
  "content": "{\n  \"nodes\": [\n    {\n      \"id\": \"2c3549c1-99c1-4255-a02d-2f454e6ced5e\",\n      \"name\": \"Every 15 minutes\",\n      \"type\": \"n8n-nodes-base.scheduleTrigger\",\n      \"position\": [\n        560,\n        340\n      ],\n      \"parameters\": {\n        \"rule\": {\n          \"interval\": [\n            {\n              \"field\": \"minutes\",\n              \"minutesInterval\": 15\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 1.1\n    },\n    {\n      \"id\": \"3380272e-5631-44aa-b7da-5e23e0966978\",\n      \"name\": \"Get all workflows with tag\",\n      \"type\": \"n8n-nodes-base.n8n\",\n      \"position\": [\n        780,\n        340\n      ],\n      \"parameters\": {\n        \"filters\": {\n          \"tags\": \"sync-to-notion\"\n        }\n      },\n      \"credentials\": {\n        \"n8nApi\": {\n          \"id\": \"230\",\n          \"name\": \"n8n admin account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"d702f13e-8e93-4142-87c7-49fbb6031e19\",\n      \"name\": \"Set fields\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        1000,\n        340\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"1744510d-7ed7-46d8-acd3-f975ab73f298\",\n              \"name\": \"active\",\n              \"type\": \"boolean\",\n              \"value\": \"={{ $json.active }}\"\n            },\n            {\n              \"id\": \"7e76f5dc-0c32-4b26-a289-975155b80112\",\n              \"name\": \"url\",\n              \"type\": \"string\",\n              \"value\": \"={{ $vars.instance_url }}workflow/{{ $json.id }}\"\n            },\n            {\n              \"id\": \"a7b069bf-8090-4dca-a432-f4fd7aa84e6f\",\n              \"name\": \"errorWorkflow\",\n              \"type\": \"boolean\",\n              \"value\": \"={{ !!$json.settings?.errorWorkflow }}\"\n            },\n            {\n              \"id\": \"0bff7a9b-0860-4552-b0f6-5fc279fc75d6\",\n              \"name\": \"name\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.name }}\"\n            },\n            {\n              \"id\": \"3065ee2f-d1bb-42b7-b341-7bb38b0f6720\",\n              \"name\": \"updatedAt\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.updatedAt }}\"\n            },\n            {\n              \"id\": \"ea9d39e4-50ca-4c79-b6ab-8b22cafd0257\",\n              \"name\": \"createdAt\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.createdAt }}\"\n            },\n            {\n              \"id\": \"265d66cd-1796-40eb-ae5b-dca8d1a91871\",\n              \"name\": \"envId\",\n              \"type\": \"string\",\n              \"value\": \"=internal-{{ $json.id }}\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 3.3\n    },\n    {\n      \"id\": \"4527dc91-bad5-4214-b210-ea8f89504fbf\",\n      \"name\": \"Get notion page with workflow id\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        1220,\n        340\n      ],\n      \"parameters\": {\n        \"url\": \"https://api.notion.com/v1/databases/fa25c53eac9a416eab3961b2f5c0c647/query\",\n        \"method\": \"POST\",\n        \"options\": {},\n        \"jsonBody\": \"={\\n    \\\"filter\\\": { \\\"and\\\": [\\n    {\\n        \\\"property\\\": \\\"env id\\\",\\n        \\\"rich_text\\\": { \\\"contains\\\": \\\"{{ $json.envId }}\\\" }\\n    }]\\n}\\n}\",\n        \"sendBody\": true,\n        \"sendHeaders\": true,\n        \"specifyBody\": \"json\",\n        \"authentication\": \"predefinedCredentialType\",\n        \"headerParameters\": {\n          \"parameters\": [\n            {\n              \"name\": \"Notion-Version\",\n              \"value\": \"2022-06-28\"\n            }\n          ]\n        },\n        \"nodeCredentialType\": \"notionApi\"\n      },\n      \"credentials\": {\n        \"notionApi\": {\n          \"id\": \"1exvaAn7wzyBgkXZ\",\n          \"name\": \"Nik's Notion Cred\"\n        }\n      },\n      \"typeVersion\": 4.1\n    },\n    {\n      \"id\": \"ced49644-b18f-4984-8dfd-199d88e3ded7\",\n      \"name\": \"Map fields\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        1440,\n        340\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"49092f3a-7f42-4067-b8ea-1073ef1d1bb8\",\n              \"name\": \"input\",\n              \"type\": \"object\",\n              \"value\": \"={{ $('Set fields').item.json }}\"\n            }\n          ]\n        },\n        \"includeOtherFields\": true\n      },\n      \"typeVersion\": 3.3\n    },\n    {\n      \"id\": \"b890dacf-2ac2-4802-b96a-5097119d35ee\",\n      \"name\": \"if newly added workflow\",\n      \"type\": \"n8n-nodes-base.if\",\n      \"position\": [\n        1660,\n        340\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"conditions\": {\n          \"options\": {\n            \"leftValue\": \"\",\n            \"caseSensitive\": true,\n            \"typeValidation\": \"strict\"\n          },\n          \"combinator\": \"and\",\n          \"conditions\": [\n            {\n              \"id\": \"88337d36-8cf6-4cd5-bec1-5123cf612934\",\n              \"operator\": {\n                \"type\": \"array\",\n                \"operation\": \"empty\",\n                \"singleValue\": true\n              },\n              \"leftValue\": \"={{ $json.results }}\",\n              \"rightValue\": \"\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"86edfe55-9a88-49ed-82de-df0c44a65d53\",\n      \"name\": \"Add to Notion\",\n      \"type\": \"n8n-nodes-base.notion\",\n      \"position\": [\n        1920,\n        240\n      ],\n      \"parameters\": {\n        \"title\": \"={{ $json.input.name }}\",\n        \"options\": {},\n        \"resource\": \"databasePage\",\n        \"databaseId\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"fa25c53e-ac9a-416e-ab39-61b2f5c0c647\",\n          \"cachedResultUrl\": \"https://www.notion.so/fa25c53eac9a416eab3961b2f5c0c647\",\n          \"cachedResultName\": \"Workflows maintained\"\n        },\n        \"propertiesUi\": {\n          \"propertyValues\": [\n            {\n              \"key\": \"env id|rich_text\",\n              \"textContent\": \"={{ $json.input.envId }}\"\n            },\n            {\n              \"key\": \"URL (dev)|url\",\n              \"urlValue\": \"={{ $json.input.url }}\"\n            },\n            {\n              \"key\": \"isActive (dev)|checkbox\",\n              \"checkboxValue\": \"={{ $json.input.active }}\"\n            },\n            {\n              \"key\": \"Workflow created at|date\",\n              \"date\": \"={{ $json.input.createdAt }}\"\n            },\n            {\n              \"key\": \"Workflow updatded at|date\",\n              \"date\": \"={{ $json.input.updatedAt }}\"\n            },\n            {\n              \"key\": \"Error workflow setup|checkbox\",\n              \"checkboxValue\": \"={{ $json.input.errorWorkflow }}\"\n            }\n          ]\n        }\n      },\n      \"credentials\": {\n        \"notionApi\": {\n          \"id\": \"1exvaAn7wzyBgkXZ\",\n          \"name\": \"Nik's Notion Cred\"\n        }\n      },\n      \"typeVersion\": 2.1\n    },\n    {\n      \"id\": \"9d547270-37dd-41ee-98b7-13001c954ffa\",\n      \"name\": \"Update in Notion\",\n      \"type\": \"n8n-nodes-base.notion\",\n      \"position\": [\n        1920,\n        440\n      ],\n      \"parameters\": {\n        \"pageId\": {\n          \"__rl\": true,\n          \"mode\": \"url\",\n          \"value\": \"={{ $json.results[0].url }}\"\n        },\n        \"options\": {},\n        \"resource\": \"databasePage\",\n        \"operation\": \"update\",\n        \"propertiesUi\": {\n          \"propertyValues\": [\n            {\n              \"key\": \"isActive (dev)|checkbox\",\n              \"checkboxValue\": \"={{ $json.input.active }}\"\n            },\n            {\n              \"key\": \"Name|title\",\n              \"title\": \"={{ $json.input.name }}\"\n            },\n            {\n              \"key\": \"URL (dev)|url\",\n              \"urlValue\": \"={{ $json.input.url }}\"\n            },\n            {\n              \"key\": \"isActive (dev)|checkbox\",\n              \"checkboxValue\": \"={{ $json.input.active }}\"\n            },\n            {\n              \"key\": \"Workflow updatded at|date\",\n              \"date\": \"={{ $json.input.updatedAt }}\"\n            },\n            {\n              \"key\": \"Error workflow setup|checkbox\",\n              \"checkboxValue\": \"={{ false }}\"\n            }\n          ]\n        }\n      },\n      \"credentials\": {\n        \"notionApi\": {\n          \"id\": \"1exvaAn7wzyBgkXZ\",\n          \"name\": \"Nik's Notion Cred\"\n        }\n      },\n      \"typeVersion\": 2.1\n    },\n    {\n      \"id\": \"9e4d88f6-aff8-48f1-9470-8b18aae7b83a\",\n      \"name\": \"Sticky Note3\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        540,\n        100\n      ],\n      \"parameters\": {\n        \"color\": 5,\n        \"width\": 445.6145160912248,\n        \"height\": 193.68880276091272,\n        \"content\": \"### üë®‚Äçüé§ Setup\\n1. Add your n8n api creds\\n2. Add your notion creds\\n3. create notion database with fields `env id` as `text`, `isActive (dev)` as `boolean`, `URL (dev)` as `url`, `Workflow created at` as `date`, `Workflow updated at` as `date`, `Error workflow setup` as `boolean`\\n4. Add tag `sync-to-notion` to some workflows\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"c212f6ec-22e3-41cf-b1a5-03f261715444\",\n      \"name\": \"Sticky Note2\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        1000,\n        540\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 368.0997057335963,\n        \"height\": 80,\n        \"content\": \"### üëÜ Set instance url instead of `{{ $vars.instance_url }}` (or set the env variable if you have that feature)\"\n      },\n      \"typeVersion\": 1\n    }\n  ],\n  \"pinData\": {},\n  \"connections\": {\n    \"Map fields\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"if newly added workflow\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Set fields\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Get notion page with workflow id\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Every 15 minutes\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Get all workflows with tag\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"if newly added workflow\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Add to Notion\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Update in Notion\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Get all workflows with tag\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Set fields\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Get notion page with workflow id\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Map fields\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}",
  "metadata": {
    "node_types": [
      "n8n-nodes-base.scheduleTrigger",
      "n8n-nodes-base.n8n",
      "n8n-nodes-base.set",
      "n8n-nodes-base.httpRequest",
      "n8n-nodes-base.set",
      "n8n-nodes-base.if",
      "n8n-nodes-base.notion",
      "n8n-nodes-base.notion",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote"
    ],
    "trigger": null
  }
}