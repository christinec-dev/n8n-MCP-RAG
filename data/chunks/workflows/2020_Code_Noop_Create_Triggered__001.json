{
  "source": "2020_Code_Noop_Create_Triggered.json",
  "index": 1,
  "content": "{\n  \"id\": \"xlMrGt0c1eFi4J1U\",\n  \"meta\": {\n    \"instanceId\": \"fb8bc2e315f7f03c97140b30aa454a27bc7883a19000fa1da6e6b571bf56ad6d\",\n    \"templateCredsSetupCompleted\": true\n  },\n  \"name\": \"Addon for Workflow Nodes Update Check Template\",\n  \"tags\": [],\n  \"nodes\": [\n    {\n      \"id\": \"e8068a93-5474-474e-a48e-947269b7ca5f\",\n      \"name\": \"Execute Workflow Trigger\",\n      \"type\": \"n8n-nodes-base.executeWorkflowTrigger\",\n      \"position\": [\n        860,\n        1140\n      ],\n      \"parameters\": {},\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"9b4524d8-6ded-489b-bf45-6810f5306652\",\n      \"name\": \"Sticky Note4\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        800,\n        120\n      ],\n      \"parameters\": {\n        \"color\": 5,\n        \"width\": 1316.8621045610755,\n        \"height\": 887.980239951363,\n        \"content\": \"## Download the main workflow and connect it's output to this workflow\\n- Download this workflow and follow the belonging instructions: [https://n8n.io/workflows/2301-check-if-workflows-contain-build-in-nodes-that-are-not-of-the-latest-version/](https://n8n.io/workflows/2301-check-if-workflows-contain-build-in-nodes-that-are-not-of-the-latest-version/)\\n- Add an \\\"Execute Workflow\\\" node and configure it, so it calls this workflow.\\n  \\n![Image](https://i.imgur.com/y0vPhYz.png#full-width)\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"cb0cacc1-34d0-4e4d-a7db-e44ece1a155f\",\n      \"name\": \"Prepare Output\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        2180,\n        1140\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"26c2bf59-2051-47e3-a6bf-3896ad427404\",\n              \"name\": \"name\",\n              \"type\": \"string\",\n              \"value\": \"=<a href={{ $('Settings').item.json.instanceBaseUrl }}/workflow/{{ $json.id }}>{{ $json.name }}</a>\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 3.4\n    },\n    {\n      \"id\": \"4b914937-1cff-4fc2-886b-64ec6818daf3\",\n      \"name\": \"Send Summary\",\n      \"type\": \"n8n-nodes-base.gmail\",\n      \"position\": [\n        2400,\n        1140\n      ],\n      \"webhookId\": \"1ad759b3-f1cd-49dd-b288-e3344fa94c8a\",\n      \"parameters\": {\n        \"message\": \"=These workflows contain outdated nodes:<br>\\n<ul>\\n{{ $('Prepare Output').all().pluck('json').pluck('name').map(item => \\\"<li>\\\"+item+\\\"</li>\\\").join('') }}\\n</ul>\",\n        \"options\": {\n          \"appendAttribution\": false\n        },\n        \"subject\": \"Outdated n8n Workflow Nodes\"\n      },\n      \"credentials\": {\n        \"gmailOAuth2\": {\n          \"id\": \"TWM2BLjDHQtGAFQn\",\n          \"name\": \"Gmail (octionicsolutions)\"\n        }\n      },\n      \"executeOnce\": true,\n      \"typeVersion\": 2.1\n    },\n    {\n      \"id\": \"2f259d45-cb31-4007-beb0-93123cc619c3\",\n      \"name\": \"Get Workflow\",\n      \"type\": \"n8n-nodes-base.n8n\",\n      \"position\": [\n        1520,\n        1140\n      ],\n      \"parameters\": {\n        \"operation\": \"get\",\n        \"workflowId\": {\n          \"__rl\": true,\n          \"mode\": \"id\",\n          \"value\": \"={{ $('Start Reference').item.json.Id }}\"\n        },\n        \"requestOptions\": {}\n      },\n      \"credentials\": {\n        \"n8nApi\": {\n          \"id\": \"fRyEJuhN9Nf3aQap\",\n          \"name\": \"n8n account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"e2bbfc5b-1af6-43b1-9d03-f35b5837d3cc\",\n      \"name\": \"Update Workflow\",\n      \"type\": \"n8n-nodes-base.n8n\",\n      \"position\": [\n        1960,\n        1140\n      ],\n      \"parameters\": {\n        \"operation\": \"update\",\n        \"workflowId\": {\n          \"__rl\": true,\n          \"mode\": \"id\",\n          \"value\": \"={{ $json.id }}\"\n        },\n        \"requestOptions\": {},\n        \"workflowObject\": \"={{ JSON.stringify($json) }}\"\n      },\n      \"credentials\": {\n        \"n8nApi\": {\n          \"id\": \"fRyEJuhN9Nf3aQap\",\n          \"name\": \"n8n account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"f2bb0529-6e38-46c6-93e8-de76e9ecc31e\",\n      \"name\": \"Modify Workflow (if required)\",\n      \"type\": \"n8n-nodes-base.code\",\n      \"position\": [\n        1740,\n        1140\n      ],\n      \"parameters\": {\n        \"mode\": \"runOnceForEachItem\",\n        \"jsCode\": \"let symbol = $('Settings').item.json.symbol;\\nlet onlyMajorChanges = $('Settings').item.json.onlyMajorChanges;\\nlet addNodesToCanvas = $('Settings').item.json.addNodesToCanvas;\\n\\n// create shallow copy including nested objects\\nlet data = JSON.parse(JSON.stringify($json));\\n\\nchangeCount = 0;\\n// Loop through nodes and update the names\\nfor (let outdatedNode of $('Start Reference').item.json.outdated_nodes) {\\n  // skip minor changes, if settings require it\\n  if (onlyMajorChanges && outdatedNode.version.toString().substring(0, 1) == outdatedNode.latestVersion.toString().substring(0, 1)) {\\n    continue;\\n  }\\n  // update nodes, it they are not already renamed with symbol\\n  for (let existingNode of data.nodes) {\\n    if (outdatedNode.name == existingNode.name && !existingNode.name.startsWith(symbol) && existingNode.id) {\\n      // prepend new nodes, so they appear below outdated nodes on the canvas\\n      if (addNodesToCanvas) {\\n        let newNode = JSON.parse(JSON.stringify(existingNode));\\n        delete newNode.id;\\n        newNode.typeVersion = outdatedNode.latestVersion;\\n        newNode.position = [newNode.position[0] + 40, newNode.position[1] - 40];\\n        data.nodes.unshift(newNode);\\n      }\\n      // rename outdated nodes (prepend symbol)\\n      existingNode.name = symbol + \\\" \\\" + existingNode.name;\\n    \\n      // update connections\\n      for (let connectionKey in data.connections) {\\n        let connection = data.connections[connectionKey];\\n      \\n        // rename keys\\n        if (connectionKey == outdatedNode.name) {\\n          let newKey = symbol + \\\" \\\" + connectionKey;\\n          data.connections[newKey] = connection;\\n          delete data.connections[connectionKey];\\n        }\\n      \\n        // check the nested \\\"main\\\" array\\n        if (connection.main) {\\n          for (let mainArray of connection.main) {\\n            for (let nodeObj of mainArray) {\\n              if (nodeObj.node == outdatedNode.name) {\\n                nodeObj.node = symbol + \\\" \\\" + nodeObj.node;\\n              }\\n            }\\n          }\\n        }\\n      }\\n      changeCount++;\\n    }\\n  }\\n}\\n\\nif (changeCount == 0) {\\n  return null;\\n}\\n\\nreturn {\\n  id: data.id,\\n  name: data.name,\\n  nodes: data.nodes,\\n  connections: data.connections,\\n  settings: data.settings\\n}\"\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"b4b7d328-8128-4f07-841a-1efa26c3fdd5\",\n      \"name\": \"Start Reference\",\n      \"type\": \"n8n-nodes-base.noOp\",\n      \"position\": [\n        1080,\n        1140\n      ],\n      \"parameters\": {},\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"7d80b557-15ac-479e-a219-dd254580a063\",\n      \"name\": \"Sticky Note\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        800,\n        1020\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 216.6228464570463,\n        \"height\": 282.1449413577448,\n        \"content\": \"This workflow is called by another workflow which provides a list of all workflows with major and minor node updates\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"1becaab6-fe2a-44e9-bc7e-ce87665f25bd\",\n      \"name\": \"Sticky Note2\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        2120,\n        680\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 435.46822963832705,\n        \"height\": 327.68691689762716,\n        \"content\": \"## Example input data\\n\\n```\\n[\\n  {\\n    \\\"workflow\\\": \\\"Workflow Nodes Update\\\",\\n    \\\"Id\\\": \\\"dFJpQTFg3QPH6Ol9\\\",\\n    \\\"outdated_nodes\\\": [\\n      {\\n        \\\"name\\\": \\\"If\\\",\\n        \\\"type\\\": \\\"n8n-nodes-base.if\\\",\\n        \\\"version\\\": 2,\\n        \\\"latestVersion\\\": 2.2\\n      }\\n    ]\\n  }\\n]\\n```\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"9ce81677-4dd4-4a9a-a7a3-66b113c69de6\",\n      \"name\": \"Sticky Note1\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        1020,\n        1020\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 216.6228464570463,\n        \"height\": 282.1449413577448,\n        \"content\": \"The following nodes start referencing from here, so it is easily possible to change the logic prior to this node.\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"f6e7e7ce-1282-4292-8675-ca8bbe215d5f\",\n      \"name\": \"Sticky Note5\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        1240,\n        1020\n      ],\n      \"parameters\": {\n        \"width\": 216.6228464570463,\n        \"height\": 282.1449413577448,\n        \"content\": \"## Update settings\\nMinimum requirement:\\n- Set your instanceBaseUrl\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"46b168d5-c866-497b-8664-92722a356feb\",\n      \"name\": \"Settings\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        1300,\n        1140\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"99947a54-e9f9-4d04-b273-9d7eeed62775\",\n              \"name\": \"instanceBaseUrl\",\n              \"type\": \"string\",\n              \"value\": \"http://localhost:5432\"\n            },\n            {\n              \"id\": \"35a63bda-fcbb-4885-a8d6-4b52c6579206\",\n              \"name\": \"symbol\",\n              \"type\": \"string\",\n              \"value\": \"⚠️\"\n            },\n            {\n              \"id\": \"3481286b-359f-4e86-8f56-bdb267ebd6a2\",\n              \"name\": \"onlyMajorChanges\",\n              \"type\": \"boolean\",\n              \"value\": true\n            },\n            {\n              \"id\": \"2377c274-5501-494f-813e-0d3ebe47e375\",\n              \"name\": \"addNodesToCanvas\",\n              \"type\": \"boolean\",\n              \"value\": true\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 3.4\n    },\n    {\n      \"id\": \"d28ac933-7dbc-4039-821b-7cd4c4c5ec94\",\n      \"name\": \"Sticky Note6\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        2120,\n        1020\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 216.6228464570463,\n        \"height\": 282.1449413577448,\n        \"content\": \"URL's are generated for each affected workflow\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"0fef2be5-92d5-4d4f-8afc-b958ee616787\",\n      \"name\": \"Sticky Note7\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        2340,\n        1020\n      ],\n      \"parameters\": {\n        \"width\": 216.6228464570463,\n        \"height\": 282.1449413577448,\n        \"content\": \"## Setup Gmail\\nMinimum requirement:\\n- Update mail recipient\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"dc940f78-1eff-4393-9d9a-f4afefe24d45\",\n      \"name\": \"Sticky Note8\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        1460,\n        1020\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 657.2496253932529,\n        \"height\": 282.1449413577448,\n        \"content\": \"Each workflow is being processed and modified if needed. Depending on the settings an icon is being prepended to the name of outdated nodes. In addition a newer version is being added close by, so it can be replaced quicker by the user.\"\n      },\n      \"typeVersion\": 1\n    }\n  ],\n  \"active\": false,\n  \"pinData\": {},\n  \"settings\": {\n    \"executionOrder\": \"v1\"\n  },\n  \"versionId\": \"f4bb34b0-7561-4d77-beac-8f6988a0ed64\",\n  \"connections\": {\n    \"Settings\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Get Workflow\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Get Workflow\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Modify Workflow (if required)\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Prepare Output\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Send Summary\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Start Reference\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Settings\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Update Workflow\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Prepare Output\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Execute Workflow Trigger\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Start Reference\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Modify Workflow (if required)\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Update Workflow\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}",
  "metadata": {
    "node_types": [
      "n8n-nodes-base.executeWorkflowTrigger",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.set",
      "n8n-nodes-base.gmail",
      "n8n-nodes-base.n8n",
      "n8n-nodes-base.n8n",
      "n8n-nodes-base.code",
      "n8n-nodes-base.noOp",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.set",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote"
    ],
    "trigger": "execute workflow trigger"
  }
}