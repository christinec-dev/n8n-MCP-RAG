{
  "source": "0276_Microsoftonedrive_Readbinaryfile_Automation_Webhook.json",
  "index": 1,
  "content": "{\n  \"meta\": {\n    \"instanceId\": \"8c8c5237b8e37b006a7adce87f4369350c58e41f3ca9de16196d3197f69eabcd\"\n  },\n  \"nodes\": [\n    {\n      \"id\": \"05bd643c-6dd0-4f36-a586-3a06cc26893c\",\n      \"name\": \"Note\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        200,\n        780\n      ],\n      \"parameters\": {\n        \"width\": 476.4578377639565,\n        \"height\": 299.6468819708682,\n        \"content\": \"## Working with Excel files\\n1. Load the spreadsheet file into the workflow (.xls, .xlsx, .csv).\\n2. Convert the file with **Spreadsheet File** node. This allows other nodes to access the data.\\n3. Transform and manipulate the spreadsheet data as needed\\n4. [Optional] Convert back to a spreadsheet file\\n5. [Optional] Save file locally or upload to a server\\n\\n\\n\\nℹ️ This template shows how to work with spreadsheet files themselves. Use the **Microsoft Excel 365** node to interact with the Microsoft Office 365 cloud platform. \"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"84db705b-b45f-447f-b3e6-ac9650816e3b\",\n      \"name\": \"Note1\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        840,\n        800\n      ],\n      \"parameters\": {\n        \"width\": 261.5285597588645,\n        \"height\": 244.71805702217537,\n        \"content\": \"### 1A. From a public URL\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"92b8375b-92a3-41ca-874e-d9c4567e21d4\",\n      \"name\": \"Read Binary File\",\n      \"type\": \"n8n-nodes-base.readBinaryFile\",\n      \"notes\": \"Fetches a local file\",\n      \"disabled\": true,\n      \"position\": [\n        920,\n        1140\n      ],\n      \"parameters\": {\n        \"filePath\": \"/files/customer-datastore.xlsx\"\n      },\n      \"notesInFlow\": true,\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"e595db63-8556-4e5e-89df-9895691ed4bb\",\n      \"name\": \"Note7\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        840,\n        680\n      ],\n      \"parameters\": {\n        \"width\": 332.13093980992585,\n        \"height\": 80,\n        \"content\": \"## 1. Load file into workflow\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"66ae38b6-01e6-486b-aae1-d696d22fb2cf\",\n      \"name\": \"Note8\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        840,\n        1380\n      ],\n      \"parameters\": {\n        \"width\": 263.20908130939836,\n        \"height\": 475.9602777402797,\n        \"content\": \"### 1C. From a cloud platform\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"c2e2cc7e-01a2-4138-ba6f-344be3dd91f3\",\n      \"name\": \"On clicking 'execute'\",\n      \"type\": \"n8n-nodes-base.manualTrigger\",\n      \"position\": [\n        500,\n        1140\n      ],\n      \"parameters\": {},\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"050bdd2e-6fe5-4145-8a0b-c1b4b8870c53\",\n      \"name\": \"Note2\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"disabled\": true,\n      \"position\": [\n        2060,\n        680\n      ],\n      \"parameters\": {\n        \"width\": 326.8935002375224,\n        \"height\": 302.0190073917633,\n        \"content\": \"## 4. [Optional] Convert node data back to .xls file\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"3822a521-c1f4-40a9-bbb6-540a2bb4651b\",\n      \"name\": \"Note4\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"disabled\": true,\n      \"position\": [\n        1640,\n        680\n      ],\n      \"parameters\": {\n        \"width\": 359.63512407276517,\n        \"height\": 304.93769799366413,\n        \"content\": \"## 3. Manipulate or transform your spreadsheet data \\n\\n\\n\\n\\n\\n\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"a90ef806-62a7-492d-b493-337d796c677a\",\n      \"name\": \"Note5\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        2460,\n        1080\n      ],\n      \"parameters\": {\n        \"width\": 253.5004831258875,\n        \"height\": 243.48423158332457,\n        \"content\": \"### 4B. To a webserver via (S)FTP\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"a5419c12-4be4-4fdf-8b9f-f6c73104477a\",\n      \"name\": \"Write Binary File\",\n      \"type\": \"n8n-nodes-base.writeBinaryFile\",\n      \"position\": [\n        2520,\n        860\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"fileName\": \"=/tmp/{{$binary.data.fileName}}\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"3d3474ee-298f-48ee-b7b4-2dd64729c747\",\n      \"name\": \"Note6\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"disabled\": true,\n      \"position\": [\n        1280,\n        680\n      ],\n      \"parameters\": {\n        \"width\": 279.5841955487948,\n        \"height\": 309.4318901795142,\n        \"content\": \"## 2. Convert the file into JSON format\\nJSON data can be used by nodes\\n\\n\\n\\n\\n\\n\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"93cd3132-460b-4a67-b627-b417bbd74012\",\n      \"name\": \"Note9\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"disabled\": true,\n      \"position\": [\n        2460,\n        680\n      ],\n      \"parameters\": {\n        \"width\": 332.13093980992585,\n        \"height\": 86.72208620213638,\n        \"content\": \"## 5. Save or upload new file\\n### [Optional]\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"4ca7e58c-2d8f-463f-86f9-f87f47a7364b\",\n      \"name\": \"Note10\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        2460,\n        800\n      ],\n      \"parameters\": {\n        \"width\": 253.5004831258875,\n        \"height\": 245.22344655940856,\n        \"content\": \"### 4A. To a local filesystem\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"db8f95b3-db71-4111-b5a4-a53cdfeea896\",\n      \"name\": \"Note11\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"disabled\": true,\n      \"position\": [\n        2460,\n        1380\n      ],\n      \"parameters\": {\n        \"width\": 253.5004831258875,\n        \"height\": 480.2511652360096,\n        \"content\": \"### 4C. To a cloud service\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"ae1a1cdf-4670-41da-8bc5-aa6817ce08bc\",\n      \"name\": \"Note3\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        840,\n        1080\n      ],\n      \"parameters\": {\n        \"width\": 263.20908130939836,\n        \"height\": 244.71805702217537,\n        \"content\": \"### 1B. From the local filesystem\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"529b03fb-b81d-40f3-bade-684cc9776cba\",\n      \"name\": \"Download from Google Drive\",\n      \"type\": \"n8n-nodes-base.googleDrive\",\n      \"disabled\": true,\n      \"position\": [\n        920,\n        1440\n      ],\n      \"parameters\": {\n        \"fileId\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"1ffuj8v-s0h8LeEmrA2hBk-b7qKF_c9uT\",\n          \"cachedResultUrl\": \"https://docs.google.com/spreadsheets/d/1ffuj8v-s0h8LeEmrA2hBk-b7qKF_c9uT/edit?usp=drivesdk&ouid=112909978107527312058&rtpof=true&sd=true\",\n          \"cachedResultName\": \"customer-datastore.xlsx\"\n        },\n        \"options\": {},\n        \"operation\": \"download\"\n      },\n      \"credentials\": {\n        \"googleDriveOAuth2Api\": {\n          \"id\": \"148\",\n          \"name\": \"FPS\"\n        }\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"b63c9748-0c7d-4d2a-aa5b-db76d31af957\",\n      \"name\": \"Download from Microsoft OneDrive\",\n      \"type\": \"n8n-nodes-base.microsoftOneDrive\",\n      \"disabled\": true,\n      \"position\": [\n        920,\n        1640\n      ],\n      \"parameters\": {\n        \"fileId\": \"549D14658E697C62!2087\",\n        \"operation\": \"download\"\n      },\n      \"credentials\": {\n        \"microsoftOneDriveOAuth2Api\": {\n          \"id\": \"88\",\n          \"name\": \"Microsoft Drive account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"6333d0b5-d58b-4a19-af9a-0e5ea4fa15e8\",\n      \"name\": \"Download Excel File\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"notes\": \"Fetches file from server\",\n      \"position\": [\n        920,\n        860\n      ],\n      \"parameters\": {\n        \"url\": \"https://internal.users.n8n.cloud/webhook/709a234d-add7-41d2-9326-8d981f58120b\",\n        \"options\": {}\n      },\n      \"notesInFlow\": true,\n      \"typeVersion\": 3\n    },\n    {\n      \"id\": \"88b24dbb-dc9f-4f03-a5b3-71ba89295346\",\n      \"name\": \"Work out Age\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        1760,\n        820\n      ],\n      \"parameters\": {\n        \"values\": {\n          \"string\": [\n            {\n              \"name\": \"age\",\n              \"value\": \"={{ Math.trunc($today.diff(DateTime.fromFormat($json[\\\"created\\\"], 'yyyy-MM-dd'), 'years').toObject().years) }}\"\n            }\n          ]\n        },\n        \"options\": {}\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"2f1f2fa9-4995-46c9-a415-3768a0895e88\",\n      \"name\": \"Upload to SFTP\",\n      \"type\": \"n8n-nodes-base.ftp\",\n      \"disabled\": true,\n      \"position\": [\n        2520,\n        1140\n      ],\n      \"parameters\": {\n        \"path\": \"=/home/n8n/{{$binary.data.fileName}}\",\n        \"protocol\": \"sftp\",\n        \"operation\": \"upload\"\n      },\n      \"credentials\": {\n        \"sftp\": {\n          \"id\": \"8\",\n          \"name\": \"SFTP\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"81c06f12-83f1-4973-a1ec-6d58e26eb8c9\",\n      \"name\": \"Upload to Google Drive\",\n      \"type\": \"n8n-nodes-base.googleDrive\",\n      \"disabled\": true,\n      \"position\": [\n        2520,\n        1440\n      ],\n      \"parameters\": {\n        \"name\": \"={{$binary.data.fileName}}\",\n        \"options\": {},\n        \"binaryData\": true\n      },\n      \"credentials\": {\n        \"googleDriveOAuth2Api\": {\n          \"id\": \"148\",\n          \"name\": \"FPS\"\n        }\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"a0ef4740-8716-4fab-8498-c13ee32842cb\",\n      \"name\": \"Upload to Microsoft OneDrive\",\n      \"type\": \"n8n-nodes-base.microsoftOneDrive\",\n      \"disabled\": true,\n      \"position\": [\n        2520,\n        1640\n      ],\n      \"parameters\": {\n        \"fileName\": \"={{$binary.data.fileName}}\",\n        \"parentId\": \"root\",\n        \"binaryData\": true\n      },\n      \"credentials\": {\n        \"microsoftOneDriveOAuth2Api\": {\n          \"id\": \"88\",\n          \"name\": \"Microsoft Drive account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"01e6575d-bb92-4f32-82b4-acfe7448a364\",\n      \"name\": \"Read Spreadsheet File\",\n      \"type\": \"n8n-nodes-base.spreadsheetFile\",\n      \"position\": [\n        1360,\n        820\n      ],\n      \"parameters\": {\n        \"options\": {}\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"ed09f502-109f-42dc-a62c-6b6f54aad46e\",\n      \"name\": \"Write Spreadsheet File\",\n      \"type\": \"n8n-nodes-base.spreadsheetFile\",\n      \"position\": [\n        2160,\n        820\n      ],\n      \"parameters\": {\n        \"options\": {\n          \"fileName\": \"=customer-datastore_{{$today.toFormat('yyyyMMdd')}}.xlsx\"\n        },\n        \"operation\": \"toFile\",\n        \"fileFormat\": \"xlsx\"\n      },\n      \"typeVersion\": 1\n    }\n  ],\n  \"connections\": {\n    \"Work out Age\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Write Spreadsheet File\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Read Binary File\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Read Spreadsheet File\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Download Excel File\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Read Spreadsheet File\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"On clicking 'execute'\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Read Binary File\",\n            \"type\": \"main\",\n            \"index\": 0\n          },\n          {\n            \"node\": \"Download Excel File\",\n            \"type\": \"main\",\n            \"index\": 0\n          },\n          {\n            \"node\": \"Download from Google Drive\",\n            \"type\": \"main\",\n            \"index\": 0\n          },\n          {\n            \"node\": \"Download from Microsoft OneDrive\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Read Spreadsheet File\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Work out Age\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Write Spreadsheet File\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Upload to SFTP\",\n            \"type\": \"main\",\n            \"index\": 0\n          },\n          {\n            \"node\": \"Upload to Google Drive\",\n            \"type\": \"main\",\n            \"index\": 0\n          },\n          {\n            \"node\": \"Write Binary File\",\n            \"type\": \"main\",\n            \"index\": 0\n          },\n          {\n            \"node\": \"Upload to Microsoft OneDrive\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Download from Google Drive\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Read Spreadsheet File\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Download from Microsoft OneDrive\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Read Spreadsheet File\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}",
  "metadata": {
    "node_types": [
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.readBinaryFile",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.manualTrigger",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.writeBinaryFile",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.googleDrive",
      "n8n-nodes-base.microsoftOneDrive",
      "n8n-nodes-base.httpRequest",
      "n8n-nodes-base.set",
      "n8n-nodes-base.ftp",
      "n8n-nodes-base.googleDrive",
      "n8n-nodes-base.microsoftOneDrive",
      "n8n-nodes-base.spreadsheetFile",
      "n8n-nodes-base.spreadsheetFile"
    ],
    "trigger": null
  }
}