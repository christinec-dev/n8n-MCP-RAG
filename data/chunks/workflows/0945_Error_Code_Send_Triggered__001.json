{
  "source": "0945_Error_Code_Send_Triggered.json",
  "index": 1,
  "content": "{\n  \"id\": \"3b1q6ZJTxeONrpUV\",\n  \"meta\": {\n    \"instanceId\": \"\"\n  },\n  \"name\": \"Error Alert and Summarizer\",\n  \"tags\": [],\n  \"nodes\": [\n    {\n      \"id\": \"d29a5b06-1609-416f-bc74-0274d3321019\",\n      \"name\": \"Error Trigger\",\n      \"type\": \"n8n-nodes-base.errorTrigger\",\n      \"position\": [\n        -600,\n        -40\n      ],\n      \"parameters\": {},\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"a71d3052-a89b-4e8e-baee-7fe245575f42\",\n      \"name\": \"OpenAI Chat Model\",\n      \"type\": \"@n8n/n8n-nodes-langchain.lmChatOpenAi\",\n      \"position\": [\n        528,\n        180\n      ],\n      \"parameters\": {\n        \"model\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"gpt-4o\",\n          \"cachedResultName\": \"gpt-4o\"\n        },\n        \"options\": {}\n      },\n      \"credentials\": {\n        \"openAiApi\": {\n          \"id\": \"786\",\n          \"name\": \"OpenAi account\"\n        }\n      },\n      \"typeVersion\": 1.2\n    },\n    {\n      \"id\": \"e71dee7b-4dfd-49ab-8939-f3808ee112d7\",\n      \"name\": \"Structured Output Parser\",\n      \"type\": \"@n8n/n8n-nodes-langchain.outputParserStructured\",\n      \"position\": [\n        648,\n        180\n      ],\n      \"parameters\": {\n        \"jsonSchemaExample\": \"{\\n\\\"diagnosis\\\":\\\"\\\",\\n\\\"cause\\\":\\\"\\\",\\n\\\"resolution\\\":\\\"\\\"\\n}\"\n      },\n      \"typeVersion\": 1.2\n    },\n    {\n      \"id\": \"3611e9e8-f677-49c4-b06c-fa6c28f43930\",\n      \"name\": \"SET EMAIL\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        -380,\n        -40\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"45e1443a-fb44-42f8-96ad-423197c7265b\",\n              \"name\": \"TO\",\n              \"type\": \"string\",\n              \"value\": \"myemail@myemail.com\"\n            },\n            {\n              \"id\": \"968b05dc-f476-4e13-8166-e62005d0f936\",\n              \"name\": \"CC\",\n              \"type\": \"string\",\n              \"value\": \"theiremail@theiremail.com\"\n            },\n            {\n              \"id\": \"570663c5-29c0-44fb-9992-908b7cca8136\",\n              \"name\": \"BCC\",\n              \"type\": \"string\",\n              \"value\": \"theiremail@theiremail.com\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 3.4\n    },\n    {\n      \"id\": \"3676f72e-d06d-44f8-be35-19efe09a257e\",\n      \"name\": \"Sticky Note\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -450,\n        -260\n      ],\n      \"parameters\": {\n        \"color\": 3,\n        \"height\": 380,\n        \"content\": \"# SET YOUR EMAILS\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"f0b08a20-6ecc-4487-9a0a-30be07cc0cbb\",\n      \"name\": \"Sticky Note1\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -40,\n        -260\n      ],\n      \"parameters\": {\n        \"color\": 3,\n        \"width\": 280,\n        \"height\": 380,\n        \"content\": \"# Enable/Disable Manual Executions\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"b35cd2a6-5f22-4e06-9bb0-880855c423a8\",\n      \"name\": \"Remove Manual Exec\",\n      \"type\": \"n8n-nodes-base.if\",\n      \"position\": [\n        60,\n        -40\n      ],\n      \"parameters\": {\n        \"options\": {\n          \"ignoreCase\": true\n        },\n        \"conditions\": {\n          \"options\": {\n            \"version\": 2,\n            \"leftValue\": \"\",\n            \"caseSensitive\": false,\n            \"typeValidation\": \"strict\"\n          },\n          \"combinator\": \"and\",\n          \"conditions\": [\n            {\n              \"id\": \"9b2f3ff3-db9c-406b-a97f-37620dc5fab9\",\n              \"operator\": {\n                \"type\": \"string\",\n                \"operation\": \"notContains\"\n              },\n              \"leftValue\": \"={{ $json.mode }}\",\n              \"rightValue\": \"manual\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 2.2\n    },\n    {\n      \"id\": \"2a33b02a-78f1-4243-ba7d-f217ea4d1895\",\n      \"name\": \"Get Failed Exec\",\n      \"type\": \"n8n-nodes-base.n8n\",\n      \"position\": [\n        -160,\n        -40\n      ],\n      \"parameters\": {\n        \"options\": {\n          \"activeWorkflows\": true\n        },\n        \"resource\": \"execution\",\n        \"operation\": \"get\",\n        \"executionId\": \"={{ $('Error Trigger').item.json.execution.id }}\",\n        \"requestOptions\": {}\n      },\n      \"credentials\": {\n        \"n8nApi\": {\n          \"id\": \"786\",\n          \"name\": \"n8n account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"b36ccbf9-4e47-44fc-aed3-424b6f121329\",\n      \"name\": \"Extract Error Details\",\n      \"type\": \"n8n-nodes-base.code\",\n      \"position\": [\n        280,\n        -40\n      ],\n      \"parameters\": {\n        \"jsCode\": \"// 1) Grab your full execution JSON\\nconst exec = items[0].json;\\n\\n// 2) Build execution‐level metadata\\nconst meta = {\\n  executionId:    exec.id,\\n  finished:       exec.finished,\\n  mode:           exec.mode,\\n  status:         exec.status,\\n  createdAt:      exec.createdAt,\\n  startedAt:      exec.startedAt,\\n  stoppedAt:      exec.stoppedAt,\\n  deletedAt:      exec.deletedAt,\\n  workflowId:     exec.workflowId,\\n  workflowName:   exec.workflowData?.name,\\n  retryOf:        exec.retryOf,\\n  retrySuccessId: exec.retrySuccessId,\\n};\\n\\n// 3) Identify trigger node name from startData\\nconst runNodeFilter = exec.data?.startData?.runNodeFilter || [];\\nconst triggerNodeName = runNodeFilter[0] || null;\\n\\n// 4) Grab the raw trigger runData\\nconst runData = exec.data?.resultData?.runData || {};\\nconst triggerRuns = triggerNodeName ? (runData[triggerNodeName] || []) : [];\\n\\n// 5) Extract the JSON payload from the first run of the trigger\\nlet triggerPayload = {};\\nif (triggerRuns.length && triggerRuns[0].data?.main?.[0]?.[0]?.json) {\\n  triggerPayload = triggerRuns[0].data.main[0][0].json;\\n}\\n\\n// 6) Merge trigger info into meta\\nmeta.triggerNodeName = triggerNodeName;\\nmeta.triggerPayload  = triggerPayload;\\n\\n// 7) Now scan for all node errors, **excluding** any nodeName that contains “SERP”\\nconst allErrors = [];\\nfor (const [nodeName, runs] of Object.entries(runData)) {\\n  // Skip any of the SERP nodes\\n  if (nodeName.includes('SERP')) continue;\\n\\n  runs.forEach(run => {\\n    if (run.executionStatus === 'error') {\\n      const err     = run.error || exec.data.resultData.error || {};\\n      const nodeDef = err.node || run.node || {};\\n\\n      allErrors.push({\\n        ...meta,                    // exec + trigger metadata\\n\\n        nodeName,\\n        nodeId:        nodeDef.id,\\n        nodeType:      nodeDef.type,\\n        nodeLabel:     nodeDef.name,\\n\\n        startTime:     run.startTime,\\n        executionTime: run.executionTime,\\n        source:        run.source,\\n\\n        errorName:        err.name,\\n        errorMessage:     err.message,\\n        errorDescription: err.description,\\n        httpCode:         err.httpCode,\\n        messages:         err.messages,\\n        context:          err.context,\\n        stack:            err.stack,\\n\\n        parameters:       nodeDef.parameters,\\n        credentials:      nodeDef.credentials,\\n      });\\n    }\\n  });\\n}\\n\\n// 8) Return results\\nif (!allErrors.length) {\\n  return [{ json: { message: '✅ No (non‑SERP) errors found in this execution.' } }];\\n}\\nreturn allErrors.map(e => ({ json: e }));\\n\"\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"a26fb0c8-99eb-466d-b201-89c402fa1af4\",\n      \"name\": \"Error Solver Agent\",\n      \"type\": \"@n8n/n8n-nodes-langchain.agent\",\n      \"position\": [\n        500,\n        -40\n      ],\n      \"parameters\": {\n        \"text\": \"=Can you please help me with this error that occured in my n8n workflow? {{ JSON.stringify($json) }}\",\n        \"options\": {\n          \"systemMessage\": \"You are an seasoned n8n expert with specializations in managing n8n instances and workflows. The user will provide a detailed error json object and your goal is to review, analyze and understand the error and using your expertise diagnose the error and provide a detailed report to the user with your diagnosis, cause and resolution so the user understands and can immediately fix the issue.\"\n        },\n        \"promptType\": \"define\",\n        \"hasOutputParser\": true\n      },\n      \"typeVersion\": 1.8\n    },\n    {\n      \"id\": \"8cfd7229-3ff1-4ba1-a67d-caa21be8064f\",\n      \"name\": \"Set Diagnosis Fields\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        876,\n        -40\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"fac5fbee-d63d-4148-b047-5ed5af4f2574\",\n              \"name\": \"error.diagnosis\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.output.diagnosis }}\"\n            },\n            {\n              \"id\": \"ece9388d-f667-4984-a143-7241f622fe76\",\n              \"name\": \"error.cause\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.output.cause }}\"\n            },\n            {\n              \"id\": \"acb6b34a-a651-42fc-a44a-331b2e0d745c\",\n              \"name\": \"error.resolution\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.output.resolution }}\"\n            },\n            {\n              \"id\": \"c765754b-d6d5-4592-ac3f-99a350bc3c19\",\n              \"name\": \"error.workflowName\",\n              \"type\": \"string\",\n              \"value\": \"={{ $('Extract Error Details').item.json.workflowName }}\"\n            },\n            {\n              \"id\": \"dabebc62-3e0c-4d22-afbf-54ba66a912fb\",\n              \"name\": \"error.workflowId\",\n              \"type\": \"string\",\n              \"value\": \"={{ $('Extract Error Details').item.json.workflowId }}\"\n            },\n            {\n              \"id\": \"6ab19800-9a0f-439f-bf62-7a7afc5bf958\",\n              \"name\": \"workflowLink\",\n              \"type\": \"string\",\n              \"value\": \"={{ $execution.resumeUrl.split('/').slice(0, 3).join('/') }}/workflow/{{ $('Extract Error Details').item.json.workflowId }}\"\n            },\n            {\n              \"id\": \"29daaea5-052b-46d4-8192-141db159bff2\",\n              \"name\": \"error.executionId\",\n              \"type\": \"string\",\n              \"value\": \"={{ $('Extract Error Details').item.json.executionId }}\"\n            },\n            {\n              \"id\": \"9e4e553c-c82b-41ec-8ee2-14162cdc3bd8\",\n              \"name\": \"executionLink\",\n              \"type\": \"string\",\n              \"value\": \"={{ $execution.resumeUrl.split('/').slice(0, 3).join('/') }}/workflow/{{ $('Extract Error Details').item.json.workflowId }}/executions/{{ $('Extract Error Details').item.json.executionId }}\"\n            },\n            {\n              \"id\": \"7269ea9f-ed49-46cd-89f2-d4a467da529d\",\n              \"name\": \"error.finished\",\n              \"type\": \"boolean\",\n              \"value\": \"={{ $('Extract Error Details').item.json.finished }}\"\n            },\n            {\n              \"id\": \"29a6e6d2-5058-4dd9-b2f9-3980a6a9073a\",\n              \"name\": \"error.startedAt\",\n              \"type\": \"string\",\n              \"value\": \"={{ $('Extract Error Details').item.json.startedAt }}\"\n            },\n            {\n              \"id\": \"a0ad0e13-5a6e-48db-9a80-74c09434de7f\",\n              \"name\": \"error.nodeName\",\n              \"type\": \"string\",\n              \"value\": \"={{ $('Extract Error Details').item.json.nodeName }}\"\n            },\n            {\n              \"id\": \"6c1001d4-a581-4520-9f16-a2c7cf0e1f84\",\n              \"name\": \"error.previousNode\",\n              \"type\": \"string\",\n              \"value\": \"={{ $('Extract Error Details').item.json.source[0].previousNode }}\"\n            },\n            {\n              \"id\": \"8c3402ca-3f15-44ae-9b96-ea37c174334c\",\n              \"name\": \"rawJson\",\n              \"type\": \"string\",\n              \"value\": \"={{ JSON.stringify($('Extract Error Details').item.json) }}\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 3.4\n    },\n    {\n      \"id\": \"9e95edf0-b2f1-443b-9ac4-3e3b3311cad5\",\n      \"name\": \"Send Gmail\",\n      \"type\": \"n8n-nodes-base.gmail\",\n      \"position\": [\n        1316,\n        -40\n      ],\n      \"webhookId\": \"2f253c1f-36c3-4d58-ba2f-3a50bb78f188\",\n      \"parameters\": {\n        \"sendTo\": \"={{ $('SET EMAIL').item.json.TO }}\",\n        \"message\": \"={{ $json.html }}\",\n        \"options\": {\n          \"ccList\": \"={{ $('SET EMAIL').item.json.CC }}\",\n          \"bccList\": \"={{ $('SET EMAIL').item.json.BCC }}\",\n          \"appendAttribution\": true\n        },\n        \"subject\": \"={{ $json.subject }}\"\n      },\n      \"credentials\": {\n        \"gmailOAuth2\": {\n          \"id\": \"786\",\n          \"name\": \"Gmail account\"\n        }\n      },\n      \"typeVersion\": 2.1\n    },\n    {\n      \"id\": \"1705ee42-0be4-41a2-8ff9-f6963eef7382\",\n      \"name\": \"Generate Email\",\n      \"type\": \"n8n-nodes-base.code\",\n      \"position\": [\n        1100,\n        -40\n      ],\n      \"parameters\": {\n        \"jsCode\": \"// 1. Pull in your error payload\\nconst rawInput = items[0].json;\\nconst parsed = typeof rawInput === 'string' ? JSON.parse(rawInput) : rawInput;\\nconst errorArray = Array.isArray(parsed) ? parsed : [parsed];\\n\\n// 2. Build HTML & Markdown sections\\nlet htmlSections = '';\\n\\n\\nfor (const errObj of errorArray) {\\n  const {\\n    error: {\\n      workflowName,\\n      executionId,\\n      nodeName,\\n      previousNode,\\n      diagnosis,\\n      cause,\\n      resolution,\\n      startedAt,\\n    },\\n    workflowLink,\\n    executionLink,\\n  } = errObj;\\n\\n  // HTML block\\n  htmlSections += `\\n    <div style=\\\"border:1px solid #ddd;border-radius:4px;padding:16px;margin-bottom:20px;background:#fafafa;\\\">\\n      <h3 style=\\\"margin:0 0 10px;color:#c0392b;font-family:Arial,sans-serif;\\\">\\n        🛑 ${workflowName} — Error in node: ${nodeName}\\n      </h3>\\n      <p style=\\\"margin:4px 0;font-family:Arial,sans-serif;\\\">\\n        <strong>Workflow:</strong> \\n        <a href=\\\"${workflowLink}\\\" style=\\\"color:#2980b9;text-decoration:none;\\\">\\n          ${workflowName}\\n        </a><br/>\\n        <strong>Execution:</strong> \\n        <a href=\\\"${executionLink}\\\" style=\\\"color:#2980b9;text-decoration:none;\\\">\\n          #${executionId}\\n        </a><br/>\\n        <strong>Previous Node:</strong> ${previousNode}<br/>\\n        <strong>Started At:</strong> ${new Date(startedAt).toLocaleString('en-US', { timeZone: 'America/New_York' })}\\n      </p>\\n      <hr style=\\\"border:none;border-top:1px solid #ccc;margin:12px 0;\\\"/>\\n      <h4 style=\\\"margin:0 0 6px;color:#e67e22;font-family:Arial,sans-serif;\\\">🔍 Diagnosis</h4>\\n      <p style=\\\"margin:4px 0 12px;font-family:Arial,sans-serif;\\\">${diagnosis}</p>\\n      <h4 style=\\\"margin:0 0 6px;color:#e67e22;font-family:Arial,sans-serif;\\\">⚙️ Cause</h4>\\n      <p style=\\\"margin:4px 0 12px;font-family:Arial,sans-serif;\\\">${cause}</p>\\n      <h4 style=\\\"margin:0 0 6px;color:#e67e22;font-family:Arial,sans-serif;\\\">✅ Resolution</h4>\\n      <p style=\\\"white-space:pre-wrap;margin:4px 0;font-family:Arial,sans-serif;\\\">${resolution}</p>\\n    </div>`;\\n\\n// 3. Wrap up\\nconst html = `\\n  <div style=\\\"font-family:Arial,sans-serif;color:#333;background:#fff;padding:20px;\\\">\\n    <h2 style=\\\"margin-top:0;color:#2c3e50;\\\">Automated Error Report</h2>\\n    ${htmlSections}\\n     <p style=\\\"font-size:12px;color:#777;font-family:Arial,sans-serif;\\\">\\n  This message was generated automatically by \\n  <a href=\\\"https://realsimple.dev\\\" style=\\\"color:#777;text-decoration:none;\\\"><b>Real Simple Solutions</b></a>.\\n</p>\\n<div style=\\\"background:#f0f4ff;padding:8px 12px;margin-top:6px;border-radius:6px;font-size:12px;font-family:Arial,sans-serif;\\\">\\n  ✨ <strong>Want more n8n AI automation templates?</strong><br>\\n  Check out our full collection on \\n  <a href=\\\"https://joeper.es/4jXyRub\\\" style=\\\"color:#0066cc;text-decoration:none;\\\"><b>Gumroad</b></a>.\\n</div>\\n  </div>\\n`;\\n\\n// 4. Return all three\\nreturn [\\n  {\\n    json: {\\n      subject: `🚨 n8n Error: ${errorArray[0].error.workflowName} (#${errorArray[0].error.executionId})`,\\n      html\\n    },\\n  },\\n];\\n\"\n      },\n      \"typeVersion\": 2\n    }\n  ],\n  \"active\": true,\n  \"pinData\": {},\n  \"settings\": {\n    \"executionOrder\": \"v1\"\n  },\n  \"versionId\": \"be484a20-26cd-4df4-a993-f7d01c2956e6\",\n  \"connections\": {\n    \"SET EMAIL\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Get Failed Exec\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Error Trigger\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"SET EMAIL\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Generate Email\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Send Gmail\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Get Failed Exec\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Remove Manual Exec\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"OpenAI Chat Model\": {\n      \"ai_languageModel\": [\n        [\n          {\n            \"node\": \"Error Solver Agent\",\n            \"type\": \"ai_languageModel\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Error Solver Agent\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Set Diagnosis Fields\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Remove Manual Exec\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Extract Error Details\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Set Diagnosis Fields\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Generate Email\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Extract Error Details\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Error Solver Agent\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Structured Output Parser\": {\n      \"ai_outputParser\": [\n        [\n          {\n            \"node\": \"Error Solver Agent\",\n            \"type\": \"ai_outputParser\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}",
  "metadata": {
    "node_types": [
      "n8n-nodes-base.errorTrigger",
      "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "@n8n/n8n-nodes-langchain.outputParserStructured",
      "n8n-nodes-base.set",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.if",
      "n8n-nodes-base.n8n",
      "n8n-nodes-base.code",
      "@n8n/n8n-nodes-langchain.agent",
      "n8n-nodes-base.set",
      "n8n-nodes-base.gmail",
      "n8n-nodes-base.code"
    ],
    "trigger": "error trigger"
  }
}