{
  "source": "1648_Splitout_Converttofile_Send_Webhook.json",
  "index": 1,
  "content": "{\n  \"id\": \"DswhuYzoemjA6iNN\",\n  \"meta\": {\n    \"instanceId\": \"a1ae5c8dc6c65e674f9c3947d083abcc749ef2546dff9f4ff01de4d6a36ebfe6\",\n    \"templateCredsSetupCompleted\": true\n  },\n  \"name\": \"Scrape Books from URL with Dumpling AI, Clean HTML, Save to Sheets, Email as CSV\",\n  \"tags\": [\n    {\n      \"id\": \"TlcNkmb96fUfZ2eA\",\n      \"name\": \"Tutorials\",\n      \"createdAt\": \"2025-04-15T17:02:00.249Z\",\n      \"updatedAt\": \"2025-04-15T17:02:00.249Z\"\n    }\n  ],\n  \"nodes\": [\n    {\n      \"id\": \"2e4f64a5-353c-4dd3-9822-62df795d4940\",\n      \"name\": \"Convert to CSV File\",\n      \"type\": \"n8n-nodes-base.convertToFile\",\n      \"position\": [\n        1640,\n        340\n      ],\n      \"parameters\": {\n        \"options\": {}\n      },\n      \"typeVersion\": 1.1\n    },\n    {\n      \"id\": \"472442d3-a691-4310-93f8-019579d0c473\",\n      \"name\": \"Extract all books from the page\",\n      \"type\": \"n8n-nodes-base.html\",\n      \"position\": [\n        760,\n        340\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"operation\": \"extractHtmlContent\",\n        \"dataPropertyName\": \"content\",\n        \"extractionValues\": {\n          \"values\": [\n            {\n              \"key\": \"books\",\n              \"cssSelector\": \".row > li\",\n              \"returnArray\": true,\n              \"returnValue\": \"html\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 1.2\n    },\n    {\n      \"id\": \"92765257-d64d-47c9-bd57-50914342138b\",\n      \"name\": \"Sort by price\",\n      \"type\": \"n8n-nodes-base.sort\",\n      \"position\": [\n        1420,\n        340\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"sortFieldsUi\": {\n          \"sortField\": [\n            {\n              \"order\": \"descending\",\n              \"fieldName\": \"price\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"efc2f33f-1bef-4906-b3b7-b02868080a54\",\n      \"name\": \"Extract individual book price\",\n      \"type\": \"n8n-nodes-base.html\",\n      \"position\": [\n        1200,\n        340\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"operation\": \"extractHtmlContent\",\n        \"dataPropertyName\": \"books\",\n        \"extractionValues\": {\n          \"values\": [\n            {\n              \"key\": \"title\",\n              \"attribute\": \"title\",\n              \"cssSelector\": \"h3 > a\",\n              \"returnValue\": \"attribute\"\n            },\n            {\n              \"key\": \"price\",\n              \"cssSelector\": \".price_color\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 1.2\n    },\n    {\n      \"id\": \"74c7c3af-d63c-4b6c-95a0-15f45b19134b\",\n      \"name\": \"Send CSV via e-mail\",\n      \"type\": \"n8n-nodes-base.gmail\",\n      \"position\": [\n        1860,\n        340\n      ],\n      \"webhookId\": \"40f2d609-52ed-40bf-b190-1f1cebbe3fb7\",\n      \"parameters\": {\n        \"sendTo\": \"\",\n        \"message\": \"Hey, here's the scraped data from the online bookstore!\",\n        \"options\": {\n          \"attachmentsUi\": {\n            \"attachmentsBinary\": [\n              {}\n            ]\n          }\n        },\n        \"subject\": \"bookstore csv\",\n        \"emailType\": \"text\"\n      },\n      \"credentials\": {\n        \"gmailOAuth2\": {\n          \"id\": \"j70r3RTMED1pgN3R\",\n          \"name\": \"Gmail account 2\"\n        }\n      },\n      \"typeVersion\": 2.1\n    },\n    {\n      \"id\": \"95c7998b-ece0-4dea-b99e-97ac22fb8a59\",\n      \"name\": \"Sticky Note3\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        140,\n        -260\n      ],\n      \"parameters\": {\n        \"width\": 619,\n        \"height\": 297,\n        \"content\": \"### Scrape Books from URL with Dumpling AI, Clean HTML, Save to Sheets, Email as CSV\\n\\n📌 This workflow scrapes book data from a website, turns it into a CSV, saves it, and sends it by email.\\n\\n🔧 It starts from a Google Sheets trigger, fetches the page using DumplingAI, extracts books, sorts by price, and emails the CSV.\\n\\n✅ Make sure APIs for Gmail, Sheets & Drive are enabled in Google Cloud. Update the URL in the \\\"Fetch website content\\\" node.\\n\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"f599028a-49a9-4b85-b484-5abf1229e373\",\n      \"name\": \"Sticky Note\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        140,\n        60\n      ],\n      \"parameters\": {\n        \"color\": 4,\n        \"width\": 900,\n        \"height\": 300,\n        \"content\": \"### 🔁 Trigger to Raw Book HTML\\n\\n1. **Google Sheets Trigger**  \\n   Watches a sheet for new row entries. Once a new URL is added, the workflow starts.\\n\\n2. **Fetch Website Content (Dumpling AI)**  \\n   Makes an HTTP POST request to Dumpling AI to scrape and return the full HTML of the target URL.\\n\\n3. **Extract All Books**  \\n   Uses CSS selectors to isolate the list items (`li.row > li`) containing book entries.\\n\\n4. **Split Out Node**  \\n   Breaks the array of book HTML blocks into individual items, so each book can be processed separately in the next steps.\\n\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"bc6ab72c-de03-4e79-9da0-ca12ddf31811\",\n      \"name\": \"Sticky Note1\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        1140,\n        60\n      ],\n      \"parameters\": {\n        \"color\": 6,\n        \"width\": 840,\n        \"height\": 300,\n        \"content\": \"### 📦 Parse, Sort, Export & Email\\n\\n5. **Extract Individual Book Data**  \\n   From each book, extract the title (`<h3>a` title attribute) and price (`.price_color` content).\\n\\n6. **Sort by Price**  \\n   Organizes the extracted data in descending order using the price field.\\n\\n7. **Convert to CSV File**  \\n   Transforms the sorted JSON data into a downloadable CSV file format.\\n\\n8. **Send CSV via Gmail**  \\n   Automatically sends an email with the CSV file attached to the predefined address.\\n\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"a1246b4e-212f-4bd3-970b-b0ff8db2f834\",\n      \"name\": \"Trigger- Watches For new URL in Spreadsheet\",\n      \"type\": \"n8n-nodes-base.googleSheetsTrigger\",\n      \"position\": [\n        320,\n        340\n      ],\n      \"parameters\": {\n        \"event\": \"rowAdded\",\n        \"options\": {},\n        \"pollTimes\": {\n          \"item\": [\n            {\n              \"mode\": \"everyMinute\"\n            }\n          ]\n        },\n        \"sheetName\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"\",\n          \"cachedResultUrl\": \"https://docs.google.com/spreadsheets/d/1pb4WLqv2EruLM1z9-utehcINolSj0vlUqZionyLoRUs/edit#gid=0\",\n          \"cachedResultName\": \"Sheet1\"\n        },\n        \"documentId\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"\",\n          \"cachedResultUrl\": \"https://docs.google.com/spreadsheets/d/1pb4WLqv2EruLM1z9-utehcINolSj0vlUqZionyLoRUs/edit?usp=drivesdk\",\n          \"cachedResultName\": \"URLs\"\n        }\n      },\n      \"credentials\": {\n        \"googleSheetsTriggerOAuth2Api\": {\n          \"id\": \"qDzHSzTkclwDHpSR\",\n          \"name\": \"Google Sheets Trigger account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"b19aa287-3be4-4e16-908d-b0cb484519e3\",\n      \"name\": \"Scrape Website Content with Dumpling AI\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        540,\n        340\n      ],\n      \"parameters\": {\n        \"url\": \"https://app.dumplingai.com/api/v1/scrape\",\n        \"method\": \"POST\",\n        \"options\": {\n          \"allowUnauthorizedCerts\": true\n        },\n        \"jsonBody\": \"={\\n  \\\"url\\\": \\\"{{ $('Trigger- Watches For new URL in Spreadsheet')}}\\\", \\n  \\\"format\\\": \\\"html\\\",\\n  \\\"cleaned\\\": \\\"True\\\"\\n  }\",\n        \"sendBody\": true,\n        \"sendHeaders\": true,\n        \"specifyBody\": \"json\",\n        \"authentication\": \"genericCredentialType\",\n        \"genericAuthType\": \"httpHeaderAuth\",\n        \"headerParameters\": {\n          \"parameters\": [\n            {\n              \"name\": \"Content-Type\",\n              \"value\": \"application/json\"\n            }\n          ]\n        }\n      },\n      \"credentials\": {\n        \"httpBasicAuth\": {\n          \"id\": \"mznexGH3YDtrUTAk\",\n          \"name\": \"Unnamed credential\"\n        },\n        \"httpHeaderAuth\": {\n          \"id\": \"xamyMqCpAech5BeT\",\n          \"name\": \"Header Auth account\"\n        }\n      },\n      \"typeVersion\": 4.1\n    },\n    {\n      \"id\": \"02cbc6f9-bdcb-45fc-9973-ded42346ffbc\",\n      \"name\": \"Split HTML Array into Individual Books\",\n      \"type\": \"n8n-nodes-base.splitOut\",\n      \"position\": [\n        980,\n        340\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"fieldToSplitOut\": \"books\"\n      },\n      \"typeVersion\": 1\n    }\n  ],\n  \"active\": false,\n  \"pinData\": {},\n  \"settings\": {\n    \"executionOrder\": \"v1\"\n  },\n  \"versionId\": \"264412ff-9d74-443c-a2ff-69be1e042a82\",\n  \"connections\": {\n    \"Sort by price\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Convert to CSV File\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Convert to CSV File\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Send CSV via e-mail\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Extract individual book price\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Sort by price\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Extract all books from the page\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Split HTML Array into Individual Books\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Split HTML Array into Individual Books\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Extract individual book price\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Scrape Website Content with Dumpling AI\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Extract all books from the page\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Trigger- Watches For new URL in Spreadsheet\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Scrape Website Content with Dumpling AI\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}",
  "metadata": {
    "node_types": [
      "n8n-nodes-base.convertToFile",
      "n8n-nodes-base.html",
      "n8n-nodes-base.sort",
      "n8n-nodes-base.html",
      "n8n-nodes-base.gmail",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.googleSheetsTrigger",
      "n8n-nodes-base.httpRequest",
      "n8n-nodes-base.splitOut"
    ],
    "trigger": "trigger- watches for new url in spreadsheet"
  }
}