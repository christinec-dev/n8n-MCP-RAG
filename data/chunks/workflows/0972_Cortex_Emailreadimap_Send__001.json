{
  "source": "0972_Cortex_Emailreadimap_Send.json",
  "index": 1,
  "content": "{\n  \"id\": 4,\n  \"name\": \"Email\",\n  \"nodes\": [\n    {\n      \"name\": \"IMAP Email\",\n      \"type\": \"n8n-nodes-base.emailReadImap\",\n      \"position\": [\n        -300,\n        200\n      ],\n      \"parameters\": {\n        \"format\": \"resolved\",\n        \"options\": {}\n      },\n      \"credentials\": {\n        \"imap\": {\n          \"id\": \"5\",\n          \"name\": \"IMAP account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"TheHive\",\n      \"type\": \"n8n-nodes-base.theHive\",\n      \"position\": [\n        -20,\n        200\n      ],\n      \"parameters\": {\n        \"tags\": \"Email\",\n        \"type\": \"Email\",\n        \"title\": \"={{$node[\\\"IMAP Email\\\"].binary.attachment_0.fileName}}\",\n        \"source\": \"Outlook\",\n        \"sourceRef\": \"={{$node[\\\"IMAP Email\\\"].json[\\\"messageId\\\"]}}\",\n        \"artifactUi\": {\n          \"artifactValues\": [\n            {\n              \"dataType\": \"file\",\n              \"binaryProperty\": \"attachment_0\"\n            }\n          ]\n        },\n        \"description\": \"={{$node[\\\"IMAP Email\\\"].binary.attachment_0.fileName}}\",\n        \"additionalFields\": {}\n      },\n      \"credentials\": {\n        \"theHiveApi\": {\n          \"id\": \"1\",\n          \"name\": \"The Hive account\"\n        }\n      },\n      \"typeVersion\": 1,\n      \"alwaysOutputData\": true\n    },\n    {\n      \"name\": \"Create Case\",\n      \"type\": \"n8n-nodes-base.theHive\",\n      \"position\": [\n        280,\n        200\n      ],\n      \"parameters\": {\n        \"id\": \"={{$node[\\\"TheHive\\\"].json[\\\"_id\\\"]}}\",\n        \"operation\": \"promote\",\n        \"additionalFields\": {}\n      },\n      \"credentials\": {\n        \"theHiveApi\": {\n          \"id\": \"1\",\n          \"name\": \"The Hive account\"\n        }\n      },\n      \"typeVersion\": 1,\n      \"alwaysOutputData\": true\n    },\n    {\n      \"name\": \"Case\",\n      \"type\": \"n8n-nodes-base.theHive\",\n      \"position\": [\n        540,\n        200\n      ],\n      \"parameters\": {\n        \"id\": \"={{$node[\\\"Create Case\\\"].json[\\\"_id\\\"]}}\",\n        \"resource\": \"case\",\n        \"operation\": \"get\"\n      },\n      \"credentials\": {\n        \"theHiveApi\": {\n          \"id\": \"1\",\n          \"name\": \"The Hive account\"\n        }\n      },\n      \"typeVersion\": 1,\n      \"alwaysOutputData\": true\n    },\n    {\n      \"name\": \"Observable\",\n      \"type\": \"n8n-nodes-base.theHive\",\n      \"position\": [\n        1060,\n        200\n      ],\n      \"parameters\": {\n        \"caseId\": \"={{$node[\\\"Case\\\"].json[\\\"_id\\\"]}}\",\n        \"options\": {},\n        \"resource\": \"observable\",\n        \"returnAll\": true\n      },\n      \"credentials\": {\n        \"theHiveApi\": {\n          \"id\": \"1\",\n          \"name\": \"The Hive account\"\n        }\n      },\n      \"typeVersion\": 1,\n      \"alwaysOutputData\": true\n    },\n    {\n      \"name\": \"Analyzer Email\",\n      \"type\": \"n8n-nodes-base.theHive\",\n      \"position\": [\n        1340,\n        200\n      ],\n      \"parameters\": {\n        \"id\": \"={{$node[\\\"Observable\\\"].json[\\\"_id\\\"]}}\",\n        \"dataType\": \"file\",\n        \"resource\": \"observable\",\n        \"analyzers\": [\n          \"24a64a086a410e1c7d7ace74003c4480::CORTEX\"\n        ],\n        \"operation\": \"executeAnalyzer\"\n      },\n      \"credentials\": {\n        \"theHiveApi\": {\n          \"id\": \"1\",\n          \"name\": \"The Hive account\"\n        }\n      },\n      \"retryOnFail\": true,\n      \"typeVersion\": 1,\n      \"alwaysOutputData\": true\n    },\n    {\n      \"name\": \"Cortex\",\n      \"type\": \"n8n-nodes-base.cortex\",\n      \"position\": [\n        1560,\n        200\n      ],\n      \"parameters\": {\n        \"jobId\": \"={{$node[\\\"Analyzer Email\\\"].json[\\\"cortexJobId\\\"]}}\",\n        \"resource\": \"job\",\n        \"operation\": \"report\"\n      },\n      \"credentials\": {\n        \"cortexApi\": {\n          \"id\": \"2\",\n          \"name\": \"Cortex account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"IF\",\n      \"type\": \"n8n-nodes-base.if\",\n      \"position\": [\n        -20,\n        600\n      ],\n      \"parameters\": {\n        \"conditions\": {\n          \"number\": [\n            {\n              \"value1\": \"={{$node[\\\"Cortex\\\"].json[\\\"report\\\"][\\\"full\\\"][\\\"iocs\\\"][\\\"domain\\\"].length}}\",\n              \"operation\": \"larger\"\n            },\n            {\n              \"value1\": \"={{$node[\\\"Cortex\\\"].json[\\\"report\\\"][\\\"full\\\"][\\\"iocs\\\"][\\\"email\\\"].length}}\",\n              \"operation\": \"larger\"\n            },\n            {\n              \"value1\": \"={{$node[\\\"Cortex\\\"].json[\\\"report\\\"][\\\"full\\\"][\\\"iocs\\\"][\\\"ip\\\"].length}}\",\n              \"operation\": \"larger\"\n            }\n          ]\n        },\n        \"combineOperation\": \"any\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Update Case Domain\",\n      \"type\": \"n8n-nodes-base.theHive\",\n      \"position\": [\n        420,\n        480\n      ],\n      \"parameters\": {\n        \"ioc\": true,\n        \"data\": \"={{$node[\\\"Cortex\\\"].json[\\\"report\\\"][\\\"full\\\"][\\\"iocs\\\"][\\\"domain\\\"]}}\",\n        \"caseId\": \"={{$node[\\\"Case\\\"].json[\\\"_id\\\"]}}\",\n        \"status\": \"Ok\",\n        \"message\": \"={{$node[\\\"Cortex\\\"].json[\\\"analyzerName\\\"]}}\",\n        \"options\": {\n          \"tags\": \"Domain\"\n        },\n        \"dataType\": \"domain\",\n        \"resource\": \"observable\",\n        \"operation\": \"create\"\n      },\n      \"credentials\": {\n        \"theHiveApi\": {\n          \"id\": \"1\",\n          \"name\": \"The Hive account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Update Case Email\",\n      \"type\": \"n8n-nodes-base.theHive\",\n      \"position\": [\n        420,\n        620\n      ],\n      \"parameters\": {\n        \"ioc\": true,\n        \"data\": \"={{$node[\\\"Cortex\\\"].json[\\\"report\\\"][\\\"full\\\"][\\\"iocs\\\"][\\\"email\\\"]}}\",\n        \"caseId\": \"={{$node[\\\"Case\\\"].json[\\\"_id\\\"]}}\",\n        \"status\": \"Ok\",\n        \"message\": \"={{$node[\\\"Cortex\\\"].json[\\\"analyzerName\\\"]}}\",\n        \"options\": {\n          \"tags\": \"Domain\"\n        },\n        \"dataType\": \"mail\",\n        \"resource\": \"observable\",\n        \"operation\": \"create\"\n      },\n      \"credentials\": {\n        \"theHiveApi\": {\n          \"id\": \"1\",\n          \"name\": \"The Hive account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Update Case Ip\",\n      \"type\": \"n8n-nodes-base.theHive\",\n      \"position\": [\n        420,\n        760\n      ],\n      \"parameters\": {\n        \"ioc\": true,\n        \"data\": \"={{$node[\\\"Cortex\\\"].json[\\\"report\\\"][\\\"full\\\"][\\\"iocs\\\"][\\\"ip\\\"]}}\",\n        \"caseId\": \"={{$node[\\\"Case\\\"].json[\\\"_id\\\"]}}\",\n        \"status\": \"Ok\",\n        \"message\": \"={{$node[\\\"Cortex\\\"].json[\\\"analyzerName\\\"]}}\",\n        \"options\": {\n          \"tags\": \"Domain\"\n        },\n        \"dataType\": \"ip\",\n        \"resource\": \"observable\",\n        \"operation\": \"create\"\n      },\n      \"credentials\": {\n        \"theHiveApi\": {\n          \"id\": \"1\",\n          \"name\": \"The Hive account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Wait\",\n      \"type\": \"n8n-nodes-base.wait\",\n      \"position\": [\n        800,\n        200\n      ],\n      \"webhookId\": \"ecada1d5-a671-44fc-906e-c64c6f05e760\",\n      \"parameters\": {\n        \"unit\": \"seconds\",\n        \"amount\": 5\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Email Reputation\",\n      \"type\": \"n8n-nodes-base.theHive\",\n      \"position\": [\n        640,\n        620\n      ],\n      \"parameters\": {\n        \"id\": \"={{$node[\\\"Update Case Email\\\"].json[\\\"id\\\"]}}\",\n        \"dataType\": \"mail\",\n        \"resource\": \"observable\",\n        \"analyzers\": [\n          \"9902b4e5c58015184b177de13f2151c7::CORTEX\"\n        ],\n        \"operation\": \"executeAnalyzer\"\n      },\n      \"credentials\": {\n        \"theHiveApi\": {\n          \"id\": \"1\",\n          \"name\": \"The Hive account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"OTX IP\",\n      \"type\": \"n8n-nodes-base.theHive\",\n      \"position\": [\n        640,\n        760\n      ],\n      \"parameters\": {\n        \"id\": \"={{$node[\\\"Update Case Ip\\\"].json[\\\"id\\\"]}}\",\n        \"dataType\": \"ip\",\n        \"resource\": \"observable\",\n        \"analyzers\": [\n          \"b084bf78d1aea92966b6ef6a4f6193a5::CORTEX\"\n        ],\n        \"operation\": \"executeAnalyzer\"\n      },\n      \"credentials\": {\n        \"theHiveApi\": {\n          \"id\": \"1\",\n          \"name\": \"The Hive account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"OTX DOMAIN\",\n      \"type\": \"n8n-nodes-base.theHive\",\n      \"position\": [\n        640,\n        480\n      ],\n      \"parameters\": {\n        \"id\": \"={{$node[\\\"Update Case Domain\\\"].json[\\\"id\\\"]}}\",\n        \"dataType\": \"domain\",\n        \"resource\": \"observable\",\n        \"analyzers\": [\n          \"b084bf78d1aea92966b6ef6a4f6193a5::CORTEX\"\n        ],\n        \"operation\": \"executeAnalyzer\"\n      },\n      \"credentials\": {\n        \"theHiveApi\": {\n          \"id\": \"1\",\n          \"name\": \"The Hive account\"\n        }\n      },\n      \"typeVersion\": 1\n    }\n  ],\n  \"active\": true,\n  \"settings\": {},\n  \"connections\": {\n    \"IF\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Update Case Domain\",\n            \"type\": \"main\",\n            \"index\": 0\n          },\n          {\n            \"node\": \"Update Case Email\",\n            \"type\": \"main\",\n            \"index\": 0\n          },\n          {\n            \"node\": \"Update Case Ip\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Case\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Wait\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Wait\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Observable\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Cortex\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"IF\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"TheHive\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Create Case\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"IMAP Email\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"TheHive\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Observable\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Analyzer Email\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Create Case\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Case\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Analyzer Email\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Cortex\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Update Case Ip\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"OTX IP\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Update Case Email\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Email Reputation\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Update Case Domain\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"OTX DOMAIN\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}",
  "metadata": {
    "node_types": [
      "n8n-nodes-base.emailReadImap",
      "n8n-nodes-base.theHive",
      "n8n-nodes-base.theHive",
      "n8n-nodes-base.theHive",
      "n8n-nodes-base.theHive",
      "n8n-nodes-base.theHive",
      "n8n-nodes-base.cortex",
      "n8n-nodes-base.if",
      "n8n-nodes-base.theHive",
      "n8n-nodes-base.theHive",
      "n8n-nodes-base.theHive",
      "n8n-nodes-base.wait",
      "n8n-nodes-base.theHive",
      "n8n-nodes-base.theHive",
      "n8n-nodes-base.theHive"
    ],
    "trigger": null
  }
}