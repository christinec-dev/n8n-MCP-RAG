{
  "source": "1562_Filter_Manual_Import_Webhook.json",
  "index": 1,
  "content": "{\n  \"id\": \"NLVfecejH0cTtcdd\",\n  \"meta\": {\n    \"instanceId\": \"fb924c73af8f703905bc09c9ee8076f48c17b596ed05b18c0ff86915ef8a7c4a\"\n  },\n  \"name\": \"Import CSV from URL to GoogleSheet\",\n  \"tags\": [],\n  \"nodes\": [\n    {\n      \"id\": \"90cced3d-b03b-4b51-b1f7-4cbd2dac25eb\",\n      \"name\": \"When clicking \\\"Execute Workflow\\\"\",\n      \"type\": \"n8n-nodes-base.manualTrigger\",\n      \"position\": [\n        860,\n        380\n      ],\n      \"parameters\": {},\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"df9519b6-937e-4a9e-bdb9-86fb722ca3c1\",\n      \"name\": \"Upload to spreadsheet\",\n      \"type\": \"n8n-nodes-base.googleSheets\",\n      \"position\": [\n        1880,\n        380\n      ],\n      \"parameters\": {\n        \"columns\": {\n          \"value\": {},\n          \"schema\": [\n            {\n              \"id\": \"unique_key\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"unique_key\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"﻿country\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"required\": false,\n              \"displayName\": \"﻿country\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"country_code\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"required\": false,\n              \"displayName\": \"country_code\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"year_week\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"required\": false,\n              \"displayName\": \"year_week\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"level\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"required\": false,\n              \"displayName\": \"level\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"region\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"required\": false,\n              \"displayName\": \"region\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"region_name\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"required\": false,\n              \"displayName\": \"region_name\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"new_cases\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"required\": false,\n              \"displayName\": \"new_cases\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"tests_done\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"required\": false,\n              \"displayName\": \"tests_done\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"population\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"required\": false,\n              \"displayName\": \"population\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"testing_rate\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"required\": false,\n              \"displayName\": \"testing_rate\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"positivity_rate\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"required\": false,\n              \"displayName\": \"positivity_rate\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"testing_data_source\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"required\": false,\n              \"displayName\": \"testing_data_source\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            }\n          ],\n          \"mappingMode\": \"autoMapInputData\",\n          \"matchingColumns\": [\n            \"unique_key\"\n          ]\n        },\n        \"options\": {\n          \"cellFormat\": \"USER_ENTERED\"\n        },\n        \"operation\": \"appendOrUpdate\",\n        \"sheetName\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": 383583634,\n          \"cachedResultUrl\": \"https://docs.google.com/spreadsheets/d/13YYuEJ1cDf-t8P2MSTFWnnNHCreQ6Zo8oPSp7WeNnbY/edit#gid=383583634\",\n          \"cachedResultName\": \"COVID-weekly\"\n        },\n        \"documentId\": {\n          \"__rl\": true,\n          \"mode\": \"url\",\n          \"value\": \"https://docs.google.com/spreadsheets/d/13YYuEJ1cDf-t8P2MSTFWnnNHCreQ6Zo8oPSp7WeNnbY\"\n        }\n      },\n      \"credentials\": {\n        \"googleSheetsOAuth2Api\": {\n          \"id\": \"54\",\n          \"name\": \"Google Sheets account\"\n        }\n      },\n      \"typeVersion\": 4\n    },\n    {\n      \"id\": \"8298b29e-8784-4e15-902f-dc073fa73668\",\n      \"name\": \"Add unique field\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        1460,\n        380\n      ],\n      \"parameters\": {\n        \"fields\": {\n          \"values\": [\n            {\n              \"name\": \"unique_key\",\n              \"stringValue\": \"={{ $json.country_code }}-{{ $json.year_week }}\"\n            }\n          ]\n        },\n        \"options\": {}\n      },\n      \"typeVersion\": 3\n    },\n    {\n      \"id\": \"b71bb998-4df2-4311-ae98-42c3e5e41d58\",\n      \"name\": \"Import CSV\",\n      \"type\": \"n8n-nodes-base.spreadsheetFile\",\n      \"position\": [\n        1260,\n        380\n      ],\n      \"parameters\": {\n        \"options\": {\n          \"headerRow\": true\n        },\n        \"fileFormat\": \"csv\"\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"36204081-3995-46d4-ac8f-3408cbaed657\",\n      \"name\": \"Download CSV\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        1060,\n        380\n      ],\n      \"parameters\": {\n        \"url\": \"https://opendata.ecdc.europa.eu/covid19/testing/csv/data.csv\",\n        \"options\": {\n          \"response\": {\n            \"response\": {\n              \"responseFormat\": \"file\"\n            }\n          }\n        }\n      },\n      \"typeVersion\": 4.1\n    },\n    {\n      \"id\": \"b1a78d2e-1a8b-4d98-b130-080b3017192d\",\n      \"name\": \"Keep only DACH in 2023\",\n      \"type\": \"n8n-nodes-base.filter\",\n      \"position\": [\n        1680,\n        380\n      ],\n      \"parameters\": {\n        \"conditions\": {\n          \"string\": [\n            {\n              \"value1\": \"={{ $json.year_week }}\",\n              \"value2\": \"2023\",\n              \"operation\": \"startsWith\"\n            }\n          ],\n          \"boolean\": [\n            {\n              \"value1\": \"={{ ['DE', 'AT', 'CH'].includes($json.country_code )}}\",\n              \"value2\": true\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"c5a3af9b-30a0-4337-bbb7-cff54007b22f\",\n      \"name\": \"Sticky Note\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        1620,\n        241\n      ],\n      \"parameters\": {\n        \"width\": 460,\n        \"height\": 293,\n        \"content\": \"### Google API has rate-limits for read and write operations, that's why we take only a subset of the data\\n\\nTo import the whole dataset please add Split In Batches and a Wait node with a sufficient delay.\"\n      },\n      \"typeVersion\": 1\n    }\n  ],\n  \"active\": false,\n  \"pinData\": {},\n  \"settings\": {\n    \"executionOrder\": \"v1\"\n  },\n  \"versionId\": \"d49a3f54-a422-4e76-b410-f8c12b4dd78b\",\n  \"connections\": {\n    \"Import CSV\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Add unique field\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Download CSV\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Import CSV\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Add unique field\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Keep only DACH in 2023\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Keep only DACH in 2023\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Upload to spreadsheet\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"When clicking \\\"Execute Workflow\\\"\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Download CSV\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}",
  "metadata": {
    "node_types": [
      "n8n-nodes-base.manualTrigger",
      "n8n-nodes-base.googleSheets",
      "n8n-nodes-base.set",
      "n8n-nodes-base.spreadsheetFile",
      "n8n-nodes-base.httpRequest",
      "n8n-nodes-base.filter",
      "n8n-nodes-base.stickyNote"
    ],
    "trigger": null
  }
}