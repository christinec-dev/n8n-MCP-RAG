{
  "source": "0726_Code_Schedule_Update_Scheduled.json",
  "index": 1,
  "content": "{\n  \"nodes\": [\n    {\n      \"id\": \"4ca55c6e-cf2e-4239-82a9-88d0a201e761\",\n      \"name\": \"List upgradable packages\",\n      \"type\": \"n8n-nodes-base.ssh\",\n      \"notes\": \"apt list --upgradable\",\n      \"position\": [\n        -280,\n        0\n      ],\n      \"parameters\": {\n        \"command\": \"apt list --upgradable\"\n      },\n      \"credentials\": {\n        \"sshPassword\": {\n          \"id\": \"Ps31IKTeseWFlA0g\",\n          \"name\": \"SSH Password account\"\n        }\n      },\n      \"notesInFlow\": true,\n      \"typeVersion\": 1,\n      \"alwaysOutputData\": false\n    },\n    {\n      \"id\": \"ae1f0a55-31aa-494b-baa6-822dc606188e\",\n      \"name\": \"Send Email through SMTP\",\n      \"type\": \"n8n-nodes-base.emailSend\",\n      \"position\": [\n        380,\n        0\n      ],\n      \"webhookId\": \"8073c571-b36f-4330-a510-ca2ff2924fbf\",\n      \"parameters\": {\n        \"html\": \"=The following packages can be updated on your server:\\n\\n{{ $json.htmlList }}\\n\\nPlease login and perform upgrade.\",\n        \"options\": {},\n        \"subject\": \"Server needs updates\",\n        \"toEmail\": \"change.me@example.com\",\n        \"fromEmail\": \"change.me@example.com\"\n      },\n      \"credentials\": {\n        \"smtp\": {\n          \"id\": \"uiNePdJaDng5a43S\",\n          \"name\": \"SMTP account\"\n        }\n      },\n      \"typeVersion\": 2.1\n    },\n    {\n      \"id\": \"e1d76671-d94c-40d5-9364-623db9319f11\",\n      \"name\": \"Run workflow every day\",\n      \"type\": \"n8n-nodes-base.scheduleTrigger\",\n      \"position\": [\n        -540,\n        0\n      ],\n      \"parameters\": {\n        \"rule\": {\n          \"interval\": [\n            {}\n          ]\n        }\n      },\n      \"typeVersion\": 1.2\n    },\n    {\n      \"id\": \"ec4d722a-b88c-42da-971c-28ad5774596d\",\n      \"name\": \"Format as HTML list\",\n      \"type\": \"n8n-nodes-base.code\",\n      \"position\": [\n        -60,\n        0\n      ],\n      \"parameters\": {\n        \"jsCode\": \"function formatStdoutAsHtmlList(stdoutData) {\\n\\n    // Split the stdout into lines and map to HTML list items\\n    const htmlListItems = stdoutData.split('\\\\n').map((line) => {\\n        if (line.trim() && line !== \\\"Listing...\\\") { // Optionally skip empty lines or headers\\n            return `<li>${line.trim()}</li>`;\\n        }\\n    }).filter(item => item); // Remove any undefined items due to empty lines or skipped headers\\n\\n    // Wrap the list items in a <ul> tag\\n    const htmlList = `<ul>${htmlListItems.join('')}</ul>`;\\n\\n    // Return the formatted HTML list as part of an object\\n    return { \\\"htmlList\\\": htmlList };\\n}\\n\\nreturn formatStdoutAsHtmlList($input.first().json.stdout);\"\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"6f14eb02-c505-4f83-a5bb-68094e763fd9\",\n      \"name\": \"Check if there are updates\",\n      \"type\": \"n8n-nodes-base.if\",\n      \"position\": [\n        140,\n        0\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"conditions\": {\n          \"options\": {\n            \"version\": 2,\n            \"leftValue\": \"\",\n            \"caseSensitive\": true,\n            \"typeValidation\": \"strict\"\n          },\n          \"combinator\": \"and\",\n          \"conditions\": [\n            {\n              \"id\": \"db66d892-26fb-406c-a0ac-2e4b8a60310a\",\n              \"operator\": {\n                \"type\": \"string\",\n                \"operation\": \"notEquals\"\n              },\n              \"leftValue\": \"={{ $json.htmlList }}\",\n              \"rightValue\": \"<ul></ul>\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 2.2\n    },\n    {\n      \"id\": \"3924c696-5b0e-4ae2-b2e2-435fed344028\",\n      \"name\": \"Sticky Note\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -740,\n        -180\n      ],\n      \"parameters\": {\n        \"width\": 300,\n        \"content\": \"## VPS upgrade notify \\nThis workflow will everyday check if server has upgradable packages and inform you by email if there is.\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"bb8ade2a-4ffe-4c79-91eb-55af568eb1b1\",\n      \"name\": \"Sticky Note1\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        380,\n        -180\n      ],\n      \"parameters\": {\n        \"width\": 300,\n        \"content\": \"## Update email addresses\\nUpdate From and To email addresses in this node to receive notifications\"\n      },\n      \"typeVersion\": 1\n    }\n  ],\n  \"connections\": {\n    \"Format as HTML list\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Check if there are updates\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Run workflow every day\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"List upgradable packages\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Send Email through SMTP\": {\n      \"main\": [\n        []\n      ]\n    },\n    \"List upgradable packages\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Format as HTML list\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Check if there are updates\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Send Email through SMTP\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}",
  "metadata": {
    "node_types": [
      "n8n-nodes-base.ssh",
      "n8n-nodes-base.emailSend",
      "n8n-nodes-base.scheduleTrigger",
      "n8n-nodes-base.code",
      "n8n-nodes-base.if",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote"
    ],
    "trigger": null
  }
}