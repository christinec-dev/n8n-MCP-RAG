{
  "source": "0932_Limit_Code_Create_Webhook.json",
  "index": 1,
  "content": "{\n  \"id\": \"3JsfhcDcjqxx0hr3\",\n  \"meta\": {\n    \"instanceId\": \"38fb1860cc6284b8af9ba3b485f32cc1851cd97470ef1b4a472b5e707f1c93b5\"\n  },\n  \"name\": \"Extract And Decode Google News RSS URLs to Clean Article Links\",\n  \"tags\": [\n    {\n      \"id\": \"ROumyeVDIszTv7f5\",\n      \"name\": \"no-ai\",\n      \"createdAt\": \"2025-02-08T15:29:36.956Z\",\n      \"updatedAt\": \"2025-02-08T15:29:36.956Z\"\n    },\n    {\n      \"id\": \"XuoLgc5Eegoi3VEP\",\n      \"name\": \"scraping\",\n      \"createdAt\": \"2025-01-31T18:19:12.753Z\",\n      \"updatedAt\": \"2025-01-31T18:19:12.753Z\"\n    },\n    {\n      \"id\": \"nBHkkAND8NXbkg8m\",\n      \"name\": \"news\",\n      \"createdAt\": \"2025-03-13T15:47:18.420Z\",\n      \"updatedAt\": \"2025-03-13T15:47:18.420Z\"\n    }\n  ],\n  \"nodes\": [\n    {\n      \"id\": \"cdb0a726-e961-40ae-b679-43f7bd73650d\",\n      \"name\": \"When clicking ‘Test workflow’\",\n      \"type\": \"n8n-nodes-base.manualTrigger\",\n      \"position\": [\n        560,\n        1240\n      ],\n      \"parameters\": {},\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"028ddd3b-069c-43be-ad56-8f898805fccf\",\n      \"name\": \"Limit\",\n      \"type\": \"n8n-nodes-base.limit\",\n      \"position\": [\n        1040,\n        1000\n      ],\n      \"parameters\": {\n        \"maxItems\": 5\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"2215bfdc-1e6e-475c-9753-b05fd5b0d63a\",\n      \"name\": \"Reading Google News RSS\",\n      \"type\": \"n8n-nodes-base.rssFeedRead\",\n      \"position\": [\n        840,\n        1000\n      ],\n      \"parameters\": {\n        \"url\": \"https://news.google.com/rss?hl=it&gl=IT&ceid=IT:it\",\n        \"options\": {\n          \"ignoreSSL\": false\n        }\n      },\n      \"typeVersion\": 1.1\n    },\n    {\n      \"id\": \"23b50dac-9506-41cb-8b57-15373468ab3c\",\n      \"name\": \"Decoded url\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        1520,\n        1420\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"c51f320e-4fb8-4bd4-8e36-9330e251936e\",\n              \"name\": \"google_news_url\",\n              \"type\": \"string\",\n              \"value\": \"={{ JSON.parse(JSON.parse($json.data.split('\\\\n\\\\n')[1])[0][2])[1] }}\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 3.4\n    },\n    {\n      \"id\": \"40f54966-41c7-4dc3-95ac-18b8eaffe1db\",\n      \"name\": \"Call decoding URL\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        1280,\n        1420\n      ],\n      \"parameters\": {\n        \"url\": \"https://news.google.com/_/DotsSplashUi/data/batchexecute\",\n        \"method\": \"POST\",\n        \"options\": {\n          \"response\": {\n            \"response\": {\n              \"fullResponse\": true,\n              \"responseFormat\": \"text\"\n            }\n          }\n        },\n        \"sendBody\": true,\n        \"contentType\": \"form-urlencoded\",\n        \"sendHeaders\": true,\n        \"bodyParameters\": {\n          \"parameters\": [\n            {\n              \"name\": \"f.req\",\n              \"value\": \"={{ $json.f_req }}\"\n            }\n          ]\n        },\n        \"headerParameters\": {\n          \"parameters\": [\n            {\n              \"name\": \"Content-Type\",\n              \"value\": \"application/x-www-form-urlencoded;charset=UTF-8\"\n            },\n            {\n              \"name\": \"User-Agent\",\n              \"value\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/129.0.0.0 Safari/537.36\"\n            },\n            {\n              \"name\": \"Referer\",\n              \"value\": \"https://www.google.com/\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 4.2\n    },\n    {\n      \"id\": \"e7a208d3-bf65-4170-bb11-d13287f8dd78\",\n      \"name\": \"Prepare decoding variables\",\n      \"type\": \"n8n-nodes-base.code\",\n      \"position\": [\n        1040,\n        1420\n      ],\n      \"parameters\": {\n        \"jsCode\": \"return $input.all().map(item => {\\n    const gn_art_id = item.json.base64Str;\\n    const timestamp = item.json.timestamp;\\n    const signature = item.json.signature;\\n\\n    const articlesReq = [\\n        'Fbv4je',\\n        `[\\\"garturlreq\\\",[[\\\"X\\\",\\\"X\\\",[\\\"X\\\",\\\"X\\\"],null,null,1,1,\\\"US:en\\\",null,1,null,null,null,null,null,0,1],\\\"X\\\",\\\"X\\\",1,[1,1,1],1,1,null,0,0,null,0],\\\"${gn_art_id}\\\",${timestamp},\\\"${signature}\\\"]`,\\n    ];\\n\\n    return {\\n        json: {\\n            f_req: JSON.stringify([[articlesReq]])  // Questo verrà usato nel nodo HTTP Request\\n        }\\n    };\\n});\"\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"35fe85f1-82c7-4b50-b47b-14c56678e377\",\n      \"name\": \"Get encoded news URL\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        1280,\n        1000\n      ],\n      \"parameters\": {\n        \"url\": \"={{ $('Limit').item.json.link }}\",\n        \"options\": {}\n      },\n      \"typeVersion\": 4.2\n    },\n    {\n      \"id\": \"3d640138-4247-4e6d-a0e9-fefc9f41e057\",\n      \"name\": \"Sticky Note1\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        740,\n        760\n      ],\n      \"parameters\": {\n        \"width\": 220,\n        \"height\": 400,\n        \"content\": \"## Get Google News\\n\\nChange the language parameters on ISO639-1 standard \\n\\n1. hl=it\\n2. gl=IT\\n3. ceid=IT:it\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"1e7a5638-8829-49f1-a445-f510eb18bbd7\",\n      \"name\": \"Sticky Note2\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        980,\n        760\n      ],\n      \"parameters\": {\n        \"width\": 220,\n        \"height\": 400,\n        \"content\": \"## Limit result\\n\\nI suggest limiting the results to a maximum of 3 because the entire workflow makes a lot of HTTP requests\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"24a405df-c334-461a-ab0d-91ebc39185c1\",\n      \"name\": \"Sticky Note3\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        500,\n        760\n      ],\n      \"parameters\": {\n        \"color\": 5,\n        \"width\": 220,\n        \"height\": 820,\n        \"content\": \"## INFO\\n\\nDisclaimer:\\nYou can add a cron trigger but... don't do too often: Google could block your ip.\\n\\nThis workflow works until works: the decoding procedure is hardcoded and based on reverse engineering. Requests and responses are not documented by Google.\\n\\n\\n\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"c54e9729-7cbd-4628-b7be-ee072047b3d4\",\n      \"name\": \"Sticky Note4\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        1220,\n        760\n      ],\n      \"parameters\": {\n        \"color\": 3,\n        \"width\": 220,\n        \"height\": 400,\n        \"content\": \"## Get encoded content\\n\\nHere we retrieve HTML content\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"a5b25d20-0d06-4650-b8bc-0d03c97eb416\",\n      \"name\": \"Map needed keys\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        780,\n        1420\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"b5a11795-2bd1-412f-a215-f7402bece002\",\n              \"name\": \"signature\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.signature }}\"\n            },\n            {\n              \"id\": \"33267283-3ac8-4d65-9a01-c7f154a7d061\",\n              \"name\": \"timestamp\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.timestamp }}\"\n            },\n            {\n              \"id\": \"bff8f19a-30d6-4307-87da-9b98b26cee8b\",\n              \"name\": \"base64Str\",\n              \"type\": \"string\",\n              \"value\": \"={{ $('Limit').item.json.guid }}\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 3.4\n    },\n    {\n      \"id\": \"116eec84-dbfe-4880-8fc4-d350ff99d4be\",\n      \"name\": \"Extract decoding keys\",\n      \"type\": \"n8n-nodes-base.html\",\n      \"position\": [\n        1520,\n        1000\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"operation\": \"extractHtmlContent\",\n        \"extractionValues\": {\n          \"values\": [\n            {\n              \"key\": \"signature\",\n              \"attribute\": \"data-n-a-sg\",\n              \"cssSelector\": \"div\",\n              \"returnValue\": \"attribute\"\n            },\n            {\n              \"key\": \"timestamp\",\n              \"attribute\": \"data-n-a-ts\",\n              \"cssSelector\": \"div\",\n              \"returnValue\": \"attribute\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 1.2\n    },\n    {\n      \"id\": \"22825293-d9f8-4fa2-99b4-2150a74b2a12\",\n      \"name\": \"Sticky Note5\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        1460,\n        760\n      ],\n      \"parameters\": {\n        \"width\": 220,\n        \"height\": 400,\n        \"content\": \"## Decoding Keys\\n\\nThe HTML content extracted contains the necessary variables for decoding:\\n\\n+ signature\\n+ timestamp\\n+ base64string (already in the URL)\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"46dce5e2-1c4f-45d8-a849-ebe13d673ef9\",\n      \"name\": \"Sticky Note6\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        740,\n        1180\n      ],\n      \"parameters\": {\n        \"width\": 220,\n        \"height\": 400,\n        \"content\": \"## Clean output\\n\\nMapping variables for easy utilization\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"9dbc9f69-d34a-470e-81af-c3bcc9a92a48\",\n      \"name\": \"Sticky Note7\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        980,\n        1180\n      ],\n      \"parameters\": {\n        \"color\": 3,\n        \"width\": 220,\n        \"height\": 400,\n        \"content\": \"## Preparing Request\\n\\nDecoding the request requires specific body content. Here, we build it using the decoding keys.\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"39a492a7-a099-4ae7-ac17-d3842f0682fe\",\n      \"name\": \"Sticky Note8\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        1220,\n        1180\n      ],\n      \"parameters\": {\n        \"color\": 3,\n        \"width\": 220,\n        \"height\": 400,\n        \"content\": \"## This is decoding step\\n\\nSending a request to a specific Google decoding URL\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"29d3b1a3-5882-484d-9add-68a746f0a7b8\",\n      \"name\": \"Sticky Note9\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        1460,\n        1180\n      ],\n      \"parameters\": {\n        \"width\": 220,\n        \"height\": 400,\n        \"content\": \"## Cleaning URL\\n\\nGoogle adds some unwanted and random characters at the beginning of the URL\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"6b2fc671-2a22-4a6d-bcc5-38294981d9fe\",\n      \"name\": \"Sticky Note10\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        1700,\n        760\n      ],\n      \"parameters\": {\n        \"color\": 4,\n        \"width\": 220,\n        \"height\": 820,\n        \"content\": \"## OUTPUT\\n\\nA lot of requests are made before getting clean News URLs.\\n\\nYou can add an HttpRequest and get News text with jina.ai, extract by using HTML node, or a custom node like https://www.npmjs.com/package/n8n-nodes-webpage-content-extractor\\n\\n\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"6c82769b-e784-4a38-b2ed-447da7f1a6f7\",\n      \"name\": \"Aggregate results in a single object\",\n      \"type\": \"n8n-nodes-base.aggregate\",\n      \"position\": [\n        1760,\n        1080\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"aggregate\": \"aggregateAllItemData\"\n      },\n      \"typeVersion\": 1\n    }\n  ],\n  \"active\": false,\n  \"pinData\": {},\n  \"settings\": {\n    \"executionOrder\": \"v1\"\n  },\n  \"versionId\": \"c4fbad75-5811-4031-bdfe-ee494067ded3\",\n  \"connections\": {\n    \"Limit\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Get encoded news URL\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Decoded url\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Aggregate results in a single object\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Map needed keys\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Prepare decoding variables\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Call decoding URL\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Decoded url\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Get encoded news URL\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Extract decoding keys\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Extract decoding keys\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Map needed keys\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Reading Google News RSS\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Limit\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Prepare decoding variables\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Call decoding URL\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"When clicking ‘Test workflow’\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Reading Google News RSS\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}",
  "metadata": {
    "node_types": [
      "n8n-nodes-base.manualTrigger",
      "n8n-nodes-base.limit",
      "n8n-nodes-base.rssFeedRead",
      "n8n-nodes-base.set",
      "n8n-nodes-base.httpRequest",
      "n8n-nodes-base.code",
      "n8n-nodes-base.httpRequest",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.set",
      "n8n-nodes-base.html",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.aggregate"
    ],
    "trigger": null
  }
}