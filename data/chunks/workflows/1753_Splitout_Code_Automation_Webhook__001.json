{
  "source": "1753_Splitout_Code_Automation_Webhook.json",
  "index": 1,
  "content": "{\n  \"id\": \"mKGMYXJottl0PDtM\",\n  \"meta\": {\n    \"instanceId\": \"cb484ba7b742928a2048bf8829668bed5b5ad9787579adea888f05980292a4a7\"\n  },\n  \"name\": \"Write a WordPress post with AI (starting from a few keywords)\",\n  \"tags\": [],\n  \"nodes\": [\n    {\n      \"id\": \"a4f19a81-6101-48c2-9560-9cf231bc240b\",\n      \"name\": \"Form\",\n      \"type\": \"n8n-nodes-base.formTrigger\",\n      \"position\": [\n        -580,\n        320\n      ],\n      \"webhookId\": \"4b937814-e829-4df7-aaba-31192babf7e1\",\n      \"parameters\": {\n        \"path\": \"create-wordpress-post\",\n        \"formTitle\": \"Create a WordPress post with AI\",\n        \"formFields\": {\n          \"values\": [\n            {\n              \"fieldLabel\": \"Keywords (comma-separated)\",\n              \"requiredField\": true\n            },\n            {\n              \"fieldType\": \"dropdown\",\n              \"fieldLabel\": \"Number of chapters\",\n              \"fieldOptions\": {\n                \"values\": [\n                  {\n                    \"option\": \"1\"\n                  },\n                  {\n                    \"option\": \"2\"\n                  },\n                  {\n                    \"option\": \"3\"\n                  },\n                  {\n                    \"option\": \"4\"\n                  },\n                  {\n                    \"option\": \"5\"\n                  },\n                  {\n                    \"option\": \"6\"\n                  },\n                  {\n                    \"option\": \"7\"\n                  },\n                  {\n                    \"option\": \"8\"\n                  },\n                  {\n                    \"option\": \"9\"\n                  },\n                  {\n                    \"option\": \"10\"\n                  }\n                ]\n              },\n              \"requiredField\": true\n            },\n            {\n              \"fieldType\": \"number\",\n              \"fieldLabel\": \"Max words count\",\n              \"requiredField\": true\n            }\n          ]\n        },\n        \"responseMode\": \"responseNode\",\n        \"formDescription\": \"Fill this form with the required information to create a draft post on WordPress\"\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"e4cf75f7-00e7-473a-a944-af635581715f\",\n      \"name\": \"Sticky Note2\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        209.98769233621147,\n        140\n      ],\n      \"parameters\": {\n        \"color\": 4,\n        \"width\": 301.3874093724939,\n        \"height\": 371.765663140765,\n        \"content\": \"## Data check\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"e949a487-6701-4650-b9be-08146b4e93ad\",\n      \"name\": \"Sticky Note3\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        225.20535922952297,\n        200\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 272.8190508599808,\n        \"height\": 80,\n        \"content\": \"Checks that the data returned by OpenAI is correct\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"662fe28b-c0b7-4aef-b99c-a8c4c641251c\",\n      \"name\": \"Sticky Note5\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        1580,\n        140\n      ],\n      \"parameters\": {\n        \"color\": 5,\n        \"width\": 282.3398199598652,\n        \"height\": 371.7656631407652,\n        \"content\": \"## Draft on WordPress\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"85996d51-ab98-41f5-b525-d926f04f50a8\",\n      \"name\": \"Sticky Note9\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        1595,\n        200\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 254.77269221373095,\n        \"height\": 80,\n        \"content\": \"The article is posted as a draft on WordPress\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"46f67505-f2dc-4110-b1d4-a27d7814cb52\",\n      \"name\": \"Sticky Note10\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        1881,\n        140\n      ],\n      \"parameters\": {\n        \"color\": 3,\n        \"width\": 557.7592769264069,\n        \"height\": 369.2595606183891,\n        \"content\": \"## Featured image\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"a1beeb4f-f171-4c6a-ac19-7086b09757ab\",\n      \"name\": \"Sticky Note11\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        1900,\n        200\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 517.9195082760601,\n        \"height\": 80,\n        \"content\": \"The image is generated with Dall-E, uploaded to WordPress, and then connected to the post as its featured image\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"d1fd737b-7f14-4371-8720-7742f708e641\",\n      \"name\": \"Sticky Note12\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -117.99507693448459,\n        200\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 287.370178643191,\n        \"height\": 80,\n        \"content\": \"Starting from the given keywords, generates the article title, subtitle, chapters, and image prompt\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"ccaaf851-613b-4d0c-8b3d-99a35ec9cdad\",\n      \"name\": \"Sticky Note\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -129.93405171072595,\n        142\n      ],\n      \"parameters\": {\n        \"color\": 6,\n        \"width\": 319.697690939268,\n        \"height\": 370.512611879577,\n        \"content\": \"## Article structure\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"69bebd7b-8ad5-4b0d-a8df-1b2e6d4be96e\",\n      \"name\": \"Sticky Note1\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -640,\n        140\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 239.97343293577688,\n        \"height\": 370.512611879577,\n        \"content\": \"## User form\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"2037f81b-189c-4dc4-a4dc-179e4283544c\",\n      \"name\": \"Sticky Note13\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -623,\n        200\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 199.7721486302032,\n        \"height\": 80,\n        \"content\": \"The user triggers the post creation\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"e8d7f711-185d-499b-ba58-de52ac6a4e58\",\n      \"name\": \"Sticky Note4\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        2461,\n        140\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 219.70753707029849,\n        \"height\": 370.512611879577,\n        \"content\": \"## User feedback\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"d89bebca-3607-4c66-a13d-07c32262e01a\",\n      \"name\": \"Sticky Note14\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        2481,\n        200\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 183.38125554060056,\n        \"height\": 80,\n        \"content\": \"Final confirmation to the user\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"7df452e2-52f3-4efe-94a4-7d4eab0670c8\",\n      \"name\": \"Sticky Note6\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        534.9876923362115,\n        530.9889231025903\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 281.2716777103785,\n        \"height\": 288.4116890365125,\n        \"content\": \"\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\nUser is notified to try again since some data is missing\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"f881bcd9-c7d2-4a1c-bc1a-beb515d52ade\",\n      \"name\": \"Sticky Note7\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -128.98646156983267,\n        532.991384635348\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 319.8306137081817,\n        \"height\": 275.3956890735875,\n        \"content\": \"\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\nWikipedia is used to write the article\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"1b788b37-b8b5-47f6-8198-547dac8c76d6\",\n      \"name\": \"Settings\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        -320,\n        320\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"3a433b0f-9957-4b64-ad81-359ab5e521d5\",\n              \"name\": \"wordpress_url\",\n              \"type\": \"string\",\n              \"value\": \"https://you-wordpress-url-here.com/\"\n            },\n            {\n              \"id\": \"ec5430e3-92c5-46e4-8c2c-c87291680892\",\n              \"name\": \"keywords\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json['Keywords (comma-separated)'] }}\"\n            },\n            {\n              \"id\": \"5defb0a2-d921-4909-b10d-da59e1768496\",\n              \"name\": \"chapters\",\n              \"type\": \"number\",\n              \"value\": \"={{ $json['Number of chapters'] }}\"\n            },\n            {\n              \"id\": \"230ebd0b-73c2-4265-9b3c-57af7fbc48c8\",\n              \"name\": \"words\",\n              \"type\": \"number\",\n              \"value\": \"={{ $json['Max words count'] }}\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 3.3\n    },\n    {\n      \"id\": \"af29ed91-84b5-43f8-b1ce-1c8dc35c2c1b\",\n      \"name\": \"Sticky Note8\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -377,\n        140\n      ],\n      \"parameters\": {\n        \"color\": 2,\n        \"width\": 226.71615243495023,\n        \"height\": 370.512611879577,\n        \"content\": \"## Settings\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"a6fe2238-22ba-4c54-adef-663bd3955dcc\",\n      \"name\": \"Sticky Note15\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -360,\n        200\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 179.37633247508526,\n        \"height\": 80,\n        \"content\": \"Set the URL of your WordPress here\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"358ac79f-be7d-44eb-a353-b2ad4ac8d582\",\n      \"name\": \"Check data consistency\",\n      \"type\": \"n8n-nodes-base.if\",\n      \"position\": [\n        300,\n        320\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"conditions\": {\n          \"options\": {\n            \"leftValue\": \"\",\n            \"caseSensitive\": true,\n            \"typeValidation\": \"strict\"\n          },\n          \"combinator\": \"and\",\n          \"conditions\": [\n            {\n              \"id\": \"9c8c53ea-6079-48da-9d6e-dd527167b123\",\n              \"operator\": {\n                \"type\": \"string\",\n                \"operation\": \"notEmpty\",\n                \"singleValue\": true\n              },\n              \"leftValue\": \"={{ $json.message.content.title }}\",\n              \"rightValue\": \"\"\n            },\n            {\n              \"id\": \"a7fabfe1-3539-453a-93d9-8d6d395c3de4\",\n              \"operator\": {\n                \"type\": \"array\",\n                \"operation\": \"lengthGte\",\n                \"rightType\": \"number\"\n              },\n              \"leftValue\": \"={{ $json.message.content.chapters }}\",\n              \"rightValue\": \"={{ 1 }}\"\n            },\n            {\n              \"id\": \"a687081e-24e2-423c-a2da-b7c18baf0715\",\n              \"operator\": {\n                \"type\": \"string\",\n                \"operation\": \"notEmpty\",\n                \"singleValue\": true\n              },\n              \"leftValue\": \"={{ $json.message.content.subtitle }}\",\n              \"rightValue\": \"\"\n            },\n            {\n              \"id\": \"0a435a69-3699-4b98-b46f-40954c7a7816\",\n              \"operator\": {\n                \"type\": \"string\",\n                \"operation\": \"notEmpty\",\n                \"singleValue\": true\n              },\n              \"leftValue\": \"={{ $json.message.content.introduction }}\",\n              \"rightValue\": \"\"\n            },\n            {\n              \"id\": \"1a440144-21f3-42bd-9222-774bd564f3ef\",\n              \"operator\": {\n                \"type\": \"string\",\n                \"operation\": \"notEmpty\",\n                \"singleValue\": true\n              },\n              \"leftValue\": \"={{ $json.message.content.conclusions }}\",\n              \"rightValue\": \"\"\n            },\n            {\n              \"id\": \"834ce92d-b1e9-48ef-ae63-1d0841c900b5\",\n              \"operator\": {\n                \"type\": \"string\",\n                \"operation\": \"notEmpty\",\n                \"singleValue\": true\n              },\n              \"leftValue\": \"={{ $json.message.content.imagePrompt }}\",\n              \"rightValue\": \"\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"479f474a-1687-4588-8485-d793afc6757d\",\n      \"name\": \"Split out chapters\",\n      \"type\": \"n8n-nodes-base.splitOut\",\n      \"position\": [\n        600,\n        320\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"fieldToSplitOut\": \"message.content.chapters\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"bde7b7db-45c6-4ab3-a705-358000cefbec\",\n      \"name\": \"Merge chapters title and text\",\n      \"type\": \"n8n-nodes-base.merge\",\n      \"position\": [\n        1220,\n        460\n      ],\n      \"parameters\": {\n        \"mode\": \"combine\",\n        \"options\": {},\n        \"combinationMode\": \"mergeByPosition\"\n      },\n      \"typeVersion\": 2.1\n    },\n    {\n      \"id\": \"0079022b-eaa2-481b-8c78-f8623a63645b\",\n      \"name\": \"Final article text\",\n      \"type\": \"n8n-nodes-base.code\",\n      \"position\": [\n        1400,\n        320\n      ],\n      \"parameters\": {\n        \"jsCode\": \"let article = \\\"\\\";\\n\\n// Introduction\\narticle += $('Create post title and structure').first().json.message.content.introduction;\\narticle += \\\"<br><br>\\\";\\n\\nfor (const item of $input.all()) {\\n article += \\\"<strong>\\\" + item.json.title + \\\"</strong>\\\";\\n article += \\\"<br><br>\\\";\\n article += item.json.message.content;\\n article += \\\"<br><br>\\\";\\n}\\n\\n// Conclusions\\narticle += \\\"<strong>Conclusions</strong>\\\";\\narticle += \\\"<br><br>\\\";\\narticle += $('Create post title and structure').first().json.message.content.conclusions;\\n\\n\\nreturn [\\n {\\n \\\"article\\\": article\\n }\\n];\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"d892f00a-90fd-4bbb-bac6-4684d7d0c638\",\n      \"name\": \"Post on Wordpress\",\n      \"type\": \"n8n-nodes-base.wordpress\",\n      \"position\": [\n        1680,\n        320\n      ],\n      \"parameters\": {\n        \"title\": \"={{ $('Create post title and structure').all()[0].json.message.content.title }}\",\n        \"additionalFields\": {\n          \"status\": \"draft\",\n          \"content\": \"={{ $json.article }}\"\n        }\n      },\n      \"credentials\": {\n        \"wordpressApi\": {\n          \"id\": \"xxxxxxxxxxx\",\n          \"name\": \"WordPress Credentials\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"a609d80d-f586-4e5f-a72d-01257f676574\",\n      \"name\": \"Upload media\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        2120,\n        320\n      ],\n      \"parameters\": {\n        \"url\": \"https://wp-demo.mondo.surf/wp-json/wp/v2/media\",\n        \"method\": \"POST\",\n        \"options\": {},\n        \"sendBody\": true,\n        \"contentType\": \"binaryData\",\n        \"sendHeaders\": true,\n        \"authentication\": \"predefinedCredentialType\",\n        \"headerParameters\": {\n          \"parameters\": [\n            {\n              \"name\": \"Content-Disposition\",\n              \"value\": \"attachment; filename=\\\"example.jpg\\\"\"\n            }\n          ]\n        },\n        \"inputDataFieldName\": \"data\",\n        \"nodeCredentialType\": \"wordpressApi\"\n      },\n      \"credentials\": {\n        \"wordpressApi\": {\n          \"id\": \"xxxxxxxxxxx\",\n          \"name\": \"WordPress Credentials\"\n        }\n      },\n      \"typeVersion\": 4.1\n    },\n    {\n      \"id\": \"bdb2ef52-0201-4fe1-a7a6-59e34e21bf5e\",\n      \"name\": \"Set image ID for the post\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        2280,\n        320\n      ],\n      \"parameters\": {\n        \"url\": \"=https://wp-demo.mondo.surf/wp-json/wp/v2/posts/{{ $('Post on Wordpress').item.json.id }}\",\n        \"method\": \"POST\",\n        \"options\": {},\n        \"sendQuery\": true,\n        \"authentication\": \"predefinedCredentialType\",\n        \"queryParameters\": {\n          \"parameters\": [\n            {\n              \"name\": \"featured_media\",\n              \"value\": \"={{ $json.id }}\"\n            }\n          ]\n        },\n        \"nodeCredentialType\": \"wordpressApi\"\n      },\n      \"credentials\": {\n        \"wordpressApi\": {\n          \"id\": \"xxxxxxxxxxx\",\n          \"name\": \"WordPress Credentials\"\n        }\n      },\n      \"typeVersion\": 4.1\n    },\n    {\n      \"id\": \"a721762f-168d-4c87-ab6d-0d31deecd9a5\",\n      \"name\": \"Respond: Success\",\n      \"type\": \"n8n-nodes-base.respondToWebhook\",\n      \"position\": [\n        2520,\n        320\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"respondWith\": \"json\",\n        \"responseBody\": \"={\\n \\\"formSubmittedText\\\": \\\"The article {{ $json.title.rendered }} was correctly created as a draft on WordPress!\\\"\\n}\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"51b79bc2-035d-4db8-87bb-db6c889b164e\",\n      \"name\": \"Respond: Error\",\n      \"type\": \"n8n-nodes-base.respondToWebhook\",\n      \"position\": [\n        620,\n        580\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"respondWith\": \"json\",\n        \"responseBody\": \"={\\n 'formSubmittedText': 'There was a problem creating the article, please refresh the form and try again!'\\n}\\n\\n\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"d8748498-0800-4208-b993-f233d14da7b6\",\n      \"name\": \"Sticky Note16\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        533.7711864406776,\n        140\n      ],\n      \"parameters\": {\n        \"color\": 2,\n        \"width\": 225.47038972308582,\n        \"height\": 370.512611879577,\n        \"content\": \"## Chapters split\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"4115de31-d4e9-4d77-a055-3dead31c4dc5\",\n      \"name\": \"Sticky Note17\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        550.7711864406779,\n        200\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 185.6051460344073,\n        \"height\": 80,\n        \"content\": \"Splits out chapter contents from the previous node\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"aff8edf6-4e1e-4522-86f7-f0ce88cd0cd4\",\n      \"name\": \"Sticky Note18\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        792,\n        198\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 287.370178643191,\n        \"height\": 80,\n        \"content\": \"Writes the text for each chapter\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"e45715a8-b1ca-4499-a16a-854f8bd4f370\",\n      \"name\": \"Sticky Note19\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        780,\n        140\n      ],\n      \"parameters\": {\n        \"color\": 6,\n        \"width\": 333.40108076977657,\n        \"height\": 370.512611879577,\n        \"content\": \"## Chapters text\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"5c4cd7a1-7dc9-4159-9bd2-dbe5f8feb663\",\n      \"name\": \"Sticky Note21\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        1138.423429009716,\n        140\n      ],\n      \"parameters\": {\n        \"color\": 4,\n        \"width\": 420.4253447940705,\n        \"height\": 514.2177254645992,\n        \"content\": \"## Content preparation\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"7a6d3f7d-0436-4844-b09a-37e805b95a2f\",\n      \"name\": \"Sticky Note22\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        1160,\n        200\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 368.1523541074699,\n        \"height\": 80,\n        \"content\": \"Merges the content and prepare it before sending it to WordPress\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"903b695d-015a-4956-9c63-45802dfb9fdb\",\n      \"name\": \"Generate featured image\",\n      \"type\": \"@n8n/n8n-nodes-langchain.openAi\",\n      \"position\": [\n        1940,\n        320\n      ],\n      \"parameters\": {\n        \"prompt\": \"=Generate a photographic image to be used as the cover image for the article titled: {{ $('Create post title and structure').all()[0].json.message.content.title }}. This is the prompt for the image: {{ $('Create post title and structure').all()[0].json.message.content.imagePrompt }}, photography, realistic, sigma 85mm f/1.4\",\n        \"options\": {\n          \"size\": \"1792x1024\",\n          \"style\": \"natural\",\n          \"quality\": \"hd\"\n        },\n        \"resource\": \"image\"\n      },\n      \"credentials\": {\n        \"openAiApi\": {\n          \"id\": \"xxxxxxxxxxx\",\n          \"name\": \"OpenAI Credentials\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"faa847cb-9702-4207-aa1e-6d9f62493527\",\n      \"name\": \"Wikipedia\",\n      \"type\": \"@n8n/n8n-nodes-langchain.toolWikipedia\",\n      \"position\": [\n        -20,\n        620\n      ],\n      \"parameters\": {},\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"9d09c92e-11c0-4ea9-81d6-13bc9266741a\",\n      \"name\": \"Create post title and structure\",\n      \"type\": \"@n8n/n8n-nodes-langchain.openAi\",\n      \"position\": [\n        -100,\n        320\n      ],\n      \"parameters\": {\n        \"modelId\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"gpt-4-1106-preview\",\n          \"cachedResultName\": \"GPT-4-1106-PREVIEW\"\n        },\n        \"options\": {\n          \"maxTokens\": 2048\n        },\n        \"messages\": {\n          \"values\": [\n            {\n              \"content\": \"=Write the title, the subtitle, the chapters details, the introduction, the conclusions, and an image prompt for a SEO-friendly article about these topics:\\n{{ $json.keywords }}.\\n\\nInstructions:\\n- Place the article title in a JSON field called `title`\\n- Place the subtitle in a JSON field called `subtitle`\\n- Place the introduction in a JSON field called `introduction`\\n- In the introduction introduce the topic that is then explored in depth in the rest of the text\\n- The introduction should be around 60 words\\n- Place the conclusions in a JSON field called `conclusions`\\n- The conclusions should be around 60 words\\n- Use the conclusions to sum all said in the article and offer a conclusion to the reader\\n- The image prompt will be used to produce a photographic cover image for the article and should depict the topics discussed in the article\\n- Place the image prompt in a JSON field called `imagePrompt`\\n- There should be {{ $json.chapters.toString() }} chapters.\\n- For each chapter provide a title and an exaustive prompt that will be used to write the chapter text.\\n- Place the chapters in an array field called `chapters`\\n- For each chapter provide the fields `title` and `prompt`\\n- The chapters should follow a logical flow and not repeat the same concepts.\\n- The chapters should be one related to the other and not isolated blocks of text. The text should be fluent and folow a linear logic.\\n- Don't start the chapters with \\\"Chapter 1\\\", \\\"Chapter 2\\\", \\\"Chapter 3\\\"... just write the title of the chapter\\n- For the title and the capthers' titles don't use colons (`:`)\\n- For the text, use HTML for formatting, but limited to bold, italic and lists.\\n- Don't use markdown for formatting.\\n- Always search on Wikipedia for useful information or verify the accuracy of what you write.\\n- Never mention it if you don't find information on Wikipedia or the web\\n- Go deep in the topic you treat, don't just throw some superficial info\"\n            }\n          ]\n        },\n        \"jsonOutput\": true\n      },\n      \"credentials\": {\n        \"openAiApi\": {\n          \"id\": \"xxxxxxxxxxx\",\n          \"name\": \"OpenAI Credentials\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"2ecd3a50-a34f-4ab9-ad31-e4e6608708fb\",\n      \"name\": \"Create chapters text\",\n      \"type\": \"@n8n/n8n-nodes-langchain.openAi\",\n      \"position\": [\n        820,\n        320\n      ],\n      \"parameters\": {\n        \"modelId\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"gpt-4-0125-preview\",\n          \"cachedResultName\": \"GPT-4-0125-PREVIEW\"\n        },\n        \"options\": {\n          \"maxTokens\": 2048\n        },\n        \"messages\": {\n          \"values\": [\n            {\n              \"content\": \"=Write a chapter for the article: {{ $('Create post title and structure').item.json.message.content.title }}, {{ $('Create post title and structure').item.json.message.content.subtitle }}, that talks about {{ $('Settings').item.json[\\\"keywords\\\"] }}\\n\\nThis is the prompt for the chapter titled {{ $json.title }}: {{ $json.prompt }}.\\n\\nGuidelines:\\n- Just return the plain text for each chapter (no JSON structure).\\n- Don't use markdown for formatting.\\n- Use HTML for formatting, but limited to bold, italic and lists.\\n- Don't add internal titles or headings.\\n- The length of each chapther should be around {{ Math.round(($('Settings').item.json.words - 120)/ $('Settings').item.json.chapters) }} words long\\n- Go deep in the topic you treat, don't just throw some superficial info\\n{{ $itemIndex > 0 ? \\\"- The previous chapter talks about \\\" + $input.all()[$itemIndex-1].json.title : \\\"\\\" }}\\n{{ $itemIndex > 0 ? \\\"- The promt for the previous chapter is \\\" + $input.all()[$itemIndex-1].json.prompt : \\\"\\\" }}\\n{{ $itemIndex < $input.all().length ? \\\"- The following chapter will talk about \\\" + $input.all()[$itemIndex+1].json.title: \\\"\\\" }}\\n{{ $itemIndex < $input.all().length ? \\\"- The prompt for the following chapter is \\\" + $input.all()[$itemIndex+1].json.prompt : \\\"\\\" }}\\n- Consider the previous and following chapters what writing the text for this chapter. The text must be coherent with the previous and following chapters.\\n- This chapter should not repeat the concepts already exposed in the previous chapter.\\n- This chapter is a part of a larger article so don't include an introduction or conclusions. This chapter should merge with the rest of the article.\\n\"\n            }\n          ]\n        }\n      },\n      \"credentials\": {\n        \"openAiApi\": {\n          \"id\": \"xxxxxxxxxxx\",\n          \"name\": \"OpenAI Credentials\"\n        }\n      },\n      \"typeVersion\": 1\n    }\n  ],\n  \"active\": true,\n  \"pinData\": {},\n  \"settings\": {\n    \"callerPolicy\": \"workflowsFromSameOwner\",\n    \"executionOrder\": \"v1\",\n    \"saveManualExecutions\": true,\n    \"saveDataSuccessExecution\": \"all\"\n  },\n  \"versionId\": \"64d94f1e-51c8-40f7-a6b3-80fc43d9e71a\",\n  \"connections\": {\n    \"Form\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Settings\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Settings\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Create post title and structure\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Wikipedia\": {\n      \"ai_tool\": [\n        [\n          {\n            \"node\": \"Create post title and structure\",\n            \"type\": \"ai_tool\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Upload media\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Set image ID for the post\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Post on Wordpress\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Generate featured image\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Final article text\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Post on Wordpress\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Split out chapters\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Merge chapters title and text\",\n            \"type\": \"main\",\n            \"index\": 1\n          },\n          {\n            \"node\": \"Create chapters text\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Create chapters text\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Merge chapters title and text\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Check data consistency\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Split out chapters\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Respond: Error\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Generate featured image\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Upload media\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Set image ID for the post\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Respond: Success\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Merge chapters title and text\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Final article text\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Create post title and structure\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Check data consistency\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}",
  "metadata": {
    "node_types": [
      "n8n-nodes-base.formTrigger",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.set",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.if",
      "n8n-nodes-base.splitOut",
      "n8n-nodes-base.merge",
      "n8n-nodes-base.code",
      "n8n-nodes-base.wordpress",
      "n8n-nodes-base.httpRequest",
      "n8n-nodes-base.httpRequest",
      "n8n-nodes-base.respondToWebhook",
      "n8n-nodes-base.respondToWebhook",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "@n8n/n8n-nodes-langchain.openAi",
      "@n8n/n8n-nodes-langchain.toolWikipedia",
      "@n8n/n8n-nodes-langchain.openAi",
      "@n8n/n8n-nodes-langchain.openAi"
    ],
    "trigger": null
  }
}