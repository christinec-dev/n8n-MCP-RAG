{
  "source": "0754_Googleslides_Noop_Automation_Triggered.json",
  "index": 1,
  "content": "{\n  \"id\": \"2qIFnWXdHJJs4oBk\",\n  \"meta\": {\n    \"instanceId\": \"6c586999cefcd4ec9b2ab69e3f6b7974d96831b39a984af15104588e20b2737a\",\n    \"templateCredsSetupCompleted\": true\n  },\n  \"name\": \"DSP Certificate w/ Google Forms\",\n  \"tags\": [],\n  \"nodes\": [\n    {\n      \"id\": \"1f3a1bb2-1e5b-4696-aafc-5b3267d76cbf\",\n      \"name\": \"Google Sheets Trigger\",\n      \"type\": \"n8n-nodes-base.googleSheetsTrigger\",\n      \"position\": [\n        -100,\n        -20\n      ],\n      \"parameters\": {\n        \"event\": \"rowAdded\",\n        \"options\": {},\n        \"pollTimes\": {\n          \"item\": [\n            {\n              \"mode\": \"everyMinute\"\n            }\n          ]\n        },\n        \"sheetName\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": 1715309269,\n          \"cachedResultUrl\": \"https://docs.google.com/spreadsheets/d/1WqhSc4sx6GMupZgFo7xKoegXVo3fJVhqrovCQPa1esM/edit#gid=1715309269\",\n          \"cachedResultName\": \"Form Responses 1\"\n        },\n        \"documentId\": {\n          \"__rl\": true,\n          \"mode\": \"id\",\n          \"value\": \"1WqhSc4sx6GMupZgFo7xKoegXVo3fJVhqrovCQPa1esM\"\n        }\n      },\n      \"credentials\": {\n        \"googleSheetsTriggerOAuth2Api\": {\n          \"id\": \"LPj2gg4OdDdyokS7\",\n          \"name\": \"Google Sheets (jkp@kajonkietsuksa.ac.th)\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"385f6b0f-2db0-4a44-816c-c6f6c8ccb493\",\n      \"name\": \"No Operation, do nothing\",\n      \"type\": \"n8n-nodes-base.noOp\",\n      \"position\": [\n        620,\n        180\n      ],\n      \"parameters\": {},\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"58a77733-99f1-4884-b955-0a6f6c983cfc\",\n      \"name\": \"Sticky Note\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -240,\n        -340\n      ],\n      \"parameters\": {\n        \"width\": 300,\n        \"height\": 180,\n        \"content\": \"### 1) Start here\\n* Create a Google Form and then enable quiz mode.\\n* Publish it, submit 1 text data.\\n* In response section, you'll see \\\"Link to Google Sheet\\\" option.\\n* Press, and it will create a new sheet.\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"aeef0ccc-3031-40d0-a627-5f21ade148b1\",\n      \"name\": \"Sticky Note1\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        320,\n        -140\n      ],\n      \"parameters\": {\n        \"width\": 180,\n        \"content\": \"### 4) Passing Score\\n* Adjust your passing score here\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"c21dbdb5-ed87-4aac-bbc7-338aaed830ba\",\n      \"name\": \"Sticky Note2\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -240,\n        -100\n      ],\n      \"parameters\": {\n        \"height\": 180,\n        \"content\": \"### 2) Trigger Node\\n* Replace your Google Sheet id's in this node.\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"d2b15c40-d38a-4bec-97c8-d4b35e3a69fa\",\n      \"name\": \"Sticky Note3\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        40,\n        -100\n      ],\n      \"parameters\": {\n        \"width\": 260,\n        \"height\": 180,\n        \"content\": \"### 3) Extract Node\\n* Select the data we want to use to proceed.\\n* For this case, i'll select only Name, Email, Score (Because this is only what we need)\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"79957ca7-ac5f-4f5b-b921-ddec3cb9f88b\",\n      \"name\": \"Extract essential data\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        120,\n        60\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"7cdc9108-ab77-4904-a74b-29677b06cc81\",\n              \"name\": \"respondentName\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json['ชื่อ (เป็นภาษาอังกฤษ)'] }}\"\n            },\n            {\n              \"id\": \"1800b27a-6cbc-4b82-a17a-87d7d1e7a66e\",\n              \"name\": \"respondentEmail\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json['Email Address'] }}\"\n            },\n            {\n              \"id\": \"36cb99ca-7c98-41b5-a2a4-a03ac8d83189\",\n              \"name\": \"respondentScore\",\n              \"type\": \"number\",\n              \"value\": \"={{ $json.Score }}\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 3.4\n    },\n    {\n      \"id\": \"912838e0-6b35-47a1-8935-dc90b4c59ecb\",\n      \"name\": \"Score Checker\",\n      \"type\": \"n8n-nodes-base.if\",\n      \"position\": [\n        360,\n        -20\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"conditions\": {\n          \"options\": {\n            \"version\": 2,\n            \"leftValue\": \"\",\n            \"caseSensitive\": true,\n            \"typeValidation\": \"strict\"\n          },\n          \"combinator\": \"and\",\n          \"conditions\": [\n            {\n              \"id\": \"286a95ee-1edc-4310-af22-d161e1f04a27\",\n              \"operator\": {\n                \"type\": \"number\",\n                \"operation\": \"gt\"\n              },\n              \"leftValue\": \"={{ $json.respondentScore }}\",\n              \"rightValue\": 3\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 2.2\n    },\n    {\n      \"id\": \"9c9e308f-ce90-425d-aafc-08711cbf95df\",\n      \"name\": \"Sticky Note4\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        600,\n        120\n      ],\n      \"parameters\": {\n        \"width\": 260,\n        \"content\": \"### 4.1) Score < passing criteria\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"f794c7a3-47af-4166-9504-8265837f61e6\",\n      \"name\": \"Sticky Note5\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        520,\n        -340\n      ],\n      \"parameters\": {\n        \"width\": 260,\n        \"height\": 200,\n        \"content\": \"### 4.2) Score > passing criteria\\n* Create new Google Slide \\n* Decorate it as you desired (This will be certificate's template)\\n* Use [ name ] to be a placeholder for user's name\\n* Replace it with your Google Slide's id\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"9a2954e3-59fd-4472-931f-9eeb362e627b\",\n      \"name\": \"Sticky Note6\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        820,\n        -400\n      ],\n      \"parameters\": {\n        \"width\": 260,\n        \"content\": \"### 5) Replace text\\n* This node will replace [ name ] with user's input name.\\n\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"baa88ba8-c1c6-40d7-b4c0-1e70397d7e68\",\n      \"name\": \"Sticky Note7\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        940,\n        -80\n      ],\n      \"parameters\": {\n        \"width\": 260,\n        \"content\": \"### 6) To PDF\\n* Change file name as you desire.\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"0d4b0fad-046b-4810-9d21-2c30135df6b0\",\n      \"name\": \"Copy from your template\",\n      \"type\": \"n8n-nodes-base.googleDrive\",\n      \"position\": [\n        620,\n        -160\n      ],\n      \"parameters\": {\n        \"name\": \"={{ $json.respondentName }}'s Certificate\",\n        \"fileId\": {\n          \"__rl\": true,\n          \"mode\": \"id\",\n          \"value\": \"1J8PxjjspVs7075EfIX6pnNU-TmqtzVV9ymeHoKpbwP0\"\n        },\n        \"driveId\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"My Drive\"\n        },\n        \"options\": {},\n        \"folderId\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"1xMJU-6eiXL53NDgjic2SXecTo6GeUJ-o\",\n          \"cachedResultUrl\": \"https://drive.google.com/drive/folders/1xMJU-6eiXL53NDgjic2SXecTo6GeUJ-o\",\n          \"cachedResultName\": \"KS Google Form -> Certificate System\"\n        },\n        \"operation\": \"copy\",\n        \"sameFolder\": false\n      },\n      \"credentials\": {\n        \"googleDriveOAuth2Api\": {\n          \"id\": \"2k4spLmVESgxckkx\",\n          \"name\": \"jkp@kajonkietsuksa.ac.th\"\n        }\n      },\n      \"typeVersion\": 3\n    },\n    {\n      \"id\": \"30407819-7998-4ba1-b2a0-bde7ba91747c\",\n      \"name\": \"Replace text\",\n      \"type\": \"n8n-nodes-base.googleSlides\",\n      \"position\": [\n        880,\n        -300\n      ],\n      \"parameters\": {\n        \"textUi\": {\n          \"textValues\": [\n            {\n              \"text\": \"[ NAME ]\",\n              \"replaceText\": \"={{ $('Score Checker').item.json.respondentName }}\",\n              \"pageObjectIds\": [\n                \"p\"\n              ]\n            }\n          ]\n        },\n        \"options\": {},\n        \"operation\": \"replaceText\",\n        \"presentationId\": \"={{ $json.id }}\"\n      },\n      \"credentials\": {\n        \"googleSlidesOAuth2Api\": {\n          \"id\": \"1oyCPsdPLod92Wlp\",\n          \"name\": \"Google Slides account\"\n        }\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"62f1ab2e-0471-480b-9a90-587a9ffb18d6\",\n      \"name\": \"Convert to PDF\",\n      \"type\": \"n8n-nodes-base.googleDrive\",\n      \"position\": [\n        960,\n        0\n      ],\n      \"parameters\": {\n        \"fileId\": {\n          \"__rl\": true,\n          \"mode\": \"id\",\n          \"value\": \"={{ $json.presentationId }}\"\n        },\n        \"options\": {\n          \"fileName\": \"={{ $('Score Checker').item.json.respondentName }}'s Certificate\",\n          \"googleFileConversion\": {\n            \"conversion\": {\n              \"slidesToFormat\": \"application/pdf\"\n            }\n          }\n        },\n        \"operation\": \"download\"\n      },\n      \"credentials\": {\n        \"googleDriveOAuth2Api\": {\n          \"id\": \"2k4spLmVESgxckkx\",\n          \"name\": \"jkp@kajonkietsuksa.ac.th\"\n        }\n      },\n      \"typeVersion\": 3,\n      \"alwaysOutputData\": false\n    },\n    {\n      \"id\": \"08516c84-5257-4875-8c2f-9b6a4428bfad\",\n      \"name\": \"Send to user's email\",\n      \"type\": \"n8n-nodes-base.gmail\",\n      \"position\": [\n        1360,\n        0\n      ],\n      \"webhookId\": \"f204ef80-937c-4f7b-8eb5-0699eb13c16a\",\n      \"parameters\": {\n        \"sendTo\": \"={{ $('Score Checker').item.json.respondentEmail }}\",\n        \"message\": \"=Congratulations on passing the quiz! Attached is your certificate.\",\n        \"options\": {\n          \"attachmentsUi\": {\n            \"attachmentsBinary\": [\n              {}\n            ]\n          },\n          \"appendAttribution\": false\n        },\n        \"subject\": \"Here's your certificate!!\"\n      },\n      \"credentials\": {\n        \"gmailOAuth2\": {\n          \"id\": \"qogKxJFIxmrd6rcB\",\n          \"name\": \"Gmail account (jkp@kajonkietsuksa.ac.th)\"\n        }\n      },\n      \"typeVersion\": 2.1\n    },\n    {\n      \"id\": \"ae4cd0de-e06d-4200-af17-f6e9953ccba7\",\n      \"name\": \"Sticky Note8\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        1260,\n        -100\n      ],\n      \"parameters\": {\n        \"width\": 260,\n        \"content\": \"### 7) Send email\\n* Send to user's email\\n* Customize your message here.\\n\"\n      },\n      \"typeVersion\": 1\n    }\n  ],\n  \"active\": true,\n  \"pinData\": {},\n  \"settings\": {\n    \"executionOrder\": \"v1\"\n  },\n  \"versionId\": \"54bf009a-3f95-446d-95a6-825496592a6f\",\n  \"connections\": {\n    \"Replace text\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Convert to PDF\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Score Checker\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Copy from your template\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"No Operation, do nothing\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Convert to PDF\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Send to user's email\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Google Sheets Trigger\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Extract essential data\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Extract essential data\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Score Checker\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Copy from your template\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Replace text\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}",
  "metadata": {
    "node_types": [
      "n8n-nodes-base.googleSheetsTrigger",
      "n8n-nodes-base.noOp",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.set",
      "n8n-nodes-base.if",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.googleDrive",
      "n8n-nodes-base.googleSlides",
      "n8n-nodes-base.googleDrive",
      "n8n-nodes-base.gmail",
      "n8n-nodes-base.stickyNote"
    ],
    "trigger": "google sheets trigger"
  }
}