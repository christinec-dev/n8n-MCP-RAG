{
  "source": "0230_N8Ntrainingcustomermessenger_Wait_Create_Triggered.json",
  "index": 1,
  "content": "{\n  \"nodes\": [\n    {\n      \"name\": \"On clicking 'execute'\",\n      \"type\": \"n8n-nodes-base.manualTrigger\",\n      \"position\": [\n        400,\n        520\n      ],\n      \"parameters\": {},\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Note1\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        1500,\n        360\n      ],\n      \"parameters\": {\n        \"width\": 780,\n        \"height\": 360,\n        \"content\": \"## 2. Wait for an external event\\nUse this operation when an external step is needed in order to continue with the rest of the workflow.\\nFor example - a workflow sends a purchase approval link to the merchant (using Gmail, Slack etc..) and waits for the merchant to click on it before continuing with the rest of the steps.\\n\\nIn this example, the `Customer Messenger` node mimics the email or messaging node.\\n\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Note\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        200,\n        380\n      ],\n      \"parameters\": {\n        \"width\": 300,\n        \"height\": 120,\n        \"content\": \"### Click the `Execute Workflow` button and double click on the nodes to see the input and output items.\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Create approval URL\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        1540,\n        520\n      ],\n      \"parameters\": {\n        \"values\": {\n          \"string\": [\n            {\n              \"name\": \"URL\",\n              \"value\": \"={{$resumeWebhookUrl}}?name=nathan\"\n            }\n          ]\n        },\n        \"options\": {},\n        \"keepOnlySet\": true\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Wait for external approval\",\n      \"type\": \"n8n-nodes-base.wait\",\n      \"position\": [\n        1940,\n        520\n      ],\n      \"webhookId\": \"0bcafff8-9fc1-4415-95b1-00746bb1304d\",\n      \"parameters\": {\n        \"resume\": \"webhook\",\n        \"options\": {}\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Rest of the workflow placeholder\",\n      \"type\": \"n8n-nodes-base.noOp\",\n      \"position\": [\n        2140,\n        520\n      ],\n      \"parameters\": {},\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Customer Datastore\",\n      \"type\": \"n8n-nodes-base.n8nTrainingCustomerDatastore\",\n      \"position\": [\n        580,\n        520\n      ],\n      \"parameters\": {\n        \"operation\": \"getAllPeople\",\n        \"returnAll\": true\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"SplitInBatches\",\n      \"type\": \"n8n-nodes-base.splitInBatches\",\n      \"position\": [\n        760,\n        520\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"batchSize\": 1\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Note4\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        540,\n        360\n      ],\n      \"parameters\": {\n        \"width\": 900,\n        \"height\": 360,\n        \"content\": \"## 1. Rate Limiting \\nSometimes you need to slow down how often you are contacting a service.\\n\\nIn this example, `Customer Datastore` node simulates the big batches of requests coming at once, the `SplitInBatches` node handles each one individually in a loop, and the `Wait` node creates a 2 second delay between each message to a customer.\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Wait for time interval\",\n      \"type\": \"n8n-nodes-base.wait\",\n      \"position\": [\n        920,\n        520\n      ],\n      \"webhookId\": \"2b72e9d7-75b7-4ef5-87e7-2bfdfdbaa20f\",\n      \"parameters\": {\n        \"unit\": \"seconds\",\n        \"amount\": 2\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"If - Are we Finished?\",\n      \"type\": \"n8n-nodes-base.if\",\n      \"position\": [\n        1280,\n        520\n      ],\n      \"parameters\": {\n        \"conditions\": {\n          \"boolean\": [\n            {\n              \"value1\": \"={{$node[\\\"SplitInBatches\\\"].context[\\\"noItemsLeft\\\"]}}\",\n              \"value2\": true\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Customer Messenger - Send URL to merchant\",\n      \"type\": \"n8n-nodes-base.n8nTrainingCustomerMessenger\",\n      \"position\": [\n        1740,\n        520\n      ],\n      \"parameters\": {\n        \"message\": \"={{$json[\\\"URL\\\"]}}\",\n        \"customerId\": \"1\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Customer Messenger - Send message to client\",\n      \"type\": \"n8n-nodes-base.n8nTrainingCustomerMessenger\",\n      \"position\": [\n        1100,\n        520\n      ],\n      \"parameters\": {\n        \"message\": \"=\\nHi {{$node[\\\"Customer Datastore\\\"].json[\\\"name\\\"]}}\\nThis message was sent at {{$now.toLocaleString(DateTime.TIME_WITH_SECONDS)}}\",\n        \"customerId\": \"={{$node[\\\"Customer Datastore\\\"].json[\\\"id\\\"]}}\"\n      },\n      \"typeVersion\": 1\n    }\n  ],\n  \"connections\": {\n    \"SplitInBatches\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Wait for time interval\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Customer Datastore\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"SplitInBatches\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Create approval URL\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Customer Messenger - Send URL to merchant\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"If - Are we Finished?\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Create approval URL\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"SplitInBatches\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"On clicking 'execute'\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Customer Datastore\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Wait for time interval\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Customer Messenger - Send message to client\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Wait for external approval\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Rest of the workflow placeholder\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Customer Messenger - Send URL to merchant\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Wait for external approval\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Customer Messenger - Send message to client\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"If - Are we Finished?\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}",
  "metadata": {
    "node_types": [
      "n8n-nodes-base.manualTrigger",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.set",
      "n8n-nodes-base.wait",
      "n8n-nodes-base.noOp",
      "n8n-nodes-base.n8nTrainingCustomerDatastore",
      "n8n-nodes-base.splitInBatches",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.wait",
      "n8n-nodes-base.if",
      "n8n-nodes-base.n8nTrainingCustomerMessenger",
      "n8n-nodes-base.n8nTrainingCustomerMessenger"
    ],
    "trigger": null
  }
}