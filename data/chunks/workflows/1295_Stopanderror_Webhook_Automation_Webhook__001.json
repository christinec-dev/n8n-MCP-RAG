{
  "source": "1295_Stopanderror_Webhook_Automation_Webhook.json",
  "index": 1,
  "content": "{\n  \"id\": \"AS2Rj41p6OyA0xZK\",\n  \"meta\": {\n    \"instanceId\": \"7858a8e25b8fc4dae485c1ef345e6fe74effb1f5060433ef500b4c186c965c18\",\n    \"templateCredsSetupCompleted\": true\n  },\n  \"name\": \"Auth0 User Login\",\n  \"tags\": [],\n  \"nodes\": [\n    {\n      \"id\": \"25022573-c99e-40d2-88e2-a0e7a9780181\",\n      \"name\": \"Request Access Token\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        1260,\n        320\n      ],\n      \"parameters\": {\n        \"url\": \"={{ $json.domain }}/oauth/token\",\n        \"method\": \"POST\",\n        \"options\": {},\n        \"jsonBody\": \"={\\n  \\\"grant_type\\\": \\\"authorization_code\\\",\\n  \\\"code\\\": \\\"{{ $json.query.code }}\\\",\\n  \\\"client_id\\\": \\\"{{ $json.client_id }}\\\",\\n  \\\"client_secret\\\": \\\"{{ $json.client_secret }}\\\",\\n  \\\"redirect_uri\\\": \\\"{{ $json.my_server }}\\\",\\n  \\\"audience\\\": \\\"{{ $json.domain }}/api/v2/\\\"\\n}\",\n        \"sendBody\": true,\n        \"sendHeaders\": true,\n        \"specifyBody\": \"json\",\n        \"headerParameters\": {\n          \"parameters\": [\n            {\n              \"name\": \"content-type\",\n              \"value\": \"application/x-www-form-urlencoded\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 4.2\n    },\n    {\n      \"id\": \"233d69ed-d835-4022-815e-e786706ec78a\",\n      \"name\": \"Get Userinfo\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        1500,\n        320\n      ],\n      \"parameters\": {\n        \"url\": \"={{ $('Set Application Details1').item.json.domain }}/userinfo\",\n        \"options\": {},\n        \"sendHeaders\": true,\n        \"headerParameters\": {\n          \"parameters\": [\n            {\n              \"name\": \"Authorization\",\n              \"value\": \"=Bearer {{ $json.access_token }}\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 4.2\n    },\n    {\n      \"id\": \"860e8a20-f6a3-4c8e-be71-361e6f1f8641\",\n      \"name\": \"If\",\n      \"type\": \"n8n-nodes-base.if\",\n      \"position\": [\n        720,\n        320\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"conditions\": {\n          \"options\": {\n            \"leftValue\": \"\",\n            \"caseSensitive\": true,\n            \"typeValidation\": \"strict\"\n          },\n          \"combinator\": \"and\",\n          \"conditions\": [\n            {\n              \"id\": \"fa80ac35-7029-4507-b5ea-845bec07b672\",\n              \"operator\": {\n                \"type\": \"string\",\n                \"operation\": \"exists\",\n                \"singleValue\": true\n              },\n              \"leftValue\": \"={{$json.query.code}}\",\n              \"rightValue\": \"\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 2.1\n    },\n    {\n      \"id\": \"7c4e15c7-2ee0-4c54-8255-e7cc250e718a\",\n      \"name\": \"No Code Found\",\n      \"type\": \"n8n-nodes-base.stopAndError\",\n      \"position\": [\n        880,\n        540\n      ],\n      \"parameters\": {\n        \"errorMessage\": \"Couldn't get authorization code!\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"2e0b2ff5-47ce-4199-bdd2-e31a4d32fd15\",\n      \"name\": \"Open Auth Webpage\",\n      \"type\": \"n8n-nodes-base.respondToWebhook\",\n      \"position\": [\n        1020,\n        40\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"redirectURL\": \"={{ $json.domain }}/authorize?response_type=code&scope=openid+email+profile+image+name&client_id={{ $json.client_id }}&redirect_uri={{ $json.my_server }}/webhook/receive-token\",\n        \"respondWith\": \"redirect\"\n      },\n      \"typeVersion\": 1.1\n    },\n    {\n      \"id\": \"d790ce47-725a-4a69-b66f-f7e80e2d9e5e\",\n      \"name\": \"Sticky Note\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        1180,\n        80\n      ],\n      \"parameters\": {\n        \"color\": 6,\n        \"width\": 238.05017098334866,\n        \"height\": 140.50170983348636,\n        \"content\": \"### You can also add   &connection=github to end of authorize URL in order to get user to login via Github, Facebook, etc\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"1c5bb01a-0fed-4783-b18d-d8f7e818371c\",\n      \"name\": \"Set Application Details\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        780,\n        40\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"003d523a-5e14-4a5a-aed6-f72c3fce6e6d\",\n              \"name\": \"domain\",\n              \"type\": \"string\",\n              \"value\": \"\"\n            },\n            {\n              \"id\": \"7db513f3-55f6-4bab-92b0-e62d0b7f05a1\",\n              \"name\": \"client_id\",\n              \"type\": \"string\",\n              \"value\": \"\"\n            },\n            {\n              \"id\": \"52da7d5d-6683-4cf9-a7de-c2ab2ce48f3d\",\n              \"name\": \"my_server\",\n              \"type\": \"string\",\n              \"value\": \"\"\n            }\n          ]\n        },\n        \"includeOtherFields\": true\n      },\n      \"typeVersion\": 3.4\n    },\n    {\n      \"id\": \"8ced9fb6-fd49-4d57-8d74-b04e45b6c216\",\n      \"name\": \"Sticky Note1\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        80,\n        -456.1003419666973\n      ],\n      \"parameters\": {\n        \"color\": 5,\n        \"width\": 623.7263504769883,\n        \"height\": 397.87914003146636,\n        \"content\": \"## 1. First, go to https://auth0.com and create a Single Page Application. From Dashboard/Applications, click on your new app settings. The first step is to add the following to allowed callback URLs:\\nhttp://localhost:5678, http://localhost:5678/webhook/receive-token \\n\\n### (If you do not run n8n locally, replace localhost with your server where you run n8n. You must also replace it in **Set Application Details** 'my_server' field)\\n\\n## From the same settings page,  retrieve the Domain, Client_ID, and Client_Secret of your application.\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"94155312-1230-4c13-9104-5e26a6f68e91\",\n      \"name\": \"Sticky Note2\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        1280,\n        -40\n      ],\n      \"parameters\": {\n        \"color\": 6,\n        \"width\": 437.4336297478876,\n        \"height\": 107.35461655041311,\n        \"content\": \"### This step will return the authentication page to the user and let him login using gmail or by creating a new account.\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"9a7bcabf-1cc0-43e5-8f52-cc3f2781150f\",\n      \"name\": \"Sticky Note3\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        420,\n        -40\n      ],\n      \"parameters\": {\n        \"width\": 1296.8510714753793,\n        \"height\": 256.53228919365705,\n        \"content\": \"## Step 1: Authentication\\n\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"7e7560d6-4c26-4e80-ad62-07a674e928f9\",\n      \"name\": \"Sticky Note4\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        420,\n        260\n      ],\n      \"parameters\": {\n        \"width\": 1302.371850917427,\n        \"height\": 444.78164181462137,\n        \"content\": \"## Step 2: Get Access Token\\n\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"97c8bc77-bc7d-4be2-9858-668c5e325f49\",\n      \"name\": \"Sticky Note5\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        420,\n        560.9464093496792\n      ],\n      \"parameters\": {\n        \"color\": 6,\n        \"width\": 327.74230574931124,\n        \"height\": 144.40136786678917,\n        \"content\": \"### If Step 1 was successful, Auth0 will automatically call Step 2 in its callback with a code. This code is used to generate an access token which can verify the user is legitimate and email verified.\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"fe103ba1-8143-482c-846f-0f381ca2661a\",\n      \"name\": \"Set Application Details1\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        1000,\n        320\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"003d523a-5e14-4a5a-aed6-f72c3fce6e6d\",\n              \"name\": \"domain\",\n              \"type\": \"string\",\n              \"value\": \"\"\n            },\n            {\n              \"id\": \"7db513f3-55f6-4bab-92b0-e62d0b7f05a1\",\n              \"name\": \"client_id\",\n              \"type\": \"string\",\n              \"value\": \"\"\n            },\n            {\n              \"id\": \"52da7d5d-6683-4cf9-a7de-c2ab2ce48f3d\",\n              \"name\": \"my_server\",\n              \"type\": \"string\",\n              \"value\": \"\"\n            },\n            {\n              \"id\": \"d339dd3d-ed57-4b0f-81c6-a8f5f7c474fb\",\n              \"name\": \"client_secret\",\n              \"type\": \"string\",\n              \"value\": \"\"\n            }\n          ]\n        },\n        \"includeOtherFields\": true\n      },\n      \"typeVersion\": 3.4\n    },\n    {\n      \"id\": \"b3bb59b8-16fc-483d-ae8d-ec3e65c3326d\",\n      \"name\": \"/login\",\n      \"type\": \"n8n-nodes-base.webhook\",\n      \"position\": [\n        540,\n        40\n      ],\n      \"webhookId\": \"046e2370-0ae1-4d64-be9b-cbb0545de323\",\n      \"parameters\": {\n        \"path\": \"login\",\n        \"options\": {},\n        \"responseMode\": \"responseNode\"\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"79825832-6d06-4a48-aa0a-bad3d52ab2c1\",\n      \"name\": \"/receive-token\",\n      \"type\": \"n8n-nodes-base.webhook\",\n      \"position\": [\n        540,\n        320\n      ],\n      \"webhookId\": \"7bd9ea5a-c354-41c0-9d17-4a02ca8e3055\",\n      \"parameters\": {\n        \"path\": \"receive-token\",\n        \"options\": {},\n        \"responseMode\": \"lastNode\"\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"b9406ef0-3567-46da-9989-d7f458ad73fb\",\n      \"name\": \"Sticky Note7\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        760,\n        -460\n      ],\n      \"parameters\": {\n        \"color\": 5,\n        \"width\": 426.62126002791706,\n        \"height\": 393.48225931142105,\n        \"content\": \"## 2. Fill in Set Application Details and Set Application Details1\\n\\n## 3. **Login from https://<n8n server address>/webhook/login!**\"\n      },\n      \"typeVersion\": 1\n    }\n  ],\n  \"active\": true,\n  \"pinData\": {},\n  \"settings\": {\n    \"executionOrder\": \"v1\"\n  },\n  \"versionId\": \"7d2f0dad-3951-49e2-9467-03124dbc52ba\",\n  \"connections\": {\n    \"If\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Set Application Details1\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"No Code Found\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"/login\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Set Application Details\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"/receive-token\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"If\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Request Access Token\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Get Userinfo\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Set Application Details\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Open Auth Webpage\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Set Application Details1\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Request Access Token\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}",
  "metadata": {
    "node_types": [
      "n8n-nodes-base.httpRequest",
      "n8n-nodes-base.httpRequest",
      "n8n-nodes-base.if",
      "n8n-nodes-base.stopAndError",
      "n8n-nodes-base.respondToWebhook",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.set",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.set",
      "n8n-nodes-base.webhook",
      "n8n-nodes-base.webhook",
      "n8n-nodes-base.stickyNote"
    ],
    "trigger": null
  }
}