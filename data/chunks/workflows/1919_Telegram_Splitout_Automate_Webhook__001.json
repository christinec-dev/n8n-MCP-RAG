{
  "source": "1919_Telegram_Splitout_Automate_Webhook.json",
  "index": 1,
  "content": "{\n  \"id\": \"mOcaSIUAvpt3QjQ1\",\n  \"meta\": {\n    \"instanceId\": \"31e69f7f4a77bf465b805824e303232f0227212ae922d12133a0f96ffeab4fef\",\n    \"templateCredsSetupCompleted\": true\n  },\n  \"name\": \"üåê Confluence Page AI Powered Chatbot\",\n  \"tags\": [],\n  \"nodes\": [\n    {\n      \"id\": \"f4761e1a-6430-4b3d-97f9-b91743e02ea6\",\n      \"name\": \"Sticky Note\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        80,\n        -340\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 633,\n        \"height\": 974,\n        \"content\": \"## Confluence\\nhttps://developer.atlassian.com/cloud/confluence/basic-auth-for-rest-apis/\\nhttps://id.atlassian.com/manage-profile/security/api-tokens\\nhttps://developer.atlassian.com/cloud/confluence/rest/v2/intro/#about\\n\\nSupplying basic auth headers\\nYou can construct and send basic auth headers yourself, including a base64-encoded string that contains your Atlassian account email and API token.\\n\\nTo use basic auth headers, perform the following steps:\\n\\nGenerate an API Token for your Atlassian Account: https://id.atlassian.com/manage/api-tokens\\nBuild a string of the form your_email@domain.com:your_user_api_token.\\nYou'll need to encode your authorization credentials to Base64 encoded. You can do this locally:\\nLinux/Unix/MacOS:\\n\\nCopy\\n```\\necho -n your_email@domain.com:your_user_api_token | base64\\n```\\nWindows 7 and later, using Microsoft Powershell:\\n\\nCopy\\n```\\n$Text = ‚Äòyour_email@domain.com:your_user_api_token‚Äô\\n$Bytes = [System.Text.Encoding]::UTF8.GetBytes($Text)\\n$EncodedText = [Convert]::ToBase64String($Bytes)\\n$EncodedText\\n```\\nSupply an Authorization header with content Basic followed by the encoded string. Example: Authorization: Basic eW91cl9lbWFpbEBkb21haW4uY29tOnlvdXJfdXNlcl9hcGlfdG9rZW4=\\n\\nCopy\\n```\\ncurl -D- \\\\\\n   -X GET \\\\\\n   -H \\\"Authorization: Basic <your_encoded_string>\\\" \\\\\\n   -H \\\"Content-Type: application/json\\\" \\\\\\n   \\\"https://<your-domain.atlassian.net>/wiki/rest/api/space\\\"\\n```\\n\\nThe above cURL command will not work as shown. You need to replace <your_encoded_string> and <your-domain.atlassian.net> with your authorization credentials encoded string and instance information before running it in the terminal.\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"b2865684-687e-45a9-bb0c-e78df4dda72e\",\n      \"name\": \"Sticky Note2\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        760,\n        -340\n      ],\n      \"parameters\": {\n        \"color\": 5,\n        \"width\": 768.3946456283678,\n        \"height\": 381.59428876752247,\n        \"content\": \"## Using Rest API to GET Confluence Page Body\\nhttps://developer.atlassian.com/cloud/confluence/rest/v2/api-group-page/#api-pages-id-get\\n\\nRequest\\nhttps://<your-wiki>.atlassian.net/wiki/api/v2/pages/{id}\\nPath parameters\\nid\\ninteger\\n\\nRequired\\nQuery parameters\\n\\nThe content format types to be returned in the body field of the response. \\nIf available, the representation will be available under a response field of the same name under the body field.\\n\\nValid values: storage, atlas_doc_format, view, export_view, anonymous_export_view, styled_view, editor\\n\\n\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"2fae2b02-b15f-4226-86c2-f4444f10965e\",\n      \"name\": \"Confluence Page Storage View\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        900,\n        580\n      ],\n      \"parameters\": {\n        \"url\": \"=https://example.atlassian.net/wiki/api/v2/pages/{{ $json.id }}\",\n        \"options\": {},\n        \"sendQuery\": true,\n        \"sendHeaders\": true,\n        \"authentication\": \"genericCredentialType\",\n        \"genericAuthType\": \"httpHeaderAuth\",\n        \"queryParameters\": {\n          \"parameters\": [\n            {\n              \"name\": \"body-format\",\n              \"value\": \"storage\"\n            }\n          ]\n        },\n        \"headerParameters\": {\n          \"parameters\": [\n            {}\n          ]\n        }\n      },\n      \"credentials\": {\n        \"httpHeaderAuth\": {\n          \"id\": \"KafuDlwiWOVNQcyC\",\n          \"name\": \"Confluence API\"\n        }\n      },\n      \"typeVersion\": 4.2\n    },\n    {\n      \"id\": \"49c5c6f7-f879-4518-aeef-922154f47ea6\",\n      \"name\": \"HTML to Markdown\",\n      \"type\": \"n8n-nodes-base.markdown\",\n      \"position\": [\n        1100,\n        580\n      ],\n      \"parameters\": {\n        \"html\": \"={{ $json.body.storage.value }}\",\n        \"options\": {}\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"6ef64460-1406-43c9-9c5b-9d8ae3f51d31\",\n      \"name\": \"gpt-4o-mini\",\n      \"type\": \"@n8n/n8n-nodes-langchain.lmChatOpenAi\",\n      \"position\": [\n        1260,\n        760\n      ],\n      \"parameters\": {\n        \"options\": {}\n      },\n      \"credentials\": {\n        \"openAiApi\": {\n          \"id\": \"jEMSvKmtYfzAkhe6\",\n          \"name\": \"OpenAi account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"b8f998da-34b2-40d4-9816-b7a3ca33a3d9\",\n      \"name\": \"When chat message received\",\n      \"type\": \"@n8n/n8n-nodes-langchain.manualChatTrigger\",\n      \"position\": [\n        820,\n        180\n      ],\n      \"parameters\": {},\n      \"typeVersion\": 1.1\n    },\n    {\n      \"id\": \"8fcfb987-3ea1-43cd-804f-dc2d629e558e\",\n      \"name\": \"Window Buffer Memory\",\n      \"type\": \"@n8n/n8n-nodes-langchain.memoryBufferWindow\",\n      \"position\": [\n        1400,\n        760\n      ],\n      \"parameters\": {\n        \"sessionKey\": \"={{ $('When chat message received').item.json.sessionId }}\",\n        \"sessionIdType\": \"customKey\"\n      },\n      \"typeVersion\": 1.2\n    },\n    {\n      \"id\": \"53fe680c-af07-4712-b3cd-ae853f19cf8a\",\n      \"name\": \"Sticky Note3\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        760,\n        420\n      ],\n      \"parameters\": {\n        \"color\": 6,\n        \"width\": 1163,\n        \"height\": 515,\n        \"content\": \"## Chatbot for Confluence Pages\\n\\n\\n\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"f37546a9-1b33-4276-9ea3-e461b53fe70a\",\n      \"name\": \"Chat Response\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        1700,\n        680\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"636ec5bb-141c-491b-b827-bf6c3753a531\",\n              \"name\": \"output\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.output }}\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 3.4\n    },\n    {\n      \"id\": \"c53f59bd-f0d9-4629-bf56-ca439ef9c7f5\",\n      \"name\": \"Globals\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        1100,\n        180\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"74683edb-6368-4673-95f3-2885e30595cf\",\n              \"name\": \"page_id_tekla\",\n              \"type\": \"string\",\n              \"value\": \"688157\"\n            },\n            {\n              \"id\": \"3a8796d7-3426-4f4a-bddf-973720b59e9d\",\n              \"name\": \"page_id_n8n\",\n              \"type\": \"string\",\n              \"value\": \"491546\"\n            },\n            {\n              \"id\": \"42b27698-8d11-4fb0-a308-e256e0752f4d\",\n              \"name\": \"page_id_more_n8n\",\n              \"type\": \"string\",\n              \"value\": \"983041\"\n            },\n            {\n              \"id\": \"62572887-e17a-4957-9ab1-3546277f79ab\",\n              \"name\": \"page_id_tekla_clash_checking\",\n              \"type\": \"string\",\n              \"value\": \"753691\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 3.4\n    },\n    {\n      \"id\": \"ee500c5b-9289-4636-8178-6235c0fe4080\",\n      \"name\": \"Search By ID\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        1300,\n        180\n      ],\n      \"parameters\": {\n        \"url\": \"=https://example.atlassian.net/wiki/rest/api/search?limit=1&cql=id={{ $json.page_id_n8n }}\",\n        \"options\": {},\n        \"authentication\": \"genericCredentialType\",\n        \"genericAuthType\": \"httpHeaderAuth\"\n      },\n      \"credentials\": {\n        \"httpHeaderAuth\": {\n          \"id\": \"KafuDlwiWOVNQcyC\",\n          \"name\": \"Confluence API\"\n        }\n      },\n      \"typeVersion\": 4.2\n    },\n    {\n      \"id\": \"934f0c57-6184-4c85-a0dc-097b3c470be4\",\n      \"name\": \"Sticky Note4\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        1020,\n        80\n      ],\n      \"parameters\": {\n        \"width\": 872,\n        \"height\": 297,\n        \"content\": \"## Confluence Search By ID\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"c51b8421-962d-46a1-aaf5-1b170252b7da\",\n      \"name\": \"Page Schema\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        1700,\n        180\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"3e8b49af-f3c6-4441-842f-9ce9a42c34b6\",\n              \"name\": \"content._links.webui\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.content._links.webui }}\"\n            },\n            {\n              \"id\": \"6fd53eb3-52b2-4f7b-92ca-89a26e05d52a\",\n              \"name\": \"content._links.self\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.content._links.self }}\"\n            },\n            {\n              \"id\": \"dfc89cbb-2f63-41ca-acfb-27b4d36d0418\",\n              \"name\": \"title\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.title }}\"\n            },\n            {\n              \"id\": \"0e15af12-8ae2-4337-a174-f3c3592bd0c6\",\n              \"name\": \"url\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.url }}\"\n            },\n            {\n              \"id\": \"6bbfa6eb-d6db-42c4-9ef6-81611fda0365\",\n              \"name\": \"excerpt\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.excerpt }}\"\n            },\n            {\n              \"id\": \"a5a26e42-af66-41a6-9406-7ccb86fb3386\",\n              \"name\": \"id\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.content.id }}\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 3.4\n    },\n    {\n      \"id\": \"2c765cad-e488-44ad-98b6-6e0a2c575fd2\",\n      \"name\": \"AI Agent\",\n      \"type\": \"@n8n/n8n-nodes-langchain.agent\",\n      \"position\": [\n        1300,\n        580\n      ],\n      \"parameters\": {\n        \"text\": \"=Answer questions from user with the context provided.  Only respond using the context.  If you do not know the answer simply respond with \\\"I don't know.\\\"\\n\\nUser question: {{ $('When chat message received').item.json.chatInput }}\\n\\nContext: {{ $json.data }}\",\n        \"agent\": \"conversationalAgent\",\n        \"options\": {},\n        \"promptType\": \"define\"\n      },\n      \"typeVersion\": 1.6\n    },\n    {\n      \"id\": \"a89508f9-fd88-4a9f-84da-a0ddef590e1b\",\n      \"name\": \"Send Telegram Message\",\n      \"type\": \"n8n-nodes-base.telegram\",\n      \"position\": [\n        1700,\n        480\n      ],\n      \"webhookId\": \"3ba1ee6d-1648-4421-823b-e68ae14d769b\",\n      \"parameters\": {\n        \"text\": \"={{ $json.output}}\",\n        \"chatId\": \"={{ $env.TELEGRAM_CHAT_ID }}\",\n        \"additionalFields\": {\n          \"parse_mode\": \"HTML\",\n          \"appendAttribution\": false\n        }\n      },\n      \"credentials\": {\n        \"telegramApi\": {\n          \"id\": \"pAIFhguJlkO3c7aQ\",\n          \"name\": \"Telegram account\"\n        }\n      },\n      \"typeVersion\": 1.2\n    },\n    {\n      \"id\": \"dae8ae00-1552-4945-948e-2556dfdd8802\",\n      \"name\": \"Split Out\",\n      \"type\": \"n8n-nodes-base.splitOut\",\n      \"position\": [\n        1500,\n        180\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"fieldToSplitOut\": \"results\"\n      },\n      \"typeVersion\": 1\n    }\n  ],\n  \"active\": false,\n  \"pinData\": {},\n  \"settings\": {\n    \"executionOrder\": \"v1\"\n  },\n  \"versionId\": \"d57c434b-ed09-484a-bcc4-d81681001a36\",\n  \"connections\": {\n    \"Globals\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Search By ID\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"AI Agent\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Chat Response\",\n            \"type\": \"main\",\n            \"index\": 0\n          },\n          {\n            \"node\": \"Send Telegram Message\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Split Out\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Page Schema\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Page Schema\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Confluence Page Storage View\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"gpt-4o-mini\": {\n      \"ai_languageModel\": [\n        [\n          {\n            \"node\": \"AI Agent\",\n            \"type\": \"ai_languageModel\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Search By ID\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Split Out\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"HTML to Markdown\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"AI Agent\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Window Buffer Memory\": {\n      \"ai_memory\": [\n        [\n          {\n            \"node\": \"AI Agent\",\n            \"type\": \"ai_memory\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"When chat message received\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Globals\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Confluence Page Storage View\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"HTML to Markdown\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}",
  "metadata": {
    "node_types": [
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.httpRequest",
      "n8n-nodes-base.markdown",
      "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "@n8n/n8n-nodes-langchain.manualChatTrigger",
      "@n8n/n8n-nodes-langchain.memoryBufferWindow",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.set",
      "n8n-nodes-base.set",
      "n8n-nodes-base.httpRequest",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.set",
      "@n8n/n8n-nodes-langchain.agent",
      "n8n-nodes-base.telegram",
      "n8n-nodes-base.splitOut"
    ],
    "trigger": null
  }
}