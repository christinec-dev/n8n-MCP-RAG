{
  "source": "1990_Wait_Code_Automation_Webhook.json",
  "index": 1,
  "content": "{\n  \"id\": \"C2pB17EpXAJwOcst\",\n  \"meta\": {\n    \"instanceId\": \"ba379c9b99d35340c90344105e7e5d06ca0de3e88926f0384d2c23099dad1937\"\n  },\n  \"name\": \"OpenAI Assistant for Hubspot Chat\",\n  \"tags\": [],\n  \"nodes\": [\n    {\n      \"id\": \"7f11a684-911b-4fbc-ba1b-a8e7bce8e914\",\n      \"name\": \"getHubspotMessage\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        280,\n        580\n      ],\n      \"parameters\": {\n        \"url\": \"=https://api.hubapi.com/conversations/v3/conversations/threads/{{ $json[\\\"body\\\"][0][\\\"objectId\\\"] }}/messages/{{ $json[\\\"body\\\"][0][\\\"messageId\\\"] }}\",\n        \"options\": {},\n        \"authentication\": \"predefinedCredentialType\",\n        \"nodeCredentialType\": \"hubspotAppToken\"\n      },\n      \"credentials\": {\n        \"hubspotAppToken\": {\n          \"id\": \"56nluFhXiGjYN1EY\",\n          \"name\": \"HubSpot App Token tinder\"\n        },\n        \"hubspotOAuth2Api\": {\n          \"id\": \"y6819fYl4TsW9gl6\",\n          \"name\": \"HubSpot account 6\"\n        },\n        \"hubspotDeveloperApi\": {\n          \"id\": \"dHB9nVcnZTqf2JDX\",\n          \"name\": \"HubSpot Developer account\"\n        }\n      },\n      \"typeVersion\": 4.1\n    },\n    {\n      \"id\": \"687bcbb8-38c8-4d21-a46f-186e880d003c\",\n      \"name\": \"OpenAi Create Thread\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        1260,\n        420\n      ],\n      \"parameters\": {\n        \"url\": \"https://api.openai.com/v1/threads\",\n        \"method\": \"POST\",\n        \"options\": {},\n        \"jsonBody\": \"={\\n \\\"messages\\\": [\\n {\\n \\\"role\\\": \\\"user\\\",\\n \\\"content\\\": \\\"{{ $('getHubspotMessage').item.json[\\\"text\\\"] }}\\\"\\n }\\n ]\\n}\",\n        \"sendBody\": true,\n        \"sendHeaders\": true,\n        \"specifyBody\": \"json\",\n        \"authentication\": \"predefinedCredentialType\",\n        \"headerParameters\": {\n          \"parameters\": [\n            {\n              \"name\": \"openai-beta\",\n              \"value\": \"assistants=v1\"\n            }\n          ]\n        },\n        \"nodeCredentialType\": \"openAiApi\"\n      },\n      \"credentials\": {\n        \"openAiApi\": {\n          \"id\": \"sCh1Lrc1ZT8NVcgn\",\n          \"name\": \"OpenAi Makeitfuture.eu\"\n        }\n      },\n      \"typeVersion\": 4.1\n    },\n    {\n      \"id\": \"8b51d465-d298-4b7a-b939-026bd51469d3\",\n      \"name\": \"OpenAI Run\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        1620,\n        420\n      ],\n      \"parameters\": {\n        \"url\": \"=https://api.openai.com/v1/threads/{{ $json[\\\"OpenAI Thread ID\\\"] }}/runs\",\n        \"method\": \"POST\",\n        \"options\": {},\n        \"jsonBody\": \"={\\n \\\"assistant_id\\\": \\\"asst_MA71Jq0SElVpdjmJa212CTFd\\\"\\n}\",\n        \"sendBody\": true,\n        \"sendHeaders\": true,\n        \"specifyBody\": \"json\",\n        \"authentication\": \"predefinedCredentialType\",\n        \"headerParameters\": {\n          \"parameters\": [\n            {\n              \"name\": \"openai-beta\",\n              \"value\": \"assistants=v1\"\n            }\n          ]\n        },\n        \"nodeCredentialType\": \"openAiApi\"\n      },\n      \"credentials\": {\n        \"openAiApi\": {\n          \"id\": \"sCh1Lrc1ZT8NVcgn\",\n          \"name\": \"OpenAi Makeitfuture.eu\"\n        }\n      },\n      \"typeVersion\": 4.1\n    },\n    {\n      \"id\": \"3e645c55-a236-466f-9983-2a3e91c250db\",\n      \"name\": \"Get Run\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        1920,\n        600\n      ],\n      \"parameters\": {\n        \"url\": \"=https://api.openai.com/v1/threads/{{ $json[\\\"thread_id\\\"] }}/runs/{{ $json[\\\"id\\\"] }}\",\n        \"options\": {},\n        \"sendHeaders\": true,\n        \"authentication\": \"predefinedCredentialType\",\n        \"headerParameters\": {\n          \"parameters\": [\n            {\n              \"name\": \"openai-beta\",\n              \"value\": \"assistants=v1\"\n            }\n          ]\n        },\n        \"nodeCredentialType\": \"openAiApi\"\n      },\n      \"credentials\": {\n        \"openAiApi\": {\n          \"id\": \"sCh1Lrc1ZT8NVcgn\",\n          \"name\": \"OpenAi Makeitfuture.eu\"\n        }\n      },\n      \"typeVersion\": 4.1,\n      \"alwaysOutputData\": true\n    },\n    {\n      \"id\": \"a69a1d1e-b932-481e-8d36-8d121c63ad4b\",\n      \"name\": \"Get Last Message\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        2520,\n        460\n      ],\n      \"parameters\": {\n        \"url\": \"=https://api.openai.com/v1/threads/{{ $json[\\\"thread_id\\\"] }}/messages\",\n        \"options\": {},\n        \"sendHeaders\": true,\n        \"authentication\": \"predefinedCredentialType\",\n        \"headerParameters\": {\n          \"parameters\": [\n            {\n              \"name\": \"openai-beta\",\n              \"value\": \"assistants=v1\"\n            }\n          ]\n        },\n        \"nodeCredentialType\": \"openAiApi\"\n      },\n      \"credentials\": {\n        \"openAiApi\": {\n          \"id\": \"sCh1Lrc1ZT8NVcgn\",\n          \"name\": \"OpenAi Makeitfuture.eu\"\n        }\n      },\n      \"typeVersion\": 4.1\n    },\n    {\n      \"id\": \"d9758207-56d4-4180-aac7-f0ebafab1064\",\n      \"name\": \"HTTP Request\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        2820,\n        960\n      ],\n      \"parameters\": {\n        \"url\": \"=https://www.listafirme.ro/api/search-v1.asp\",\n        \"options\": {},\n        \"sendQuery\": true,\n        \"queryParameters\": {\n          \"parameters\": [\n            {\n              \"name\": \"key\",\n              \"value\": \"982dc86a0c1bd4c71185d39ae9f36998\"\n            },\n            {\n              \"name\": \"src\",\n              \"value\": \"={{JSON.parse($json[\\\"required_action\\\"][\\\"submit_tool_outputs\\\"][\\\"tool_calls\\\"][0][\\\"function\\\"][\\\"arguments\\\"]).src}}\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 4.1\n    },\n    {\n      \"id\": \"5c6f30fd-3ac2-401c-897a-54c7e998c97b\",\n      \"name\": \"Completed, Action or Inprogress\",\n      \"type\": \"n8n-nodes-base.switch\",\n      \"position\": [\n        2120,\n        600\n      ],\n      \"parameters\": {\n        \"rules\": {\n          \"rules\": [\n            {\n              \"value2\": \"completed\"\n            },\n            {\n              \"output\": 1,\n              \"value2\": \"requires_action\"\n            },\n            {\n              \"output\": 2,\n              \"value2\": \"in_progress\",\n              \"operation\": \"=equal\"\n            },\n            {\n              \"output\": 3,\n              \"value2\": \"queued\"\n            }\n          ]\n        },\n        \"value1\": \"={{ $json.status }}\",\n        \"dataType\": \"string\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"c1bc0adf-3552-43a3-b38f-bfc76e2683cd\",\n      \"name\": \"Wait\",\n      \"type\": \"n8n-nodes-base.wait\",\n      \"position\": [\n        2360,\n        1000\n      ],\n      \"webhookId\": \"e15c2bb6-e022-4c6d-869b-f361b1ec1259\",\n      \"parameters\": {\n        \"unit\": \"seconds\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"2e0c4528-5b2b-4d3c-9b53-166ea0f2a28e\",\n      \"name\": \"Wait1\",\n      \"type\": \"n8n-nodes-base.wait\",\n      \"position\": [\n        2340,\n        760\n      ],\n      \"webhookId\": \"3a175bf4-c569-431e-bc56-abed3653ce9d\",\n      \"parameters\": {\n        \"unit\": \"seconds\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"f80a2cd8-6691-4186-909b-cfed95318014\",\n      \"name\": \"Submit Data\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        3360,\n        960\n      ],\n      \"parameters\": {\n        \"url\": \"=https://api.openai.com/v1/threads/{{ $('Select Function').item.json[\\\"thread_id\\\"] }}/runs/{{ $('Select Function').item.json[\\\"id\\\"] }}/submit_tool_outputs\",\n        \"method\": \"POST\",\n        \"options\": {},\n        \"jsonBody\": \"={\\n \\\"tool_outputs\\\": [\\n {\\n \\\"tool_call_id\\\": \\\"{{ $('Select Function').item.json[\\\"required_action\\\"][\\\"submit_tool_outputs\\\"][\\\"tool_calls\\\"][0][\\\"id\\\"] }}\\\",\\n \\\"output\\\": \\\"{{$json.escapedJsonString}}\\\"\\n }\\n ]\\n} \",\n        \"sendBody\": true,\n        \"sendHeaders\": true,\n        \"specifyBody\": \"json\",\n        \"authentication\": \"predefinedCredentialType\",\n        \"headerParameters\": {\n          \"parameters\": [\n            {\n              \"name\": \"openai-beta\",\n              \"value\": \"assistants=v1\"\n            }\n          ]\n        },\n        \"nodeCredentialType\": \"openAiApi\"\n      },\n      \"credentials\": {\n        \"openAiApi\": {\n          \"id\": \"sCh1Lrc1ZT8NVcgn\",\n          \"name\": \"OpenAi Makeitfuture.eu\"\n        }\n      },\n      \"typeVersion\": 4.1,\n      \"alwaysOutputData\": true\n    },\n    {\n      \"id\": \"eb114cfd-1af2-4c8b-bfba-583453a1d7ca\",\n      \"name\": \"Select Function\",\n      \"type\": \"n8n-nodes-base.switch\",\n      \"position\": [\n        2520,\n        700\n      ],\n      \"parameters\": {\n        \"rules\": {\n          \"rules\": [\n            {\n              \"value2\": \"getAWBbyOrder\"\n            },\n            {\n              \"output\": 1,\n              \"value2\": \"get_awb_history\"\n            }\n          ]\n        },\n        \"value1\": \"={{ $json.required_action.submit_tool_outputs.tool_calls[0].function.name }}\",\n        \"dataType\": \"string\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"4d1ad478-a9a4-4e9f-9b06-e2a9b7b2b55c\",\n      \"name\": \"Code1\",\n      \"type\": \"n8n-nodes-base.code\",\n      \"position\": [\n        3080,\n        960\n      ],\n      \"parameters\": {\n        \"jsCode\": \"const item1 = $input.all()[0]?.json;\\nconst jsonString = JSON.stringify(item1);\\nconst escapedJsonString = jsonString.replace(/\\\"/g, '\\\\\\\\\\\"');\\n\\nreturn { escapedJsonString };\\n\"\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"39cab0c4-1d7d-41cb-a88d-00acc8e79a24\",\n      \"name\": \"Wait2\",\n      \"type\": \"n8n-nodes-base.wait\",\n      \"position\": [\n        3720,\n        1400\n      ],\n      \"webhookId\": \"68ae5068-6a39-424c-b88d-019bfee78b6f\",\n      \"parameters\": {\n        \"unit\": \"seconds\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"54205ed2-7c96-44b6-9637-20830300310a\",\n      \"name\": \"HTTP Request1\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        2820,\n        1180\n      ],\n      \"parameters\": {\n        \"url\": \"=https://www.listafirme.ro/api/info-v1.asp\",\n        \"options\": {},\n        \"sendQuery\": true,\n        \"queryParameters\": {\n          \"parameters\": [\n            {\n              \"name\": \"key\",\n              \"value\": \"982dc86a0c1bd4c71185d39ae9f36998\"\n            },\n            {\n              \"name\": \"data\",\n              \"value\": \"={\\\"TaxCode\\\":\\\"{{JSON.parse($json[\\\"required_action\\\"][\\\"submit_tool_outputs\\\"][\\\"tool_calls\\\"][0][\\\"function\\\"][\\\"arguments\\\"]).src}}\\\",\\\"NACE\\\":\\\"info\\\",\\\"VAT\\\":\\\"\\\", \\\"RegNo\\\":\\\"\\\", \\\"Status\\\":\\\"\\\", \\\"LegalForm\\\":\\\"\\\", \\\"Name\\\":\\\"\\\", \\\"Date\\\":\\\"\\\", \\\"TownCode\\\":\\\"\\\", \\\"County\\\":\\\"\\\", \\\"City\\\":\\\"\\\", \\\"Address\\\":\\\"\\\", \\\"Administrators\\\":\\\"\\\", \\\"Shareholders\\\":\\\"\\\", \\\"Balance\\\":\\\"latest\\\", \\\"Phone\\\":\\\"\\\", \\\"Mobile\\\":\\\"\\\", \\\"Fax\\\":\\\"\\\", \\\"Email\\\":\\\"\\\", \\\"Web\\\":\\\"\\\", \\\"Geolocation\\\":\\\"\\\", \\\"Description\\\":\\\"\\\", \\\"Trademarks\\\":\\\"\\\", \\\"Subsidiaries\\\":\\\"\\\", \\\"Branches\\\":\\\"\\\", \\\"FiscalActivity\\\":\\\"\\\", \\\"Obligations\\\":\\\"\\\", \\\"Links\\\":\\\"\\\"}\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 4.1\n    },\n    {\n      \"id\": \"862ab78d-0288-4c78-9e02-7ad4ff794a6d\",\n      \"name\": \"Code\",\n      \"type\": \"n8n-nodes-base.code\",\n      \"position\": [\n        3060,\n        1180\n      ],\n      \"parameters\": {\n        \"jsCode\": \"const item1 = $input.all()[0]?.json;\\nconst jsonString = JSON.stringify(item1);\\nconst escapedJsonString = jsonString.replace(/\\\"/g, '\\\\\\\\\\\"');\\n\\nreturn { escapedJsonString };\\n\"\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"e9d1d277-107d-403c-9911-5faa4ae75671\",\n      \"name\": \"Submit Data1\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        3260,\n        1180\n      ],\n      \"parameters\": {\n        \"url\": \"=https://api.openai.com/v1/threads/{{ $('Select Function').item.json[\\\"thread_id\\\"] }}/runs/{{ $('Select Function').item.json[\\\"id\\\"] }}/submit_tool_outputs\",\n        \"method\": \"POST\",\n        \"options\": {},\n        \"jsonBody\": \"={\\n \\\"tool_outputs\\\": [\\n {\\n \\\"tool_call_id\\\": \\\"{{ $('Select Function').item.json[\\\"required_action\\\"][\\\"submit_tool_outputs\\\"][\\\"tool_calls\\\"][0][\\\"id\\\"] }}\\\",\\n \\\"output\\\": \\\"{{$json.escapedJsonString}}\\\"\\n }\\n ]\\n} \",\n        \"sendBody\": true,\n        \"sendHeaders\": true,\n        \"specifyBody\": \"json\",\n        \"authentication\": \"predefinedCredentialType\",\n        \"headerParameters\": {\n          \"parameters\": [\n            {\n              \"name\": \"openai-beta\",\n              \"value\": \"assistants=v1\"\n            }\n          ]\n        },\n        \"nodeCredentialType\": \"openAiApi\"\n      },\n      \"credentials\": {\n        \"openAiApi\": {\n          \"id\": \"sCh1Lrc1ZT8NVcgn\",\n          \"name\": \"OpenAi Makeitfuture.eu\"\n        }\n      },\n      \"typeVersion\": 4.1,\n      \"alwaysOutputData\": true\n    },\n    {\n      \"id\": \"28e7637b-9a3b-49ba-b4c7-efd3f6cf0522\",\n      \"name\": \"Wait3\",\n      \"type\": \"n8n-nodes-base.wait\",\n      \"position\": [\n        3460,\n        1360\n      ],\n      \"webhookId\": \"6d7d039c-8a4b-4178-8d31-57fb3c24ac14\",\n      \"parameters\": {\n        \"unit\": \"seconds\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"2b954546-8bc6-4028-9826-37a64d2aed04\",\n      \"name\": \"respondHubspotMessage1\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        2820,\n        420\n      ],\n      \"parameters\": {\n        \"url\": \"=https://api.hubapi.com/conversations/v3/conversations/threads/{{ $('getHubspotMessage').item.json[\\\"conversationsThreadId\\\"] }}/messages\",\n        \"method\": \"POST\",\n        \"options\": {},\n        \"sendBody\": true,\n        \"authentication\": \"predefinedCredentialType\",\n        \"bodyParameters\": {\n          \"parameters\": [\n            {\n              \"name\": \"type\",\n              \"value\": \"MESSAGE\"\n            },\n            {\n              \"name\": \"richText\",\n              \"value\": \"={{ $json.data[0].content[0].text.value }}\"\n            },\n            {\n              \"name\": \"senderActorId\",\n              \"value\": \"A-5721819\"\n            },\n            {\n              \"name\": \"channelId\",\n              \"value\": \"={{ $('getHubspotMessage').item.json.channelId }}\"\n            },\n            {\n              \"name\": \"channelAccountId\",\n              \"value\": \"={{ $('getHubspotMessage').item.json.channelAccountId }}\"\n            },\n            {\n              \"name\": \"text\",\n              \"value\": \"{{ $json.data[0].content[0].text.value }}\"\n            }\n          ]\n        },\n        \"nodeCredentialType\": \"hubspotAppToken\"\n      },\n      \"credentials\": {\n        \"hubspotAppToken\": {\n          \"id\": \"56nluFhXiGjYN1EY\",\n          \"name\": \"HubSpot App Token tinder\"\n        },\n        \"hubspotOAuth2Api\": {\n          \"id\": \"y6819fYl4TsW9gl6\",\n          \"name\": \"HubSpot account 6\"\n        },\n        \"hubspotDeveloperApi\": {\n          \"id\": \"dHB9nVcnZTqf2JDX\",\n          \"name\": \"HubSpot Developer account\"\n        }\n      },\n      \"typeVersion\": 4.1\n    },\n    {\n      \"id\": \"6facd7e9-5cbd-4eb7-ab22-84b4fbf35885\",\n      \"name\": \"IF\",\n      \"type\": \"n8n-nodes-base.if\",\n      \"position\": [\n        640,\n        600\n      ],\n      \"parameters\": {\n        \"conditions\": {\n          \"string\": [\n            {\n              \"value1\": \"={{ $('getHubspotMessage').item.json[\\\"senders\\\"][0][\\\"actorId\\\"] }}\",\n              \"value2\": \"A-5721819\",\n              \"operation\": \"notEqual\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"9410bce8-3a2d-4852-acbd-8baa7ee4964d\",\n      \"name\": \"Airtable\",\n      \"type\": \"n8n-nodes-base.airtable\",\n      \"position\": [\n        860,\n        600\n      ],\n      \"parameters\": {\n        \"base\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"appGAPr0tOy8J0NXC\",\n          \"cachedResultUrl\": \"https://airtable.com/appGAPr0tOy8J0NXC\",\n          \"cachedResultName\": \"Hubspot Conversations ChatGPT\"\n        },\n        \"table\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"tbljZ0POq35jgnKES\",\n          \"cachedResultUrl\": \"https://airtable.com/appGAPr0tOy8J0NXC/tbljZ0POq35jgnKES\",\n          \"cachedResultName\": \"Conversations\"\n        },\n        \"options\": {},\n        \"operation\": \"search\",\n        \"filterByFormula\": \"={Hubspot Thread ID}=\\\"{{ $json.conversationsThreadId }}\\\"\"\n      },\n      \"credentials\": {\n        \"airtableTokenApi\": {\n          \"id\": \"Ha1BL7JqKQIwX3H1\",\n          \"name\": \"Hubspot Conversations Makeitfuture Management\"\n        }\n      },\n      \"typeVersion\": 2,\n      \"alwaysOutputData\": true\n    },\n    {\n      \"id\": \"06449687-7521-4151-89c5-050a2768af13\",\n      \"name\": \"IF1\",\n      \"type\": \"n8n-nodes-base.if\",\n      \"position\": [\n        1040,\n        640\n      ],\n      \"parameters\": {\n        \"conditions\": {\n          \"string\": [\n            {\n              \"value1\": \"={{ $('Airtable').item.json.id }}\",\n              \"operation\": \"isEmpty\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"65c3015e-760f-41e8-9d18-05492cf908c8\",\n      \"name\": \"createThread\",\n      \"type\": \"n8n-nodes-base.airtable\",\n      \"position\": [\n        1440,\n        420\n      ],\n      \"parameters\": {\n        \"base\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"appGAPr0tOy8J0NXC\",\n          \"cachedResultUrl\": \"https://airtable.com/appGAPr0tOy8J0NXC\",\n          \"cachedResultName\": \"Hubspot Conversations ChatGPT\"\n        },\n        \"table\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"tbljZ0POq35jgnKES\",\n          \"cachedResultUrl\": \"https://airtable.com/appGAPr0tOy8J0NXC/tbljZ0POq35jgnKES\",\n          \"cachedResultName\": \"Conversations\"\n        },\n        \"columns\": {\n          \"value\": {\n            \"OpenAI Thread ID\": \"={{ $json[\\\"id\\\"] }}\",\n            \"Hubspot Thread ID\": \"={{ $('getHubspotMessage').item.json.conversationsThreadId }}\"\n          },\n          \"schema\": [\n            {\n              \"id\": \"Hubspot Thread ID\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"readOnly\": false,\n              \"required\": false,\n              \"displayName\": \"Hubspot Thread ID\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"OpenAI Thread ID\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"readOnly\": false,\n              \"required\": false,\n              \"displayName\": \"OpenAI Thread ID\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            }\n          ],\n          \"mappingMode\": \"defineBelow\",\n          \"matchingColumns\": []\n        },\n        \"options\": {},\n        \"operation\": \"create\"\n      },\n      \"credentials\": {\n        \"airtableTokenApi\": {\n          \"id\": \"Ha1BL7JqKQIwX3H1\",\n          \"name\": \"Hubspot Conversations Makeitfuture Management\"\n        }\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"14cd4854-34fa-4a40-8bd2-cce2d9da9571\",\n      \"name\": \"OpenAI Run1\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        1620,\n        780\n      ],\n      \"parameters\": {\n        \"url\": \"=https://api.openai.com/v1/threads/{{ $('Airtable').item.json[\\\"OpenAI Thread ID\\\"] }}/runs\",\n        \"method\": \"POST\",\n        \"options\": {},\n        \"jsonBody\": \"={\\n \\\"assistant_id\\\": \\\"asst_MA71Jq0SElVpdjmJa212CTFd\\\"\\n}\",\n        \"sendBody\": true,\n        \"sendHeaders\": true,\n        \"specifyBody\": \"json\",\n        \"authentication\": \"predefinedCredentialType\",\n        \"headerParameters\": {\n          \"parameters\": [\n            {\n              \"name\": \"openai-beta\",\n              \"value\": \"assistants=v1\"\n            }\n          ]\n        },\n        \"nodeCredentialType\": \"openAiApi\"\n      },\n      \"credentials\": {\n        \"openAiApi\": {\n          \"id\": \"sCh1Lrc1ZT8NVcgn\",\n          \"name\": \"OpenAi Makeitfuture.eu\"\n        }\n      },\n      \"typeVersion\": 4.1,\n      \"continueOnFail\": true,\n      \"alwaysOutputData\": false\n    },\n    {\n      \"id\": \"7c37641f-b0a4-4031-b289-3d6aed5a5bd6\",\n      \"name\": \"IF2\",\n      \"type\": \"n8n-nodes-base.if\",\n      \"position\": [\n        60,\n        600\n      ],\n      \"parameters\": {\n        \"conditions\": {\n          \"string\": [\n            {\n              \"value1\": \"={{ $json[\\\"body\\\"][0][\\\"messageId\\\"] }}\",\n              \"operation\": \"isNotEmpty\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"12744ebd-1d36-4f3c-9cbe-2ed7d18d37e3\",\n      \"name\": \"Sticky Note1\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -200,\n        440\n      ],\n      \"parameters\": {\n        \"width\": 640.1970959824021,\n        \"height\": 428.68258455167785,\n        \"content\": \"Watch for new message on the chatbot. \\nThis can be triggered with [n8n chat widget](https://www.npmjs.com/package/@n8n/chat), hubspot or other chat services. \\n\\n\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"9c200085-e9aa-4e11-93c2-da8184976229\",\n      \"name\": \"Sticky Note\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        2480,\n        340\n      ],\n      \"parameters\": {\n        \"width\": 615.2010006500725,\n        \"height\": 279.76857176586907,\n        \"content\": \"Post assistant Message back to chat service, in this case Hubspot\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"4458aafb-d280-46d0-ba54-3eb4ee746892\",\n      \"name\": \"Sticky Note2\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        1200,\n        300\n      ],\n      \"parameters\": {\n        \"width\": 636.6434938094908,\n        \"height\": 304.69360473583896,\n        \"content\": \"Create a new Thread, save it to database and RUN\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"f13f45aa-47c9-4a76-a69c-f13f51d9434f\",\n      \"name\": \"Sticky Note3\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        480,\n        440\n      ],\n      \"parameters\": {\n        \"width\": 328.9155262250898,\n        \"height\": 421.64797280574976,\n        \"content\": \"UPDATE USER FILTER FOR DUPLICATION\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"ba0d0a2c-5014-44b8-a281-9d5014b78bcc\",\n      \"name\": \"Sticky Note6\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        840,\n        440\n      ],\n      \"parameters\": {\n        \"width\": 328.9155262250898,\n        \"height\": 421.64797280574976,\n        \"content\": \"Search for Thread ID in a database. \\n\\nThis database is maintaing references between messaging service thread id and OpenI Thread ID. \"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"3d3562b5-631f-405c-b671-6856214f167f\",\n      \"name\": \"Sticky Note7\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        1200,\n        680\n      ],\n      \"parameters\": {\n        \"width\": 636.6434938094908,\n        \"height\": 304.69360473583896,\n        \"content\": \"POST a new message to existing thread.\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"9ad1622c-5b42-4279-bf16-edf7bcbb5155\",\n      \"name\": \"Sticky Note8\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        1900,\n        320\n      ],\n      \"parameters\": {\n        \"width\": 393.4831089305742,\n        \"height\": 629.4777449641093,\n        \"content\": \"Get Run Status:\\nIf still in progress, run again. \\nIf action needed go to respective action.\\nIf Completed, post message.\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"e51965ef-7694-41b3-9c9a-9f78c00af3f3\",\n      \"name\": \"Sticky Note9\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        2538.191410231545,\n        840\n      ],\n      \"parameters\": {\n        \"width\": 1361.867818730004,\n        \"height\": 731.995091888263,\n        \"content\": \"Run required actions based on Assistant answer and respond to Assistant with the function answer. \\n\\nEach route is a function that you need to define inside your assistant configuration.\\n\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"706fb261-724e-4c22-8def-24a320d213a2\",\n      \"name\": \"OpenAI\",\n      \"type\": \"@n8n/n8n-nodes-langchain.openAi\",\n      \"position\": [\n        1280,\n        780\n      ],\n      \"parameters\": {\n        \"text\": \"={{ $('getHubspotMessage').item.json[\\\"text\\\"] }}\",\n        \"prompt\": \"define\",\n        \"options\": {\n          \"baseURL\": \"https://api.openai.com/v1/threads/{{ $('Airtable').item.json[\\\"OpenAI Thread ID\\\"] }}/messages\"\n        },\n        \"resource\": \"assistant\",\n        \"assistantId\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"asst_wVbEcnRttQ8K65DOV0fk1DJU\",\n          \"cachedResultName\": \"Lista Firma Agent\"\n        }\n      },\n      \"credentials\": {\n        \"openAiApi\": {\n          \"id\": \"sCh1Lrc1ZT8NVcgn\",\n          \"name\": \"OpenAi Makeitfuture.eu\"\n        }\n      },\n      \"typeVersion\": 1.3\n    },\n    {\n      \"id\": \"b8f686cc-33d6-4e99-987c-d1f91864e81d\",\n      \"name\": \"Webhook\",\n      \"type\": \"n8n-nodes-base.webhook\",\n      \"position\": [\n        -160,\n        600\n      ],\n      \"webhookId\": \"637d5b46-b35f-4943-92a2-864ddce170f4\",\n      \"parameters\": {\n        \"path\": \"hubspot-tinder\",\n        \"options\": {},\n        \"httpMethod\": \"POST\"\n      },\n      \"typeVersion\": 1\n    }\n  ],\n  \"active\": false,\n  \"pinData\": {},\n  \"settings\": {\n    \"executionOrder\": \"v1\"\n  },\n  \"versionId\": \"d9763b45-9092-490f-85b4-926354cdeb47\",\n  \"connections\": {\n    \"IF\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Airtable\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"IF1\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"OpenAi Create Thread\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"OpenAI\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"IF2\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"getHubspotMessage\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Code\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Submit Data1\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Wait\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Get Run\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Code1\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Submit Data\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Wait1\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Get Run\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Wait2\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Get Run\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Wait3\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Get Run\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"OpenAI\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"OpenAI Run1\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Get Run\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Completed, Action or Inprogress\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Webhook\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"IF2\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Airtable\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"IF1\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"OpenAI Run\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Get Run\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"OpenAI Run1\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Get Run\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Submit Data\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Wait2\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"HTTP Request\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Code1\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Submit Data1\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Wait3\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"createThread\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"OpenAI Run\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"HTTP Request1\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Code\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Select Function\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"HTTP Request\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"HTTP Request1\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Get Last Message\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"respondHubspotMessage1\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"getHubspotMessage\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"IF\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"OpenAi Create Thread\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"createThread\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Completed, Action or Inprogress\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Get Last Message\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Select Function\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Wait1\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Wait\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}",
  "metadata": {
    "node_types": [
      "n8n-nodes-base.httpRequest",
      "n8n-nodes-base.httpRequest",
      "n8n-nodes-base.httpRequest",
      "n8n-nodes-base.httpRequest",
      "n8n-nodes-base.httpRequest",
      "n8n-nodes-base.httpRequest",
      "n8n-nodes-base.switch",
      "n8n-nodes-base.wait",
      "n8n-nodes-base.wait",
      "n8n-nodes-base.httpRequest",
      "n8n-nodes-base.switch",
      "n8n-nodes-base.code",
      "n8n-nodes-base.wait",
      "n8n-nodes-base.httpRequest",
      "n8n-nodes-base.code",
      "n8n-nodes-base.httpRequest",
      "n8n-nodes-base.wait",
      "n8n-nodes-base.httpRequest",
      "n8n-nodes-base.if",
      "n8n-nodes-base.airtable",
      "n8n-nodes-base.if",
      "n8n-nodes-base.airtable",
      "n8n-nodes-base.httpRequest",
      "n8n-nodes-base.if",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "@n8n/n8n-nodes-langchain.openAi",
      "n8n-nodes-base.webhook"
    ],
    "trigger": null
  }
}