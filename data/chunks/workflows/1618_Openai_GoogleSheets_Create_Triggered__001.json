{
  "source": "1618_Openai_GoogleSheets_Create_Triggered.json",
  "index": 1,
  "content": "{\n  \"id\": \"8FLJK1NsduFL0Y5P\",\n  \"meta\": {\n    \"instanceId\": \"fb924c73af8f703905bc09c9ee8076f48c17b596ed05b18c0ff86915ef8a7c4a\"\n  },\n  \"name\": \"Qualify new leads in Google Sheets via OpenAI's GPT-4\",\n  \"tags\": [\n    {\n      \"id\": \"y9tvM3hISJKT2jeo\",\n      \"name\": \"Ted's Tech Talks\",\n      \"createdAt\": \"2023-08-15T22:12:34.260Z\",\n      \"updatedAt\": \"2023-08-15T22:12:34.260Z\"\n    }\n  ],\n  \"nodes\": [\n    {\n      \"id\": \"1f179325-0bec-4e5c-8ebd-0a2bb3ebefaa\",\n      \"name\": \"Merge\",\n      \"type\": \"n8n-nodes-base.merge\",\n      \"position\": [\n        1440,\n        340\n      ],\n      \"parameters\": {\n        \"mode\": \"combine\",\n        \"options\": {},\n        \"combinationMode\": \"mergeByPosition\"\n      },\n      \"typeVersion\": 2.1\n    },\n    {\n      \"id\": \"7b548661-2b32-451f-ba52-91ca86728f1e\",\n      \"name\": \"Sticky Note\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        358,\n        136.3642172523962\n      ],\n      \"parameters\": {\n        \"width\": 442,\n        \"height\": 360.6357827476038,\n        \"content\": \"### 1. Create a Google Sheet document\\n* This template uses Google Sheet document connected to Google Forms, but a standalone Sheet document will work too\\n* Adapt initial trigger to your needs: check for new entries periodically or add a manual trigger\\n\\n[Link to the Google Sheet template](https://docs.google.com/spreadsheets/d/1jk8ZbfOMObvHGGImc0sBJTZB_hracO4jRqfbryMgzEs)\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"308b4dce-4656-47bd-b217-69565b1c34f6\",\n      \"name\": \"Sticky Note1\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        820,\n        420\n      ],\n      \"parameters\": {\n        \"width\": 471,\n        \"height\": 322,\n        \"content\": \"### 2. Provide lead qualification instructions\\n* Create a __system message__ with overall instructions\\n* Add a __user message__ with the JSON variables\\n* Set node parses the resulting JSON object, but you can also request a plain string response in the system message\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"c00442ca-98cf-4296-b084-f0881ce4fd39\",\n      \"name\": \"Sticky Note2\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        1320,\n        222.18785942492013\n      ],\n      \"parameters\": {\n        \"width\": 355,\n        \"height\": 269.81214057507987,\n        \"content\": \"### 3. Combine the initial data with GPT response\\n* This Merge node puts together original records from the google sheet and responses from the OpenAI\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"62643a4c-a69c-4351-9960-20413285ff33\",\n      \"name\": \"Sticky Note3\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        1700,\n        220\n      ],\n      \"parameters\": {\n        \"width\": 398,\n        \"height\": 265,\n        \"content\": \"### 4. Update the Google Sheet document\\n* Provide __Column to Match On__ (usually a timestamp in case of Google Forms)\\n* Enter the result from GPT into a separate column\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"4cd58340-81c4-46c7-b346-25a9b6ef2910\",\n      \"name\": \"Update lead status\",\n      \"type\": \"n8n-nodes-base.googleSheets\",\n      \"position\": [\n        1860,\n        340\n      ],\n      \"parameters\": {\n        \"columns\": {\n          \"value\": {\n            \"Rating\": \"={{ $json.reply.rating }}\",\n            \"Timestamp\": \"={{ $json.Timestamp }}\"\n          },\n          \"schema\": [\n            {\n              \"id\": \"Timestamp\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"Timestamp\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"Email Address\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": true,\n              \"required\": false,\n              \"displayName\": \"Email Address\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"Your name\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": true,\n              \"required\": false,\n              \"displayName\": \"Your name\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"Your business area\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": true,\n              \"required\": false,\n              \"displayName\": \"Your business area\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"Your team size\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": true,\n              \"required\": false,\n              \"displayName\": \"Your team size\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"Rating\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"required\": false,\n              \"displayName\": \"Rating\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"row_number\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": true,\n              \"readOnly\": true,\n              \"required\": false,\n              \"displayName\": \"row_number\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            }\n          ],\n          \"mappingMode\": \"defineBelow\",\n          \"matchingColumns\": [\n            \"Timestamp\"\n          ]\n        },\n        \"options\": {},\n        \"operation\": \"update\",\n        \"sheetName\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": 72739218,\n          \"cachedResultUrl\": \"https://docs.google.com/spreadsheets/d/1jk8ZbfOMObvHGGImc0sBJTZB_hracO4jRqfbryMgzEs/edit#gid=72739218\",\n          \"cachedResultName\": \"Form Responses 1\"\n        },\n        \"documentId\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"1jk8ZbfOMObvHGGImc0sBJTZB_hracO4jRqfbryMgzEs\",\n          \"cachedResultUrl\": \"https://docs.google.com/spreadsheets/d/1jk8ZbfOMObvHGGImc0sBJTZB_hracO4jRqfbryMgzEs/edit?usp=drivesdk\",\n          \"cachedResultName\": \"Join Community (Responses)\"\n        }\n      },\n      \"credentials\": {\n        \"googleSheetsOAuth2Api\": {\n          \"id\": \"RtRiRezoxiWkzZQt\",\n          \"name\": \"Ted's Tech Talks Google account\"\n        }\n      },\n      \"typeVersion\": 4.2\n    },\n    {\n      \"id\": \"fea0acee-13b6-441a-8cf9-c8fedbc4617d\",\n      \"name\": \"Extract JSON reply\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        1120,\n        580\n      ],\n      \"parameters\": {\n        \"fields\": {\n          \"values\": [\n            {\n              \"name\": \"reply\",\n              \"type\": \"objectValue\",\n              \"objectValue\": \"={{ JSON.parse($json.message.content) }}\"\n            }\n          ]\n        },\n        \"include\": \"selected\",\n        \"options\": {}\n      },\n      \"typeVersion\": 3.2\n    },\n    {\n      \"id\": \"0a0608fe-894f-4eb5-b690-233c6dfc0428\",\n      \"name\": \"Qualify leads with GPT\",\n      \"type\": \"n8n-nodes-base.openAi\",\n      \"position\": [\n        900,\n        580\n      ],\n      \"parameters\": {\n        \"prompt\": {\n          \"messages\": [\n            {\n              \"role\": \"system\",\n              \"content\": \"Your task is to qualify incoming leads. Leads are form submissions to a closed community group. Use the following criteria for a quality lead:\\n\\n1. We are looking for decision makers who run companies or who have some teams. The bigger the team - the better. Basically, everyone with some level of responsibility should be accepted. This is the main criterion.\\n2. Email from a non-standard domain. Ideally this should be a corporate domain, but this is a secondary criterion.\\n\\nPlease thing step by step whether a lead is quality or not?\\n\\nIf at least one of the criteria satisfy, reply with \\\"qualified\\\" in response. Otherwise reply \\\"not qualified\\\". Reply with a JSON of the following structure: {\\\"rating\\\":\\\"string\\\",\\\"explanation\\\":\\\"string\\\"}. Reply only with with the JSON and nothing more!\"\n            },\n            {\n              \"content\": \"=Here's a lead info:\\nName: {{ $json['Your name'] }}\\nEmail: {{ $json['Email Address'] }}\\nBusiness area: {{ $json['Your business area'] }}\\nSize of the team: {{ $json['Your team size'] }}\"\n            }\n          ]\n        },\n        \"options\": {\n          \"temperature\": 0.3\n        },\n        \"resource\": \"chat\",\n        \"chatModel\": \"gpt-4-turbo-preview\"\n      },\n      \"credentials\": {\n        \"openAiApi\": {\n          \"id\": \"rveqdSfp7pCRON1T\",\n          \"name\": \"Ted's Tech Talks OpenAi\"\n        }\n      },\n      \"typeVersion\": 1.1\n    },\n    {\n      \"id\": \"22fdec69-a4a9-430d-9950-79195799ae7a\",\n      \"name\": \"Check for new entries\",\n      \"type\": \"n8n-nodes-base.googleSheetsTrigger\",\n      \"position\": [\n        520,\n        340\n      ],\n      \"parameters\": {\n        \"event\": \"rowAdded\",\n        \"options\": {},\n        \"pollTimes\": {\n          \"item\": [\n            {\n              \"mode\": \"everyMinute\"\n            }\n          ]\n        },\n        \"sheetName\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": 72739218,\n          \"cachedResultUrl\": \"https://docs.google.com/spreadsheets/d/1jk8ZbfOMObvHGGImc0sBJTZB_hracO4jRqfbryMgzEs/edit#gid=72739218\",\n          \"cachedResultName\": \"Form Responses 1\"\n        },\n        \"documentId\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"1jk8ZbfOMObvHGGImc0sBJTZB_hracO4jRqfbryMgzEs\",\n          \"cachedResultUrl\": \"https://docs.google.com/spreadsheets/d/1jk8ZbfOMObvHGGImc0sBJTZB_hracO4jRqfbryMgzEs/edit?usp=drivesdk\",\n          \"cachedResultName\": \"Join Community (Responses)\"\n        }\n      },\n      \"credentials\": {\n        \"googleSheetsTriggerOAuth2Api\": {\n          \"id\": \"m33qCYf9eEvSgo0x\",\n          \"name\": \"Ted's Tech Talks Google Sheets Trigger\"\n        }\n      },\n      \"typeVersion\": 1\n    }\n  ],\n  \"active\": false,\n  \"pinData\": {},\n  \"settings\": {\n    \"callerPolicy\": \"workflowsFromSameOwner\",\n    \"executionOrder\": \"v1\",\n    \"saveManualExecutions\": true,\n    \"saveExecutionProgress\": true,\n    \"saveDataSuccessExecution\": \"all\"\n  },\n  \"versionId\": \"ffad0998-1a6b-469d-9297-6d7fd88387b9\",\n  \"connections\": {\n    \"Merge\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Update lead status\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Extract JSON reply\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Merge\",\n            \"type\": \"main\",\n            \"index\": 1\n          }\n        ]\n      ]\n    },\n    \"Check for new entries\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Merge\",\n            \"type\": \"main\",\n            \"index\": 0\n          },\n          {\n            \"node\": \"Qualify leads with GPT\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Qualify leads with GPT\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Extract JSON reply\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}",
  "metadata": {
    "node_types": [
      "n8n-nodes-base.merge",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.googleSheets",
      "n8n-nodes-base.set",
      "n8n-nodes-base.openAi",
      "n8n-nodes-base.googleSheetsTrigger"
    ],
    "trigger": null
  }
}