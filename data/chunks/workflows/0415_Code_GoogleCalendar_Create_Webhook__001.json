{
  "source": "0415_Code_GoogleCalendar_Create_Webhook.json",
  "index": 1,
  "content": "{\n  \"meta\": {\n    \"instanceId\": \"3c58c896c9089c8fb4d7f2b069bf3119193f239a1f538829758e2f4d6b5f5b24\"\n  },\n  \"nodes\": [\n    {\n      \"id\": \"9aa9fa6c-5ccb-4f2b-b6a8-2b91f4a58355\",\n      \"name\": \"Setup\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        420,\n        680\n      ],\n      \"parameters\": {\n        \"fields\": {\n          \"values\": [\n            {\n              \"name\": \"apiKey\",\n              \"stringValue\": \"32aa914c947342169c4998b6701a77e0\"\n            },\n            {\n              \"name\": \"newsAge\",\n              \"type\": \"numberValue\",\n              \"numberValue\": \"10\"\n            },\n            {\n              \"name\": \"maxArticles\",\n              \"stringValue\": \"20\"\n            },\n            {\n              \"name\": \"emails\"\n            }\n          ]\n        },\n        \"options\": {}\n      },\n      \"typeVersion\": 3.2\n    },\n    {\n      \"id\": \"6f471217-b69b-4f67-981d-c7c1e2d710b6\",\n      \"name\": \"Extract company name\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        1100,\n        480\n      ],\n      \"parameters\": {\n        \"fields\": {\n          \"values\": [\n            {\n              \"name\": \"companyName\",\n              \"stringValue\": \"={{ $json.summary.toLowerCase().replace('meeting with', '').replace('call with', '').trim() }}\"\n            }\n          ]\n        },\n        \"options\": {}\n      },\n      \"typeVersion\": 3.2\n    },\n    {\n      \"id\": \"9bb5adfa-5a36-453e-ad8d-59229ca2f1ab\",\n      \"name\": \"Sticky Note\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        200,\n        320\n      ],\n      \"parameters\": {\n        \"color\": 4,\n        \"width\": 436,\n        \"height\": 192,\n        \"content\": \"### Latest company news before a call\\n\\nThis workflow will send you a list of latest news about a company for every meeting in your calendar each day, keeping you up to date with your leads and meeting partners.\\n\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"ddfa92e0-ff37-4733-9002-65fe21989d8a\",\n      \"name\": \"Every morning @ 7\",\n      \"type\": \"n8n-nodes-base.scheduleTrigger\",\n      \"position\": [\n        200,\n        680\n      ],\n      \"parameters\": {\n        \"rule\": {\n          \"interval\": [\n            {\n              \"triggerAtHour\": 7\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 1.1\n    },\n    {\n      \"id\": \"b71c3683-6077-41b4-ab23-66ee22f64532\",\n      \"name\": \"Filter meetings\",\n      \"type\": \"n8n-nodes-base.if\",\n      \"position\": [\n        840,\n        680\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"conditions\": {\n          \"options\": {\n            \"leftValue\": \"\",\n            \"caseSensitive\": true,\n            \"typeValidation\": \"strict\"\n          },\n          \"combinator\": \"or\",\n          \"conditions\": [\n            {\n              \"id\": \"bcfb06b1-d365-43a8-9802-869529baca98\",\n              \"operator\": {\n                \"type\": \"string\",\n                \"operation\": \"startsWith\"\n              },\n              \"leftValue\": \"={{ $json.summary.toLowerCase() }}\",\n              \"rightValue\": \"call with\"\n            },\n            {\n              \"id\": \"4ea43ccf-d586-4985-87db-fc1e9f734351\",\n              \"operator\": {\n                \"type\": \"string\",\n                \"operation\": \"startsWith\"\n              },\n              \"leftValue\": \"={{ $json.summary.toLowerCase() }}\",\n              \"rightValue\": \"meeting with\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"34c4241e-e29a-4d9a-b8a8-130b9f19383f\",\n      \"name\": \"Get latest news\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        1300,\n        480\n      ],\n      \"parameters\": {\n        \"url\": \"=https://newsapi.org/v2/everything?apiKey={{ $('Setup').first().json.apiKey }}&q={{ $json.companyName }}&from={{ DateTime.now().minus({ days: $('Setup').first().json.newsAge }).toFormat('yyyy-MM-dd') }}&sortBy=publishedAt&language=en&pageSize={{ $('Setup').first().json.maxArticles }}&searchIn=title\",\n        \"options\": {}\n      },\n      \"typeVersion\": 4.1\n    },\n    {\n      \"id\": \"51059db7-5fec-4287-bf3f-a6a4e76ac5a4\",\n      \"name\": \"Format for email\",\n      \"type\": \"n8n-nodes-base.code\",\n      \"position\": [\n        1500,\n        480\n      ],\n      \"parameters\": {\n        \"mode\": \"runOnceForEachItem\",\n        \"jsCode\": \"let html = `<table style=\\\"width: 100%\\\">`;\\nhtml += '</table>';\\n\\nfor(article of $input.item.json.articles) {\\n  console.log(article)\\n  html += `\\n    <tr>\\n      <td style=\\\"display: flex; background-color: #f2f4f8; font-family: sans-serif; padding: 0.3em 0.5em\\\">\\n        <div style=\\\"padding: 1em\\\">\\n          <a style=\\\"display: block; margin-bottom: 10px; font-size: 1.2em\\\" href=\\\"${article.url}\\\">${article.title}</a>\\n          <i>\\n            ${article.description ? article.description : article.content}\\n          </i>\\n          <div style=\\\"margin-top: 1em\\\">\\n            ${ article.source?.name ? '<b>Source:</b> ' + article.source?.name : '' }\\n          </div>\\n        </div>\\n      </td>\\n    </tr>\\n  `\\n}\\nreturn { \\\"html\\\": html };\"\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"9b4351a8-edf9-49ef-829e-6998cb1eea2c\",\n      \"name\": \"Send news\",\n      \"type\": \"n8n-nodes-base.gmail\",\n      \"position\": [\n        1700,\n        480\n      ],\n      \"parameters\": {\n        \"sendTo\": \"={{ $('Setup').first().json.emails }}\",\n        \"message\": \"={{ $json.html }}\",\n        \"options\": {},\n        \"subject\": \"=Latest news for '{{ $('Extract company name').item.json.summary }}'\"\n      },\n      \"credentials\": {\n        \"gmailOAuth2\": {\n          \"id\": \"10\",\n          \"name\": \"mrdosija@gmail.com\"\n        }\n      },\n      \"typeVersion\": 2.1\n    },\n    {\n      \"id\": \"182504b0-3cf6-4afe-ba93-1d2bf7a02fa3\",\n      \"name\": \"Sticky Note1\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        360,\n        640\n      ],\n      \"parameters\": {\n        \"height\": 511.499984507795,\n        \"content\": \"\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n### Configure your workflow here\\n1. `apiKey` - Your API key for [News API](https://newsapi.org)\\n2. `newsAge` - How old should news be, in days\\n3. `maxArticles` - Number of articles that will be sent, max 100\\n4. `emails`- List of email addresses that should receive the news, separated by commas\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"604bc73b-f805-40df-baa0-eb3de4c515f3\",\n      \"name\": \"Sticky Note2\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        820,\n        660\n      ],\n      \"parameters\": {\n        \"width\": 231.52514020446353,\n        \"height\": 275.2500697149263,\n        \"content\": \"\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\nThis will get all meetings that start with *Meeting with* or *Call with* but feel free to update the filter to suit your needs.\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"318b2bdc-712f-42a8-b224-8f0dc2c9c4e5\",\n      \"name\": \"No meetings today\",\n      \"type\": \"n8n-nodes-base.noOp\",\n      \"position\": [\n        1700,\n        700\n      ],\n      \"parameters\": {},\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"96b075cd-5c16-453e-93a6-348b22b704bb\",\n      \"name\": \"Get meetings for today\",\n      \"type\": \"n8n-nodes-base.googleCalendar\",\n      \"position\": [\n        660,\n        680\n      ],\n      \"parameters\": {\n        \"options\": {\n          \"timeMax\": \"={{ $today.plus({ days: 1 }) }}\",\n          \"timeMin\": \"={{ $today }}\",\n          \"singleEvents\": true\n        },\n        \"calendar\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"milorad.filipovic19@gmail.com\",\n          \"cachedResultName\": \"milorad.filipovic19@gmail.com\"\n        },\n        \"operation\": \"getAll\"\n      },\n      \"credentials\": {\n        \"googleCalendarOAuth2Api\": {\n          \"id\": \"22\",\n          \"name\": \"Google Calendar account\"\n        }\n      },\n      \"typeVersion\": 1\n    }\n  ],\n  \"pinData\": {},\n  \"connections\": {\n    \"Setup\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Get meetings for today\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Filter meetings\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Extract company name\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"No meetings today\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Get latest news\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Format for email\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Format for email\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Send news\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Every morning @ 7\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Setup\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Extract company name\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Get latest news\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Get meetings for today\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Filter meetings\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}",
  "metadata": {
    "node_types": [
      "n8n-nodes-base.set",
      "n8n-nodes-base.set",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.scheduleTrigger",
      "n8n-nodes-base.if",
      "n8n-nodes-base.httpRequest",
      "n8n-nodes-base.code",
      "n8n-nodes-base.gmail",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.noOp",
      "n8n-nodes-base.googleCalendar"
    ],
    "trigger": null
  }
}