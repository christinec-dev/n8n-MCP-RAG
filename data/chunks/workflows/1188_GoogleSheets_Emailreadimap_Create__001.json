{
  "source": "1188_GoogleSheets_Emailreadimap_Create.json",
  "index": 1,
  "content": "{\n  \"id\": 90,\n  \"name\": \"Extract expenses from emails and add to Google Sheet\",\n  \"nodes\": [\n    {\n      \"name\": \"Check subject\",\n      \"type\": \"n8n-nodes-base.if\",\n      \"position\": [\n        800,\n        300\n      ],\n      \"parameters\": {\n        \"conditions\": {\n          \"string\": [\n            {\n              \"value1\": \"={{$json[\\\"subject\\\"].toLowerCase()}}\",\n              \"value2\": \"=/{{$json[\\\"subjectPatterns\\\"].toLowerCase()}}/\",\n              \"operation\": \"regex\"\n            }\n          ]\n        },\n        \"combineOperation\": \"any\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Setup Variables\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        620,\n        300\n      ],\n      \"parameters\": {\n        \"values\": {\n          \"string\": [\n            {\n              \"name\": \"subjectPatterns\",\n              \"value\": \"(expenses|reciept)\"\n            }\n          ]\n        },\n        \"options\": {}\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Check for new emails\",\n      \"type\": \"n8n-nodes-base.emailReadImap\",\n      \"position\": [\n        440,\n        300\n      ],\n      \"parameters\": {\n        \"format\": \"resolved\",\n        \"mailbox\": \"Inbox\",\n        \"options\": {\n          \"allowUnauthorizedCerts\": true\n        }\n      },\n      \"credentials\": {\n        \"imap\": {\n          \"id\": \"24\",\n          \"name\": \"GMAIL\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Read Receipts\",\n      \"type\": \"n8n-nodes-base.mindee\",\n      \"position\": [\n        1020,\n        280\n      ],\n      \"parameters\": {\n        \"binaryPropertyName\": \"attachment_0\"\n      },\n      \"credentials\": {\n        \"mindeeReceiptApi\": {\n          \"id\": \"61\",\n          \"name\": \"Mindee Receipt account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Set column data\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        1200,\n        280\n      ],\n      \"parameters\": {\n        \"values\": {\n          \"string\": [\n            {\n              \"name\": \"Date\",\n              \"value\": \"={{$json[\\\"date\\\"]}}\"\n            },\n            {\n              \"name\": \"Description\",\n              \"value\": \"={{$node[\\\"Check for new emails\\\"].json[\\\"subject\\\"].split(\\\"-\\\")[1]}}\"\n            },\n            {\n              \"name\": \"Category\",\n              \"value\": \"={{$json[\\\"category\\\"]}}\"\n            },\n            {\n              \"name\": \"Currency\",\n              \"value\": \"={{$json[\\\"currency\\\"]}}\"\n            },\n            {\n              \"name\": \"Amount\",\n              \"value\": \"={{$json[\\\"total\\\"]}}\"\n            }\n          ]\n        },\n        \"options\": {}\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Add to Google Sheet\",\n      \"type\": \"n8n-nodes-base.googleSheets\",\n      \"position\": [\n        1380,\n        280\n      ],\n      \"parameters\": {\n        \"range\": \"A:E\",\n        \"options\": {},\n        \"sheetId\": \"1xAtx1ORZYKu4urgqpOe3DawFjiWeOZO0VCVvOlQYnaE\",\n        \"operation\": \"append\",\n        \"authentication\": \"oAuth2\"\n      },\n      \"credentials\": {\n        \"googleSheetsOAuth2Api\": {\n          \"id\": \"8\",\n          \"name\": \"Sheets\"\n        }\n      },\n      \"typeVersion\": 1\n    }\n  ],\n  \"active\": false,\n  \"settings\": {},\n  \"connections\": {\n    \"Check subject\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Read Receipts\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Read Receipts\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Set column data\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Set column data\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Add to Google Sheet\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Setup Variables\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Check subject\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Check for new emails\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Setup Variables\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}",
  "metadata": {
    "node_types": [
      "n8n-nodes-base.if",
      "n8n-nodes-base.set",
      "n8n-nodes-base.emailReadImap",
      "n8n-nodes-base.mindee",
      "n8n-nodes-base.set",
      "n8n-nodes-base.googleSheets"
    ],
    "trigger": null
  }
}