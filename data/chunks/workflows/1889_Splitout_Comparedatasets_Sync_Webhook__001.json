{
  "source": "1889_Splitout_Comparedatasets_Sync_Webhook.json",
  "index": 1,
  "content": "{\n  \"id\": \"ikxQzs58WxtUjbuE\",\n  \"meta\": {\n    \"instanceId\": \"494d0146a0f47676ad70a44a32086b466621f62da855e3eaf0ee51dee1f76753\",\n    \"templateCredsSetupCompleted\": true\n  },\n  \"name\": \"Entra Contacts to Zammad User Sync\",\n  \"tags\": [],\n  \"nodes\": [\n    {\n      \"id\": \"5cf615cd-d555-4efa-bde4-5e1e2bda0c71\",\n      \"name\": \"When clicking ‘Test workflow’\",\n      \"type\": \"n8n-nodes-base.manualTrigger\",\n      \"position\": [\n        -2120,\n        160\n      ],\n      \"parameters\": {},\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"334e380c-ce6b-48c6-be2a-e688cd52ef14\",\n      \"name\": \"Note1\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -1700,\n        380\n      ],\n      \"parameters\": {\n        \"width\": 1635.910561370123,\n        \"height\": 329.7269624573379,\n        \"content\": \"## Select Entra Contacts that should be synced to Zammad\\n\\n\\n\\n\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"39b9ace7-97ba-4202-9c7a-752f67c6a60b\",\n      \"name\": \"Zammad Univeral User Object\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        -500,\n        500\n      ],\n      \"parameters\": {\n        \"values\": {\n          \"number\": [\n            {\n              \"name\": \"entra_key\",\n              \"value\": \"={{ $json.id }}\"\n            }\n          ],\n          \"string\": [\n            {\n              \"name\": \"email\",\n              \"value\": \"={{ $json.mail }}\"\n            },\n            {\n              \"name\": \"lastname\",\n              \"value\": \"={{ $json.surname }}\"\n            },\n            {\n              \"name\": \"firstname\",\n              \"value\": \"={{ $json.givenName }}\"\n            },\n            {\n              \"name\": \"mobile\",\n              \"value\": \"={{ $json.phones[1].number }}\"\n            },\n            {\n              \"name\": \"phone\",\n              \"value\": \"={{ $json.phones[2].number }}\"\n            }\n          ]\n        },\n        \"options\": {},\n        \"keepOnlySet\": true\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"df5b4173-e1bd-49ce-9827-1b51a5e98da0\",\n      \"name\": \"Get Zammad Users\",\n      \"type\": \"n8n-nodes-base.zammad\",\n      \"position\": [\n        -1000,\n        160\n      ],\n      \"parameters\": {\n        \"filters\": {},\n        \"operation\": \"getAll\",\n        \"returnAll\": true\n      },\n      \"credentials\": {\n        \"zammadTokenAuthApi\": {\n          \"id\": \"fj5GuzcJuNLQeMxz\",\n          \"name\": \"Zammad Token Auth account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"7f1d3b74-48dd-4245-9f17-286bcc552047\",\n      \"name\": \"Merge\",\n      \"type\": \"n8n-nodes-base.merge\",\n      \"position\": [\n        200,\n        180\n      ],\n      \"parameters\": {\n        \"mode\": \"combine\",\n        \"options\": {},\n        \"fieldsToMatchString\": \"email\"\n      },\n      \"typeVersion\": 3\n    },\n    {\n      \"id\": \"c98c849e-8b0c-45b0-9b05-6b648bf9329c\",\n      \"name\": \"Find new Zammad Users\",\n      \"type\": \"n8n-nodes-base.compareDatasets\",\n      \"position\": [\n        200,\n        460\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"mergeByFields\": {\n          \"values\": [\n            {\n              \"field1\": \"email\",\n              \"field2\": \"email\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 2.3\n    },\n    {\n      \"id\": \"079437ca-a379-48ba-a4e5-52b87454adba\",\n      \"name\": \"Update Zammad User\",\n      \"type\": \"n8n-nodes-base.zammad\",\n      \"position\": [\n        560,\n        180\n      ],\n      \"parameters\": {\n        \"id\": \"={{ $json.id }}\",\n        \"operation\": \"update\",\n        \"updateFields\": {\n          \"phone\": \"={{ $json.phone }}\",\n          \"mobile\": \"={{ $json.mobile }}\",\n          \"lastname\": \"={{ $json.lastname }}\",\n          \"firstname\": \"={{ $json.firstname }}\",\n          \"customFieldsUi\": {\n            \"customFieldPairs\": [\n              {\n                \"name\": \"entra_key\",\n                \"value\": \"={{ $json.entra_key }}\"\n              },\n              {\n                \"name\": \"entra_object_type\",\n                \"value\": \"contact\"\n              }\n            ]\n          }\n        }\n      },\n      \"credentials\": {\n        \"zammadTokenAuthApi\": {\n          \"id\": \"fj5GuzcJuNLQeMxz\",\n          \"name\": \"Zammad Token Auth account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"34140616-c9c2-4899-a6a8-dc6e89a87c5c\",\n      \"name\": \"Create Zammad User\",\n      \"type\": \"n8n-nodes-base.zammad\",\n      \"position\": [\n        580,\n        480\n      ],\n      \"parameters\": {\n        \"lastname\": \"={{ $json.lastname }}\",\n        \"firstname\": \"={{ $json.firstname }}\",\n        \"additionalFields\": {\n          \"email\": \"={{ $json.email }}\",\n          \"phone\": \"={{ $json.phone }}\",\n          \"mobile\": \"={{ $json.mobile }}\",\n          \"customFieldsUi\": {\n            \"customFieldPairs\": [\n              {\n                \"name\": \"entra_key\",\n                \"value\": \"={{ $json.entra_key }}\"\n              },\n              {\n                \"name\": \"entra_object_type\",\n                \"value\": \"contact\"\n              }\n            ]\n          }\n        }\n      },\n      \"credentials\": {\n        \"zammadTokenAuthApi\": {\n          \"id\": \"fj5GuzcJuNLQeMxz\",\n          \"name\": \"Zammad Token Auth account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"6c8ef4d9-7bb2-4090-a0cf-411269f766aa\",\n      \"name\": \"Deactivate Zammad User\",\n      \"type\": \"n8n-nodes-base.zammad\",\n      \"position\": [\n        600,\n        860\n      ],\n      \"parameters\": {\n        \"id\": \"={{ $json.id }}\",\n        \"operation\": \"update\",\n        \"updateFields\": {\n          \"phone\": \"={{ $json.phone }}\",\n          \"active\": false,\n          \"mobile\": \"={{ $json.mobile }}\",\n          \"lastname\": \"={{ $json.lastname }}\",\n          \"firstname\": \"={{ $json.firstname }}\",\n          \"customFieldsUi\": {\n            \"customFieldPairs\": [\n              {\n                \"name\": \"entra_key\",\n                \"value\": \"={{ $json.entra_key }}\"\n              },\n              {\n                \"name\": \"entra_object_type\",\n                \"value\": \"contact\"\n              }\n            ]\n          }\n        }\n      },\n      \"credentials\": {\n        \"zammadTokenAuthApi\": {\n          \"id\": \"fj5GuzcJuNLQeMxz\",\n          \"name\": \"Zammad Token Auth account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"e3db9840-666a-42d3-9466-70e970a57f29\",\n      \"name\": \"Find removed Users\",\n      \"type\": \"n8n-nodes-base.compareDatasets\",\n      \"position\": [\n        200,\n        880\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"resolve\": \"preferInput1\",\n        \"mergeByFields\": {\n          \"values\": [\n            {\n              \"field1\": \"entra_key\",\n              \"field2\": \"entra_key\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 2.3\n    },\n    {\n      \"id\": \"6100fd80-8d9c-44ed-bfc1-6d39794c5405\",\n      \"name\": \"Get Contacts from Entra\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        -1600,\n        500\n      ],\n      \"parameters\": {\n        \"url\": \"https://graph.microsoft.com/v1.0/contacts\",\n        \"options\": {},\n        \"authentication\": \"predefinedCredentialType\",\n        \"nodeCredentialType\": \"microsoftOAuth2Api\"\n      },\n      \"credentials\": {\n        \"microsoftOAuth2Api\": {\n          \"id\": \"U2E5p3lreqSi8v1N\",\n          \"name\": \"ms365test.zammad.org\"\n        },\n        \"microsoftGraphSecurityOAuth2Api\": {\n          \"id\": \"b09tqOxzkl0P8UQD\",\n          \"name\": \"ms365test.zammad.org\"\n        }\n      },\n      \"typeVersion\": 4.2\n    },\n    {\n      \"id\": \"27e598a5-39a5-408b-a8ab-bf0ada9a6870\",\n      \"name\": \"Entra Contacts\",\n      \"type\": \"n8n-nodes-base.splitOut\",\n      \"position\": [\n        -1220,\n        500\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"fieldToSplitOut\": \"value\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"ac38d73e-7a71-4b7d-913e-abc96236b124\",\n      \"name\": \"Filter contacts if needed\",\n      \"type\": \"n8n-nodes-base.if\",\n      \"position\": [\n        -840,\n        500\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"conditions\": {\n          \"options\": {\n            \"version\": 2,\n            \"leftValue\": \"\",\n            \"caseSensitive\": true,\n            \"typeValidation\": \"strict\"\n          },\n          \"combinator\": \"and\",\n          \"conditions\": [\n            {\n              \"id\": \"15da9b4f-46fa-4e9b-bd33-40ae79b88cd5\",\n              \"operator\": {\n                \"type\": \"object\",\n                \"operation\": \"exists\",\n                \"singleValue\": true\n              },\n              \"leftValue\": \"={{ $json }}\",\n              \"rightValue\": \"\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 2.2\n    },\n    {\n      \"id\": \"28d3faf9-7cf4-4470-941b-abada3de3b9c\",\n      \"name\": \"Filter if needed\",\n      \"type\": \"n8n-nodes-base.if\",\n      \"position\": [\n        -400,\n        160\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"conditions\": {\n          \"options\": {\n            \"version\": 2,\n            \"leftValue\": \"\",\n            \"caseSensitive\": true,\n            \"typeValidation\": \"strict\"\n          },\n          \"combinator\": \"and\",\n          \"conditions\": [\n            {\n              \"id\": \"5b258616-66b2-4378-8215-5dce8edd19b3\",\n              \"operator\": {\n                \"type\": \"string\",\n                \"operation\": \"equals\"\n              },\n              \"leftValue\": \"={{ $json.entra_object_type }}\",\n              \"rightValue\": \"contact\"\n            },\n            {\n              \"id\": \"0d569bde-d384-48d0-a208-aa707752d6e5\",\n              \"operator\": {\n                \"type\": \"boolean\",\n                \"operation\": \"true\",\n                \"singleValue\": true\n              },\n              \"leftValue\": \"={{ $json.active }}\",\n              \"rightValue\": \"\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 2.2\n    }\n  ],\n  \"active\": false,\n  \"pinData\": {},\n  \"settings\": {\n    \"executionOrder\": \"v1\"\n  },\n  \"versionId\": \"55f3ac0f-d15e-4643-a1ca-26f4ade7bb14\",\n  \"connections\": {\n    \"Merge\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Update Zammad User\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Entra Contacts\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Filter contacts if needed\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Filter if needed\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Merge\",\n            \"type\": \"main\",\n            \"index\": 0\n          },\n          {\n            \"node\": \"Find new Zammad Users\",\n            \"type\": \"main\",\n            \"index\": 0\n          },\n          {\n            \"node\": \"Find removed Users\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Get Zammad Users\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Filter if needed\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Find removed Users\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Deactivate Zammad User\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Find new Zammad Users\": {\n      \"main\": [\n        [],\n        [],\n        [],\n        [\n          {\n            \"node\": \"Create Zammad User\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Get Contacts from Entra\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Entra Contacts\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Filter contacts if needed\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Zammad Univeral User Object\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Zammad Univeral User Object\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Merge\",\n            \"type\": \"main\",\n            \"index\": 1\n          },\n          {\n            \"node\": \"Find new Zammad Users\",\n            \"type\": \"main\",\n            \"index\": 1\n          },\n          {\n            \"node\": \"Find removed Users\",\n            \"type\": \"main\",\n            \"index\": 1\n          }\n        ]\n      ]\n    },\n    \"When clicking ‘Test workflow’\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Get Zammad Users\",\n            \"type\": \"main\",\n            \"index\": 0\n          },\n          {\n            \"node\": \"Get Contacts from Entra\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}",
  "metadata": {
    "node_types": [
      "n8n-nodes-base.manualTrigger",
      "n8n-nodes-base.stickyNote",
      "n8n-nodes-base.set",
      "n8n-nodes-base.zammad",
      "n8n-nodes-base.merge",
      "n8n-nodes-base.compareDatasets",
      "n8n-nodes-base.zammad",
      "n8n-nodes-base.zammad",
      "n8n-nodes-base.zammad",
      "n8n-nodes-base.compareDatasets",
      "n8n-nodes-base.httpRequest",
      "n8n-nodes-base.splitOut",
      "n8n-nodes-base.if",
      "n8n-nodes-base.if"
    ],
    "trigger": null
  }
}